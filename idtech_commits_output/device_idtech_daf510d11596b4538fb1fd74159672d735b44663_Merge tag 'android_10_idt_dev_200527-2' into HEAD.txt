daf510d1 George.Huang 2020-06-01

Merge tag 'android_10_idt_dev_200527-2' into HEAD

android_10_idt_dev_vp6820_8mq-userdebug-daily_66

Change-Id: I1bda66c614cecb09aeb57f7f11c5e2207a753eee

diff --cc common/build/dtbo.mk
index 183e9a5f,bc6d7620..e8c88a71
--- a/common/build/dtbo.mk
+++ b/common/build/dtbo.mk
@@@ -27,25 -27,44 +27,59 @@@ els
  $(error kernel arch not supported at present)
  endif
  
+ ifeq ($(BOARD_SOC_TYPE), IMX8MN)
+ IMX8MN_RAM := -ddr4
+ IMX8MN_TYPE := -trusty
+ endif
+ 
+ TARGET_MTDTBOIMAGE_CONFIG_PATH=$(TARGET_OUT_INTERMEDIATES)/KERNEL_OBJ/arch/$(TARGET_KERNEL_ARCH)/boot/dts/$(DTS_ADDITIONAL_PATH)/
+ # Include all IDT DTS's
+ LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
+ LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
+ idt_dts_list := $(shell ls $(TARGET_KERNEL_SRC)/arch/$(KERNEL_SRC_ARCH)/boot/dts/$(DTS_ADDITIONAL_PATH)/idt_$(LOWER_BOARD_SOC_TYPE)*evk* | xargs -n 1 basename | sed 's/\(.*\)\..*//')
+ idt_dts_list := $(idt_dts_list) $(shell ls $(TARGET_KERNEL_SRC)/arch/$(KERNEL_SRC_ARCH)/boot/dts/$(DTS_ADDITIONAL_PATH)/idt_$(BOARD_SOM_TYPE)*devboard* | xargs -n 1 basename | sed 's/\(.*\)\..*//')
+ idt_dts_list += $(idt_dts_list) $(shell ls $(TARGET_KERNEL_SRC)/arch/$(KERNEL_SRC_ARCH)/boot/dts/$(DTS_ADDITIONAL_PATH)/idt_$(BOARD_SOM_TYPE)*$(LOWER_BOARD_TYPE)* | xargs -n 1 basename | sed 's/\(.*\)\..*//')
+ 
+ $(foreach idt_dts,$(idt_dts_list),$(eval TARGET_BOARD_DTS_CONFIG += $(idt_dts):$(idt_dts).dtb))
+ 
  MKDTIMG := $(HOST_OUT_EXECUTABLES)/mkdtimg
 -DTS_PATH := $(TARGET_KERNEL_SRC)/arch/$(KERNEL_SRC_ARCH)/boot/dts/$(DTS_ADDITIONAL_PATH)/
 -DTS_SRC :=
 +DTB_OUT_PATH := $(KERNEL_OUT)/arch/$(TARGET_KERNEL_ARCH)/boot/dts/$(DTS_ADDITIONAL_PATH)/
 +
 +TARGET_DTB :=
  $(foreach dts_config,$(TARGET_BOARD_DTS_CONFIG), \
 -    $(eval DTS_SRC += $(addprefix $(DTS_PATH),$(shell echo ${dts_config} | cut -d':' -f2 | sed 's/dtb/dts/g' ))))
 +	$(eval TARGET_DTB += $(addprefix $(DTB_OUT_PATH),$(shell echo ${dts_config} | cut -d':' -f2))))
  
++<<<<<<< HEAD
 +$(BOARD_PREBUILT_DTBOIMAGE): $(KERNEL_BIN) $(TARGET_DTB) | $(MKDTIMG) $(AVBTOOL)
 +	$(hide) echo "Building $(KERNEL_ARCH) dtbo ..."
 +	for dtsplat in $(TARGET_BOARD_DTS_CONFIG); do \
 +		DTS_PLATFORM=`echo $$dtsplat | cut -d':' -f1`; \
 +		DTB_NAME=`echo $$dtsplat | cut -d':' -f2`; \
 +		DTB=`echo $(KERNEL_OUT)/arch/$(TARGET_KERNEL_ARCH)/boot/dts/$(DTS_ADDITIONAL_PATH)/$${DTB_NAME}`; \
 +		DTBO_IMG=`echo $(PRODUCT_OUT)/dtbo-$${DTS_PLATFORM}.img`; \
 +		$(MKDTIMG) create $$DTBO_IMG $$DTB; \
 +		$(AVBTOOL) add_hash_footer --image $$DTBO_IMG  \
 +			--partition_name dtbo \
 +			--partition_size $(BOARD_DTBOIMG_PARTITION_SIZE); \
++=======
+ define clean_cfg
+ 	rm -f $(TARGET_MTDTBOIMAGE_CONFIG_PATH)*.cfg
+ endef
+ 
+ $(BOARD_PREBUILT_DTBOIMAGE): $(KERNEL_BIN) $(DTS_SRC) | $(MKDTIMG) $(AVBTOOL)
+ 	$(hide) echo "Building $(KERNEL_ARCH) dtbo ..."
+ 	$(call clean_cfg, $(TARGET_MTDTBOIMAGE_CONFIG_PATH)); \
+ 	for dtsplat in $(shell ls $(TARGET_MTDTBOIMAGE_CONFIG_PATH)| grep "idt_"); do \
+ 		DTB_NAME=`echo $$dtsplat`; \
+ 		DTB=`echo $(PRODUCT_OUT)/obj/KERNEL_OBJ/arch/$(TARGET_KERNEL_ARCH)/boot/dts/$(DTS_ADDITIONAL_PATH)/$${DTB_NAME}`; \
+ 		echo $$DTB >> $(TARGET_MTDTBOIMAGE_CONFIG_PATH)idt_dtbo_image.cfg ; \
+ 		echo "" >> $(TARGET_MTDTBOIMAGE_CONFIG_PATH)idt_dtbo_image.cfg ; \
++>>>>>>> android_10_idt_dev_200527-2
  	done
+ 	$(MKDTIMG) cfg_create $(PRODUCT_OUT)/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img $(TARGET_MTDTBOIMAGE_CONFIG_PATH)idt_dtbo_image.cfg; \
+ 	$(AVBTOOL) add_hash_footer --image $(PRODUCT_OUT)/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img  \
+ 		--partition_name dtbo \
+ 		--partition_size $(BOARD_DTBOIMG_PARTITION_SIZE); \
  
  .PHONY: dtboimage
  dtboimage: $(BOARD_PREBUILT_DTBOIMAGE)
diff --cc common/tools/fastboot_imx_flashall.bat
index 44370955,11169da9..485b6921
--- a/common/tools/fastboot_imx_flashall.bat
+++ b/common/tools/fastboot_imx_flashall.bat
@@@ -23,13 -34,17 +34,25 @@@ set systemimage_file=system.im
  set vendor_file=vendor.img
  set product_file=product.img
  set partition_file=partition-table.img
++<<<<<<< HEAD
 +set super_file=super.img
++=======
+ set spl_table_file=spl_tab.img
++>>>>>>> android_10_idt_dev_200527-2
  set /A support_dtbo=0
  set /A support_recovery=0
  set /A support_dualslot=0
  set /A support_mcu_os=0
  set /A support_dual_bootloader=0
++<<<<<<< HEAD
 +set /A support_dynamic_partition=0
++=======
+ set /A support_board_info=0
+ set /A write_bdinfo_serial=0
+ set /A support_idt_dual_spl=0
+ set /A support_idt_backup_spl=0
+ set /A support_idt_spl_table=0
++>>>>>>> android_10_idt_dev_200527-2
  set dual_bootloader_partition=
  set bootloader_flashed_to_board=
  set uboot_proper_to_be_flashed=
@@@ -42,7 -57,7 +65,11 @@@ set product_partition=produc
  set vbmeta_partition=vbmeta
  set dtbo_partition=dtbo
  set mcu_os_partition=mcu_os
++<<<<<<< HEAD
 +set super_partition=super
++=======
+ set board_info_partition=board_info
++>>>>>>> android_10_idt_dev_200527-2
  set /A flash_mcu=0
  set /A statisc=0
  set /A lock=0
@@@ -52,23 -67,15 +79,32 @@@ set ser_num
  set fastboot_tool=fastboot
  set /A error_level=0
  set /A flag=1
++<<<<<<< HEAD
 +set lpmake_system_image_a=
 +set lpmake_system_image_b=
 +set lpmake_vendor_image_a=
 +set lpmake_vendor_image_b=
 +set lpmake_product_image_a=
 +set lpmake_product_image_b=
 +set /A dont_generate_super=0
 +
++=======
+ set board_type=
++>>>>>>> android_10_idt_dev_200527-2
  
  :: We want to detect illegal feature input to some extent. Here it's based on SoC names. Since an SoC may be on a
  :: board running different set of images(android and automative for a example), so misuse the features of one set of
  :: images when flash another set of images can not be detect early with this scenario.
  set imx8mm_uboot_feature=dual trusty-dual 4g-evk-uuu 4g ddr4-evk-uuu ddr4 evk-uuu trusty-4g trusty-secure-unlock trusty
  set imx8mn_uboot_feature=dual trusty-dual evk-uuu trusty-secure-unlock trusty
++<<<<<<< HEAD
 +set imx8mp_uboot_feature=dual trusty-dual evk-uuu trusty-secure-unlock trusty
 +set imx8mq_uboot_feature=dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu
 +set imx8qxp_uboot_feature=mek-uuu trusty-secure-unlock trusty secure-unlock c0 trusty-c0 mek-c0-uuu
++=======
+ set imx8mq_uboot_feature=dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu signed dual-signed
+ set imx8qxp_uboot_feature=mek-uuu trusty-secure-unlock trusty secure-unlock
++>>>>>>> android_10_idt_dev_200527-2
  set imx8qm_uboot_feature=mek-uuu trusty-secure-unlock trusty secure-unlock md
  set imx7ulp_uboot_feature=evk-uuu
  
@@@ -109,7 -115,9 +145,13 @@@ if %1 == -l set /A lock=1 & shift & got
  if %1 == -e set /A erase=1 & shift & goto :parse_loop
  if %1 == -D set image_directory=%2& shift & shift & goto :parse_loop
  if %1 == -s set ser_num=%2&shift &shift & goto :parse_loop
++<<<<<<< HEAD
 +if %1 == -super set /A dont_generate_super=1 & shift & goto :parse_loop
++=======
+ if %1 == -tos set /A support_trusty=1 & shift & goto :parse_loop
+ if %1 == -bdinfo set board_info_file=%2& shift & shift & goto :parse_loop
+ if %1 == -serial set serialno_str=%2& set /A write_bdinfo_serial=1& shift & shift & goto :parse_loop
++>>>>>>> android_10_idt_dev_200527-2
  echo %1 is an illegal option
  call :help & goto :eof
  :parse_end
@@@ -225,10 -235,10 +273,15 @@@ goto :eo
  ::----------------------------------------------------------------------------------
  
  :help
++<<<<<<< HEAD
 +echo Version: 1.5
 +echo Last change: generate super.img when flash images with dynamic partition feature
++=======
+ echo Version: 1.6
+ echo Last change: add "-u" option to specify which uboot or spl&bootloader image to flash
++>>>>>>> android_10_idt_dev_200527-2
  echo.
- echo eg: fastboot_imx_flashall.bat -f imx8mm -a -D C:\Users\user_01ndroid10vk_8mm
+ echo eg: fastboot_imx_flashall.bat -f imx8mq -bdinfo board_info-imx8mq_evt-0_evk_idtechspi-0.img
  echo eg: fastboot_imx_flashall.bat -f imx7ulp -D C:\Users\user_01ndroid10vk_7ulp
  echo.
  echo Usage: %script_name% ^<option^>
@@@ -258,11 -268,9 +311,15 @@@ echo                           ©¦   imx
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
  echo                           ©¦   imx8mn       ©¦  dual trusty-dual evk-uuu trusty-secure-unlock trusty                                                ©¦
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
++<<<<<<< HEAD
 +echo                           ©¦   imx8mp       ©¦  dual trusty-dual evk-uuu trusty-secure-unlock trusty                                                ©¦
 +echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
 +echo                           ©¦   imx8mq       ©¦  dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu                                        ©¦
++=======
+ echo                           ©¦   imx8mq       ©¦  dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu signed dual-signed                     ©¦
++>>>>>>> android_10_idt_dev_200527-2
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
 -echo                           ©¦   imx8qxp      ©¦  mek-uuu trusty-secure-unlock trusty secure-unlock                                                   ©¦
 +echo                           ©¦   imx8qxp      ©¦  mek-uuu trusty-secure-unlock trusty secure-unlock c0 trusty-c0 mek-c0-uuu                           ©¦
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
  echo                           ©¦   imx8qm       ©¦  mek-uuu trusty-secure-unlock trusty secure-unlock md                                                ©¦
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
@@@ -296,10 -302,9 +353,16 @@@ echo  -D directory      the directory o
  echo                        No need to use this option if images are in current working directory
  echo  -s ser_num        the serial number of board
  echo                        If only one board connected to computer, no need to use this option
++<<<<<<< HEAD
 +echo  -super            do not generate super.img when flash the images with dynamic partition feature enabled.
 +echo                        Under the condition that dynamic partition feature are enabled:
 +echo                          if this option is not used, super.img will be generated under current working directory and flashed to the board.
 +echo                          if this option is used, make sure super.img already exists together with other images.
++=======
+ echo  -bdinfo board_info_file  flash board_info with this board_info_file image
+ echo                               If not set, use naming from current board_info partition
+ echo  -serial serialno_str  write serial number into device emmc, this could be program once in secure-user build
++>>>>>>> android_10_idt_dev_200527-2
  goto :eof
  
  :: this function checks whether the value of first parameter is in the array value of second parameter.
@@@ -443,9 -526,18 +602,19 @@@ find "recovery" fastboot_var.log > nul 
  
  ::use boot_b to check whether current gpt support a/b slot
  find "boot_b" fastboot_var.log > nul && set /A support_dualslot=1
 +find "super" fastboot_var.log > nul && set /A support_dynamic_partition=1
  del fastboot_var.log
  
+ if %support_board_info% == 1 (
+     call :check_board_info
+     if [%ERRORLEVEL%] == [2] goto :exit
+     call :check_android_info
+     if [%ERRORLEVEL%] == [3] goto :exit
+ )
+ if %support_board_info% == 1 (
+     set board_type=-%mb_model%
+ )
+ 
  :: some partitions are hard-coded in uboot, flash the uboot first and then reboot to check these partitions
  
  :: uboot or spl&bootloader
@@@ -503,9 -609,8 +685,14 @@@ if %support_dualslot% == 0 
      call :flash_partition_name %slot% || set /A error_level=1 && goto :exit
      call :flash_userpartitions || set /A error_level=1 && goto :exit
  )
++<<<<<<< HEAD
 +::super partition does not have a/b slot, handle it individually
 +if %support_dynamic_partition% == 1 (
 +    call :flash_partition %super_partition% || set /A error_level=1 && goto :exit
++=======
+ if %write_bdinfo_serial% == 1 (
+     %fastboot_tool% oem setvar dev-serial %serialno_str%
++>>>>>>> android_10_idt_dev_200527-2
  )
  
  del fastboot_var.log
diff --cc common/tools/fastboot_imx_flashall.sh
index 3d66e237,f371118b..dbdd8d63
--- a/common/tools/fastboot_imx_flashall.sh
+++ b/common/tools/fastboot_imx_flashall.sh
@@@ -5,11 -5,11 +5,16 @@@ help() 
  bn=`basename $0`
  cat << EOF
  
++<<<<<<< HEAD
 +Version: 1.5
 +Last change: generate super.img when flash images with dynamic partition feature
++=======
+ Version: 1.6
+ Last change: add "-u" option to specify which uboot or spl&bootloader image to flash
++>>>>>>> android_10_idt_dev_200527-2
  
- eg: sudo ./fastboot_imx_flashall.sh -f imx8mm -a -D ~/android10/evk_8mm/
- eg: sudo ./fastboot_imx_flashall.sh -f imx7ulp -D ~/android10/evk_7ulp/
+ eg: sudo ./fastboot_imx_flashall.sh -f imx8mm -bdinfo board_info-imx8mq_evt-0_evk_idtechspi-0.img
+ eg: sudo ./fastboot_imx_flashall.sh -f imx7ulp -f imx8mq -e -a -bdinfo board_info-imx8mq_evt-0_evk_evk-0.img
  
  Usage: $bn <option>
  
@@@ -38,11 -38,9 +43,15 @@@ options
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                             â”‚   imx8mn       â”‚  dual trusty-dual evk-uuu trusty-secure-unlock trusty                                                â”‚
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
++<<<<<<< HEAD
 +                           â”‚   imx8mp       â”‚  dual trusty-dual evk-uuu trusty-secure-unlock trusty                                                â”‚
 +                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 +                           â”‚   imx8mq       â”‚  dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu                                        â”‚
++=======
+                            â”‚   imx8mq       â”‚  dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu signed dual-signed                     â”‚
++>>>>>>> android_10_idt_dev_200527-2
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 -                           â”‚   imx8qxp      â”‚  mek-uuu trusty-secure-unlock trusty secure-unlock                                                   â”‚
 +                           â”‚   imx8qxp      â”‚  mek-uuu trusty-secure-unlock trusty secure-unlock c0 trusty-c0 mek-c0-uuu                           â”‚
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                             â”‚   imx8qm       â”‚  mek-uuu trusty-secure-unlock trusty secure-unlock md                                                â”‚
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
@@@ -76,10 -72,10 +85,17 @@@
                          No need to use this option if images are in current working directory
    -s ser_num        the serial number of board
                          If only one board connected to computer, no need to use this option
++<<<<<<< HEAD
 +  -super            do not generate super.img when flash the images with dynamic partition feature enabled.
 +                        Under the condition that dynamic partition feature are enabled:
 +                          if this option is not used, super.img will be generated under "/tmp" and flashed to the board.
 +                          if this option is used, make sure super.img already exists together with other images.
++=======
+   -R                with this option used, choose the u-boot about 1GB RAM setting.
+   -bdinfo board_info_file  flash board_info with this board_info_file image
+                                If not set, use naming from current board_info partition
+   -serial serialno_str  write serial number into device emmc, this could be program once in secure-user build
++>>>>>>> android_10_idt_dev_200527-2
  EOF
  
  }
@@@ -128,13 -124,18 +146,23 @@@ function flash_partitio
          fi
      elif [ "$(echo ${1} | grep -E "dtbo|vbmeta|recovery")" != "" -a "${dtb_feature}" != "" ]; then
          img_name="${1%_*}-${soc_name}-${dtb_feature}.img"
+     elif [ "$(echo ${1} | grep "board_info")" != "" ]; then
+         img_name="${board_info_file}"
+     elif [ "$(echo ${1} | grep -E "dtbo|vbmeta|recovery")" != "" ]; then
+         if [ "${1%_*}" == "dtbo" -a -f "${image_directory}${dtbo_file}" ]; then
+             img_name="${dtbo_file}"
+         elif [ "${1%_*}" == "vbmeta" -a -f "${image_directory}${vbmeta_file}" ]; then
+             img_name="${vbmeta_file}"
+         else
+             img_name="${1%_*}-${soc_name}.img"
+         fi
      elif [ "$(echo ${1} | grep "gpt")" != "" ]; then
          img_name=${partition_file}
 +    elif [ "$(echo ${1} | grep "super")" != "" ]; then
 +        if [ ${dont_generate_super} -eq 0 ]; then
 +            make_super_image
 +        fi
 +        img_name=${super_file}
      else
          img_name="${1%_*}-${soc_name}.img"
      fi
@@@ -190,8 -253,13 +286,14 @@@ function flash_androi
      grep -q "recovery" /tmp/fastboot_var.log && support_recovery=1
      # use boot_b to check whether current gpt support a/b slot
      grep -q "boot_b" /tmp/fastboot_var.log && support_dualslot=1
 +    grep -q "super" /tmp/fastboot_var.log && support_dynamic_partition=1
  
+     if [ ${support_board_info} -eq 1 ]; then
+         check_board_info
+         check_android_info
+         board_type="-${mb_model}"
+     fi
+ 
      # some partitions are hard-coded in uboot, flash the uboot first and then reboot to check these partitions
  
      # uboot or spl&bootloader
@@@ -283,19 -339,21 +400,34 @@@ function make_super_imag
          fi
      fi
  
++<<<<<<< HEAD
 +    ${image_directory}lpmake --metadata-size 65536 --super-name super --metadata-slots 3 --device super:7516192768 \
 +        --group nxp_dynamic_partitions_a:3747610624 --group nxp_dynamic_partitions_b:3747610624 \
 +        --partition system_a:readonly:0:nxp_dynamic_partitions_a ${lpmake_system_image_a} \
 +        --partition system_b:readonly:0:nxp_dynamic_partitions_b ${lpmake_system_image_b} \
 +        --partition vendor_a:readonly:0:nxp_dynamic_partitions_a ${lpmake_vendor_image_a} \
 +        --partition vendor_b:readonly:0:nxp_dynamic_partitions_b ${lpmake_vendor_image_b} \
 +        --partition product_a:readonly:0:nxp_dynamic_partitions_a ${lpmake_product_image_a} \
 +        --partition product_b:readonly:0:nxp_dynamic_partitions_b ${lpmake_product_image_b} \
 +        --sparse --output /tmp/${super_file}
++=======
+     if [ ${write_bdinfo_serial} -eq 1 ]; then
+         ${fastboot_tool} oem setvar dev-serial ${serialno_str}
+     fi
++>>>>>>> android_10_idt_dev_200527-2
  }
  
 +
  # parse command line
+ som_model=""
+ som_plc=""
+ mb_model=""
+ mb_plc=""
+ board_info_file=""
+ board_info_temp=""
+ dtbo_file="dtbo.img"
+ vbmeta_file="vbmeta.img"
+ android_info_file="android-info.txt"
  soc_name=""
  uboot_feature=""
  dtb_feature=""
@@@ -305,13 -363,17 +437,25 @@@ systemimage_file="system.img
  vendor_file="vendor.img"
  product_file="product.img"
  partition_file="partition-table.img"
++<<<<<<< HEAD
 +super_file="super.img"
++=======
+ spl_table_file="spl_tab.img"
++>>>>>>> android_10_idt_dev_200527-2
  support_dtbo=0
  support_recovery=0
  support_dualslot=0
  support_mcu_os=0
  support_dual_bootloader=0
++<<<<<<< HEAD
 +support_dynamic_partition=0
++=======
+ support_board_info=0
+ write_bdinfo_serial=0
+ support_idt_dual_spl=0
+ support_idt_backup_spl=0
+ support_idt_spl_table=0
++>>>>>>> android_10_idt_dev_200527-2
  dual_bootloader_partition=""
  bootloader_flashed_to_board=""
  uboot_proper_to_be_flashed=""
@@@ -323,7 -385,7 +467,11 @@@ product_partition="product
  vbmeta_partition="vbmeta"
  dtbo_partition="dtbo"
  mcu_os_partition="mcu_os"
++<<<<<<< HEAD
 +super_partition="super"
++=======
+ board_info_partition="board_info"
++>>>>>>> android_10_idt_dev_200527-2
  flash_mcu=0
  lock=0
  erase=0
@@@ -333,24 -395,18 +481,36 @@@ fastboot_tool="fastboot
  RED='[0;31m'
  STD='[0;0m'
  GREEN='[0;32m'
++<<<<<<< HEAD
 +lpmake_system_image_a=""
 +lpmake_system_image_b=""
 +lpmake_vendor_image_a=""
 +lpmake_vendor_image_b=""
 +lpmake_product_image_a=""
 +lpmake_product_image_b=""
 +result_value=0
 +dont_generate_super=0
 +
++=======
+ YELLOW='[0;33m'
+ ramsize=""
+ ramsizetest=0
+ board_type=""
++>>>>>>> android_10_idt_dev_200527-2
  
  # We want to detect illegal feature input to some extent. Here it's based on SoC names. Since an SoC may be on a
  # board running different set of images(android and automative for a example), so misuse the features of one set of
  # images when flash another set of images can not be detect early with this scenario.
  imx8mm_uboot_feature=(dual trusty-dual 4g-evk-uuu 4g ddr4-evk-uuu ddr4 evk-uuu trusty-4g trusty-secure-unlock trusty)
  imx8mn_uboot_feature=(dual trusty-dual evk-uuu trusty-secure-unlock trusty)
++<<<<<<< HEAD
 +imx8mq_uboot_feature=(dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu)
 +imx8mp_uboot_feature=(dual trusty-dual evk-uuu trusty-secure-unlock trusty)
 +imx8qxp_uboot_feature=(mek-uuu trusty-secure-unlock trusty secure-unlock c0 trusty-c0 mek-c0-uuu)
++=======
+ imx8mq_uboot_feature=(dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu signed dual-signed)
+ imx8qxp_uboot_feature=(mek-uuu trusty-secure-unlock trusty secure-unlock)
++>>>>>>> android_10_idt_dev_200527-2
  imx8qm_uboot_feature=(mek-uuu trusty-secure-unlock trusty secure-unlock md)
  imx7ulp_uboot_feature=(evk-uuu)
  
@@@ -383,7 -438,9 +543,13 @@@ while [ $# -gt 0 ]; d
          -l) lock=1 ;;
          -D) image_directory=$2; shift;;
          -s) ser_num=$2; shift;;
++<<<<<<< HEAD
 +        -super) dont_generate_super=1 ;;
++=======
+         -R) ramsizetest=1 ;;
+         -bdinfo) board_info_file=$2; shift;;
+         -serial) serialno_str=$2; write_bdinfo_serial=1; shift;;
++>>>>>>> android_10_idt_dev_200527-2
          *)  echo -e ${RED}$1${STD} is not an illegal option
              help; exit;;
      esac
diff --cc common/tools/uuu_imx_android_flash.bat
index 8eecb291,209f5e0a..591e1127
--- a/common/tools/uuu_imx_android_flash.bat
+++ b/common/tools/uuu_imx_android_flash.bat
@@@ -24,13 -37,17 +37,25 @@@ set systemimage_file=system.im
  set vendor_file=vendor.img
  set product_file=product.img
  set partition_file=partition-table.img
++<<<<<<< HEAD
 +set super_file=super.img
++=======
+ set spl_table_file=spl_tab.img
++>>>>>>> android_10_idt_dev_200527-2
  set /A support_dtbo=0
  set /A support_recovery=0
  set /A support_dualslot=0
  set /A support_mcu_os=0
  set /A support_trusty=0
++<<<<<<< HEAD
 +set /A support_dynamic_partition=0
++=======
+ set /A support_board_info=0
+ set /A write_bdinfo_serial=0
+ set /A support_idt_dual_spl=1
+ set /A support_idt_backup_spl=1
+ set /A support_idt_spl_table=1
++>>>>>>> android_10_idt_dev_200527-2
  set boot_partition=boot
  set recovery_partition=recovery
  set system_partition=system
@@@ -39,7 -56,7 +64,11 @@@ set product_partition=produc
  set vbmeta_partition=vbmeta
  set dtbo_partition=dtbo
  set mcu_os_partition=mcu_os
++<<<<<<< HEAD
 +set super_partition=super
++=======
+ set board_info_partition=board_info
++>>>>>>> android_10_idt_dev_200527-2
  set /A flash_mcu=0
  set /A statisc=0
  set /A erase=0
@@@ -64,23 -82,15 +94,32 @@@ set dual_bootloader_partition
  set /A daemon_mode=0
  set /A flag=1
  set /A dryrun=0
++<<<<<<< HEAD
 +set lpmake_system_image_a=
 +set lpmake_system_image_b=
 +set lpmake_vendor_image_a=
 +set lpmake_vendor_image_b=
 +set lpmake_product_image_a=
 +set lpmake_product_image_b=
 +set /A dont_generate_super=0
 +
++=======
+ set board_type=
++>>>>>>> android_10_idt_dev_200527-2
  
  :: We want to detect illegal feature input to some extent. Here it's based on SoC names. Since an SoC may be on a
  :: board running different set of images(android and automative for a example), so misuse the features of one set of
  :: images when flash another set of images can not be detect early with this scenario.
  set imx8mm_uboot_feature=dual trusty-dual 4g-evk-uuu 4g ddr4-evk-uuu ddr4 evk-uuu trusty-4g trusty-secure-unlock trusty
  set imx8mn_uboot_feature=dual trusty-dual evk-uuu trusty-secure-unlock trusty
++<<<<<<< HEAD
 +set imx8mp_uboot_feature=dual trusty-dual evk-uuu trusty-secure-unlock trusty
 +set imx8mq_uboot_feature=dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu
 +set imx8qxp_uboot_feature=mek-uuu trusty-secure-unlock trusty secure-unlock c0 trusty-c0 mek-c0-uuu
++=======
+ set imx8mq_uboot_feature=dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu signed dual-signed
+ set imx8qxp_uboot_feature=mek-uuu trusty-secure-unlock trusty secure-unlock
++>>>>>>> android_10_idt_dev_200527-2
  set imx8qm_uboot_feature=mek-uuu trusty-secure-unlock trusty secure-unlock md
  set imx7ulp_uboot_feature=evk-uuu
  
@@@ -121,7 -130,8 +160,12 @@@ if %1 == -y set yocto_image=%2&shift &s
  if %1 == -i set /A intervene=1 & shift & goto :parse_loop
  if %1 == -daemon set /A daemon_mode=1 & shift & goto :parse_loop
  if %1 == -dryrun set /A dryrun=1 & shift & goto :parse_loop
++<<<<<<< HEAD
 +if %1 == -super set /A dont_generate_super=1 & shift & goto :parse_loop
++=======
+ if %1 == -bdinfo set board_info_file=%2& shift & shift & goto :parse_loop
+ if %1 == -serial set serialno_str=%2& set /A write_bdinfo_serial=1& shift & shift & goto :parse_loop
++>>>>>>> android_10_idt_dev_200527-2
  echo unknown option "%1", please check it.
  call :help & set /A error_level=1 && goto :exit
  :parse_end
@@@ -474,10 -488,11 +538,11 @@@ goto :eo
  
  :help
  echo.
 -echo Version: 1.6
 -echo Last change: remove "-tos" and "-dboot" option, add "-u" option to specify which uboot or spl&bootloader image to flash
 -echo currently suported platforms: evk_7ulp, evk_8mm, evk_8mq, evk_8mn, aiy_8mq, mek_8q, mek_8q_car
 +echo Version: 1.7
 +echo Last change: generate super.img when flash images with dynamic partition feature
 +echo currently suported platforms: evk_7ulp, evk_8mm, evk_8mq, evk_8mn, evk_8mp, aiy_8mq, mek_8q, mek_8q_car
  echo.
+ echo eg: uuu_imx_android_flash.bat -f imx8mq -bdinfo board_info-imx8mq_evt-0_evk_idtechspi-0.img
  echo eg: uuu_imx_android_flash.bat -f imx8qm -a -e -D C:\Users\user_01\imagesndroid10\mek_8q\ -t emmc -u trusty -d mipi-panel
  echo.
  echo Usage: %script_name% ^<option^>
@@@ -507,11 -522,9 +572,15 @@@ echo                           ©¦   imx
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
  echo                           ©¦   imx8mn       ©¦  dual trusty-dual evk-uuu trusty-secure-unlock trusty                                                ©¦
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
++<<<<<<< HEAD
 +echo                           ©¦   imx8mp       ©¦  dual trusty-dual evk-uuu trusty-secure-unlock trusty                                                ©¦
 +echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
 +echo                           ©¦   imx8mq       ©¦  dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu                                        ©¦
++=======
+ echo                           ©¦   imx8mq       ©¦  dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu signed dual-signed                     ©¦
++>>>>>>> android_10_idt_dev_200527-2
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
 -echo                           ©¦   imx8qxp      ©¦  mek-uuu trusty-secure-unlock trusty secure-unlock                                                   ©¦
 +echo                           ©¦   imx8qxp      ©¦  mek-uuu trusty-secure-unlock trusty secure-unlock c0 trusty-c0 mek-c0-uuu                          ©¦
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
  echo                           ©¦   imx8qm       ©¦  mek-uuu trusty-secure-unlock trusty secure-unlock md                                                ©¦
  echo                           ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©à©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È
@@@ -553,10 -564,8 +622,15 @@@ echo  -i                with this optio
  echo                        This option is for users to manually flash the images to partitions they want to
  echo  -daemon           after uuu script generated, uuu will be invoked with daemon mode. It is used for flash multi boards
  echo  -dryrun           only generate the uuu script under /tmp direcbory but not flash images
++<<<<<<< HEAD
 +echo  -super            do not generate super.img when flash the images with dynamic partition feature enabled.
 +echo                        Under the condition that dynamic partition feature are enabled:
 +echo                          if this option is not used, super.img will be generated under current working directory and flashed to the board.
 +echo                          if this option is used, make sure super.img already exists together with other images.
++=======
+ echo  -bdinfo board_info_file  flash board_info with this board_info_file image
+ echo  -serial serialno_str  write serial number into device emmc, this could be program once in secure-user build
++>>>>>>> android_10_idt_dev_200527-2
  goto :eof
  
  
@@@ -691,14 -724,14 +789,25 @@@ if not [%partition_to_be_flashed:bootlo
      set img_name=%bootloader_flashed_to_board%
      goto :start_to_flash
  )
++<<<<<<< HEAD
 +if not [%partition_to_be_flashed:super=%] == [%partition_to_be_flashed%] (
 +    if %dont_generate_super% == 0 (
 +        call :make_super_image
 +    )
 +    set img_name=%super_file%
 +    goto :start_to_flash
 +)
 +
++=======
+ if not [%partition_to_be_flashed:spl_bak_=%] == [%partition_to_be_flashed%] (
+     set img_name=%bootloader_flashed_to_board%
+     goto :start_to_flash
+ )
+ if not [%partition_to_be_flashed:spl_tab_=%] == [%partition_to_be_flashed%] (
+     set img_name=%spl_table_file%
+     goto :start_to_flash
+ )
++>>>>>>> android_10_idt_dev_200527-2
  
  if %support_dtbo% == 1 (
      if not [%partition_to_be_flashed:boot=%] == [%partition_to_be_flashed%] (
@@@ -832,9 -923,8 +1013,14 @@@ if not [%slot%] == [] 
      call :flash_userpartitions || set /A error_level=1 && goto :exit
  )
  
++<<<<<<< HEAD
 +::super partition does not have a/b slot, handle it individually
 +if %support_dynamic_partition% == 1 (
 +    call :flash_partition %super_partition%
++=======
+ if %write_bdinfo_serial% == 1 (
+     echo FB: oem setvar dev-serial %serialno_str% >> uuu.lst
++>>>>>>> android_10_idt_dev_200527-2
  )
  
  goto :eof
diff --cc common/tools/uuu_imx_android_flash.sh
index 7872b7aa,8353af5d..13db67b7
--- a/common/tools/uuu_imx_android_flash.sh
+++ b/common/tools/uuu_imx_android_flash.sh
@@@ -5,10 -5,11 +5,11 @@@ help() 
  bn=`basename $0`
  cat << EOF
  
 -Version: 1.6
 -Last change: remove "-tos" and "-dboot" option, add "-u" option to specify which uboot or spl&bootloader image to flash
 -currently suported platforms: evk_7ulp, evk_8mm, evk_8mq, evk_8mn, aiy_8mq, mek_8q, mek_8q_car
 +Version: 1.7
 +Last change: generate super.img when flash images with dynamic partition feature
 +currently suported platforms: evk_7ulp, evk_8mm, evk_8mq, evk_8mn, aiy_8mq, evk_8mp, mek_8q, mek_8q_car
  
+ eg: ./uuu_imx_android_flash.sh -f imx8mq -e -a -bdinfo board_info-imx8mq_evt-0_evk_evk-0.img
  eg: ./uuu_imx_android_flash.sh -f imx8qm -a -e -D ~/android10/mek_8q/ -t emmc -u trusty -d mipi-panel
  
  Usage: $bn <option>
@@@ -38,11 -39,9 +39,11 @@@ options
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                             â”‚   imx8mn       â”‚  dual trusty-dual evk-uuu trusty-secure-unlock trusty                                                â”‚
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
-                            â”‚   imx8mq       â”‚  dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu                                        â”‚
+                            â”‚   imx8mq       â”‚  dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu signed dual-signed                     â”‚
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 -                           â”‚   imx8qxp      â”‚  mek-uuu trusty-secure-unlock trusty secure-unlock                                                   â”‚
 +                           â”‚   imx8mp       â”‚  dual trusty-dual evk-uuu trusty-secure-unlock trusty                                                â”‚
 +                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 +                           â”‚   imx8qxp      â”‚  mek-uuu trusty-secure-unlock trusty secure-unlock c0 trusty-c0 mek-c0-uuu                           â”‚
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                             â”‚   imx8qm       â”‚  mek-uuu trusty-secure-unlock trusty secure-unlock md                                                â”‚
                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
@@@ -82,12 -79,12 +83,19 @@@
                          including the name of yocto sdcard image, this parameter could be a relative path or an absolute path
    -i                with this option used, after uboot for uuu loaded and executed to fastboot mode with target device chosen, this script will stop
                          This option is for users to manually flash the images to partitions they want to
+   -R                with this option used, choose the u-boot about 1GB RAM setting.
    -daemon           after uuu script generated, uuu will be invoked with daemon mode. It is used for flash multi boards
    -dryrun           only generate the uuu script under /tmp direcbory but not flash images
++<<<<<<< HEAD
 +  -super            do not generate super.img when flash the images with dynamic partition feature enabled.
 +                       Under the condition that dynamic partition feature are enabled:
 +                         if this option is not used, super.img will be generated under "/tmp" and flashed to the board.
 +                         if this option is used, make sure super.img already exists together with other images.
++=======
+   -bdinfo board_info_file  flash board_info with this board_info_file image
+                                If not set, use naming from current board_info partition
+   -serial serialno_str  write serial number into device emmc, this could be program once in secure-user build
++>>>>>>> android_10_idt_dev_200527-2
  EOF
  
  }
@@@ -172,13 -168,18 +181,23 @@@ function flash_partitio
          img_name="${soc_name}_mcu_demo.img"
      elif [ "$(echo ${1} | grep -E "dtbo|vbmeta|recovery")" != "" -a "${dtb_feature}" != "" ]; then
          img_name="${1%_*}-${soc_name}-${dtb_feature}.img"
+     elif [ "$(echo ${1} | grep "board_info")" != "" ]; then
+         img_name="${board_info_file}"
+     elif [ "$(echo ${1} | grep -E "dtbo|vbmeta|recovery")" != "" ]; then
+         if [ "${1%_*}" == "dtbo" -a -f "${image_directory}${dtbo_file}" ]; then
+             img_name="${dtbo_file}"
+         elif [ "${1%_*}" == "vbmeta" -a -f "${image_directory}${vbmeta_file}" ]; then
+             img_name="${vbmeta_file}"
+         else
+             img_name="${1%_*}-${soc_name}.img"
+         fi
      elif [ "$(echo ${1} | grep "gpt")" != "" ]; then
          img_name=${partition_file}
 +    elif [ "$(echo ${1} | grep "super")" != "" ]; then
 +        if [ ${dont_generate_super} -eq 0 ]; then
 +            make_super_image
 +        fi
 +        img_name=${super_file}
      else
          img_name="${1%_*}-${soc_name}.img"
      fi
@@@ -293,49 -366,23 +388,64 @@@ function flash_androi
          flash_partition_name ${slot}
          flash_userpartitions
      fi
++<<<<<<< HEAD
 +    # super partition does not have a/b slot, handle it individually
 +    if [ ${support_dynamic_partition} -eq 1 ]; then
 +        flash_partition ${super_partition}
++=======
+ 
+     if [ ${write_bdinfo_serial} -eq 1 ]; then
+         echo FB: oem setvar dev-serial ${serialno_str} >> /tmp/uuu.lst
++>>>>>>> android_10_idt_dev_200527-2
      fi
  }
  
 +# this function will invoke lpmake to create super.img, the super.img will
 +# be created in /tmp, make sure that there is enouth space
 +function make_super_image
 +{
 +    rm -rf /tmp/${super_file}
 +    # now dynamic partition is only enabled in dual slot condition
 +    if [ ${support_dualslot} -eq 1 ]; then
 +        if [ "${slot}" == "_a" ]; then
 +            lpmake_system_image_a="--image system_a=${sym_link_directory}${systemimage_file}"
 +            lpmake_vendor_image_a="--image vendor_a=${sym_link_directory}${vendor_file}"
 +            lpmake_product_image_a="--image product_a=${sym_link_directory}${product_file}"
 +        elif [ "${slot}" == "_b" ]; then
 +            lpmake_system_image_b="--image system_b=${sym_link_directory}${systemimage_file}"
 +            lpmake_vendor_image_b="--image vendor_b=${sym_link_directory}${vendor_file}"
 +            lpmake_product_image_b="--image product_b=${sym_link_directory}${product_file}"
 +        else
 +            lpmake_system_image_a="--image system_a=${sym_link_directory}${systemimage_file}"
 +            lpmake_vendor_image_a="--image vendor_a=${sym_link_directory}${vendor_file}"
 +            lpmake_product_image_a="--image product_a=${sym_link_directory}${product_file}"
 +            lpmake_system_image_b="--image system_b=${sym_link_directory}${systemimage_file}"
 +            lpmake_vendor_image_b="--image vendor_b=${sym_link_directory}${vendor_file}"
 +            lpmake_product_image_b="--image product_b=${sym_link_directory}${product_file}"
 +        fi
 +    fi
 +
 +        ${sym_link_directory}lpmake --metadata-size 65536 --super-name super --metadata-slots 3 --device super:7516192768 \
 +            --group nxp_dynamic_partitions_a:3747610624 --group nxp_dynamic_partitions_b:3747610624 \
 +            --partition system_a:readonly:0:nxp_dynamic_partitions_a ${lpmake_system_image_a} \
 +            --partition system_b:readonly:0:nxp_dynamic_partitions_b ${lpmake_system_image_b} \
 +            --partition vendor_a:readonly:0:nxp_dynamic_partitions_a ${lpmake_vendor_image_a} \
 +            --partition vendor_b:readonly:0:nxp_dynamic_partitions_b ${lpmake_vendor_image_b} \
 +            --partition product_a:readonly:0:nxp_dynamic_partitions_a ${lpmake_product_image_a} \
 +            --partition product_b:readonly:0:nxp_dynamic_partitions_b ${lpmake_product_image_b} \
 +            --sparse --output /tmp/${super_file}
 +}
  
  # parse command line
+ som_model=""
+ som_plc=""
+ mb_model=""
+ mb_plc=""
+ board_info_file=""
+ board_info_temp=""
+ dtbo_file="dtbo.img"
+ vbmeta_file="vbmeta.img"
+ android_info_file="android-info.txt"
  soc_name=""
  uboot_feature=""
  dtb_feature=""
@@@ -345,13 -392,17 +455,25 @@@ systemimage_file="system.img
  vendor_file="vendor.img"
  product_file="product.img"
  partition_file="partition-table.img"
++<<<<<<< HEAD
 +super_file="super.img"
++=======
+ spl_table_file="spl_tab.img"
++>>>>>>> android_10_idt_dev_200527-2
  support_dtbo=0
  support_recovery=0
  support_dualslot=0
  support_mcu_os=0
  support_trusty=0
++<<<<<<< HEAD
 +support_dynamic_partition=0
++=======
+ support_board_info=0
+ write_bdinfo_serial=0
+ support_idt_dual_spl=1
+ support_idt_backup_spl=1
+ support_idt_spl_table=1
++>>>>>>> android_10_idt_dev_200527-2
  boot_partition="boot"
  recovery_partition="recovery"
  system_partition="system"
@@@ -360,7 -411,7 +482,11 @@@ product_partition="product
  vbmeta_partition="vbmeta"
  dtbo_partition="dtbo"
  mcu_os_partition="mcu_os"
++<<<<<<< HEAD
 +super_partition="super"
++=======
+ board_info_partition="board_info"
++>>>>>>> android_10_idt_dev_200527-2
  
  flash_mcu=0
  erase=0
@@@ -388,23 -441,17 +516,34 @@@ sym_link_directory="
  yocto_image_sym_link=""
  daemon_mode=0
  dryrun=0
++<<<<<<< HEAD
 +lpmake_system_image_a=""
 +lpmake_system_image_b=""
 +lpmake_vendor_image_a=""
 +lpmake_vendor_image_b=""
 +lpmake_product_image_a=""
 +lpmake_product_image_b=""
 +result_value=0
 +dont_generate_super=0
++=======
+ ramsize=""
+ ramsizetest=0
+ board_type=""
++>>>>>>> android_10_idt_dev_200527-2
  
  # We want to detect illegal feature input to some extent. Here it's based on SoC names. Since an SoC may be on a
  # board running different set of images(android and automative for a example), so misuse the features of one set of
  # images when flash another set of images can not be detect early with this scenario.
  imx8mm_uboot_feature=(dual trusty-dual 4g-evk-uuu 4g ddr4-evk-uuu ddr4 evk-uuu trusty-4g trusty-secure-unlock trusty)
  imx8mn_uboot_feature=(dual trusty-dual evk-uuu trusty-secure-unlock trusty)
++<<<<<<< HEAD
 +imx8mq_uboot_feature=(dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu)
 +imx8mp_uboot_feature=(dual trusty-dual evk-uuu trusty-secure-unlock trusty)
 +imx8qxp_uboot_feature=(mek-uuu trusty-secure-unlock trusty secure-unlock c0 trusty-c0 mek-c0-uuu)
++=======
+ imx8mq_uboot_feature=(dual trusty-dual evk-uuu trusty-secure-unlock trusty aiy-uuu signed dual-signed)
+ imx8qxp_uboot_feature=(mek-uuu trusty-secure-unlock trusty secure-unlock)
++>>>>>>> android_10_idt_dev_200527-2
  imx8qm_uboot_feature=(mek-uuu trusty-secure-unlock trusty secure-unlock md)
  imx7ulp_uboot_feature=(evk-uuu)
  
@@@ -441,9 -487,11 +580,15 @@@ while [ $# -gt 0 ]; d
          -y) yocto_image=$2; shift;;
          -p) board=$2; shift;;
          -i) intervene=1 ;;
+         -R) ramsizetest=1 ;;
          -daemon) daemon_mode=1 ;;
          -dryrun) dryrun=1 ;;
++<<<<<<< HEAD
 +        -super) dont_generate_super=1 ;;
++=======
+         -bdinfo) board_info_file=$2; shift;;
+         -serial) serialno_str=$2; write_bdinfo_serial=1; shift;;
++>>>>>>> android_10_idt_dev_200527-2
          *)  echo -e >&2 ${RED}the option \"${1}\"  you specified is not supported, please check it${STD}
              help; exit;;
      esac
diff --cc imx8m/AndroidProducts.mk
index 038688a9,f6c0fba7..fd3d8c35
--- a/imx8m/AndroidProducts.mk
+++ b/imx8m/AndroidProducts.mk
@@@ -27,26 -27,28 +27,54 @@@
  # Copied from build/target/product/AndroidProducts.mk
  
  PRODUCT_MAKEFILES := \
++<<<<<<< HEAD
 +  $(LOCAL_DIR)/evk_8mq/evk_8mq.mk \
 +  $(LOCAL_DIR)/evk_8mq/evk_8mq_drm.mk \
 +  $(LOCAL_DIR)/evk_8mm/evk_8mm.mk \
 +  $(LOCAL_DIR)/evk_8mm/evk_8mm_ddr4.mk \
 +  $(LOCAL_DIR)/evk_8mm/evk_8mm_drm.mk \
 +  $(LOCAL_DIR)/evk_8mn/evk_8mn.mk \
 +  $(LOCAL_DIR)/evk_8mp/evk_8mp.mk
 +
 +COMMON_LUNCH_CHOICES := \
 +  evk_8mq-user \
 +  evk_8mq-userdebug \
 +  evk_8mq_drm-user \
 +  evk_8mq_drm-userdebug \
 +  evk_8mm-user \
 +  evk_8mm-userdebug \
 +  evk_8mm_ddr4-user \
 +  evk_8mm_ddr4-userdebug \
 +  evk_8mm_drm-user \
 +  evk_8mm_drm-userdebug \
 +  evk_8mn-user \
 +  evk_8mn-userdebug \
 +  evk_8mp-user \
 +  evk_8mp-userdebug
++=======
+   $(LOCAL_DIR)/evk_a300/evk_a300.mk \
+   $(LOCAL_DIR)/evk_a300/evk_a300_drm.mk \
+   $(LOCAL_DIR)/evk_a100/evk_a100.mk \
+   $(LOCAL_DIR)/vp6820_8mq/vp6820_8mq.mk \
+   $(LOCAL_DIR)/vp6820_8mq/vp6820_8mq_drm.mk \
+   $(LOCAL_DIR)/vp6820_8mq/vp6820_8mq_secure.mk \
+   $(LOCAL_DIR)/vp6820_8mq/vp6820_8mq_go.mk \
+   $(LOCAL_DIR)/vp6820_8mn/vp6820_8mn.mk
+ 
+ COMMON_LUNCH_CHOICES := \
+   evk_a300-user \
+   evk_a300-userdebug \
+   evk_a300_drm-user \
+   evk_a300_drm-userdebug \
+   evk_a100-user \
+   evk_a100-userdebug \
+   vp6820_8mq-user \
+   vp6820_8mq-userdebug \
+   vp6820_8mq_drm-user \
+   vp6820_8mq_drm-userdebug \
+   vp6820_8mq_secure-user \
+   vp6820_8mq_go-user \
+   vp6820_8mq_go-userdebug \
+   vp6820_8mn-user \
+   vp6820_8mn-userdebug
++>>>>>>> android_10_idt_dev_200527-2
diff --cc imx8m/BoardConfigCommon.mk
index 20d65a37,a3c6cad9..1d939699
--- a/imx8m/BoardConfigCommon.mk
+++ b/imx8m/BoardConfigCommon.mk
@@@ -103,10 -104,11 +103,16 @@@ BOARD_GPU_LIBDRM := libdrm_im
  
  AB_OTA_UPDATER := true
  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
++<<<<<<< HEAD
 +AB_OTA_PARTITIONS += dtbo boot system vendor vbmeta
 +else
 +AB_OTA_PARTITIONS += dtbo boot system vendor vbmeta product
++=======
+ AB_OTA_PARTITIONS := dtbo boot system vendor vbmeta bootloader spl spl_bak
+ else
+ AB_OTA_PARTITIONS := dtbo boot system vendor vbmeta product bootloader spl spl_bak
++>>>>>>> android_10_idt_dev_200527-2
  endif
 -BOARD_BUILD_SYSTEM_ROOT_IMAGE := true
  TARGET_NO_RECOVERY := true
  BOARD_USES_RECOVERY_AS_BOOT := true
  TARGET_RECOVERY_PIXEL_FORMAT := "RGBX_8888"
diff --cc imx8m/ProductConfigCommon.mk
index 05fcfbc0,87e2c671..d0eb72b7
--- a/imx8m/ProductConfigCommon.mk
+++ b/imx8m/ProductConfigCommon.mk
@@@ -40,14 -28,30 +28,30 @@@ PRODUCT_PACKAGES += 
      SoundRecorder
  endif
  
+ endif
+ 
+ # Android infrastructures
+ PRODUCT_PACKAGES += \
+     CactusPlayer \
+     ExtractorPkg \
+     charger_res_images \
+     libGLES_android \
+     libRS \
+     libedid \
+     libion \
+     librs_jni \
+     slideshow \
+     verity_warning_images_idt \
+     vndk-sp
+ 
  # HAL
  PRODUCT_PACKAGES += \
 -    copybit.imx8 \
 -    gralloc.imx8 \
 -    hwcomposer.imx8 \
 -    lights.imx8 \
 -    overlay.imx8 \
 -    power.imx8
 +    copybit.imx \
 +    gralloc.imx \
 +    hwcomposer.imx \
 +    lights.imx \
 +    overlay.imx \
 +    power.imx
  
  PRODUCT_STATIC_BOOT_CONTROL_HAL:= \
      bootctrl-static.avb \
@@@ -160,31 -165,120 +165,31 @@@ PRODUCT_PACKAGES += 
      gmem_info \
      gpu-top
  
- # Omx related libs, please align to device/fsl/proprietary/omx/fsl-omx.mk
+ # Omx related libs, please align to device/idtech/proprietary/omx/fsl-omx.mk
  PRODUCT_PACKAGES += \
 -    ComponentRegistry.txt \
 -    component_register \
 -    component_register_ac3 \
 -    component_register_ddp \
 -    component_register_ra \
 -    component_register_rv \
 -    component_register_ms \
 -    component_register_wmv9 \
 -    contentpipe_register \
 -    core_register \
 -    fslomx.cfg \
      lib_aac_dec_v2_arm12_elinux \
 -    lib_aac_parser_arm11_elinux \
 -    lib_aac_parser_arm11_elinux.3.0 \
      lib_aacd_wrap_arm12_elinux_android \
 -    lib_amr_parser_arm11_elinux.3.0 \
 -    lib_ape_parser_arm11_elinux.3.0 \
 -    lib_avi_parser_arm11_elinux.3.0 \
 -    lib_divx_drm_arm11_elinux \
 -    lib_dsf_parser_arm11_elinux.3.0 \
 -    lib_ffmpeg_arm11_elinux \
      lib_flac_dec_v2_arm11_elinux \
 -    lib_flac_parser_arm11_elinux \
 -    lib_flac_parser_arm11_elinux.3.0 \
 -    lib_flv_parser_arm11_elinux.3.0 \
 -    lib_id3_parser_arm11_elinux \
 -    lib_mkv_parser_arm11_elinux.3.0 \
      lib_mp3_dec_v2_arm12_elinux \
      lib_mp3_enc_v2_arm12_elinux \
 -    lib_mp3_parser_arm11_elinux.3.0 \
 -    lib_mp3_parser_v2_arm11_elinux \
      lib_mp3d_wrap_arm12_elinux_android \
 -    lib_mp4_muxer_arm11_elinux \
 -    lib_mp4_parser_arm11_elinux.3.0 \
 -    lib_mpg2_parser_arm11_elinux.3.0 \
      lib_nb_amr_dec_v2_arm9_elinux \
      lib_nb_amr_enc_v2_arm11_elinux \
 -    lib_ogg_parser_arm11_elinux.3.0 \
 -    lib_omx_aac_dec_v2_arm11_elinux \
 -    lib_omx_aac_enc_v2_arm11_elinux \
 -    lib_omx_aac_parser_v2_arm11_elinux \
 -    lib_omx_ac3toiec937_arm11_elinux \
 -    lib_omx_amr_dec_v2_arm11_elinux \
 -    lib_omx_amr_enc_v2_arm11_elinux \
 -    lib_omx_android_audio_render_arm11_elinux \
 -    lib_omx_android_audio_source_arm11_elinux \
 -    lib_omx_async_write_pipe_arm11_elinux \
 -    lib_omx_audio_fake_render_arm11_elinux \
 -    lib_omx_audio_processor_v2_arm11_elinux \
 -    lib_omx_bsac_dec_v2_arm11_elinux \
 -    lib_omx_camera_source_arm11_elinux \
 -    lib_omx_client_arm11_elinux \
 -    lib_omx_clock_v2_arm11_elinux \
 -    lib_omx_common_v2_arm11_elinux \
 -    lib_omx_core_mgr_v2_arm11_elinux \
 -    lib_omx_core_v2_arm11_elinux \
 -    lib_omx_ec3_dec_v2_arm11_elinux \
 -    lib_omx_flac_dec_v2_arm11_elinux \
 -    lib_omx_flac_parser_v2_arm11_elinux \
 -    lib_omx_fsl_muxer_v2_arm11_elinux \
 -    lib_omx_fsl_parser_v2_arm11_elinux \
 -    lib_omx_https_pipe_arm11_elinux \
 -    lib_omx_https_pipe_v2_arm11_elinux \
 -    lib_omx_https_pipe_v3_arm11_elinux \
 -    lib_omx_ipulib_render_arm11_elinux \
 -    lib_omx_libav_audio_dec_arm11_elinux \
 -    lib_omx_libav_video_dec_arm11_elinux \
 -    lib_omx_local_file_pipe_v2_arm11_elinux \
 -    lib_omx_mp3_dec_v2_arm11_elinux \
 -    lib_omx_mp3_enc_v2_arm11_elinux \
 -    lib_omx_mp3_parser_v2_arm11_elinux \
 -    lib_omx_osal_v2_arm11_elinux \
 -    lib_omx_overlay_render_arm11_elinux \
 -    lib_omx_pcm_dec_v2_arm11_elinux \
 -    lib_omx_player_arm11_elinux \
 -    lib_omx_res_mgr_v2_arm11_elinux \
 -    lib_omx_rtps_pipe_arm11_elinux \
 -    lib_omx_shared_fd_pipe_arm11_elinux \
 -    lib_omx_sorenson_dec_v2_arm11_elinux \
 -    lib_omx_streaming_parser_arm11_elinux \
 -    lib_omx_surface_render_arm11_elinux \
 -    lib_omx_surface_source_arm11_elinux \
 -    lib_omx_tunneled_decoder_arm11_elinux \
 -    lib_omx_udps_pipe_arm11_elinux \
 -    lib_omx_utils_v2_arm11_elinux \
 -    lib_omx_vpu_dec_v2_arm11_elinux \
 -    lib_omx_vpu_enc_v2_arm11_elinux \
 -    lib_omx_vpu_v2_arm11_elinux \
 -    lib_omx_wav_parser_v2_arm11_elinux \
      lib_peq_v2_arm11_elinux \
 -    lib_vpu_wrapper \
 -    lib_wav_parser_arm11_elinux \
 -    lib_wav_parser_arm11_elinux.3.0 \
      lib_wb_amr_dec_arm9_elinux \
      lib_wb_amr_enc_arm11_elinux \
 -    libavcodec \
 -    libavutil \
      libfsl_jpeg_enc_arm11_elinux \
 -    libfslextractor \
 -    libfslxec \
 -    libstagefrighthw \
 -    libswresample \
 -    libxec \
 -    media_codecs_ac3.xml \
 -    media_codecs_ddp.xml \
 -    media_codecs_ms.xml \
 -    media_codecs_wmv9.xml \
 -    media_codecs_ra.xml \
 -    media_codecs_rv.xml \
 +    media_codecs_c2_ac3.xml \
 +    media_codecs_c2_ddp.xml \
 +    media_codecs_c2_ms.xml \
 +    media_codecs_c2_wmv9.xml \
 +    media_codecs_c2_ra.xml \
 +    media_codecs_c2_rv.xml \
      media_codecs_performance.xml \
      media_profiles_V1_0.xml \
 -    media_codecs_google_video.xml
 +    media_codecs_google_c2_video.xml \
 +    media_codecs_c2.xml \
 +    media_codecs_performance_c2.xml
  
  ifneq ($(LOW_MEMORY),true)
  PRODUCT_PACKAGES += \
@@@ -229,39 -310,23 +234,42 @@@ PRODUCT_PACKAGES += 
      lib_wma10_dec_v2_arm12_elinux \
      lib_wma10d_wrap_arm12_elinux_android
  
 +# imx c2 codec binary
 +PRODUCT_PACKAGES += \
 +    android.hardware.media.c2@1.0-service \
 +    libsfplugin_ccodec \
 +    lib_imx_c2_componentbase \
 +    lib_imx_ts_manager \
 +    lib_c2_imx_store \
 +    lib_c2_imx_audio_dec_common \
 +    lib_c2_imx_aac_dec \
 +    lib_c2_imx_ac3_dec \
 +    lib_c2_imx_eac3_dec \
 +    lib_c2_imx_mp3_dec \
 +    lib_c2_imx_ra_dec \
 +    lib_c2_imx_wma_dec \
 +
 +# Support Dynamic partition userspace fastboot
 +PRODUCT_PACKAGES += \
 +    fastbootd \
 +
  # Copy soc related config and binary to board
  PRODUCT_COPY_FILES += \
 -    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media_codecs_google_audio.xml:$(TARGET_COPY_OUT_VENDOR)/etc/media_codecs_google_audio.xml \
 -    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media_codecs_google_telephony.xml:$(TARGET_COPY_OUT_VENDOR)/etc/media_codecs_google_telephony.xml \
 -    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media_codecs_google_tv.xml:$(TARGET_COPY_OUT_VENDOR)/etc/media_codecs_google_tv.xml \
 +    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media_codecs_google_c2_audio.xml:$(TARGET_COPY_OUT_VENDOR)/etc/media_codecs_google_c2_audio.xml \
 +    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media_codecs_google_c2_telephony.xml:$(TARGET_COPY_OUT_VENDOR)/etc/media_codecs_google_c2_telephony.xml \
 +    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media_codecs_google_c2_tv.xml:$(TARGET_COPY_OUT_VENDOR)/etc/media_codecs_google_c2_tv.xml \
      $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media_profiles_720p.xml:$(TARGET_COPY_OUT_VENDOR)/etc/media_profiles_720p.xml \
-     device/fsl/common/input/Dell_Dell_USB_Entry_Keyboard.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/Dell_Dell_USB_Entry_Keyboard.idc \
-     device/fsl/common/input/Dell_Dell_USB_Keyboard.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/Dell_Dell_USB_Keyboard.idc \
-     device/fsl/common/input/Dell_Dell_USB_Keyboard.kl:$(TARGET_COPY_OUT_VENDOR)/usr/keylayout/Dell_Dell_USB_Keyboard.kl \
-     device/fsl/common/input/eGalax_Touch_Screen.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/HannStar_P1003_Touchscreen.idc \
-     device/fsl/common/input/eGalax_Touch_Screen.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/Novatek_NT11003_Touch_Screen.idc \
-     device/fsl/common/input/eGalax_Touch_Screen.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/eGalax_Touch_Screen.idc \
-     device/fsl/imx8m/init.recovery.freescale.rc:root/init.recovery.freescale.rc \
-     device/fsl/imx8m/com.example.android.systemupdatersample.xml:$(TARGET_COPY_OUT_SYSTEM)/etc/permissions/com.example.android.systemupdatersample.xml \
+     device/idtech/common/input/Dell_Dell_USB_Entry_Keyboard.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/Dell_Dell_USB_Entry_Keyboard.idc \
+     device/idtech/common/input/Dell_Dell_USB_Keyboard.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/Dell_Dell_USB_Keyboard.idc \
+     device/idtech/common/input/Dell_Dell_USB_Keyboard.kl:$(TARGET_COPY_OUT_VENDOR)/usr/keylayout/Dell_Dell_USB_Keyboard.kl \
+     device/idtech/common/input/eGalax_Touch_Screen.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/HannStar_P1003_Touchscreen.idc \
+     device/idtech/common/input/eGalax_Touch_Screen.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/Novatek_NT11003_Touch_Screen.idc \
+     device/idtech/common/input/eGalax_Touch_Screen.idc:$(TARGET_COPY_OUT_VENDOR)/usr/idc/eGalax_Touch_Screen.idc \
+     device/idtech/common/input/matrix-keypad.kl:$(TARGET_COPY_OUT_VENDOR)/usr/keylayout/matrix-keypad.kl: \
+     device/idtech/imx8m/init.recovery.freescale.rc:root/init.recovery.freescale.rc \
+     device/idtech/imx8m/com.example.android.systemupdatersample.xml:$(TARGET_COPY_OUT_SYSTEM)/etc/permissions/com.example.android.systemupdatersample.xml \
+     device/idtech/common/input/touchscreen/FW_TDDI_TRUNK_FB.ili:$(TARGET_COPY_OUT_VENDOR)/usr/tp/ili/FW_TDDI_TRUNK_FB.ili \
+     device/idtech/common/input/touchscreen/TM050JYHS11_TM_500_20190614.hex:$(TARGET_COPY_OUT_VENDOR)/usr/tp/ili/TM050JYHS11_TM_500_20190614 \
      frameworks/av/services/audiopolicy/config/a2dp_audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/a2dp_audio_policy_configuration.xml \
      frameworks/av/services/audiopolicy/config/audio_policy_volumes.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_volumes.xml \
      frameworks/av/services/audiopolicy/config/default_volume_tables.xml:$(TARGET_COPY_OUT_VENDOR)/etc/default_volume_tables.xml \
diff --cc imx8m/evk_8mq/sepolicy/file_contexts
index bf7cde83,0dda8491..7e752367
--- a/imx8m/evk_8mq/sepolicy/file_contexts
+++ b/imx8m/evk_8mq/sepolicy/file_contexts
@@@ -40,4 -38,9 +40,13 @@@
  #Thermal HAL service
  /vendor/bin/hw/android\.hardware\.thermal@2\.0-service.imx         u:object_r:hal_thermal_default_exec:s0
  
++<<<<<<< HEAD
 +/vendor/bin/hw/android\.hardware\.media\.c2@1\.0-service    u:object_r:mediacodec_exec:s0
++=======
+ #quectel port
+ /dev/ttyUSB[0-9]*                u:object_r:tty_device:s0
+ /dev/ttyACM[0-9]*                u:object_r:tty_device:s0
+ /vendor/bin/hw/rild              u:object_r:rild_exec:s0
+ #/system/socket/rild              u:object_r:rild_socket:s0
+ #/system/socket/rild-debug        u:object_r:rild_debug_socket:s0
++>>>>>>> android_10_idt_dev_200527-2
diff --cc imx8m/evk_a100/BoardConfig.mk
index ef693c6e,90a87f2e..738b8b04
--- a/imx8m/evk_a100/BoardConfig.mk
+++ b/imx8m/evk_a100/BoardConfig.mk
@@@ -2,12 -2,11 +2,18 @@@
  # SoC-specific compile-time definitions.
  #
  
- BOARD_SOC_TYPE := IMX8MM
+ BOARD_SOC_TYPE := IMX8MN
+ BOARD_SOM_TYPE := a100
  BOARD_TYPE := EVK
++<<<<<<< HEAD:imx8m/evk_8mm/BoardConfig.mk
 +BOARD_HAVE_VPU := true
 +BOARD_VPU_TYPE := hantro
 +FSL_VPU_OMX_ONLY := true
 +HAVE_FSL_IMX_GPU2D := true
++=======
+ BOARD_HAVE_VPU := false
+ HAVE_FSL_IMX_GPU2D := false
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a100/BoardConfig.mk
  HAVE_FSL_IMX_GPU3D := true
  HAVE_FSL_IMX_IPU := false
  HAVE_FSL_IMX_PXP := false
@@@ -32,9 -29,12 +36,16 @@@ SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU 
  # Product-specific compile-time definitions.
  #
  
- IMX_DEVICE_PATH := device/fsl/imx8m/evk_8mm
+ IMX_DEVICE_PATH := device/idtech/imx8m/evk_a100
  
++<<<<<<< HEAD:imx8m/evk_8mm/BoardConfig.mk
 +include device/fsl/imx8m/BoardConfigCommon.mk
++=======
+ include device/idtech/imx8m/BoardConfigCommon.mk
+ ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
+ -include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
+ endif
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a100/BoardConfig.mk
  
  BUILD_TARGET_FS ?= ext4
  TARGET_USERIMAGES_USE_EXT4 := true
@@@ -42,23 -42,16 +53,36 @@@
  TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.freescale
  
  # Support gpt
++<<<<<<< HEAD:imx8m/evk_8mm/BoardConfig.mk
 +ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
 +  BOARD_BPT_INPUT_FILES += device/fsl/common/partition/device-partitions-13GB-ab_super.bpt
 +  ADDITION_BPT_PARTITION = partition-table-28GB:device/fsl/common/partition/device-partitions-28GB-ab_super.bpt \
 +                           partition-table-dual:device/fsl/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
 +                           partition-table-28GB-dual:device/fsl/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
 +else
 +  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
 +    BOARD_BPT_INPUT_FILES += device/fsl/common/partition/device-partitions-13GB-ab-no-product.bpt
 +    ADDITION_BPT_PARTITION = partition-table-28GB:device/fsl/common/partition/device-partitions-28GB-ab-no-product.bpt \
 +                             partition-table-dual:device/fsl/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
 +                             partition-table-28GB-dual:device/fsl/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
 +  else
 +    BOARD_BPT_INPUT_FILES += device/fsl/common/partition/device-partitions-13GB-ab.bpt
 +    ADDITION_BPT_PARTITION = partition-table-28GB:device/fsl/common/partition/device-partitions-28GB-ab.bpt \
 +                             partition-table-dual:device/fsl/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
 +                             partition-table-28GB-dual:device/fsl/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
 +  endif
++=======
+ ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
+ BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-13GB-ab-no-product.bpt
+ ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab-no-product.bpt \
+                          partition-table-dual:device/idtech/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
+                          partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
+ else
+ BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab.bpt
+ ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab.bpt \
+                          partition-table-dual:device/idtech/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
+                          partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a100/BoardConfig.mk
  endif
  
  # Vendor Interface manifest and compatibility
@@@ -105,8 -78,10 +109,11 @@@ TARGET_USERIMAGES_SPARSE_EXT_DISABLED :
  
  BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
  
+ # BCM 1MW BT
+ BOARD_HAVE_BLUETOOTH_BCM := true
+ 
  BOARD_HAVE_USB_CAMERA := true
 +BOARD_HAVE_USB_MJPEG_CAMERA := false
  
  USE_ION_ALLOCATOR := true
  USE_GPU_ALLOCATOR := false
@@@ -120,76 -95,39 +127,86 @@@ TARGET_USES_MKE2FS := tru
  # define frame buffer count
  NUM_FRAMEBUFFER_SURFACE_BUFFERS := 3
  
- ifeq ($(PRODUCT_IMX_DRM),true)
- CMASIZE=736M
- else
  CMASIZE=800M
- endif
  
 -ifeq ($(LOW_MEMORY),true)
 -BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardware=freescale cma=320M@0x400M-0xb80M androidboot.primary_display=imx-drm firmware_class.path=/vendor/firmware transparent_hugepage=never loop.max_part=7 androidboot.displaymode=720p galcore.contiguousSize=33554432
 -else
 -BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardware=freescale cma=$(CMASIZE)@0x400M-0xb80M androidboot.primary_display=imx-drm firmware_class.path=/vendor/firmware transparent_hugepage=never loop.max_part=7
 -endif
 +# NXP default config
 +BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardware=freescale firmware_class.path=/vendor/firmware loop.max_part=7
 +
 +# memory config
 +BOARD_KERNEL_CMDLINE += transparent_hugepage=never
  
 -# Set the density to 213 tvdpi to match CDD.
 -BOARD_KERNEL_CMDLINE += androidboot.lcd_density=213
 +# display config
 +BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-drm
  
 -# Default wificountrycode
 +# wifi config
  BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN
  
 +# low memory device build config
 +ifeq ($(LOW_MEMORY),true)
 +BOARD_KERNEL_CMDLINE += cma=320M@0x400M-0xb80M androidboot.displaymode=720p galcore.contiguousSize=33554432
 +else
 +BOARD_KERNEL_CMDLINE += cma=$(CMASIZE)@0x400M-0xb80M
 +endif
 +
  ifeq ($(TARGET_USERIMAGES_USE_UBIFS),true)
  ifeq ($(TARGET_USERIMAGES_USE_EXT4),true)
  $(error "TARGET_USERIMAGES_USE_UBIFS and TARGET_USERIMAGES_USE_EXT4 config open in same time, please only choose one target file system image")
  endif
  endif
  
- BOARD_PREBUILT_DTBOIMAGE := out/target/product/evk_8mm/dtbo-imx8mm.img
+ LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
+ LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
+ BOARD_PREBUILT_DTBOIMAGE := out/target/product/evk_a100/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
  
++<<<<<<< HEAD:imx8m/evk_8mm/BoardConfig.mk
 +ifeq ($(PRODUCT_8MM_DDR4), true)
 +  ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
 +    # dts target for imx8mm_evk with DDR4 on board
 +    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
 +      # dts without product partition
 +      TARGET_BOARD_DTS_CONFIG ?= imx8mm:imx8mm-ddr4-evk-no-product.dtb
 +    else
 +      TARGET_BOARD_DTS_CONFIG ?= imx8mm:imx8mm-ddr4-evk.dtb
 +    endif
 +  else
 +    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
 +      TARGET_BOARD_DTS_CONFIG ?= imx8mm:imx8mm-ddr4-evk-no-product-no-dynamic_partition.dtb
 +    else
 +      TARGET_BOARD_DTS_CONFIG ?= imx8mm:imx8mm-ddr4-evk-no-dynamic_partition.dtb
 +    endif
 +  endif
 +else
 +  ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
 +    # dts target for imx8mm_evk with LPDDR4 on board
 +    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
 +      # dts without product partition
 +      TARGET_BOARD_DTS_CONFIG ?= imx8mm:imx8mm-evk-no-product.dtb
 +    else
 +      # imx8mm with MIPI-HDMI display and QCA wifi
 +      TARGET_BOARD_DTS_CONFIG ?= imx8mm:imx8mm-evk.dtb
 +      # imx8mm with MIPI panel display and QCA wifi
 +      TARGET_BOARD_DTS_CONFIG += imx8mm-mipi-panel:imx8mm-evk-rm67191.dtb
 +      # imx8mm with MIPI-HDMI display, QCA wifi and m4 image to support LPA
 +      TARGET_BOARD_DTS_CONFIG += imx8mm-m4:imx8mm-evk-rpmsg.dtb
 +    endif
 +  else
 +    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
 +      TARGET_BOARD_DTS_CONFIG ?= imx8mm:imx8mm-evk-no-product-no-dynamic_partition.dtb
 +    else
 +      TARGET_BOARD_DTS_CONFIG ?= imx8mm:imx8mm-evk-no-dynamic_partition.dtb
 +    endif
 +  endif
++=======
+ ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
+ TARGET_BOARD_DTS_CONFIG := imx8mn:fsl-imx8mn-ddr4-evk-no-product.dtb
+ else
+ # imx8mn with MIPI-HDMI display, BCM wifi and support trusty
+ TARGET_BOARD_DTS_CONFIG := imx8mn:fsl-imx8mn-ddr4-evk.dtb
+ # imx8mn with MIPI panel display and BCM wifi
+ TARGET_BOARD_DTS_CONFIG += imx8mn-mipi-panel:fsl-imx8mn-ddr4-evk-rm67191.dtb
+ # imx8mn with MIPI-HDMI display and BCM wifi and M7 image
+ TARGET_BOARD_DTS_CONFIG += imx8mn-rpmsg:fsl-imx8mn-ddr4-evk-rpmsg.dtb
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a100/BoardConfig.mk
  endif
  
  BOARD_SEPOLICY_DIRS := \
diff --cc imx8m/evk_a100/evk_a100.mk
index edc04cd9,6b548477..bdffe8f3
--- a/imx8m/evk_a100/evk_a100.mk
+++ b/imx8m/evk_a100/evk_a100.mk
@@@ -6,8 -6,8 +6,13 @@@ IMX_DEVICE_PATH := device/idtech/imx8m/
  # configs shared between uboot, kernel and Android rootfs
  include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
  
++<<<<<<< HEAD:imx8m/evk_8mm/evk_8mm.mk
 +-include device/fsl/common/imx_path/ImxPathConfig.mk
 +include device/fsl/imx8m/ProductConfigCommon.mk
++=======
+ -include device/idtech/common/imx_path/ImxPathConfig.mk
+ $(call inherit-product, device/idtech/imx8m/ProductConfigCommon.mk)
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a100/evk_a100.mk
  
  ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.freescale),)
  $(shell touch $(IMX_DEVICE_PATH)/fstab.freescale)
@@@ -23,31 -23,8 +28,36 @@@ PRODUCT_FULL_TREBLE_OVERRIDE := tru
  #Enable this to choose 32 bit user space build
  #IMX8_BUILD_32BIT_ROOTFS := true
  
++<<<<<<< HEAD:imx8m/evk_8mm/evk_8mm.mk
 +#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
 +TARGET_USE_DYNAMIC_PARTITIONS ?= true
 +#If the device is retrofit to have dynamic partition feature, set this variable to true to build
 +#the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
 +TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
 +
 +ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
 +  PRODUCT_USE_DYNAMIC_PARTITIONS := true
 +  BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
 +  BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
 +  ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
 +    PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
 +    BOARD_SUPER_PARTITION_METADATA_DEVICE := system
 +    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
 +      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor
 +      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 2952790016
 +      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
 +    else
 +      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor product
 +      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 1610612736
 +      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
 +      BOARD_SUPER_PARTITION_PRODUCT_DEVICE_SIZE := 1879048192
 +    endif
 +  endif
 +endif
++=======
+ #Enable this to config 1GB ddr on evk_a100
+ #LOW_MEMORY := true
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a100/evk_a100.mk
  
  # Include keystore attestation keys and certificates.
  ifeq ($(PRODUCT_IMX_TRUSTY),true)
@@@ -74,35 -51,9 +84,41 @@@ PRODUCT_COPY_FILES += 
      $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
      $(IMX_DEVICE_PATH)/ueventd.freescale.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
      $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
++<<<<<<< HEAD:imx8m/evk_8mm/evk_8mm.mk
 +    device/fsl/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
 +    device/fsl/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh
 +
 +ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
 +PRODUCT_COPY_FILES += \
 +    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/dynamic_partiton_tools/lpmake:lpmake \
 +    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/dynamic_partiton_tools/lpmake.exe:lpmake.exe
 +endif
 +
 +# Audio card json
 +PRODUCT_COPY_FILES += \
 +    device/fsl/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
 +    device/fsl/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
 +    device/fsl/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
 +    device/fsl/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
 +    device/fsl/common/audio-json/ak4497_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4497_config.json \
 +    device/fsl/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
 +
 +ifeq ($(PRODUCT_8MM_DDR4), true)
 +#DDR4 board, bcm wifi supplicant overlay
 +PRODUCT_COPY_FILES += \
 +    $(IMX_DEVICE_PATH)/init.imx8mm.ddr4.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.additional.rc \
 +    device/fsl/common/wifi/bcm_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
 +else
 +#LPDDR4 board, qcom wifi supplicant overlay
 +PRODUCT_COPY_FILES += \
 +    $(IMX_DEVICE_PATH)/init.imx8mm.lpddr4.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.additional.rc \
 +    device/fsl/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
 +endif
++=======
+     device/idtech/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
+     device/idtech/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
+     device/idtech/common/wifi/bcm_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a100/evk_a100.mk
  
  ifeq ($(PRODUCT_IMX_TRUSTY),true)
  PRODUCT_COPY_FILES += \
@@@ -168,8 -121,12 +186,12 @@@ DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE
  
  PRODUCT_CHARACTERISTICS := tablet
  
 -PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi
 +PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
  
+ # GPU openCL g2d
+ PRODUCT_COPY_FILES += \
+     $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
+ 
  # HWC2 HAL
  PRODUCT_PACKAGES += \
      android.hardware.graphics.composer@2.3-service
@@@ -192,9 -149,16 +214,20 @@@ PRODUCT_PACKAGES += 
      libGAL \
      libGLSLC \
      libVSC \
-     libg2d-viv \
      libgpuhelper \
++<<<<<<< HEAD:imx8m/evk_8mm/evk_8mm.mk
 +    gatekeeper.imx
++=======
+     libSPIRV_viv \
+     libvulkan_VIVANTE \
+     vulkan.imx8 \
+     libCLC \
+     libLLVM_viv \
+     libOpenCL \
+     libg2d-opencl \
+     libg2d-viv \
+     gatekeeper.imx8
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a100/evk_a100.mk
  
  PRODUCT_PACKAGES += \
      android.hardware.audio@5.0-impl:32 \
@@@ -354,11 -278,4 +362,15 @@@ PRODUCT_PACKAGES += 
      adb_debug.prop
  endif
  
++<<<<<<< HEAD:imx8m/evk_8mm/evk_8mm.mk
 +IMX-DEFAULT-G2D-LIB := libg2d-viv
 +
 +ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 +ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 +INSTALL_64BIT_LIBRARY := true
 +endif
 +-include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
 +endif
++=======
+ IMX-DEFAULT-G2D-LIB := libg2d-opencl
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a100/evk_a100.mk
diff --cc imx8m/evk_a300/camera_config_imx8mq.json
index 037e2b0f,a9ec51ad..8ee84edf
--- a/imx8m/evk_a300/camera_config_imx8mq.json
+++ b/imx8m/evk_a300/camera_config_imx8mq.json
@@@ -4,16 -4,15 +4,20 @@@
    ],
  
    "hal_version": "3",
-   "cam_blit_copy": "DPU",
+   "cam_blit_copy": "GPU_3D",
    "cam_blit_csc": "GPU_3D",
 +  "hw_jpeg_enc": "mxc-jpeg-enc",
  
    "camera_metadata": [
      {
        "camera_type": "back",
++<<<<<<< HEAD:imx8q/mek_8q/camera_config_imx8qxp.json
 +      "camera_name": "mxc-isi-cap",
++=======
+       "camera_name": "mx6s-csi0",
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a300/camera_config_imx8mq.json
        "orientation": "0",
-       "buffer_type": "dma",
+       "buffer_type": "mmap",
        "ActiveArrayWidth": "2592",
        "ActiveArrayHeight": "1944",
        "PixelArrayWidth": "2592",
@@@ -34,17 -38,17 +43,31 @@@
      },
      {
        "camera_type": "front",
++<<<<<<< HEAD:imx8q/mek_8q/camera_config_imx8qxp.json
 +      "camera_name": "mxc-isi-cap",
 +      "orientation": "0",
 +      "buffer_type": "dma",
 +      "ActiveArrayWidth": "2592",
 +      "ActiveArrayHeight": "1944",
 +      "PixelArrayWidth": "2592",
 +      "PixelArrayHeight": "1944",
 +      "PhysicalWidth": "3.6288",
 +      "PhysicalHeight": "2.7216",
 +      "FocalLength": "3.37",
 +      "MaxJpegSize": "6291456",
++=======
+       "camera_name": "mx6s-csi1",
+       "orientation": "0",
+       "buffer_type": "mmap",
+       "ActiveArrayWidth": "1600",
+       "ActiveArrayHeight": "1200",
+       "PixelArrayWidth": "1600",
+       "PixelArrayHeight": "1200",
+       "PhysicalWidth": "2.24",
+       "PhysicalHeight": "1.68",
+       "FocalLength": "2.66",
+       "MaxJpegSize": "2097152",
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a300/camera_config_imx8mq.json
        "MinFrameDuration": "33331760",
        "MaxFrameDuration": "300000000",
        "OmitFrame": [
diff --cc imx8m/evk_a300/evk_a300_drm.mk
index f6aacf45,8ec77222..a7898b6b
--- a/imx8m/evk_a300/evk_a300_drm.mk
+++ b/imx8m/evk_a300/evk_a300_drm.mk
@@@ -5,17 -5,18 +5,18 @@@ IMX_DEVICE_PATH := device/idtech/imx8m/
  
  PRODUCT_IMX_DRM := true
  
- # copy drm specific files before inherit evk_8mm.mk, otherwise copy is ignored
+ # copy drm specific files before inherit evk_a300.mk, otherwise copy is ignored
  PRODUCT_COPY_FILES += \
- 	$(IMX_DEVICE_PATH)/init.imx8mm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.imx8mm.main.rc \
- 	$(IMX_DEVICE_PATH)/init.imx8mm.drm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.imx8mm.rc \
- 	$(TOPDIR)device/fsl/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
+ 	$(IMX_DEVICE_PATH)/audio_policy_configuration_drm.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
+ 	$(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.imx8mq.main.rc \
+ 	$(IMX_DEVICE_PATH)/init.imx8mq.drm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.imx8mq.rc \
+ 	$(TOPDIR)device/idtech/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
  
  
- $(call inherit-product, $(TOPDIR)device/fsl/imx8m/optee-packages.mk)
- $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/evk_8mm.mk)
+ $(call inherit-product, $(TOPDIR)device/idtech/imx8m/optee-packages.mk)
+ $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/evk_a300.mk)
  
 -TARGET_KERNEL_DEFCONFIG := android_defconfig
 +TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
  
  
  # Overrides
@@@ -38,7 -39,7 +39,11 @@@ DECODED_BUFFER_LEN		:= 0x3000000
  endif
  endif
  
++<<<<<<< HEAD:imx8m/evk_8mm/evk_8mm_drm.mk
 +TARGET_BOARD_DTS_CONFIG := imx8mm:imx8mm-evk-drm.dtb imx8mm-mipi-panel:imx8mm-evk-rm67191.dtb imx8mm-m4:imx8mm-evk-m4.dtb
++=======
+ TARGET_BOARD_DTS_CONFIG := imx8mq:fsl-imx8mq-evk-drm.dtb imx8mq-mipi:fsl-imx8mq-evk-lcdif-adv7535.dtb imx8mq-dual:fsl-imx8mq-evk-dual-display.dtb
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a300/evk_a300_drm.mk
  
  # Exoplayer
  PRODUCT_PACKAGES += \
diff --cc imx8m/evk_a300/init.imx8mq.rc
index 36f39221,eabe3c9f..c0721d5f
--- a/imx8m/evk_a300/init.imx8mq.rc
+++ b/imx8m/evk_a300/init.imx8mq.rc
@@@ -10,27 -17,12 +17,31 @@@ on early-boo
      chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
      chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
  
++<<<<<<< HEAD:imx8q/mek_8q/init.imx8qxp.rc
 +on early-boot
 +    # For mek_8qxp, when swap used about 400M, upgrade the level.
 +    setprop ro.lmk.upgrade_pressure 87
 +    setprop ro.lmk.downgrade_pressure 95
 +    setprop ro.lmk.critical_upgrade true
 +
 +    # Set OpenGLES version
 +    setprop ro.opengles.version 196609
 +
 +    # Set GPU 3D minimum clock to 3/64
 +    write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
 +
 +    # Set light sensor sysfs path
 +    setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-15/device/15-0044/"
 +
++=======
++>>>>>>> android_10_idt_dev_200527-2:imx8m/evk_a300/init.imx8mq.rc
  on property:sys.boot_completed=1
      # Set default CPU frequency governor
+     # configure governor settings for little cluster
      write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "schedutil"
 -    write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 500
 -    write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 2000
 +    # The rate-limit tunable in the schedutil governor applies to transitions to both lower and higher frequencies
 +    # Set both up and down limit us to 200us
 +    write /sys/devices/system/cpu/cpufreq/schedutil/rate_limit_us 200
  
  on property:sys.boot_completed=1
      # update cpuset now that processors are up
diff --cc imx8m/sepolicy/file.te
index 39ad9a78,9a21738e..570111b7
--- a/imx8m/sepolicy/file.te
+++ b/imx8m/sepolicy/file.te
@@@ -1,4 -1,4 +1,8 @@@
  type mediadrm_vendor_data_file, file_type, data_file_type;
  type debugfs_dma, debugfs_type, fs_type;
  type debugfs_sw_sync, debugfs_type, fs_type;
++<<<<<<< HEAD
 +type sysfs_soc, sysfs_type, fs_type;
++=======
+ type sysfs_usb_uevent, sysfs_type, fs_type;
++>>>>>>> android_10_idt_dev_200527-2
diff --cc imx8m/vp6820_8mn/init.imx8mn.rc
index 0fdd6e9e,eabe3c9f..0db2114c
--- a/imx8m/vp6820_8mn/init.imx8mn.rc
+++ b/imx8m/vp6820_8mn/init.imx8mn.rc
@@@ -9,41 -16,13 +16,49 @@@ on early-boo
      chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
      chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
      chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
++<<<<<<< HEAD:imx8q/mek_8q/init.imx8qm.rc
 +    # cpu4 is A72 core on imx8qm, it has separate governor
 +    chown root system /sys/devices/system/cpu/cpu4/cpufreq/scaling_max_freq
 +    chmod 0664 /sys/devices/system/cpu/cpu4/cpufreq/scaling_max_freq
 +    chown root system /sys/devices/system/cpu/cpu4/cpufreq/scaling_min_freq
 +    chmod 0664 /sys/devices/system/cpu/cpu4/cpufreq/scaling_min_freq
 +    chown root system /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor
 +    chmod 0664 /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor
 +    chown root system /sys/devices/system/cpu/cpu4/cpufreq/cpuinfo_cur_freq
 +    chmod 0440 /sys/devices/system/cpu/cpu4/cpufreq/cpuinfo_cur_freq
 +    chown root system /sys/devices/system/cpu/cpu4/cpufreq/scaling_available_frequencies
 +
 +on early-boot
 +
 +    # For mek_8qm, when swap used about 400M, upgrade the level.
 +    setprop ro.lmk.upgrade_pressure 93
 +    setprop ro.lmk.downgrade_pressure 99
 +    setprop ro.lmk.critical_upgrade true
 +
 +    # Set OpenGLES version
 +    setprop ro.opengles.version 196610
 +
 +    # Set GPU 3D minimum clock to 3/64
 +    write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
 +
 +    # Set light sensor sysfs path
 +    setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-2/device/2-0044/"
++=======
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mn/init.imx8mn.rc
  
  on property:sys.boot_completed=1
      # Set default CPU frequency governor
      # configure governor settings for little cluster
      write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "schedutil"
++<<<<<<< HEAD:imx8q/mek_8q/init.imx8qm.rc
 +    write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor "schedutil"
 +    # The rate-limit tunable in the schedutil governor applies to transitions to both lower and higher frequencies
 +    # Set both up and down limit us to 200us
 +    write /sys/devices/system/cpu/cpufreq/schedutil/rate_limit_us 200
++=======
+     write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 500
+     write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 2000
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mn/init.imx8mn.rc
  
  on property:sys.boot_completed=1
      # update cpuset now that processors are up
diff --cc imx8m/vp6820_8mn/init.rc
index f6a09505,d9a5f24e..2af3d5cb
--- a/imx8m/vp6820_8mn/init.rc
+++ b/imx8m/vp6820_8mn/init.rc
@@@ -76,13 -80,7 +80,11 @@@ on early-boo
      # fsl omx graphic manager media framework property
      setprop rw.VIDEO_RENDER_NAME video_render.surface
      setprop media.fsl_codec.flag 7
++<<<<<<< HEAD:imx8q/mek_8q/init.rc
 +    setprop media.amphion_vpu.enable-tile 0
++=======
+     setprop debug.stagefright.ccodec 0
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mn/init.rc
  
      setprop camera.disable_zsl_mode 1
  
@@@ -118,14 -122,24 +126,31 @@@
      chmod 0664 /sys/kernel/debug/sync/sw_sync
  
      # Default backlight device
++<<<<<<< HEAD:imx8q/mek_8q/init.rc
 +    setprop hw.backlight.dev "56228000.dsi_host.0"
 +    # Chmod/chown FSL specific sys entry
 +    chown system system /sys/class/backlight/56228000.dsi_host.0/brightness
 +    chmod 0660 /sys/class/backlight/56228000.dsi_host.0/brightness
++=======
+     setprop hw.backlight.dev "32e10000.mipi_dsi.0"
+     # Chmod/chown FSL specific sys entry
+     chown system system /sys/class/backlight/32e10000.mipi_dsi.0/brightness
+     chmod 0660 /sys/class/backlight/32e10000.mipi_dsi.0/brightness
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mn/init.rc
  
-     # Set light sensor threshold lux value
+     # Set light sensor sysfs path and light sensor threshold lux value
+     setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
      setprop ro.lightsensor.threshold  20
  
+     # Dectect DSF streams when scanning media
+     setprop ro.FSL_DSF_PARSER 1
+ 
+     # Allow DSD file(duration larger than 10s) can play
+     setprop audio.offload.min.duration.secs 10
+ 
+     # Enlarge limition of audio buffer allocation
+     setprop ro.af.client_heap_size_kbyte 32768
+ 
      # enlarge media max memory size to 3G.
      setprop ro.media.maxmem 3221225471
  
diff --cc imx8m/vp6820_8mq/fstab.freescale
index 32f68701,85f7ae12..3a81b34d
--- a/imx8m/vp6820_8mq/fstab.freescale
+++ b/imx8m/vp6820_8mq/fstab.freescale
@@@ -3,7 -3,8 +3,12 @@@
  # The filesystem that contains the filesystem checker binary (typically /system) cannot
  # specify MF_CHECK, and must come before any filesystems that do specify MF_CHECK
  
++<<<<<<< HEAD:imx8m/evk_8mm/fstab.freescale
 +/devices/platform/soc@0/soc@0:bus@32c00000/32e40000.usb/ci_hdrc.0/* auto auto defaults voldmanaged=usb:auto
++=======
+ /devices/platform/38200000.usb/xhci-hcd.0.auto/* auto auto defaults voldmanaged=usb:auto
+ /dev/block/by-name/system      /      ext4    ro,barrier=1                                                                           wait,slotselect
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mq/fstab.freescale
  /dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,nomblk_io_submit,noauto_da_alloc,errors=panic    wait,formattable,quota,fileencryption=software,reservedsize=128M
  /dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
  /dev/block/zram0 none swap defaults zramsize=629145600
diff --cc imx8m/vp6820_8mq/init.rc
index d21b9cda,80044e26..45d3f006
--- a/imx8m/vp6820_8mq/init.rc
+++ b/imx8m/vp6820_8mq/init.rc
@@@ -57,8 -85,17 +85,16 @@@ on early-boo
      # fsl omx graphic manager media framework property
      setprop rw.VIDEO_RENDER_NAME video_render.surface
      setprop media.fsl_codec.flag 7
 -    setprop debug.stagefright.ccodec 0
  
      setprop camera.disable_zsl_mode 1
+     setprop back_camera_name mx6s-csi0
+     setprop back_camera_orient 0
+     setprop front_camera_name mx6s-csi1
+     setprop front_camera_orient 0
+ 
+    # Tweak the mmc device read ahead buffer size
+     write /sys/block/mmcblk0/queue/read_ahead_kb 2048
+     write /sys/block/mmcblk1/queue/read_ahead_kb 2048
  
      # Set period_us for usb audio
      setprop ro.audio.usb.period_us 20000
@@@ -79,34 -125,47 +124,55 @@@
      # Set tracefs permission to 755
      chmod 0755 /sys/kernel/debug/tracing
  
+     # Set sw_sync group to graphics and set permission to 664
+     chown root graphics /sys/kernel/debug/sync/sw_sync
+     chmod 0664 /sys/kernel/debug/sync/sw_sync
+ 
      # Default backlight device
+     #setprop hw.backlight.dev "30a00000.mipi_dsi_bridge.0"
      # Chmod/chown FSL specific sys entry
++<<<<<<< HEAD:imx8q/mek_8q/init_car.rc
 +    setprop hw.backlight.dev "56228000.dsi_host.0"
 +    chown system system /sys/class/backlight/56228000.dsi_host.0/brightness
 +    chmod 0660 /sys/class/backlight/56228000.dsi_host.0/brightness
 +
 +    # Set light sensor threshold lux value
++=======
+     #chown system system /sys/class/backlight/30a00000.mipi_dsi_bridge.0/brightness
+     #chmod 0660 /sys/class/backlight/30a00000.mipi_dsi_bridge.0/brightness
+     setprop hw.backlight.dev "backlight"
+     chown system system /sys/class/backlight/backlight/brightness
+     chmod 0660 /sys/class/backlight/backlight/brightness
+ 
+     # For PWM2-4
+     chown system system /sys/class/backlight/pwm_2/brightness
+     chown system system /sys/class/backlight/pwm_3/brightness
+     chown system system /sys/class/backlight/pwm_4/brightness
+     chmod 0660 /sys/class/backlight/pwm_2/brightness
+     chmod 0660 /sys/class/backlight/pwm_3/brightness
+     chmod 0660 /sys/class/backlight/pwm_4/brightness
+ 
+     # Set light sensor sysfs path and light sensor threshold lux value
+     setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mq/init.rc
      setprop ro.lightsensor.threshold  20
  
-     setprop persist.service.bdroid.bdaddr 22:22:67:C6:69:73
+     # Dectect DSF streams when scanning media
+     setprop ro.FSL_DSF_PARSER 1
  
-     # enlarge media max memory size to 3G.
-     setprop ro.media.maxmem 3221225471
+     # Allow DSD file(duration larger than 10s) can play
+     setprop audio.offload.min.duration.secs 10
  
-     setprop persist.bluetooth.enablenewavrcp false
+     # Enlarge limition of audio buffer allocation
+     setprop ro.af.client_heap_size_kbyte 32768
  
-     setprop ro.config.media_vol_steps 15
-     setprop ro.config.media_vol_default 15
+     # enlarge media max memory size to 3G.
+     setprop ro.media.maxmem 3221225471
  
+     setprop wifi.direct.interface p2p-dev-wlan0
      start vendor.wifi_hal_legacy
  
- on property:vendor.vehicle.event=1 && property:vendor.evs.video.ready=1
-     start evs_app
- 
- on property:vendor.vehicle.event=0
-     stop evs_app
- 
- on property:vendor.all.system_server.start=1
+ on boot
      start audioserver
      start mediadrm
      start media
@@@ -140,8 -182,21 +189,21 @@@ service wpa_supplicant /vendor/bin/hw/w
      disabled
      oneshot
  
+ service sensor_fusion /vendor/bin/fsl_sensor_fusion
+     class late_start
+     seclabel u:r:sensors:s0
+     user system
+     group input
+     oneshot
+ 
+ service vendor.sensors-hal-1-0 /vendor/bin/hw/android.hardware.sensors@1.0-service
+ 	class hal
+ 	user system
+ 	group system wakelock input root
+ 	capabilities BLOCK_SUSPEND SYS_NICE
+ 
  # Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
 -service watchdogd /sbin/watchdogd 10 20
 +service watchdogd /system/bin/watchdogd 10 20
      class core
      seclabel u:r:watchdogd:s0
  
diff --cc imx8m/vp6820_8mq/ueventd.freescale.rc
index 336f0016,c58f8503..7d57f405
--- a/imx8m/vp6820_8mq/ueventd.freescale.rc
+++ b/imx8m/vp6820_8mq/ueventd.freescale.rc
@@@ -1,6 -1,6 +1,12 @@@
++<<<<<<< HEAD:imx8m/evk_8mm/ueventd.freescale.rc
 +/dev/block/platform/soc@0/soc@0:bus@30800000/30b50000\.mmc/by-name/presistdata 0600   system     system
 +/dev/block/platform/soc@0/soc@0:bus@30800000/30b60000\.mmc/by-name/presistdata 0600   system     system
 +/dev/ttymxc0              0660   bluetooth  bluetooth
++=======
+ /dev/block/platform/30b50000\.usdhc/by-name/presistdata 0600   system     system
+ /dev/block/platform/30b40000\.usdhc/by-name/presistdata 0600   system     system
+ /dev/ttymxc1              0660   bluetooth  bluetooth
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mq/ueventd.freescale.rc
  /dev/snd/*                0660   system     audio
  /dev/video*               0660   system     camera
  /dev/mxc_hantro           0660   media      drmrpc
diff --cc imx8m/vp6820_8mq/vp6820_8mq_common.mk
index 8956d9c5,e5241c10..478bf183
--- a/imx8m/vp6820_8mq/vp6820_8mq_common.mk
+++ b/imx8m/vp6820_8mq/vp6820_8mq_common.mk
@@@ -6,18 -6,8 +6,23 @@@ IMX_DEVICE_PATH := device/idtech/imx8m/
  # configs shared between uboot, kernel and Android rootfs
  include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
  
++<<<<<<< HEAD:imx8q/mek_8q/mek_8q.mk
 +-include device/fsl/common/imx_path/ImxPathConfig.mk
 +
 +ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 +ifeq ($(PRODUCT_IMX_CAR),true)
 +$(call inherit-product, $(IMX_DEVICE_PATH)/core_64_bit_car.mk)
 +else
 +$(call inherit-product, $(SRC_TARGET_DIR)/product/core_64_bit.mk)
 +endif # PRODUCT_IMX_CAR
 +endif # IMX8_BUILD_32BIT_ROOTFS
 +$(call inherit-product, device/fsl/imx8q/ProductConfigCommon.mk)
++=======
+ -include device/idtech/common/imx_path/ImxPathConfig.mk
+ $(call inherit-product, device/idtech/imx8m/ProductConfigCommon.mk)
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mq/vp6820_8mq_common.mk
 +
 +include device/fsl/imx8q/ProductConfigCommon.mk
  
  ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab_nand.freescale),)
  $(shell touch $(IMX_DEVICE_PATH)/fstab_nand.freescale)
@@@ -79,76 -35,29 +76,47 @@@ endi
  PRODUCT_COPY_FILES += \
      $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
      $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
+     $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
      $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml \
-     $(IMX_DEVICE_PATH)/init.imx8qm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.imx8qm.rc \
-     $(IMX_DEVICE_PATH)/init.imx8qxp.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.imx8qxp.rc \
+     $(IMX_DEVICE_PATH)/fstab.freescale:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.freescale \
+     $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.imx8mq.rc \
+     $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
+     $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.rc \
      $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.usb.rc \
+     $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
      $(IMX_DEVICE_PATH)/ueventd.freescale.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-     device/fsl/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-     device/fsl/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-     device/fsl/common/wifi/bcm_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
- 
+     $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
+     device/idtech/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
+     device/idtech/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
+     device/idtech/common/wifi/bcm_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf \
+     device/idtech/common/deviceowner/device_policies.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/device_policies.xml \
+     device/idtech/common/deviceowner/device_owner_2.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/device_owner_2.xml \
+     device/idtech/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
+     device/idtech/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
+     device/idtech/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img
+ 
++<<<<<<< HEAD:imx8q/mek_8q/mek_8q.mk
 +ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
 +PRODUCT_COPY_FILES += \
 +    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/dynamic_partiton_tools/lpmake:lpmake \
 +    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/dynamic_partiton_tools/lpmake.exe:lpmake.exe
 +endif
 +
 +# Audio card json
 +PRODUCT_COPY_FILES += \
 +    device/fsl/common/audio-json/wm8960_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8960_config.json \
 +    device/fsl/common/audio-json/cs42888_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cs42888_config.json \
 +    device/fsl/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
 +    device/fsl/common/audio-json/xtor_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/xtor_config.json \
 +    device/fsl/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
 +
 +# Copy rpmb test key and AVB test public key
++=======
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mq/vp6820_8mq_common.mk
  ifeq ($(PRODUCT_IMX_TRUSTY),true)
  PRODUCT_COPY_FILES += \
-     device/fsl/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-     device/fsl/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
- endif
- 
- PRODUCT_COPY_FILES += \
-     device/fsl/imx8q/mek_8q/camera_config_imx8qm.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8qm.json \
-     device/fsl/imx8q/mek_8q/camera_config_imx8qxp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8qxp.json
- 
- ifeq ($(PRODUCT_IMX_CAR),true)
- PRODUCT_COPY_FILES += \
-     $(IMX_DEVICE_PATH)/audio_policy_configuration_car.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-     $(IMX_DEVICE_PATH)/car_display_settings.xml:$(TARGET_COPY_OUT_VENDOR)/etc/display_settings.xml
- else
- PRODUCT_COPY_FILES += \
-     $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml
- endif
- 
- ifeq ($(PRODUCT_IMX_CAR),true)
- PRODUCT_COPY_FILES += \
-     $(IMX_DEVICE_PATH)/init_car.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.rc \
-     $(IMX_DEVICE_PATH)/fstab.freescale.car:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.freescale \
-     $(IMX_DEVICE_PATH)/early.init_car.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-     $(IMX_DEVICE_PATH)/required_hardware_auto.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
-     device/fsl/imx8q/init.recovery.freescale.car.rc:root/init.recovery.freescale.rc
- 
- ifeq ($(PRODUCT_IMX_CAR_M4),true)
- PRODUCT_COPY_FILES += \
-     $(IMX_DEVICE_PATH)/setup.main.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/setup.main.cfg \
-     $(IMX_DEVICE_PATH)/setup.core.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/setup.core.cfg \
-     $(IMX_DEVICE_PATH)/init_car_m4.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.car_additional.rc
- else
- PRODUCT_COPY_FILES += \
-     $(IMX_DEVICE_PATH)/setup.main.car2.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/setup.main.cfg \
-     $(IMX_DEVICE_PATH)/setup.core.car2.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/setup.core.cfg \
-     $(IMX_DEVICE_PATH)/init_car_no_m4.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.car_additional.rc
- endif #PRODUCT_IMX_CAR_M4
- else
- PRODUCT_COPY_FILES += \
-     $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.freescale.rc \
-     $(IMX_DEVICE_PATH)/fstab.freescale:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.freescale \
-     frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-     $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
-     device/fsl/imx8q/init.recovery.freescale.rc:root/init.recovery.freescale.rc \
-     $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg
+     device/idtech/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
+     device/idtech/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
  endif
  
  # ONLY devices that meet the CDD's requirements may declare these features
@@@ -174,61 -89,30 +145,48 @@@ PRODUCT_COPY_FILES += 
      frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
      frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
  
++<<<<<<< HEAD:imx8q/mek_8q/mek_8q.mk
 +ifneq ($(PRODUCT_IMX_CAR),true)
 +PRODUCT_COPY_FILES += \
 +    frameworks/native/data/etc/android.hardware.sensor.accelerometer.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.sensor.accelerometer.xml \
 +    frameworks/native/data/etc/android.hardware.sensor.ambient_temperature.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.sensor.ambient_temperature.xml \
 +    frameworks/native/data/etc/android.hardware.sensor.barometer.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.sensor.barometer.xml \
 +    frameworks/native/data/etc/android.hardware.sensor.compass.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.sensor.compass.xml \
 +    frameworks/native/data/etc/android.hardware.sensor.gyroscope.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.sensor.gyroscope.xml \
 +    frameworks/native/data/etc/android.hardware.sensor.light.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.sensor.light.xml \
 +    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
 +    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
 +    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
 +    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
 +    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml
 +endif
 +
++=======
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mq/vp6820_8mq_common.mk
  # Vendor seccomp policy files for media components:
  PRODUCT_COPY_FILES += \
-     $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-     $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy
- 
- USE_XML_AUDIO_POLICY_CONF := 1
- 
- # VPU files
- PRODUCT_COPY_FILES += \
-     $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/vpu/vpu_fw_imx8_dec.bin:vendor/firmware/vpu/vpu_fw_imx8_dec.bin \
-     $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/vpu/vpu_fw_imx8_enc.bin:vendor/firmware/vpu/vpu_fw_imx8_enc.bin
- 
- # fastboot_imx_flashall scripts, fsl-sdcard-partition and uuu_imx_android_flash scripts
- PRODUCT_COPY_FILES += \
-     device/fsl/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-     device/fsl/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-     device/fsl/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-     device/fsl/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
+     $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
+     $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy
  
  PRODUCT_COPY_FILES += \
-      device/fsl/imx8q/mek_8q/powerhint_imx8qxp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8qxp.json \
-      device/fsl/imx8q/mek_8q/powerhint_imx8qm.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8qm.json
+     device/idtech/imx8m/vp6820_8mq/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
  
- ifneq ($(PRODUCT_IMX_CAR),true)
+ # fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
  PRODUCT_COPY_FILES += \
-     frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-     device/fsl/common/tools/fsl-sdcard-partition.sh:fsl-sdcard-partition.sh
- endif
+     device/idtech/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
+     device/idtech/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
+     device/idtech/common/tools/fsl-sdcard-partition.sh:fsl-sdcard-partition.sh \
+     device/idtech/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
+     device/idtech/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
  
+ USE_XML_AUDIO_POLICY_CONF := 1
  
  DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
  
  PRODUCT_CHARACTERISTICS := tablet
  
 -PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi
 +PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
  
- ifeq ($(PRODUCT_IMX_CAR),true)
- PRODUCT_CUSTOM_RECOVERY_DENSITY := ldpi
- endif
- 
  # GPU openCL g2d
  PRODUCT_COPY_FILES += \
      $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
@@@ -324,10 -192,6 +270,13 @@@ PRODUCT_PACKAGES += 
      libnnrt \
      android.hardware.neuralnetworks@1.2-service-vsi-npu-server
  
++<<<<<<< HEAD:imx8q/mek_8q/mek_8q.mk
 +# imx8 sensor HAL libs.
 +PRODUCT_PACKAGES += \
 +        sensors.imx
 +
++=======
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mq/vp6820_8mq_common.mk
  # Usb HAL
  PRODUCT_PACKAGES += \
      android.hardware.usb@1.1-service.imx
@@@ -426,30 -273,34 +357,38 @@@ endi
  PRODUCT_PROPERTY_OVERRIDES += \
      ro.product.first_api_level=28
  
++<<<<<<< HEAD:imx8q/mek_8q/mek_8q.mk
 +ifneq ($(PRODUCT_IMX_CAR),true)
- # Tensorflow lite camera demo
++=======
  PRODUCT_PACKAGES += \
-                     tflitecamerademo
- endif
- 
- ifneq ($(PRODUCT_IMX_CAR),true)
- PRODUCT_PACKAGES += \
-     android.hardware.sensors@1.0-impl \
-     android.hardware.sensors@1.0-service
- endif
- 
+     libg1 \
+     libhantro \
+     libcodec
  
  # Add oem unlocking option in settings.
  PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
  PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
  
- BOARD_VNDK_VERSION := current
- 
- ifneq ($(PRODUCT_IMX_CAR),true)
- # Included GMS package
- $(call inherit-product-if-exists, vendor/partner_gms/products/gms.mk)
+ ifneq (secure, $(findstring secure, $(TARGET_PRODUCT)))
+ # Multi-Display launcher
+ PRODUCT_PACKAGES += \
+     MultiDisplay
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mq/vp6820_8mq_common.mk
+ # Tensorflow lite camera demo
+ PRODUCT_PACKAGES += \
+     tflitecamerademo
  endif
  
+ # Multi-Client IME
+ PRODUCT_PACKAGES += \
+     MultiClientInputMethod
+ 
+ # Specify rollback index for bootloader and for AVB
+ ifneq ($(AVB_RBINDEX),)
+ BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
+ else
+ BOARD_AVB_ROLLBACK_INDEX := 0
+ endif
  
  #DRM Widevine 1.2 L3 support
  PRODUCT_PACKAGES += \
@@@ -467,31 -318,32 +406,44 @@@ PRODUCT_PACKAGES += 
      adb_debug.prop
  endif
  
- # In user build, the Cluster display is not included in
- # packages/services/Car/car_product/build/car.mk. Here add it back for testing
- ifeq ($(PRODUCT_IMX_CAR),true)
- PRODUCT_PACKAGES += \
-     DirectRenderingCluster \
- 
- endif
- 
- # Specify rollback index for bootloader and for AVB
- ifneq ($(AVB_RBINDEX),)
- BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
- else
- BOARD_AVB_ROLLBACK_INDEX := 0
- endif
- 
- #set default lib name for g2d, which will be linked
- #in OpenMAX repo
- IMX-DEFAULT-G2D-LIB := libg2d-dpu
+ IMX-DEFAULT-G2D-LIB := libg2d-viv
  
++<<<<<<< HEAD:imx8q/mek_8q/mek_8q.mk
 +ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 +ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 +INSTALL_64BIT_LIBRARY := true
 +endif
 +-include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
 +-include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp_aacp_dec/imx_dsp_aacp_dec.mk
 +-include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp_codec/imx_dsp_codec.mk
 +-include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp/imx_dsp_8q.mk
 +endif
++=======
+ # Copy Quectel vendor RIL
+ PRODUCT_COPY_FILES += \
+     vendor/quectel/libstdc++.so:/vendor/lib64/libstdc++.so \
+     vendor/quectel/libQuectelreference-ril.so:/vendor/lib64/libQuectelreference-ril.so \
+     vendor/quectel/ql-ril.conf:/system/etc/ql-ril.conf \
+     vendor/quectel/apns-conf.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/apns-conf.xml  \
+     vendor/quectel/chat:/system/bin/chat \
+     vendor/quectel/ip-down:/system/etc/ppp/ip-down \
+     vendor/quectel/ip-up:/system/etc/ppp/ip-up \
+     vendor/quectel/QAndroidLog:/system/bin/QAndroidLog \
+     vendor/quectel/QFlash:/system/bin/QFlash \
+     vendor/quectel/T1.LinuxData-OTA-DataService_V01.cfg:/system/data/T1.LinuxData-OTA-DataService_V01.cfg \
+     vendor/quectel/T2.RegServ-CotextAct_V01.cfg:/system/data/T2.RegServ-CotextAct_V01.cfg \
+     vendor/quectel/T3.SimpleData_V01.cfg:/system/data/T3.SimpleData_V01.cfg \
+     vendor/quectel/T4.Throughput_V01.cfg:/system/data/T4.Throughput_V01.cfg \
+     vendor/quectel/T5.COMMON_V01.cfg:/system/data/T5.COMMON_V01.cfg \
+     vendor/quectel/T6.FullMessage.SimpleLogPacket_V01.cfg:/system/data/T6.FullMessage.SimpleLogPacket_V01.cfg
+ 
+ #AMS
+ PRODUCT_PACKAGES += \
+     deviceadmin \
+     appmanager \
+     amsconnector \
+     amsclouddrive \
+     welcomeapp \
+     diagnosis \
+     videoplayer
++>>>>>>> android_10_idt_dev_200527-2:imx8m/vp6820_8mq/vp6820_8mq_common.mk
