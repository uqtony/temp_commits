a267f0f0 George.Huang 2021-05-06

AOS-592: [post_merge] fix conflicts

Change-Id: I343a71ae85427e23712bb5649f1cc83d047bbbad

diff --git a/imx8m/ProductConfigCommon.mk b/imx8m/ProductConfigCommon.mk
index f1bbda48..fe56bf0a 100644
--- a/imx8m/ProductConfigCommon.mk
+++ b/imx8m/ProductConfigCommon.mk
@@ -215,7 +215,7 @@ PRODUCT_SOONG_NAMESPACES += external/mesa3d
 
 # Copy framework display settings file
 PRODUCT_COPY_FILES += \
-    device/idtech/common/display-settings/display_settings.xml:$(TARGET_COPY_OUT_VENDOR)/etc/display_settings.xml
+    $(CONFIG_REPO_PATH)/common/display-settings/display_settings.xml:$(TARGET_COPY_OUT_VENDOR)/etc/display_settings.xml
 
 # -------@block_gpu-------
 # vivante libdrm support
@@ -263,7 +263,7 @@ PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
 # watermark only enabled by pcidev build
 ifeq (pcidev, $(findstring pcidev, $(TARGET_PRODUCT)))
 PRODUCT_COPY_FILES += \
-    device/idtech/common/watermark/setup.conf:/system/etc/setup.conf
+    $(CONFIG_REPO_PATH)/common/watermark/setup.conf:/system/etc/setup.conf
 endif
 
 # -------@block_audio-------
@@ -373,14 +373,14 @@ PRODUCT_PROPERTY_OVERRIDES += \
 
 # Copy soc related config and binary to board
 PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/init.idt.common.rc:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/init.idt.common.rc \
-    device/idtech/imx8m/check_modem.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/check_modem.sh \
+    $(CONFIG_REPO_PATH)/imx8m/init.idt.common.rc:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/init.idt.common.rc \
+    $(CONFIG_REPO_PATH)/imx8m/check_modem.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/check_modem.sh \
 
 # Copy the latest uuu tool
 PRODUCT_COPY_FILES += \
-    device/idtech/common/tools/uuu:uuu \
-    device/idtech/common/tools/uuu_aarch64:uuu_aarch64 \
-    device/idtech/common/tools/uuu.exe:uuu.exe
+    $(CONFIG_REPO_PATH)/common/tools/uuu:uuu \
+    $(CONFIG_REPO_PATH)/common/tools/uuu_aarch64:uuu_aarch64 \
+    $(CONFIG_REPO_PATH)/common/tools/uuu.exe:uuu.exe
 
 # -------@block_treble-------
 # vndservicemanager
diff --git a/imx8m/bigcypress_8mp/AndroidBoard.mk b/imx8m/bigcypress_8mp/AndroidBoard.mk
index cb6595f6..75193153 100644
--- a/imx8m/bigcypress_8mp/AndroidBoard.mk
+++ b/imx8m/bigcypress_8mp/AndroidBoard.mk
@@ -1,8 +1,9 @@
 LOCAL_PATH := $(call my-dir)
 
-include device/idtech/common/build/dtbo.mk
-include device/idtech/common/build/imx-recovery.mk
-include device/idtech/common/build/gpt.mk
+include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
+include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
+include $(CONFIG_REPO_PATH)/common/build/gpt.mk
+#TODO add imx8mp target
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
 -include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/bigcypress_8mp/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 75193153..00000000
--- a/imx8m/bigcypress_8mp/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,9 +0,0 @@
-LOCAL_PATH := $(call my-dir)
-
-include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
-include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
-include $(CONFIG_REPO_PATH)/common/build/gpt.mk
-#TODO add imx8mp target
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
--include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/bigcypress_8mp/AndroidUboot.mk b/imx8m/bigcypress_8mp/AndroidUboot.mk
index 70a02a7e..cfb66ae6 100644
--- a/imx8m/bigcypress_8mp/AndroidUboot.mk
+++ b/imx8m/bigcypress_8mp/AndroidUboot.mk
@@ -2,16 +2,9 @@
 MAKE += SHELL=/bin/bash
 
 ifneq ($(AARCH64_GCC_CROSS_COMPILE),)
-<<<<<<< HEAD
-ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
-else
-ATF_TOOLCHAIN_ABS := $(realpath prebuilts/gcc/$(HOST_PREBUILT_TAG)/aarch64/aarch64-linux-android-4.9/bin)
-ATF_CROSS_COMPILE := $(ATF_TOOLCHAIN_ABS)/aarch64-linux-androidkernel-
-=======
   ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
 else
   $(error shell env AARCH64_GCC_CROSS_COMPILE is not set)
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 define build_imx_uboot
@@ -22,11 +15,7 @@ define build_imx_uboot
 	cp $(UBOOT_OUT)/arch/arm/dts/imx8mp-evk.dtb $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
-<<<<<<< HEAD
 	if [ `echo $(2) | cut -d '-' -f3` = "trusty" ]; then \
-=======
-	if [ `echo $(2) | cut -d '-' -f2` = "trusty" ]; then \
->>>>>>> post_merge/android-11.0.0_2.0.0
 		cp $(FSL_PROPRIETARY_PATH)/fsl-proprietary/uboot-firmware/imx8m/tee-imx8mp.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 		$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ CROSS_COMPILE="$(ATF_CROSS_COMPILE)" PLAT=`echo $(2) | cut -d '-' -f1` bl31 -B SPD=trusty 1>/dev/null || exit 1; \
 	else \
diff --git a/imx8m/bigcypress_8mp/BoardConfig.mk b/imx8m/bigcypress_8mp/BoardConfig.mk
index 82e3e7ad..760e6215 100644
--- a/imx8m/bigcypress_8mp/BoardConfig.mk
+++ b/imx8m/bigcypress_8mp/BoardConfig.mk
@@ -1,5 +1,3 @@
-<<<<<<< HEAD
-=======
 # -------@block_infrastructure-------
 #
 # Product-specific compile-time definitions.
@@ -8,42 +6,23 @@
 include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
 
 # -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 #
 # SoC-specific compile-time definitions.
 #
 
 BOARD_SOC_TYPE := IMX8MP
-<<<<<<< HEAD
 BOARD_SOM_TYPE := a200
 BOARD_TYPE := EVK
 BOARD_MAIN_DISPLAY_ROTATION := 270
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 BOARD_HAVE_VPU := true
 BOARD_VPU_TYPE := hantro
 HAVE_FSL_IMX_GPU2D := false
 HAVE_FSL_IMX_GPU3D := true
-<<<<<<< HEAD
-HAVE_FSL_IMX_IPU := false
 HAVE_FSL_IMX_PXP := false
-BOARD_KERNEL_BASE := 0x40400000
-TARGET_GRALLOC_VERSION := v3
 TARGET_USES_HWC2 := true
-TARGET_HWCOMPOSER_VERSION := v2.0
-USE_OPENGL_RENDERER := true
 TARGET_HAVE_VULKAN := true
-ENABLE_CFI=false
 
 SOONG_CONFIG_IMXPLUGIN += \
-                        BOARD_HAVE_VPU \
-=======
-HAVE_FSL_IMX_PXP := false
-TARGET_USES_HWC2 := true
-TARGET_HAVE_VULKAN := true
-
-SOONG_CONFIG_IMXPLUGIN += \
->>>>>>> post_merge/android-11.0.0_2.0.0
                         BOARD_VPU_TYPE
 
 SOONG_CONFIG_IMXPLUGIN_BOARD_SOC_TYPE = IMX8MP
@@ -51,52 +30,6 @@ SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU = true
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_TYPE = hantro
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_ONLY = false
 
-<<<<<<< HEAD
-#
-# Product-specific compile-time definitions.
-#
-
-IMX_DEVICE_PATH := device/idtech/imx8m/bigcypress_8mp
-
-include device/idtech/imx8m/BoardConfigCommon.mk
-
-BUILD_TARGET_FS ?= ext4
-TARGET_USERIMAGES_USE_EXT4 := true
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-# Support gpt
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab_super.bpt
-  ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
-                           partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
-else
-  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-13GB-ab-no-product.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab-no-product.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
-  else
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
-  endif
-endif
-
-# Vendor Interface manifest and compatibility
-DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
-ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
-DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
-endif
-DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-USE_OPENGL_RENDERER := true
-
-=======
 
 
 # -------@block_memory-------
@@ -112,9 +45,9 @@ TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
 
 # Support gpt
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab_super.bpt
+  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab_super.bpt
   ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
+                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
                            partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
 else
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -123,14 +56,16 @@ else
                              partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
   else
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab.bpt
+    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab.bpt
     ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
+                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
   endif
 endif
 
-BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-imx8mp.img
+LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
+LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
+BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
 
 BOARD_USES_METADATA_PARTITION := true
 BOARD_ROOT_EXTRA_FOLDERS += metadata
@@ -139,22 +74,24 @@ BOARD_ROOT_EXTRA_FOLDERS += metadata
 ENABLE_CFI=false
 
 BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA4096
+BOARD_AVB_ALGORITHM := SHA256_RSA2048
 # The testkey_rsa4096.pem is copied from external/avb/test/data/testkey_rsa4096.pem
-BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/testkey_rsa4096.pem
+BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/idt_testkey_rsa2048.pem
 
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
+#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
+#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
+#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
 
 # -------@block_treble-------
 # Vendor Interface manifest and compatibility
 DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
+ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
+DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
+endif
 DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
 DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE := $(IMX_DEVICE_PATH)/device_framework_matrix.xml
 
 # -------@block_wifi-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 # NXP 8997 WIFI
 BOARD_WLAN_DEVICE            := nxp
 WPA_SUPPLICANT_VERSION       := VER_0_8_X
@@ -164,56 +101,18 @@ BOARD_HOSTAPD_PRIVATE_LIB               := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 BOARD_WPA_SUPPLICANT_PRIVATE_LIB        := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 
 WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-<<<<<<< HEAD
-
-# NXP 8997 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
-
-# NXP 8997 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
-
-#BOARD_USE_SENSOR_FUSION := true
-BOARD_USE_ST_SENSOR_INPUT := true
-
-# we don't support sparse image.
-TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
-
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
-BOARD_HAVE_USB_CAMERA := true
-BOARD_HAVE_USB_MJPEG_CAMERA := false
-
-USE_ION_ALLOCATOR := true
-USE_GPU_ALLOCATOR := false
-
-BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_KEY_PATH := device/idtech/common/security/idt_testkey_rsa2048.pem
-
-#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
-
-TARGET_USES_MKE2FS := true
-
-# define frame buffer count
-NUM_FRAMEBUFFER_SURFACE_BUFFERS := 3
-
-CMASIZE=800M
-=======
 # -------@block_bluetooth-------
 # NXP 8997 BT
 BOARD_HAVE_BLUETOOTH_NXP := true
 BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
 
 # -------@block_sensor-------
-BOARD_USE_SENSOR_FUSION := true
+BOARD_USE_ST_SENSOR_INPUT := true
 
 # -------@block_kernel_bootimg-------
 BOARD_KERNEL_BASE := 0x40400000
 
 CMASIZE=960M
->>>>>>> post_merge/android-11.0.0_2.0.0
 # NXP default config
 BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardware=nxp firmware_class.path=/vendor/firmware loop.max_part=7
 
@@ -222,11 +121,7 @@ BOARD_KERNEL_CMDLINE += transparent_hugepage=never
 BOARD_KERNEL_CMDLINE += swiotlb=65536
 
 # display config
-<<<<<<< HEAD
 BOARD_KERNEL_CMDLINE += androidboot.lcd_density=246 androidboot.primary_display=imx-drm
-=======
-BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-drm
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # wifi config
 BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_para.conf
@@ -235,30 +130,13 @@ BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_pa
 ifeq ($(LOW_MEMORY),true)
 BOARD_KERNEL_CMDLINE += cma=320M@0x400M-0xb80M androidboot.displaymode=720p galcore.contiguousSize=33554432
 else
-<<<<<<< HEAD
-BOARD_KERNEL_CMDLINE += cma=$(CMASIZE)@0x400M-0xb80M
-=======
 BOARD_KERNEL_CMDLINE += cma=$(CMASIZE)@0x400M-0x1000M
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
 BOARD_KERNEL_CMDLINE += androidboot.vendor.sysrq=1
 endif
 
-<<<<<<< HEAD
-ifeq ($(TARGET_USERIMAGES_USE_UBIFS),true)
-ifeq ($(TARGET_USERIMAGES_USE_EXT4),true)
-$(error "TARGET_USERIMAGES_USE_UBIFS and TARGET_USERIMAGES_USE_EXT4 config open in same time, please only choose one target file system image")
-endif
-endif
-
-LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
-LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
-BOARD_PREBUILT_DTBOIMAGE := out/target/product/bigcypress_8mp/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG := imx8mp:imx8mp-evk-no-product.dtb
@@ -277,13 +155,10 @@ ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
     TARGET_BOARD_DTS_CONFIG += imx8mp-lvds-panel:imx8mp-evk-jdi-wuxga-lvds-panel.dtb
     # Support MIPI panel
     TARGET_BOARD_DTS_CONFIG += imx8mp-mipi-panel:imx8mp-evk-rm67191.dtb
-<<<<<<< HEAD
-=======
     #Used to support powersave
     TARGET_BOARD_DTS_CONFIG += imx8mp-powersave:imx8mp-evk-powersave.dtb
     #Used to support powersave and mcu image
     TARGET_BOARD_DTS_CONFIG += imx8mp-powersave-non-rpmsg:imx8mp-evk-powersave-non-rpmsg.dtb
->>>>>>> post_merge/android-11.0.0_2.0.0
   endif
 else # no dynamic parition feature
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -293,20 +168,6 @@ else # no dynamic parition feature
   endif
 endif
 
-<<<<<<< HEAD
-BOARD_SEPOLICY_DIRS := \
-       device/idtech/imx8m/sepolicy \
-       $(IMX_DEVICE_PATH)/sepolicy
-
-TARGET_BOARD_KERNEL_HEADERS := device/idtech/common/kernel-headers
-
-ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
-
-BOARD_USES_METADATA_PARTITION := true
-BOARD_ROOT_EXTRA_FOLDERS += metadata
-
-BOARD_PLAT_PRIVATE_SEPOLICY_DIR := device/idtech/imx8m/sepolicy_system/private
-=======
 ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
 
 # -------@block_sepolicy-------
@@ -314,4 +175,4 @@ BOARD_SEPOLICY_DIRS := \
        $(CONFIG_REPO_PATH)/imx8m/sepolicy \
        $(IMX_DEVICE_PATH)/sepolicy
 
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_PLAT_PRIVATE_SEPOLICY_DIR := $(CONFIG_REPO_PATH)/imx8m/sepolicy_system/private
diff --git a/imx8m/bigcypress_8mp/SharedBoardConfig.mk b/imx8m/bigcypress_8mp/SharedBoardConfig.mk
index 2f318ad1..454762ef 100644
--- a/imx8m/bigcypress_8mp/SharedBoardConfig.mk
+++ b/imx8m/bigcypress_8mp/SharedBoardConfig.mk
@@ -1,32 +1,12 @@
-<<<<<<< HEAD
-KERNEL_NAME := Image
-TARGET_KERNEL_ARCH := arm64
-#IMX8MP_USES_GKI := true
-
-#Enable this to config 1GB ddr on evk_imx8mp
-#LOW_MEMORY := true
-
-#Enable this to include trusty support
-PRODUCT_IMX_TRUSTY := true
-
-#Enable this to disable product partition build.
-#IMX_NO_PRODUCT_PARTITION := true
-
-#NXP 8997 wifi driver module
-BOARD_VENDOR_KERNEL_MODULES += \
-    $(KERNEL_OUT)/drivers/net/wireless/nxp/mxm_wifiex/wlan_src/mlan.ko \
-    $(KERNEL_OUT)/drivers/net/wireless/nxp/mxm_wifiex/wlan_src/moal.ko
-=======
 # -------@block_kernel_bootimg-------
 KERNEL_NAME := Image
 TARGET_KERNEL_ARCH := arm64
-IMX8MP_USES_GKI := true
+#IMX8MP_USES_GKI := true
 
 #NXP 8997 wifi driver module
 BOARD_VENDOR_KERNEL_MODULES += \
     $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/mlan.ko \
     $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/moal.ko
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # CONFIG_IMX_SDMA: imx-sdma.ko, sdma used for audio
 # CONFIG_SND_SOC_IMX_PCM_DMA: imx-pcm-dma-common.ko, used for fsl_micfil
@@ -40,11 +20,6 @@ BOARD_VENDOR_KERNEL_MODULES += \
 # CONFIG_SND_SOC_BT_SCO: snd-soc-bt-sco.ko, bt sco driver
 # CONFIG_SND_SIMPLE_CARD: snd-soc-simple-card-utils.ko snd-soc-simple-card.ko, simple audio card used for bt sco
 # CONFIG_RTC_DRV_SNVS: rtc-snvs.ko, snvs rtc driver
-<<<<<<< HEAD
-# CONFIG_USB_XHCI_HCD: xhci-hcd.ko xhci-pci.ko xhci-plat-hcd.ko, usb host driver
-# CONFIG_KEYBOARD_SNVS_PWRKEY: snvs_pwrkey.ko, snvs power key driver
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 # CONFIG_STAGING_MEDIA: able to build drivers/staging/media/
 # CONFIG_IMX_MBOX: imx-mailbox.ko, imx mailbox driver
 # CONFIG_I2C_RPBUS: virtio_rpmsg_bus.ko, virtio rpmsg bus driver
@@ -54,19 +29,6 @@ BOARD_VENDOR_KERNEL_MODULES += \
 # CONFIG_MXC_HANTRO_VC8000E: hx280enc_vc8000e.ko, vpu encoder driver
 # CONFIG_MXC_HANTRO_845: hantrodec_845s.ko, vpu decoder driver
 
-<<<<<<< HEAD
-ifneq ($(IMX8MP_USES_GKI),)
-BOARD_VENDOR_KERNEL_MODULES += \
-    $(KERNEL_OUT)/drivers/mxc/gpu-viv/galcore.ko \
-    $(KERNEL_OUT)/drivers/dma/imx-sdma.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/imx-pcm-dma-common.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-micfil.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-micfil.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-aud2htx.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-easrc.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-sai.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-utils.ko \
-=======
 ifeq ($(IMX8MP_USES_GKI),true)
 BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/drivers/mxc/gpu-viv/galcore.ko \
@@ -79,24 +41,16 @@ BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-asrc.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-easrc.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-sai.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/gpu/drm/bridge/synopsys/dw-hdmi-cec.ko \
     $(KERNEL_OUT)/drivers/gpu/drm/bridge/synopsys/dw-hdmi-gp-audio.ko \
     $(KERNEL_OUT)/sound/soc/codecs/snd-soc-hdmi-codec.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-cdnhdmi.ko \
     $(KERNEL_OUT)/sound/soc/codecs/snd-soc-wm8960.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-wm8960.ko \
-    $(KERNEL_OUT)/sound/soc/codecs/snd-soc-bt-sco.ko \
-    $(KERNEL_OUT)/sound/soc/generic/snd-soc-simple-card-utils.ko \
-    $(KERNEL_OUT)/sound/soc/generic/snd-soc-simple-card.ko \
-=======
     $(KERNEL_OUT)/sound/soc/codecs/snd-soc-bt-sco.ko \
     $(KERNEL_OUT)/sound/soc/generic/snd-soc-simple-card-utils.ko \
     $(KERNEL_OUT)/sound/soc/generic/snd-soc-simple-card.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-audmux.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-asoc-card.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-dsp-audiomix.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-dsp.ko \
     $(KERNEL_OUT)/drivers/mxc/hantro_vc8000e/hx280enc_vc8000e.ko \
@@ -112,13 +66,6 @@ BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/sound/soc/codecs/snd-soc-rpmsg-wm8960-i2c.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-rpmsg.ko \
     $(KERNEL_OUT)/drivers/rtc/rtc-snvs.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/usb/host/xhci-hcd.ko \
-    $(KERNEL_OUT)/drivers/usb/host/xhci-pci.ko \
-    $(KERNEL_OUT)/drivers/usb/host/xhci-plat-hcd.ko \
-    $(KERNEL_OUT)/drivers/input/keyboard/snvs_pwrkey.ko \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/pci/controller/dwc/pci-imx6.ko \
     $(KERNEL_OUT)/drivers/ptp/ptp.ko \
     $(KERNEL_OUT)/drivers/pps/pps_core.ko \
@@ -161,11 +108,8 @@ endif
 # CONFIG_TYPEC_TCPCI: tcpci.ko
 # CONFIG_PHY_FSL_IMX8MQ_USB: phy-fsl-imx8mq-usb.ko
 # CONFIG_PHY_FSL_IMX_PCIE: phy-fsl-imx8-pcie.ko
-<<<<<<< HEAD
-=======
 # CONFIG_USB_XHCI_HCD: xhci-hcd.ko xhci-pci.ko xhci-plat-hcd.ko, usb host driver
 # CONFIG_KEYBOARD_SNVS_PWRKEY: snvs_pwrkey.ko, snvs power key driver
->>>>>>> post_merge/android-11.0.0_2.0.0
 # CONFIG_RESET_IMX7: reset-imx7.ko
 # CONFIG_RESET_IMX_HDMIMIX: reset-imx-audiomix.ko
 # CONFIG_RESET_IMX_AUDIOMIX: reset-imx-hdmimix.ko
@@ -179,16 +123,6 @@ endif
 # CONFIG_VIDEO_OV5640: ov5640.ko, ov5640 sensor driver
 # CONFIG_VIDEO_IMX_CAPTURE: imx8-media-dev.ko, imx8-isi-cap.ko, imx8-isi-hw.ko, imx8-isi-m2m.ko, imx8-mipi-csi2-sam.ko, imx isi and mipi driver
 
-<<<<<<< HEAD
-ifneq ($(IMX8MP_USES_GKI),)
-BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
-    $(KERNEL_OUT)/drivers/clk/imx/clk-audiomix.ko \
-    $(KERNEL_OUT)/drivers/clk/imx/clk-gate-shared.ko \
-    $(KERNEL_OUT)/drivers/clk/imx/clk-imx8mp.ko \
-    $(KERNEL_OUT)/drivers/clk/imx/clk-hdmimix.ko \
-    $(KERNEL_OUT)/drivers/clocksource/timer-imx-sysctr.ko \
-    $(KERNEL_OUT)/drivers/soc/imx/imx8m_pm_domains.ko \
-=======
 ifeq ($(IMX8MP_USES_GKI),true)
 BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
     $(KERNEL_OUT)/drivers/soc/imx/soc-imx8m.ko \
@@ -198,45 +132,26 @@ BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
     $(KERNEL_OUT)/drivers/clk/imx/clk-blk-ctrl.ko \
     $(KERNEL_OUT)/drivers/soc/imx/imx8m_pm_domains.ko \
     $(KERNEL_OUT)/drivers/clocksource/timer-imx-sysctr.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/soc/imx/busfreq-imx8mq.ko \
     $(KERNEL_OUT)/drivers/irqchip/irq-imx-irqsteer.ko \
     $(KERNEL_OUT)/drivers/pinctrl/freescale/pinctrl-imx.ko \
     $(KERNEL_OUT)/drivers/pinctrl/freescale/pinctrl-imx8mp.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/gpio/gpio-generic.ko \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/gpio/gpio-mxc.ko \
     $(KERNEL_OUT)/drivers/tty/serial/imx.ko \
     $(KERNEL_OUT)/drivers/watchdog/imx2_wdt.ko \
     $(KERNEL_OUT)/drivers/i2c/busses/i2c-imx.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/mfd/pca9450.ko \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/regulator/pca9450-regulator.ko \
     $(KERNEL_OUT)/drivers/pwm/pwm-imx27.ko \
     $(KERNEL_OUT)/drivers/video/backlight/pwm_bl.ko \
     $(KERNEL_OUT)/drivers/mmc/host/cqhci.ko \
     $(KERNEL_OUT)/drivers/mmc/host/sdhci-esdhc-imx.ko \
     $(KERNEL_OUT)/drivers/staging/android/ion/heaps/ion_cma_heap.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/mfd/imx-audiomix.ko \
-    $(KERNEL_OUT)/drivers/reset/reset-imx7.ko \
-    $(KERNEL_OUT)/drivers/reset/reset-imx-audiomix.ko \
-    $(KERNEL_OUT)/drivers/reset/reset-imx-hdmimix.ko \
-=======
     $(KERNEL_OUT)/drivers/reset/reset-imx7.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/phy/freescale/phy-fsl-imx8mp-lvds.ko \
     $(KERNEL_OUT)/drivers/phy/freescale/phy-fsl-samsung-hdmi.ko \
     $(KERNEL_OUT)/drivers/phy/freescale/phy-fsl-imx8mq-usb.ko \
     $(KERNEL_OUT)/drivers/phy/freescale/phy-fsl-imx8-pcie.ko \
-<<<<<<< HEAD
-=======
     $(KERNEL_OUT)/drivers/input/keyboard/snvs_pwrkey.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/input/touchscreen/synaptics_dsx/synaptics_dsx_i2c.ko \
     $(KERNEL_OUT)/drivers/gpu/imx/lcdif/imx-lcdif-core.ko \
     $(KERNEL_OUT)/drivers/gpu/drm/bridge/adv7511/adv7511.ko \
@@ -259,23 +174,10 @@ BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
     $(KERNEL_OUT)/drivers/usb/dwc3/dwc3-imx8mp.ko \
     $(KERNEL_OUT)/drivers/usb/dwc3/dwc3.ko \
     $(KERNEL_OUT)/drivers/usb/typec/mux/gpio-switch.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/usb/typec/tcpm/tcpci.ko \
-    $(KERNEL_OUT)/drivers/power/supply/dummy_battery.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-fiq.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-arm64-fiq.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-ipc.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-irq.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-log.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-mem.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-virtio.ko \
-=======
     $(KERNEL_OUT)/drivers/usb/host/xhci-hcd.ko \
     $(KERNEL_OUT)/drivers/usb/host/xhci-pci.ko \
     $(KERNEL_OUT)/drivers/usb/host/xhci-plat-hcd.ko \
     $(KERNEL_OUT)/drivers/power/supply/dummy_battery.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/nvmem/nvmem-imx-ocotp.ko \
     $(KERNEL_OUT)/drivers/thermal/device_cooling.ko \
     $(KERNEL_OUT)/drivers/thermal/imx8mm_thermal.ko \
@@ -283,31 +185,22 @@ BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
     $(KERNEL_OUT)/drivers/cpufreq/imx-cpufreq-dt.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-media-dev.ko \
     $(KERNEL_OUT)/drivers/media/v4l2-core/v4l2-fwnode.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/media/v4l2-core/v4l2-mem2mem.ko \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/media/i2c/ov5640.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-capture.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-isi-cap.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-isi-hw.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-isi-m2m.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-mipi-csi2-sam.ko \
-<<<<<<< HEAD
-=======
     $(KERNEL_OUT)/drivers/trusty/trusty-core.ko \
     $(KERNEL_OUT)/drivers/trusty/trusty-irq.ko \
     $(KERNEL_OUT)/drivers/trusty/trusty-log.ko \
     $(KERNEL_OUT)/drivers/trusty/trusty-virtio.ko \
     $(KERNEL_OUT)/drivers/trusty/trusty-ipc.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(TARGET_OUT_INTERMEDIATES)/VVCAM_OBJ/vvcam-video.ko \
     $(TARGET_OUT_INTERMEDIATES)/VVCAM_OBJ/vvcam-isp.ko \
     $(TARGET_OUT_INTERMEDIATES)/VVCAM_OBJ/vvcam-dwe.ko \
     $(TARGET_OUT_INTERMEDIATES)/VVCAM_OBJ/basler-camera-driver-vvcam.ko
 endif
-<<<<<<< HEAD
-=======
 
 # -------@block_memory-------
 #Enable this to config 1GB ddr on evk_imx8mp
@@ -316,4 +209,3 @@ LOW_MEMORY := false
 # -------@block_security-------
 #Enable this to include trusty support
 PRODUCT_IMX_TRUSTY := true
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/bigcypress_8mp/UbootKernelBoardConfig.mk b/imx8m/bigcypress_8mp/UbootKernelBoardConfig.mk
index 48e8f13c..f7bcc3d5 100644
--- a/imx8m/bigcypress_8mp/UbootKernelBoardConfig.mk
+++ b/imx8m/bigcypress_8mp/UbootKernelBoardConfig.mk
@@ -3,27 +3,16 @@ TARGET_BOOTLOADER_POSTFIX := bin
 UBOOT_POST_PROCESS := true
 
 # u-boot target
-<<<<<<< HEAD
 TARGET_BOOTLOADER_CONFIG := imx8mp-lpddr4:vp6820_8mp_evk_android_defconfig:signed
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-trusty:vp6820_8mp_evk_android_trusty_defconfig
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-trusty-secure-unlock:vp6820_8mp_evk_android_trusty_secure_unlock_defconfig
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-dual:vp6820_8mp_evk_android_dual_defconfig:signed
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-trusty-dual:vp6820_8mp_evk_android_trusty_dual_defconfig
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-evk-uuu-mic6g:vp6820_8mp_evk_android_uuu_mic6g_defconfig:signed
-
-ifneq ($(IMX8MP_USES_GKI),)
-=======
-TARGET_BOOTLOADER_CONFIG := imx8mp:imx8mp_evk_android_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty:imx8mp_evk_android_trusty_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty-secure-unlock:imx8mp_evk_android_trusty_secure_unlock_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-dual:imx8mp_evk_android_dual_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty-dual:imx8mp_evk_android_trusty_dual_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-evk-uuu:imx8mp_evk_android_uuu_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-powersave:imx8mp_evk_android_powersave_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty-powersave:imx8mp_evk_android_trusty_powersave_defconfig
+#TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-powersave:vp6820_8mp_evk_android_powersave_defconfig
+#TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-trusty-powersave:vp6820_8mp_evk_android_trusty_powersave_defconfig
 
 ifeq ($(IMX8MP_USES_GKI),true)
->>>>>>> post_merge/android-11.0.0_2.0.0
 TARGET_KERNEL_DEFCONFIG := gki_defconfig
 TARGET_KERNEL_GKI_DEFCONF:= android_gki_defconfig
 else
@@ -31,10 +20,7 @@ TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
 endif
 
 TARGET_KERNEL_ADDITION_DEFCONF := android_addition_defconfig
-<<<<<<< HEAD
 TARGET_KERNEL_SECURE_DEFCONF ?= android_secure_defconfig
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 
 # absolute path is used, not the same as relative path used in AOSP make
diff --git a/imx8m/bigcypress_8mp/android_addition_defconfig b/imx8m/bigcypress_8mp/android_addition_defconfig
index ea5fbb9e..6c15a77b 100644
--- a/imx8m/bigcypress_8mp/android_addition_defconfig
+++ b/imx8m/bigcypress_8mp/android_addition_defconfig
@@ -1,6 +1,5 @@
 CONFIG_LIBNVDIMM=y
 CONFIG_OF_PMEM=y
-<<<<<<< HEAD
 CONFIG_IDG_SPI=y
 # CONFIG_USB_NET_QMI_WWAN is not set
 CONFIG_SINGLE_LOGO=y
@@ -49,7 +48,6 @@ CONFIG_BCM_SBA_RAID=m
 CONFIG_WLAN_VENDOR_NXP=y
 CONFIG_MWL8K=y
 CONFIG_WLAN_VENDOR_MARVELL=m
-CONFIG_USB_PRINTER=y
 
 # CONFIG_KVM is not set
 # CONFIG_MTD_UBI is not set
@@ -254,5 +252,3 @@ CONFIG_USB_PRINTER=y
 # CONFIG_MMC_SDHCI_MSM is not set
 # CONFIG_MMC_SDHI is not set
 # CONFIG_MMC_DW_EXYNOS is not set
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/bigcypress_8mp/android_gki_defconfig b/imx8m/bigcypress_8mp/android_gki_defconfig
index 22f7c51f..bb220eff 100644
--- a/imx8m/bigcypress_8mp/android_gki_defconfig
+++ b/imx8m/bigcypress_8mp/android_gki_defconfig
@@ -1,10 +1,7 @@
 CONFIG_ARCH_MXC=y
-<<<<<<< HEAD
-=======
 CONFIG_SOC_IMX8M=m
 CONFIG_SOC_IMX_MU=m
 CONFIG_MXC_CLK=m
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_CLK_IMX8MP=m
 CONFIG_DEVICE_THERMAL=m
 CONFIG_IMX8MM_THERMAL=m
@@ -16,19 +13,11 @@ CONFIG_SERIAL_IMX=m
 CONFIG_SERIAL_IMX_CONSOLE=m
 CONFIG_IMX2_WDT=m
 CONFIG_I2C_IMX=m
-<<<<<<< HEAD
-CONFIG_MFD_PCA9450=m
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_REGULATOR_PCA9450=m
 CONFIG_PWM_IMX27=m
 CONFIG_BACKLIGHT_PWM=m
 CONFIG_MMC_SDHCI_ESDHC_IMX=m
 CONFIG_ION_CMA_HEAP=m
-<<<<<<< HEAD
-CONFIG_MFD_IMX_AUDIOMIX=m
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_PHY_FSL_IMX8MP_LVDS=m
 CONFIG_PHY_SAMSUNG_HDMI_PHY=m
 CONFIG_MXC_GPU_VIV=m
@@ -52,25 +41,15 @@ CONFIG_MEDIA_USB_SUPPORT=y
 CONFIG_USB_VIDEO_CLASS=y
 CONFIG_USB_XHCI_HCD=m
 CONFIG_TYPEC_SWITCH_GPIO=m
-<<<<<<< HEAD
-CONFIG_TYPEC_TCPCI=m
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 CONFIG_IMX_SDMA=m
 CONFIG_SND_IMX_SOC=m
 CONFIG_SND_SOC_IMX_MICFIL=m
-<<<<<<< HEAD
-CONFIG_SND_SOC_FSL_EASRC=m
-CONFIG_SND_SOC_IMX_CDNHDMI=m
-CONFIG_SND_SOC_IMX_WM8960=m
-=======
 CONFIG_SND_SOC_FSL_ASRC=m
 CONFIG_SND_SOC_FSL_EASRC=m
 CONFIG_SND_SOC_IMX_CDNHDMI=m
 CONFIG_SND_SOC_WM8960=m
 CONFIG_SND_SOC_FSL_ASOC_CARD=m
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_SND_SOC_BT_SCO=m
 CONFIG_SND_SIMPLE_CARD=m
 CONFIG_SND_SOC_FSL_DSP=m
@@ -110,11 +89,6 @@ CONFIG_MXC_HANTRO_845=m
 CONFIG_BATTERY_DUMMY=m
 
 CONFIG_RESET_IMX7=m
-<<<<<<< HEAD
-CONFIG_RESET_IMX_HDMIMIX=m
-CONFIG_RESET_IMX_AUDIOMIX=m
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_IMX8M_BUSFREQ=m
 CONFIG_IMX_IRQSTEER=m
 CONFIG_GPIO_MXC=m
@@ -126,10 +100,7 @@ CONFIG_INIT_STACK_NONE=y
 CONFIG_NVMEM_IMX_OCOTP=m
 CONFIG_CPUFREQ_DT=m
 CONFIG_ARM_IMX_CPUFREQ_DT=m
-<<<<<<< HEAD
-=======
 
 CONFIG_STATIC_USERMODEHELPER_PATH="/system/bin/sh"
 
 CONFIG_FORCE_MAX_ZONEORDER=14
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/bigcypress_8mp/audio_policy_configuration.xml b/imx8m/bigcypress_8mp/audio_policy_configuration.xml
index ceeb3476..17b12ec5 100644
--- a/imx8m/bigcypress_8mp/audio_policy_configuration.xml
+++ b/imx8m/bigcypress_8mp/audio_policy_configuration.xml
@@ -33,6 +33,10 @@
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
                              samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
                 </mixPort>
+                <mixPort name="hi-res output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT|AUDIO_OUTPUT_FLAG_HW_AV_SYNC">
+                    <profile name="" format="AUDIO_FORMAT_PCM_FLOAT"
+                             samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
+                </mixPort>
                 <mixPort name="hdmi output" role="source">
                     <profile name="" format="AUDIO_FORMAT_PCM_8_24_BIT"
                              samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
@@ -41,6 +45,10 @@
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
                              samplingRates="16000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
                 </mixPort>
+                <mixPort name="passthrough output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT">
+                    <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
+                             samplingRates="32000,44100,48000,88200,96000,176400,192000" channelMasks="AUDIO_CHANNEL_NONE"/>
+                </mixPort>
 
                 <mixPort name="primary input" role="sink">
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
@@ -82,9 +90,9 @@
                 <route type="mix" sink="Wired Headset"
                        sources="primary output"/>
                 <route type="mix" sink="Line-Out"
-                       sources="lpa output,primary output"/>
+                       sources="hi-res output,lpa output,primary output"/>
                 <route type="mix" sink="HDMI Out"
-                       sources="hdmi output"/>
+                       sources="passthrough output,hdmi output"/>
                 <route type="mix" sink="BT SCO Headset"
                        sources="bt sco output"/>
                 <route type="mix" sink="BT SCO CarKit"
diff --git a/imx8m/bigcypress_8mp/audio_policy_configuration.xml~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/audio_policy_configuration.xml~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 17b12ec5..00000000
--- a/imx8m/bigcypress_8mp/audio_policy_configuration.xml~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,123 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
-<!-- Copyright (C) 2017 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-
-<audioPolicyConfiguration version="1.0" xmlns:xi="http://www.w3.org/2001/XInclude">
-    <globalConfiguration speaker_drc_enabled="true"/>
-
-    <modules>
-        <module name="primary" halVersion="2.0">
-            <attachedDevices>
-                <item>Speaker</item>
-                <item>Built-In Mic</item>
-            </attachedDevices>
-            <defaultOutputDevice>Speaker</defaultOutputDevice>
-            <mixPorts>
-                <mixPort name="primary output" role="source" flags="AUDIO_OUTPUT_FLAG_PRIMARY">
-                    <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
-                             samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
-                </mixPort>
-                <mixPort name="lpa output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT|AUDIO_OUTPUT_FLAG_HW_AV_SYNC">
-                    <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
-                             samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
-                </mixPort>
-                <mixPort name="hi-res output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT|AUDIO_OUTPUT_FLAG_HW_AV_SYNC">
-                    <profile name="" format="AUDIO_FORMAT_PCM_FLOAT"
-                             samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
-                </mixPort>
-                <mixPort name="hdmi output" role="source">
-                    <profile name="" format="AUDIO_FORMAT_PCM_8_24_BIT"
-                             samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
-                </mixPort>
-                <mixPort name="bt sco output" role="source">
-                    <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
-                             samplingRates="16000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
-                </mixPort>
-                <mixPort name="passthrough output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT">
-                    <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
-                             samplingRates="32000,44100,48000,88200,96000,176400,192000" channelMasks="AUDIO_CHANNEL_NONE"/>
-                </mixPort>
-
-                <mixPort name="primary input" role="sink">
-                    <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
-                             samplingRates="8000,11025,16000,22050,24000,32000,44100,48000"
-                             channelMasks="AUDIO_CHANNEL_IN_MONO,AUDIO_CHANNEL_IN_STEREO"/>
-                </mixPort>
-            </mixPorts>
-            <devicePorts>
-                <devicePort tagName="Speaker" type="AUDIO_DEVICE_OUT_SPEAKER" role="sink" >
-                </devicePort>
-                <devicePort tagName="Wired Headphones" type="AUDIO_DEVICE_OUT_WIRED_HEADPHONE" role="sink">
-                </devicePort>
-                <devicePort tagName="Wired Headset" type="AUDIO_DEVICE_OUT_WIRED_HEADSET" role="sink">
-                </devicePort>
-                <devicePort tagName="Line-Out" type="AUDIO_DEVICE_OUT_LINE" role="sink">
-                </devicePort>
-                <devicePort tagName="HDMI Out" type="AUDIO_DEVICE_OUT_AUX_DIGITAL" role="sink">
-                </devicePort>
-                <devicePort tagName="BT SCO Headset" type="AUDIO_DEVICE_OUT_BLUETOOTH_SCO_HEADSET" role="sink">
-                </devicePort>
-                <devicePort tagName="BT SCO CarKit" type="AUDIO_DEVICE_OUT_BLUETOOTH_SCO_CARKIT" role="sink">
-                </devicePort>
-                <devicePort tagName="BT SCO" type="AUDIO_DEVICE_OUT_BLUETOOTH_SCO" role="sink">
-                </devicePort>
-                <devicePort tagName="Built-In Mic" type="AUDIO_DEVICE_IN_BUILTIN_MIC" role="source">
-                </devicePort>
-                <devicePort tagName="Wired Headset Mic" type="AUDIO_DEVICE_IN_WIRED_HEADSET" role="source">
-                </devicePort>
-                <devicePort tagName="Spdif-In" type="AUDIO_DEVICE_IN_AUX_DIGITAL" role="source">
-                </devicePort>
-                <devicePort tagName="BT SCO Headset Mic" type="AUDIO_DEVICE_IN_BLUETOOTH_SCO_HEADSET" role="source">
-                </devicePort>
-            </devicePorts>
-            <routes>
-                <route type="mix" sink="Speaker"
-                       sources="primary output"/>
-                <route type="mix" sink="Wired Headphones"
-                       sources="primary output"/>
-                <route type="mix" sink="Wired Headset"
-                       sources="primary output"/>
-                <route type="mix" sink="Line-Out"
-                       sources="hi-res output,lpa output,primary output"/>
-                <route type="mix" sink="HDMI Out"
-                       sources="passthrough output,hdmi output"/>
-                <route type="mix" sink="BT SCO Headset"
-                       sources="bt sco output"/>
-                <route type="mix" sink="BT SCO CarKit"
-                       sources="bt sco output"/>
-                <route type="mix" sink="BT SCO"
-                       sources="bt sco output"/>
-
-                <route type="mix" sink="primary input"
-                       sources="Wired Headset Mic,Built-In Mic,Spdif-In,BT SCO Headset Mic"/>
-            </routes>
-        </module>
-
-        <!-- A2dp Audio HAL -->
-        <xi:include href="a2dp_audio_policy_configuration.xml"/>
-
-        <!-- Usb Audio HAL -->
-        <xi:include href="usb_audio_policy_configuration.xml"/>
-
-        <!-- Remote Submix Audio HAL -->
-        <xi:include href="r_submix_audio_policy_configuration.xml"/>
-
-    </modules>
-
-    <!-- Volume section -->
-    <xi:include href="audio_policy_volumes.xml"/>
-    <xi:include href="default_volume_tables.xml"/>
-
-</audioPolicyConfiguration>
diff --git a/imx8m/bigcypress_8mp/bigcypress_8mp.mk b/imx8m/bigcypress_8mp/bigcypress_8mp.mk
index 833a26a3..9ac6e6b2 100644
--- a/imx8m/bigcypress_8mp/bigcypress_8mp.mk
+++ b/imx8m/bigcypress_8mp/bigcypress_8mp.mk
@@ -1,9 +1,10 @@
-<<<<<<< HEAD
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/bigcypress_8mp
-$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/bigcypress_8mp_common.mk)
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
+$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/bigcypress_8mq_common.mk)
 
 # Overrides
 PRODUCT_NAME := bigcypress_8mp
@@ -14,499 +15,3 @@ PRODUCT_NAME := bigcypress_8mp
 # if find key in /data/property
 PRODUCT_PROPERTY_OVERRIDES += \
     persist.idt.lock_orientation=1
-=======
-# -------@block_infrastructure-------
-CONFIG_REPO_PATH := device/nxp
-CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
-IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
-
-# configs shared between uboot, kernel and Android rootfs
-include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
-
--include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
-include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
-
-# -------@block_common_config-------
-# Overrides
-PRODUCT_NAME := evk_8mp
-PRODUCT_DEVICE := evk_8mp
-PRODUCT_MODEL := EVK_8MP
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-PRODUCT_CHARACTERISTICS := tablet
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# -------@block_treble-------
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-
-# -------@block_power-------
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/powerhint_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mp.json
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-
-PRODUCT_PACKAGES += \
-    android.hardware.power-service.imx
-
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mp.json
-
-
-# -------@block_app-------
-
-#Enable this to choose 32 bit user space build
-IMX8_BUILD_32BIT_ROOTFS := false
-
-# Set permission for GMS packages
-PRODUCT_COPY_FILES += \
-	  $(CONFIG_REPO_PATH)/imx8m/permissions/privapp-permissions-imx.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/privapp.permissions-imx.xml
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml
-
-# -------@block_kernel_bootimg-------
-
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc
-
-
-# -------@block_storage-------
-
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
-  PRODUCT_USE_DYNAMIC_PARTITIONS := true
-  BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
-  BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-endif
-
-#Enable this to disable product partition build.
-IMX_NO_PRODUCT_PARTITION := false
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
-  PRODUCT_PACKAGES += imx_ota_postinstall
-
-  AB_OTA_POSTINSTALL_CONFIG += \
-    RUN_POSTINSTALL_vendor=true \
-    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
-    FILESYSTEM_TYPE_vendor=ext4 \
-    POSTINSTALL_OPTIONAL_vendor=false
-
-  PRODUCT_COPY_FILES += \
-    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mp-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
-endif
-
-
-# fastboot_imx_flashall scripts, imx-sdcard-partition script uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# -------@block_security-------
-
-# Include keystore attestation keys and certificates.
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
--include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
-endif
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# Keymaster HAL
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-# Resume on Reboot support
-PRODUCT_PACKAGES += \
-    android.hardware.rebootescrow-service.default
-
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rebootescrow.device=/dev/block/pmem0
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-# -------@block_audio-------
-
-# Audio card json
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/audio-json/wm8960_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8960_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/hdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/hdmi_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32
-
-
-PRODUCT_COPY_FILES += \
-    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mp/imx8mp_mcu_demo.img:imx8mp_mcu_demo.img \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml
-
-# -------@block_camera-------
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mp.json \
-    $(IMX_DEVICE_PATH)/ov5640_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/ov5640_camera_config_imx8mp.json \
-    $(IMX_DEVICE_PATH)/isp_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp_camera_config_imx8mp.json \
-    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-# Copy isp files to board
-ISP_PROPRIETARY := $(FSL_PROPRIETARY_PATH)/fsl-proprietary/isp
-PRODUCT_COPY_FILES += \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/bin,$(TARGET_COPY_OUT_VENDOR)/bin) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/lib64,$(TARGET_COPY_OUT_VENDOR)/lib64) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/config,$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp)
-
-# ISP camera feature demo
-PRODUCT_PACKAGES += \
-    CameraXBasic
-
-# -------@block_display-------
-
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# HWC2 HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.composer@2.4-service
-
-# define frame buffer count
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@4.0-impl.imx \
-    android.hardware.graphics.allocator@4.0-service.imx
-
-# RenderScript HAL
-PRODUCT_PACKAGES += \
-    android.hardware.renderscript@1.0-impl
-
-PRODUCT_PACKAGES += \
-    libg2d-opencl
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod \
-    MultiDisplay
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
-
-# -------@block_gpu-------
-PRODUCT_PACKAGES += \
-    libEGL_VIVANTE \
-    libGLESv1_CM_VIVANTE \
-    libGLESv2_VIVANTE \
-    gralloc_viv.$(TARGET_BOARD_PLATFORM) \
-    libGAL \
-    libGLSLC \
-    libVSC \
-    libgpuhelper \
-    libSPIRV_viv \
-    libvulkan_VIVANTE \
-    vulkan.$(TARGET_BOARD_PLATFORM) \
-    libCLC \
-    libLLVM_viv \
-    libOpenCL \
-    libg2d-viv \
-    libOpenVX \
-    libOpenVXU \
-    libNNVXCBinary-evis \
-    libNNVXCBinary-evis2 \
-    libNNVXCBinary-lite \
-    libOvx12VXCBinary-evis \
-    libOvx12VXCBinary-evis2 \
-    libOvx12VXCBinary-lite \
-    libNNGPUBinary-evis \
-    libNNGPUBinary-evis2 \
-    libNNGPUBinary-lite \
-    libNNGPUBinary-ulite \
-    libNNArchPerf \
-    libarchmodelSw
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# -------@block_wifi-------
-
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
-
-# WiFi HAL
-PRODUCT_PACKAGES += \
-    android.hardware.wifi@1.0-service \
-    wificond
-
-# WiFi RRO
-PRODUCT_PACKAGES += \
-    WifiOverlay
-
-# nxp 8997 wifi and bluetooth combo Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para_powersave.conf:vendor/firmware/wifi_mod_para_powersave.conf
-
-# Wifi regulatory
-PRODUCT_COPY_FILES += \
-    external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
-    external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
-
-# -------@block_bluetooth-------
-
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-#nxp 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# -------@block_usb-------
-
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
-
-# -------@block_multimedia_codec-------
-
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_PACKAGES += \
-    libg1 \
-    libhantro \
-    libcodec \
-    libhantro_vc8000e
-
-# imx c2 codec binary
-PRODUCT_PACKAGES += \
-    lib_vpu_wrapper \
-    lib_imx_c2_videodec_common \
-    lib_imx_c2_videodec \
-    lib_imx_c2_vpuwrapper_dec \
-    lib_imx_c2_videoenc_common \
-    lib_imx_c2_videoenc \
-    lib_imx_c2_vpuwrapper_enc \
-    lib_imx_c2_process \
-    lib_imx_c2_process_dummy_post \
-    lib_imx_c2_process_g2d_pre \
-    c2_component_register \
-    c2_component_register_ms \
-    c2_component_register_ra
-
-# dsp decoder
-PRODUCT_PACKAGES += \
-    media_codecs_c2_dsp.xml \
-    media_codecs_c2_dsp_aacp.xml \
-    media_codecs_c2_dsp_wma.xml \
-    lib_dsp_aac_dec \
-    lib_dsp_bsac_dec \
-    lib_dsp_codec_wrap \
-    lib_dsp_mp3_dec \
-    lib_dsp_wrap_arm12_android \
-    lib_dsp_mp3_dec_ext \
-    lib_dsp_codec_wrap_ext \
-    lib_aacd_wrap_dsp \
-    lib_mp3d_wrap_dsp \
-    lib_wma10d_wrap_dsp \
-    c2_component_register_dsp \
-    c2_component_register_dsp_wma \
-    c2_component_register_dsp_aacp
-
-
-PRODUCT_PACKAGES += \
-    DirectAudioPlayer
-
-ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
-ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
-INSTALL_64BIT_LIBRARY := true
-endif
--include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
--include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp_aacp_dec/imx_dsp_aacp_dec.mk
--include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp_codec/imx_dsp_codec.mk
--include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp_wma_dec/imx_dsp_wma_dec.mk
--include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp/imx_dsp_8mp.mk
-endif
-
-# -------@block_memory-------
-
-# Include Android Go config for low memory device.
-ifeq ($(LOW_MEMORY),true)
-$(call inherit-product, build/target/product/go_defaults.mk)
-endif
-
-# -------@block_neural_network-------
-
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# -------@block_miscellaneous-------
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.imx8mp.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mp.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
-# Included GMS package
-$(call inherit-product-if-exists, vendor/partner_gms/products/gms.mk)
-PRODUCT_SOONG_NAMESPACES += vendor/partner_gms
-
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/bigcypress_8mp/bigcypress_8mp_common.mk b/imx8m/bigcypress_8mp/bigcypress_8mp_common.mk
index 7304b1c2..6936f19c 100644
--- a/imx8m/bigcypress_8mp/bigcypress_8mp_common.mk
+++ b/imx8m/bigcypress_8mp/bigcypress_8mp_common.mk
@@ -1,239 +1,307 @@
-# This is a FSL Android Reference Design platform based on i.MX8QP ARD board
-# It will inherit from FSL core product which in turn inherit from Google generic
-
-IMX_DEVICE_PATH := device/idtech/imx8m/bigcypress_8mp
+# -------@block_infrastructure-------
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 
 # configs shared between uboot, kernel and Android rootfs
 include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
 
--include device/idtech/common/imx_path/ImxPathConfig.mk
-include device/idtech/imx8m/ProductConfigCommon.mk
-
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab.nxp)
-endif
+-include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
+include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
 
+# -------@block_common_config-------
 # Overrides
 PRODUCT_NAME := bigcypress_8mp
 PRODUCT_DEVICE := bigcypress_8mp
 PRODUCT_MODEL := BIGCYPRESS_8MP
 
+TARGET_BOOTLOADER_BOARD_NAME := EVK
+
+PRODUCT_CHARACTERISTICS := tablet
+
+DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
+
+PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
+
+# -------@block_treble-------
 PRODUCT_FULL_TREBLE_OVERRIDE := true
+
+# -------@block_power-------
 PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
 PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
 
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/powerhint_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mp.json
+
+# Charger Mode
+PRODUCT_PRODUCT_PROPERTIES += \
+    ro.charger.no_ui=false
+
+# Do not skip charger_not_need trigger by default
+PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
+    vendor.skip.charger_not_need=0
+
+
+PRODUCT_PACKAGES += \
+    android.hardware.power-service.imx
+
+
+# Thermal HAL
+PRODUCT_PACKAGES += \
+    android.hardware.thermal@2.0-service.imx
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mp.json
+
+
+# -------@block_app-------
+
 #Enable this to choose 32 bit user space build
-#IMX8_BUILD_32BIT_ROOTFS := true
+IMX8_BUILD_32BIT_ROOTFS := false
+
+# Set permission for GMS packages
+PRODUCT_COPY_FILES += \
+	  $(CONFIG_REPO_PATH)/imx8m/permissions/privapp-permissions-imx.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/privapp.permissions-imx.xml
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
+    $(CONFIG_REPO_PATH)/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
+    $(CONFIG_REPO_PATH)/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
+    $(CONFIG_REPO_PATH)/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
+
+# -------@block_kernel_bootimg-------
 
 # Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
 TARGET_USE_VENDOR_BOOT ?= true
 
+
+# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
+# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
+# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
+ifeq ($(TARGET_USE_VENDOR_BOOT),true)
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
+endif
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
+    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
+    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
+    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc
+
+
+# -------@block_storage-------
+
 #Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
 TARGET_USE_DYNAMIC_PARTITIONS ?= true
-#If the device is retrofit to have dynamic partition feature, set this variable to true to build
-#the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
-TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
   PRODUCT_USE_DYNAMIC_PARTITIONS := true
   BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
   BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-  ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
-    PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
-    BOARD_SUPER_PARTITION_METADATA_DEVICE := system
-    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 2952790016
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-    else
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor product
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 1610612736
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-      BOARD_SUPER_PARTITION_PRODUCT_DEVICE_SIZE := 1879048192
-    endif
-  endif
 endif
 
-# Include keystore attestation keys and certificates.
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
--include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
-endif
+#Enable this to disable product partition build.
+IMX_NO_PRODUCT_PARTITION := false
 
-# Include Android Go config for low memory device.
-ifeq ($(LOW_MEMORY),true)
-$(call inherit-product, build/target/product/go_defaults.mk)
+$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
+
+TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
+
+ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
+  PRODUCT_PACKAGES += imx_ota_postinstall
+
+  AB_OTA_POSTINSTALL_CONFIG += \
+    RUN_POSTINSTALL_vendor=true \
+    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
+    FILESYSTEM_TYPE_vendor=ext4 \
+    POSTINSTALL_OPTIONAL_vendor=false
+
+  PRODUCT_COPY_FILES += \
+    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mp-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
 endif
 
-# Copy device related config and binary to board
+
+# fastboot_imx_flashall scripts, imx-sdcard-partition script uuu_imx_android_flash scripts
 PRODUCT_COPY_FILES += \
-    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mp/imx8mp_mcu_demo.img:imx8mp_mcu_demo.img \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp \
-    $(IMX_DEVICE_PATH)/init.imx8mp.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mp.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    device/idtech/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    device/idtech/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    device/idtech/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf \
-    device/idtech/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
-    device/idtech/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
-    device/idtech/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
-    device/idtech/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
-    device/idtech/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt \
-    device/idtech/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
+    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
+    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
+    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
+    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
+    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
 
-# Copy isp files to board
-ISP_PROPRIETARY := $(FSL_PROPRIETARY_PATH)/fsl-proprietary/isp
 PRODUCT_COPY_FILES += \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/bin,$(TARGET_COPY_OUT_VENDOR)/bin) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/lib64,$(TARGET_COPY_OUT_VENDOR)/lib64) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/config,$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp)
+    $(CONFIG_REPO_PATH)/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt
 
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
+# -------@block_security-------
+
+# Include keystore attestation keys and certificates.
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
+-include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
+endif
+
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
 PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
+    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
+    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
 endif
 
+# Keymaster HAL
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
+PRODUCT_PACKAGES += \
+    android.hardware.keymaster@4.0-service.trusty
+endif
 
-# Audio card json
-PRODUCT_COPY_FILES += \
-    device/idtech/common/audio-json/wm8960_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8960_config.json \
-    device/idtech/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
-    device/idtech/common/audio-json/hdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/hdmi_config.json \
-    device/idtech/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    device/idtech/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
-    device/idtech/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
+PRODUCT_PACKAGES += \
+    android.hardware.keymaster@4.0-service-imx
+
+# new gatekeeper HAL
+PRODUCT_PACKAGES += \
+    android.hardware.gatekeeper@1.0-service.software-imx
+
+# Add oem unlocking option in settings.
+PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
 
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    device/idtech/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    device/idtech/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
+#Oemlock HAL 1.0 support
+PRODUCT_PACKAGES += \
+    android.hardware.oemlock@1.0-service.imx
 endif
 
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/bigcypress_8mp/camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mp.json \
-    device/idtech/imx8m/bigcypress_8mp/ov5640_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/ov5640_camera_config_imx8mp.json \
-    device/idtech/imx8m/bigcypress_8mp/isp_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp_camera_config_imx8mp.json \
-    device/idtech/imx8m/bigcypress_8mp/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
+# Add Trusty OS backed gatekeeper and secure storage proxy
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
+PRODUCT_PACKAGES += \
+    android.hardware.gatekeeper@1.0-service.trusty \
+    storageproxyd
+endif
 
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
+# Specify rollback index for boot and vbmeta partitions
+ifneq ($(AVB_RBINDEX),)
+BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
+else
+BOARD_AVB_ROLLBACK_INDEX := 0
+endif
 
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
+ifneq ($(AVB_BOOT_RBINDEX),)
+BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
+else
+BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
+endif
+
+$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
+
+# Resume on Reboot support
+PRODUCT_PACKAGES += \
+    android.hardware.rebootescrow-service.default
+
+PRODUCT_PROPERTY_OVERRIDES += \
+    ro.rebootescrow.device=/dev/block/pmem0
+
+#DRM Widevine 1.2 L3 support
+PRODUCT_PACKAGES += \
+    android.hardware.drm@1.3-service.widevine \
+    android.hardware.drm@1.3-service.clearkey \
+    libwvdrmcryptoplugin \
+    libwvhidl \
+    libwvdrmengine \
+
+# -------@block_audio-------
 
+# Audio card json
 PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/bigcypress_8mp/powerhint_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mp.json
+    $(CONFIG_REPO_PATH)/common/audio-json/wm8960_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8960_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/hdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/hdmi_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
+
+PRODUCT_PACKAGES += \
+    android.hardware.audio@6.0-impl:32 \
+    android.hardware.audio@2.0-service \
+    android.hardware.audio.effect@6.0-impl:32
+
 
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script uuu_imx_android_flash scripts
 PRODUCT_COPY_FILES += \
-    device/idtech/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    device/idtech/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    device/idtech/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    device/idtech/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    device/idtech/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
+    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mp/imx8mp_mcu_demo.img:imx8mp_mcu_demo.img \
+    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
+    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
+    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml
+
+# -------@block_camera-------
 
-# Set permission for GMS packages
 PRODUCT_COPY_FILES += \
-	  device/idtech/imx8m/permissions/privapp-permissions-imx.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/privapp.permissions-imx.xml \
+    $(IMX_DEVICE_PATH)/camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mp.json \
+    $(IMX_DEVICE_PATH)/ov5640_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/ov5640_camera_config_imx8mp.json \
+    $(IMX_DEVICE_PATH)/isp_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp_camera_config_imx8mp.json \
+    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
 
-USE_XML_AUDIO_POLICY_CONF := 1
+PRODUCT_SOONG_NAMESPACES += hardware/google/camera
+PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
 
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
+# Copy isp files to board
+ISP_PROPRIETARY := $(FSL_PROPRIETARY_PATH)/fsl-proprietary/isp
+PRODUCT_COPY_FILES += \
+    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/bin,$(TARGET_COPY_OUT_VENDOR)/bin) \
+    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/lib64,$(TARGET_COPY_OUT_VENDOR)/lib64) \
+    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/config,$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp)
 
-PRODUCT_CHARACTERISTICS := tablet
+# ISP camera feature demo
+PRODUCT_PACKAGES += \
+    CameraXBasic
 
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
+# -------@block_display-------
 
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
+PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
 
 # HWC2 HAL
 PRODUCT_PACKAGES += \
     android.hardware.graphics.composer@2.4-service
 
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
+# define frame buffer count
 PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
+    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
 
 # Gralloc HAL
 PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@2.0-impl-2.1 \
-    android.hardware.graphics.allocator@2.0-impl \
-    android.hardware.graphics.allocator@2.0-service
+    android.hardware.graphics.mapper@4.0-impl.imx \
+    android.hardware.graphics.allocator@4.0-service.imx
 
 # RenderScript HAL
 PRODUCT_PACKAGES += \
     android.hardware.renderscript@1.0-impl
 
+PRODUCT_PACKAGES += \
+    libg2d-opencl
+
+# Multi-Display launcher
+PRODUCT_PACKAGES += \
+    MultiClientInputMethod
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
+
+# -------@block_gpu-------
 PRODUCT_PACKAGES += \
     libEGL_VIVANTE \
     libGLESv1_CM_VIVANTE \
     libGLESv2_VIVANTE \
-    gralloc_viv.imx \
+    gralloc_viv.$(TARGET_BOARD_PLATFORM) \
     libGAL \
     libGLSLC \
     libVSC \
     libgpuhelper \
     libSPIRV_viv \
     libvulkan_VIVANTE \
-    vulkan.imx \
+    vulkan.$(TARGET_BOARD_PLATFORM) \
     libCLC \
     libLLVM_viv \
     libOpenCL \
-    libg2d-opencl \
     libg2d-viv \
     libOpenVX \
     libOpenVXU \
@@ -250,50 +318,25 @@ PRODUCT_PACKAGES += \
     libNNArchPerf \
     libarchmodelSw
 
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32 \
-    android.hardware.power@1.3-service.imx \
-    android.hardware.light@2.0-impl \
-    android.hardware.light@2.0-service \
-    android.hardware.sensors@1.0-impl \
-    android.hardware.sensors@1.0-convert \
-    android.hardware.sensors@1.0-service \
-    android.hardware.configstore@1.1-service \
-    configstore@1.1.policy
-
-ifneq ($(IMX8MP_USES_GKI), true)
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
+# GPU openCL g2d
 PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/bigcypress_8mp/thermal_info_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mp.json
-endif
-
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.2-service-vsi-npu-server
+    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
 
-# Usb HAL
+# -------@block_sensor-------
 PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
+    android.hardware.sensors@1.0-impl \
+    android.hardware.sensors@1.0-convert \
+    android.hardware.sensors@1.0-service
 
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
+# -------@block_wifi-------
 
-#nxp 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
+    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
 
 # WiFi HAL
 PRODUCT_PACKAGES += \
     android.hardware.wifi@1.0-service \
-    wifilogd \
     wificond
 
 # WiFi RRO
@@ -303,36 +346,43 @@ PRODUCT_PACKAGES += \
 # nxp 8997 wifi and bluetooth combo Firmware
 PRODUCT_COPY_FILES += \
     vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf
+    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf \
+    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para_powersave.conf:vendor/firmware/wifi_mod_para_powersave.conf
 
 # Wifi regulatory
 PRODUCT_COPY_FILES += \
     external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
     external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
 
-# Keymaster HAL
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
+# -------@block_bluetooth-------
 
+# Bluetooth HAL
 PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
+    android.hardware.bluetooth@1.0-impl \
+    android.hardware.bluetooth@1.0-service
 
-# DRM HAL
-TARGET_ENABLE_MEDIADRM_64 := true
+#nxp 8997 Bluetooth vendor config
 PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service
+    bt_vendor.conf
 
-# new gatekeeper HAL
+# -------@block_usb-------
+
+# Usb HAL
 PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
+    android.hardware.usb@1.1-service.imx
 
-ifneq ($(BUILD_TARGET_FS),ubifs)
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.frp.pst=/dev/block/by-name/presistdata
-endif
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
+
+# -------@block_multimedia_codec-------
+
+# Vendor seccomp policy files for media components:
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
+    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
+    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
+    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
 
 PRODUCT_PACKAGES += \
     libg1 \
@@ -379,56 +429,6 @@ PRODUCT_PACKAGES += \
 PRODUCT_PACKAGES += \
     DirectAudioPlayer
 
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-#Dumpstate HAL 1.1 support
-PRODUCT_PACKAGES += \
-    android.hardware.dumpstate@1.1-service.imx
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-IMX-DEFAULT-G2D-LIB := libg2d-opencl
-
 ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 INSTALL_64BIT_LIBRARY := true
@@ -440,23 +440,66 @@ endif
 -include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp/imx_dsp_8mp.mk
 endif
 
-# Included GMS package
-$(call inherit-product-if-exists, vendor/partner_gms/products/gms.mk)
-PRODUCT_SOONG_NAMESPACES += vendor/partner_gms
+# -------@block_memory-------
 
-# Resume on Reboot support
+# Include Android Go config for low memory device.
+ifeq ($(LOW_MEMORY),true)
+$(call inherit-product, build/target/product/go_defaults.mk)
+endif
+
+# -------@block_neural_network-------
+
+# Neural Network HAL and lib
 PRODUCT_PACKAGES += \
-    android.hardware.rebootescrow-service.default
+    libovxlib \
+    libnnrt \
+    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
 
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rebootescrow.device=/dev/block/pmem0
+# -------@block_miscellaneous-------
 
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
+# Copy device related config and binary to board
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/init.imx8mp.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mp.rc \
+    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
+    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
+    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
 
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
+# ONLY devices that meet the CDD's requirements may declare these features
+PRODUCT_COPY_FILES += \
+    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
+    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
+    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
+    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
+    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
+    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
+    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
+    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
+    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
+    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
+    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
+    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
+    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
+    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
+    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
+    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
+    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
+    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
+    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
+    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
+    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
+    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
+    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
+    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
+    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
+    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
+    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
+    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
+    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
+    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
 
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
+# Included GMS package
+$(call inherit-product-if-exists, vendor/partner_gms/products/gms.mk)
+PRODUCT_SOONG_NAMESPACES += vendor/partner_gms
 
 # Copy Quectel vendor RIL
 PRODUCT_COPY_FILES += \
diff --git a/imx8m/bigcypress_8mp/bigcypress_8mp_pci.mk b/imx8m/bigcypress_8mp/bigcypress_8mp_pci.mk
index 9b8582fc..68d2da22 100644
--- a/imx8m/bigcypress_8mp/bigcypress_8mp_pci.mk
+++ b/imx8m/bigcypress_8mp/bigcypress_8mp_pci.mk
@@ -1,8 +1,10 @@
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/bigcypress_8mp
-$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/bigcypress_8mp_common.mk)
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
+$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/bigcypress_8mq_common.mk)
 
 # Overrides
 PRODUCT_NAME := bigcypress_8mp_pci
diff --git a/imx8m/bigcypress_8mp/camera_config_imx8mp.json b/imx8m/bigcypress_8mp/camera_config_imx8mp.json
index 6d11d881..0c030b95 100644
--- a/imx8m/bigcypress_8mp/camera_config_imx8mp.json
+++ b/imx8m/bigcypress_8mp/camera_config_imx8mp.json
@@ -10,13 +10,8 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
-      "camera_name": "viv_v4l2_device",
-      "device_node": "/dev/video1",
-=======
       "camera_name": "viv_v4l20",
       "bus_info": "platform:viv0",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "orientation": "0",
       "buffer_type": "mmap",
       "ActiveArrayWidth": "1920",
@@ -32,11 +27,7 @@
     },
     {
       "camera_type": "front",
-<<<<<<< HEAD
-      "camera_name": "mxc-isi-cap",
-=======
       "camera_name": "mxc_isi.1.capture",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "orientation": "0",
       "mplane": "1",
       "buffer_type": "dma",
diff --git a/imx8m/bigcypress_8mp/fstab.nxp b/imx8m/bigcypress_8mp/fstab.nxp
index 194480fa..bdab2b2d 100644
--- a/imx8m/bigcypress_8mp/fstab.nxp
+++ b/imx8m/bigcypress_8mp/fstab.nxp
@@ -3,12 +3,12 @@
 # The filesystem that contains the filesystem checker binary (typically /system) cannot
 # specify MF_CHECK, and must come before any filesystems that do specify MF_CHECK
 
-/devices/platform/32f10108.usb/38200000.dwc3/* auto auto defaults voldmanaged=usb:auto
-/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block,metadata_csum
+/devices/platform/soc@0/32f10108.usb/38200000.dwc3/* auto auto defaults voldmanaged=usb:auto
+/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block
 /dev/block/by-name/metadata    /metadata    ext4    noatime,nosuid,nodev,discard,sync                                                wait,formattable,first_stage_mount,check
 /dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
 /dev/block/by-name/idtechdata  /mnt/vendor/idtechdata  ext4    nosuid,nodev,noatime,barrier=1                       wait,formattable
 /dev/block/zram0 none swap defaults zramsize=629145600
 
 /devices/platform/soc@0/30800000.bus/30b50000.mmc/mmc_host* /storage/sdcard1 vfat nosuid,nodev wait,voldmanaged=sdcard1:auto,encryptable=footer
-/devices/platform/32f10100.usb/38100000.dwc3/* auto auto defaults voldmanaged=usb:auto
+/devices/platform/soc@0/32f10100.usb/38100000.dwc3/* auto auto defaults voldmanaged=usb:auto
diff --git a/imx8m/bigcypress_8mp/fstab.nxp~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/fstab.nxp~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index bc5e8ac7..00000000
--- a/imx8m/bigcypress_8mp/fstab.nxp~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,11 +0,0 @@
-# Android fstab file.
-#<src>                                                  <mnt_point>         <type>    <mnt_flags and options>                       <fs_mgr_flags>
-# The filesystem that contains the filesystem checker binary (typically /system) cannot
-# specify MF_CHECK, and must come before any filesystems that do specify MF_CHECK
-
-/devices/platform/soc@0/32f10108.usb/38200000.dwc3/* auto auto defaults voldmanaged=usb:auto
-/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block
-/dev/block/by-name/metadata    /metadata    ext4    noatime,nosuid,nodev,discard,sync                                                wait,formattable,first_stage_mount,check
-/dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
-/dev/block/zram0 none swap defaults zramsize=629145600
-
diff --git a/imx8m/bigcypress_8mp/init.imx8mp.rc b/imx8m/bigcypress_8mp/init.imx8mp.rc
index 3a491f10..d46e3bf0 100755
--- a/imx8m/bigcypress_8mp/init.imx8mp.rc
+++ b/imx8m/bigcypress_8mp/init.imx8mp.rc
@@ -16,6 +16,10 @@ on early-boot
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
+    chown root system /sys/devices/system/cpu/cpu2/online
+    chmod 0664 /sys/devices/system/cpu/cpu2/online
+    chown root system /sys/devices/system/cpu/cpu3/online
+    chmod 0664 /sys/devices/system/cpu/cpu3/online
 
 on property:sys.boot_completed=1
     # Set default CPU frequency governor
@@ -26,6 +30,9 @@ on property:sys.boot_completed=1
     write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 200
     write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 200
     write /proc/sys/kernel/sched_util_clamp_min 512
+    write /sys/devices/platform/soc@0/30c00000.bus/30e20000.audio-blk-ctrl/power/control auto
+    write /sys/devices/platform/soc@0/32c00000.bus/32ec0000.media-blk-ctrl/power/control auto
+    write /sys/devices/platform/soc@0/30c00000.bus/32fc0000.hdmi-blk-ctrl/power/control auto
 
 on property:sys.boot_completed=1
     # update cpuset now that processors are up
diff --git a/imx8m/bigcypress_8mp/init.imx8mp.rc~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/init.imx8mp.rc~post_merge_android-11.0.0_2.0.0
deleted file mode 100755
index d46e3bf0..00000000
--- a/imx8m/bigcypress_8mp/init.imx8mp.rc~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,59 +0,0 @@
-on early-boot
-
-    # Set OpenGLES version
-    setprop ro.opengles.version 196609
-
-    # Set GPU 3D minimum clock to 3/64
-    write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
-
-    # change for FSL specific service
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
-    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
-    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
-    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
-    chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
-    chown root system /sys/devices/system/cpu/cpu2/online
-    chmod 0664 /sys/devices/system/cpu/cpu2/online
-    chown root system /sys/devices/system/cpu/cpu3/online
-    chmod 0664 /sys/devices/system/cpu/cpu3/online
-
-on property:sys.boot_completed=1
-    # Set default CPU frequency governor
-    # configure governor settings for little cluster
-    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "schedutil"
-    # The rate-limit tunable in the schedutil governor applies to transitions to both lower and higher frequencies
-    # Set up and down limit to 200us/200us
-    write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 200
-    write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 200
-    write /proc/sys/kernel/sched_util_clamp_min 512
-    write /sys/devices/platform/soc@0/30c00000.bus/30e20000.audio-blk-ctrl/power/control auto
-    write /sys/devices/platform/soc@0/32c00000.bus/32ec0000.media-blk-ctrl/power/control auto
-    write /sys/devices/platform/soc@0/30c00000.bus/32fc0000.hdmi-blk-ctrl/power/control auto
-
-on property:sys.boot_completed=1
-    # update cpuset now that processors are up
-    write /dev/cpuset/foreground/cpus 0-3
-
-    # top-app gets all cpus
-    write /dev/cpuset/top-app/cpus 0-3
-
-    #background contains a small subset (generally one little core)
-    write /dev/cpuset/background/cpus 0
-
-    # add system-background cpuset, a new cpuset for system services
-    # that should not run on larger cores
-    # system-background is for system tasks that should only run on
-    # little cores, not on bigs to be used only by init
-    write /dev/cpuset/system-background/cpus 0-2
-
-on early-boot
-    export VSI_LOG_LEVEL 0
-    start isp_media_server
-
-service isp_media_server /vendor/bin/isp_media_server /vendor/etc/configs/isp/daA3840_30mc_1080P.json
-    group camera
-    oneshot
diff --git a/imx8m/bigcypress_8mp/init.rc b/imx8m/bigcypress_8mp/init.rc
index 8c1e6b6a..c3dfbbef 100644
--- a/imx8m/bigcypress_8mp/init.rc
+++ b/imx8m/bigcypress_8mp/init.rc
@@ -44,11 +44,6 @@ on init && property:vendor.skip.charger_not_need=0
     symlink /sdcard /mnt/sdcard
     symlink /sdcard /storage/sdcard0
 
-    # setup the global environment
-    export CORE_REGISTER_FILE /vendor/etc/core_register
-    export COMPONENT_REGISTER_FILE /vendor/etc/component_register
-    export CONTENTPIPE_REGISTER_FILE /vendor/etc/contentpipe_register
-
     # disable cursor blink for fbcon, if no splash screen support
     write /sys/class/graphics/fbcon/cursor_blink 0
 
@@ -89,15 +84,12 @@ on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charg
     start vendor.oemlock-1-0
 
 on early-boot && property:vendor.skip.charger_not_need=0
-    # For evk_8mp, when swap used about 400M, upgrade the level.
+    # For bigcypress_8mp, when swap used about 400M, upgrade the level.
     setprop ro.lmk.upgrade_pressure 93
     setprop ro.lmk.downgrade_pressure 99
     setprop ro.lmk.critical_upgrade true
 
-    # Set permission for IIM node
-    symlink /dev/mxs_viim /dev/mxc_mem
-
-    setprop hwc.stretch.filter  1
+    setprop vendor.hwc.stretch.filter  1
 
     # Default g2d [dpu|pxp|viv] lib to be used
     setprop vendor.imx.default-g2d viv
@@ -133,6 +125,12 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chown system system /sys/class/backlight/32e60000.mipi_dsi.0/brightness
     chmod 0660 /sys/class/backlight/32e60000.mipi_dsi.0/brightness
 
+    # Backup backlight device
+    setprop vendor.hw.backlight_backup.dev "lvds_backlight"
+    # Chmod/chown FSL specific sys entry
+    chown system system /sys/class/backlight/lvds_backlight/brightness
+    chmod 0660 /sys/class/backlight/lvds_backlight/brightness
+
     # Set light sensor sysfs path and light sensor threshold lux value
     setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
     setprop vendor.ro.lightsensor.threshold  20
@@ -143,9 +141,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # Enlarge limition of audio buffer allocation
     setprop ro.af.client_heap_size_kbyte 32768
 
-    # enlarge media max memory size to 3G.
-    setprop ro.media.maxmem 3221225471
-
     start vendor.wifi_hal_legacy
 
 service wpa_supplicant /vendor/bin/hw/wpa_supplicant \
@@ -178,49 +173,8 @@ service watchdogd /system/bin/watchdogd 10 20
     class core
     seclabel u:r:watchdogd:s0
 
-service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_p2p /system/bin/dhcpcd -aABKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_eth0 /system/bin/dhcpcd -ABKL eth0
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_bt-pan /system/bin/dhcpcd -ABKL
-    class main
-    disabled
-    oneshot
-
-service iprenew_wlan0 /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_p2p /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_eth0 /system/bin/dhcpcd -n eth0
-    class main
-    disabled
-    oneshot
-
-service iprenew_bt-pan /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
 # bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -B -z \
-        -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
+service bugreport /system/bin/dumpstate -d -p -z
     class main
     disabled
     oneshot
@@ -242,9 +196,6 @@ on fs && property:vendor.skip.charger_not_need=0
     # Update dm-verity state and set partition.*.verified properties
     verity_update_state
 
-on verity-logging && property:vendor.skip.charger_not_need=0
-    exec u:r:slideshow:s0 -- /sbin/slideshow warning/verity_red_1 warning/verity_red_2
-
 on post-fs && property:vendor.skip.charger_not_need=0
     # Set netd memlock rlimit to 8MB
     setrlimit 8 8388608 8388608
@@ -265,7 +216,7 @@ on post-fs-data && property:vendor.skip.charger_not_need=0
     mkdir /data/vendor/ss 0700 system system
 
     # tmp dir for opencl Compiler
-    setprop TMPDIR /data/vendor/.opencl-cache
+    setprop vendor.TMPDIR /data/vendor/.opencl-cache
     mkdir /data/vendor/.opencl-cache 0771 system camera
 
 on zygote-start && property:vendor.skip.charger_not_need=0
@@ -293,3 +244,12 @@ on property:ro.boot.vendor.sysrq=1 && property:vendor.skip.charger_not_need=0
 # setenv append_bootargs androidboot.usb.debugging=1
 on property:ro.boot.usb.debugging=1
     setprop persist.sys.usb.config adb
+
+# setenv append_bootargs androidboot.powersave.usb=true
+on property:ro.boot.powersave.usb=true
+    # enable platform/32f10100.usb runtime_pm
+    write /sys/devices/platform/soc@0/32f10100.usb/38100000.dwc3/power/control auto
+
+    #enable platform/32f10108.usb runtime_pm
+    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/power/control auto
+    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/xhci-hcd.0.auto/power/control auto
diff --git a/imx8m/bigcypress_8mp/init.rc~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/init.rc~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index eee4cf7c..00000000
--- a/imx8m/bigcypress_8mp/init.rc~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,248 +0,0 @@
-import /vendor/etc/init/hw/init.${ro.hardware}.usb.rc
-import /vendor/etc/init/hw/init.${ro.hardware}.${ro.boot.soc_type}.rc
-
-service vendor.charger /system/bin/charger
-    class charger
-    user system
-    group system wakelock input
-    capabilities SYS_BOOT
-    file /dev/kmsg w
-    file /sys/fs/pstore/console-ramoops-0 r
-    file /sys/fs/pstore/console-ramoops r
-    file /proc/last_kmsg r
-
-on charger
-    start vendor.charger
-
-on early-init
-    # mount the debugfs
-    mount debugfs none /sys/kernel/debug/ mode=0755
-
-on early-init
-    start early_init_sh
-    # Set the host name which used in console
-    export HOSTNAME evk_8mp
-
-    # Due keymaster start very early so set prop here
-    # Also gatekeeper share same role for keymaster
-    setprop ro.hardware.keystore ${ro.boot.keystore}
-    setprop ro.hardware.gatekeeper ${ro.boot.keystore}
-    setprop vendor.storageproxyd ${ro.boot.keystore}
-
-    # Use ro.boot.lcd_density to override ro.sf.lcd_density
-    setprop ro.sf.lcd_density ${ro.boot.lcd_density}
-
-# Skip charger_not_need trigger for charger mode
-on early-init && property:ro.boot.mode=charger
-    setprop vendor.skip.charger_not_need 1
-
-on init && property:vendor.skip.charger_not_need=0
-    start watchdogd
-
-    # Support legacy paths
-    symlink /sdcard /mnt/sdcard
-    symlink /sdcard /storage/sdcard0
-
-    # disable cursor blink for fbcon, if no splash screen support
-    write /sys/class/graphics/fbcon/cursor_blink 0
-
-    # deattch the fbcon as hdmi hotplug conflict with fbcon
-    write /sys/class/vtconsole/vtcon1/bind 0
-
-    chown system system /dev/stune/top-app/schedtune.boost
-    chmod 664 /dev/stune/top-app/schedtune.boost
-    chown system system /dev/stune/top-app/schedtune.prefer_idle
-    chmod 664 /dev/stune/top-app/schedtune.prefer_idle
-    chown system system /dev/stune/foreground/schedtune.boost
-    chmod 664 /dev/stune/foreground/schedtune.boost
-    chown system system /dev/stune/foreground/schedtune.prefer_idle
-    chmod 664 /dev/stune/foreground/schedtune.prefer_idle
-    chown system system /dev/stune/schedtune.boost
-    chmod 664 /dev/stune/schedtune.boost
-
-    # set default schedTune value for foreground/top-app (only affects EAS)
-    write /dev/stune/foreground/schedtune.boost 10
-    write /dev/stune/foreground/schedtune.prefer_idle 1
-    write /dev/stune/top-app/schedtune.boost 40
-    write /dev/stune/top-app/schedtune.prefer_idle 1
-    write /dev/stune/rt/schedtune.boost 50
-    write /dev/stune/rt/schedtune.prefer_idle 1
-
-on late-fs && property:vendor.skip.charger_not_need=0
-    # Start keymaster/gatekeeper service
-    start vendor.gatekeeper-1-0-${ro.boot.keystore}
-    start vendor.keymaster-4-0-${ro.boot.keystore}
-    setprop vendor.powerhal.init 1
-
-    # Wait for keymaster
-    exec_start wait_for_keymaster
-
-    mount_all /vendor/etc/fstab.nxp --late
-
-on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
-    start vendor.oemlock-1-0
-
-on early-boot && property:vendor.skip.charger_not_need=0
-    # For evk_8mp, when swap used about 400M, upgrade the level.
-    setprop ro.lmk.upgrade_pressure 93
-    setprop ro.lmk.downgrade_pressure 99
-    setprop ro.lmk.critical_upgrade true
-
-    setprop vendor.hwc.stretch.filter  1
-
-    # Default g2d [dpu|pxp|viv] lib to be used
-    setprop vendor.imx.default-g2d viv
-
-    # fsl omx graphic manager media framework property
-    setprop vendor.rw.VIDEO_RENDER_NAME video_render.surface
-    setprop vendor.media.fsl_codec.flag 7
-
-    setprop camera.disable_zsl_mode 1
-
-    #Enable GPU 2D do CSC on imx8mp platform
-    setprop vendor.camera.2d.enable true
-
-   # Tweak the mmc device read ahead buffer size
-    write /sys/block/mmcblk1/queue/read_ahead_kb 2048
-    write /sys/block/mmcblk2/queue/read_ahead_kb 2048
-
-    # Prepare for wifi
-    setprop wifi.interface wlan0
-    setprop wifi.direct.interface p2p0
-    setprop wifi.concurrent.interface wlan1
-
-    # Set tracefs permission to 755
-    chmod 0755 /sys/kernel/debug/tracing
-
-    # Set sw_sync group to graphics and set permission to 664
-    chown root graphics /sys/kernel/debug/sync/sw_sync
-    chmod 0664 /sys/kernel/debug/sync/sw_sync
-
-    # Default backlight device
-    setprop vendor.hw.backlight.dev "32e60000.mipi_dsi.0"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/32e60000.mipi_dsi.0/brightness
-    chmod 0660 /sys/class/backlight/32e60000.mipi_dsi.0/brightness
-
-    # Backup backlight device
-    setprop vendor.hw.backlight_backup.dev "lvds_backlight"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/lvds_backlight/brightness
-    chmod 0660 /sys/class/backlight/lvds_backlight/brightness
-
-    # Set light sensor sysfs path and light sensor threshold lux value
-    setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
-    setprop vendor.ro.lightsensor.threshold  20
-
-    # Allow DSD file(duration larger than 10s) can play
-    setprop audio.offload.min.duration.secs 10
-
-    # Enlarge limition of audio buffer allocation
-    setprop ro.af.client_heap_size_kbyte 32768
-
-    start vendor.wifi_hal_legacy
-
-service wpa_supplicant /vendor/bin/hw/wpa_supplicant \
-    -O/data/vendor/wifi/wpa/sockets -puse_p2p_group_interface=1 \
-    -g@android:wpa_wlan0
-    interface android.hardware.wifi.supplicant@1.0::ISupplicant default
-    interface android.hardware.wifi.supplicant@1.1::ISupplicant default
-    interface android.hardware.wifi.supplicant@1.2::ISupplicant default
-    interface android.hardware.wifi.supplicant@1.3::ISupplicant default
-    class main
-    socket wpa_wlan0 dgram 660 wifi wifi
-    disabled
-    oneshot
-
-service sensor_fusion /vendor/bin/fsl_sensor_fusion
-    class late_start
-    seclabel u:r:sensors:s0
-    user system
-    group system uhid
-    oneshot
-
-# Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
-service watchdogd /system/bin/watchdogd 10 20
-    class core
-    seclabel u:r:watchdogd:s0
-
-# bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -z
-    class main
-    disabled
-    oneshot
-    keycodes 114 115 116
-
-on boot && property:vendor.skip.charger_not_need=0
-    start audioserver
-    start mediadrm
-    start media
-    start drm
-
-on fs && property:vendor.skip.charger_not_need=0
-# mount ext4 partitions
-    mount_all /vendor/etc/fstab.nxp --early
-
-    # Adjust parameters for dm-verity device
-    write /sys/block/dm-0/queue/read_ahead_kb 4096
-
-    # Update dm-verity state and set partition.*.verified properties
-    verity_update_state
-
-on post-fs && property:vendor.skip.charger_not_need=0
-    # Set netd memlock rlimit to 8MB
-    setrlimit 8 8388608 8388608
-
-    # Turn on swap
-    swapon_all /vendor/etc/fstab.nxp
-
-    # Swap in only 1 page at a time
-    write /proc/sys/vm/page-cluster 0
-
-    # Grant permission for fetching available_pages info of statsd
-    chown system system /proc/pagetypeinfo
-    chmod 0440 /proc/pagetypeinfo
-
-on post-fs-data && property:vendor.skip.charger_not_need=0
-    setprop vold.post_fs_data_done 1
-    # create temp node for secure storage proxy
-    mkdir /data/vendor/ss 0700 system system
-
-    # tmp dir for opencl Compiler
-    setprop vendor.TMPDIR /data/vendor/.opencl-cache
-    mkdir /data/vendor/.opencl-cache 0771 system camera
-
-on zygote-start && property:vendor.skip.charger_not_need=0
-    # Create the directories used by the Wireless subsystem
-    mkdir /data/vendor/wifi 0771 wifi wifi
-    mkdir /data/vendor/wifi/wpa 0770 wifi wifi
-    mkdir /data/vendor/wifi/wpa/sockets 0770 wifi wifi
-
-service early_init_sh /vendor/bin/init.insmod.sh /vendor/etc/early.init.cfg vendor.all.early_init.ready
-    class main
-    user root
-    group root system
-    disabled
-    oneshot
-
-on property:sys.boot_completed=1 && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
-    start storageproxyd
-
-service storageproxyd /vendor/bin/storageproxyd -p /data/vendor/ss -r /dev/mmcblk2rpmb -d /dev/trusty-ipc-dev0
-   group system
-
-on property:ro.boot.vendor.sysrq=1 && property:vendor.skip.charger_not_need=0
-    write /proc/sys/kernel/sysrq 1
-
-# setenv append_bootargs androidboot.usb.debugging=1
-on property:ro.boot.usb.debugging=1
-    setprop persist.sys.usb.config adb
-
-# setenv append_bootargs androidboot.powersave.usb=true
-on property:ro.boot.powersave.usb=true
-    # enable platform/32f10100.usb runtime_pm
-    write /sys/devices/platform/soc@0/32f10100.usb/38100000.dwc3/power/control auto
-
-    #enable platform/32f10108.usb runtime_pm
-    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/power/control auto
-    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/xhci-hcd.0.auto/power/control auto
diff --git a/imx8m/bigcypress_8mp/isp_camera_config_imx8mp.json b/imx8m/bigcypress_8mp/isp_camera_config_imx8mp.json
index e24b80e0..1ed505f8 100644
--- a/imx8m/bigcypress_8mp/isp_camera_config_imx8mp.json
+++ b/imx8m/bigcypress_8mp/isp_camera_config_imx8mp.json
@@ -10,13 +10,8 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
-      "camera_name": "viv_v4l2_device",
-      "device_node": "/dev/video0",
-=======
       "camera_name": "viv_v4l20",
       "bus_info": "platform:viv0",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "orientation": "0",
       "buffer_type": "mmap",
       "ActiveArrayWidth": "1920",
diff --git a/imx8m/bigcypress_8mp/manifest.xml b/imx8m/bigcypress_8mp/manifest.xml
index 0627068d..1210dbbb 100644
--- a/imx8m/bigcypress_8mp/manifest.xml
+++ b/imx8m/bigcypress_8mp/manifest.xml
@@ -1,10 +1,10 @@
-<manifest version="1.0" type="device" target-level="4">
+<manifest version="1.0" type="device" target-level="5">
     <kernel  target-level="5" />
     <hal format="hidl">
 	<name>android.hardware.graphics.allocator</name>
         <transport>hwbinder</transport>
 	<impl level="generic"></impl>
-	<version>2.0</version>
+	<version>4.0</version>
 	<interface>
 	    <name>IAllocator</name>
 	    <instance>default</instance>
@@ -31,14 +31,12 @@
     <hal format="hidl">
         <name>android.hardware.drm</name>
         <transport>hwbinder</transport>
-        <version>1.0</version>
+        <version>1.3</version>
         <interface>
             <name>ICryptoFactory</name>
-            <instance>default</instance>
         </interface>
         <interface>
             <name>IDrmFactory</name>
-            <instance>default</instance>
         </interface>
         <fqname>@1.3::ICryptoFactory/clearkey</fqname>
         <fqname>@1.3::IDrmFactory/clearkey</fqname>
@@ -56,7 +54,7 @@
         <name>android.hardware.graphics.mapper</name>
         <transport arch="32+64">passthrough</transport>
         <impl level="generic"></impl>
-        <version>2.1</version>
+        <version>4.0</version>
         <interface>
             <name>IMapper</name>
             <instance>default</instance>
@@ -80,15 +78,6 @@
             <instance>default</instance>
         </interface>
     </hal>
-    <hal format="hidl">
-        <name>android.hardware.configstore</name>
-        <transport>hwbinder</transport>
-        <version>1.1</version>
-        <interface>
-            <name>ISurfaceFlingerConfigs</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
     <hal format="hidl">
         <name>android.hardware.media.c2</name>
         <transport>hwbinder</transport>
@@ -111,15 +100,6 @@
             <instance>default</instance>
         </interface>
     </hal>
-    <hal format="hidl">
-        <name>android.hardware.light</name>
-        <transport>hwbinder</transport>
-        <version>2.0</version>
-        <interface>
-            <name>ILight</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
     <hal format="hidl">
         <name>android.hardware.audio</name>
         <transport>hwbinder</transport>
diff --git a/imx8m/bigcypress_8mp/manifest.xml~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/manifest.xml~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index aba9b68e..00000000
--- a/imx8m/bigcypress_8mp/manifest.xml~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,153 +0,0 @@
-<manifest version="1.0" type="device" target-level="5">
-    <kernel  target-level="5" />
-    <hal format="hidl">
-	<name>android.hardware.graphics.allocator</name>
-        <transport>hwbinder</transport>
-	<impl level="generic"></impl>
-	<version>4.0</version>
-	<interface>
-	    <name>IAllocator</name>
-	    <instance>default</instance>
-	</interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.graphics.composer</name>
-        <transport>hwbinder</transport>
-        <version>2.4</version>
-        <interface>
-            <name>IComposer</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.keymaster</name>
-        <transport>hwbinder</transport>
-        <version>4.0</version>
-        <interface>
-            <name>IKeymasterDevice</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.drm</name>
-        <transport>hwbinder</transport>
-        <version>1.3</version>
-        <interface>
-            <name>ICryptoFactory</name>
-        </interface>
-        <interface>
-            <name>IDrmFactory</name>
-        </interface>
-        <fqname>@1.3::ICryptoFactory/clearkey</fqname>
-        <fqname>@1.3::IDrmFactory/clearkey</fqname>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.gatekeeper</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IGatekeeper</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.graphics.mapper</name>
-        <transport arch="32+64">passthrough</transport>
-        <impl level="generic"></impl>
-        <version>4.0</version>
-        <interface>
-            <name>IMapper</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.renderscript</name>
-        <transport arch="32+64">passthrough</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IDevice</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.media.c2</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IComponentStore</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.media.omx</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IOmx</name>
-            <instance>default</instance>
-        </interface>
-        <interface>
-            <name>IOmxStore</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.memtrack</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IMemtrack</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.audio</name>
-        <transport>hwbinder</transport>
-        <version>6.0</version>
-        <interface>
-            <name>IDevicesFactory</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.audio.effect</name>
-        <transport>hwbinder</transport>
-		<version>6.0</version>
-        <interface>
-            <name>IEffectsFactory</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.bluetooth</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IBluetoothHci</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.dumpstate</name>
-        <transport>hwbinder</transport>
-        <version>1.1</version>
-        <interface>
-            <name>IDumpstateDevice</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>nxp.hardware.display</name>
-            <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IDisplay</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-       <name>android.hardware.camera.provider</name>
-       <transport>hwbinder</transport>
-       <fqname>@2.4::ICameraProvider/external/0</fqname>
-    </hal>
-</manifest>
diff --git a/imx8m/bigcypress_8mp/ov5640_camera_config_imx8mp.json b/imx8m/bigcypress_8mp/ov5640_camera_config_imx8mp.json
index 6dcf34a7..73b1b25b 100644
--- a/imx8m/bigcypress_8mp/ov5640_camera_config_imx8mp.json
+++ b/imx8m/bigcypress_8mp/ov5640_camera_config_imx8mp.json
@@ -10,11 +10,7 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
-      "camera_name": "mxc-isi-cap",
-=======
       "camera_name": "mxc_isi.1.capture",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "orientation": "0",
       "mplane": "1",
       "buffer_type": "dma",
diff --git a/imx8m/bigcypress_8mp/overlay/frameworks/base/core/res/res/values/config.xml b/imx8m/bigcypress_8mp/overlay/frameworks/base/core/res/res/values/config.xml
index ff22c3e8..4722b491 100644
--- a/imx8m/bigcypress_8mp/overlay/frameworks/base/core/res/res/values/config.xml
+++ b/imx8m/bigcypress_8mp/overlay/frameworks/base/core/res/res/values/config.xml
@@ -188,6 +188,9 @@
     <!-- Boolean indicating whether system support sustained performance mode. -->
     <bool name="config_sustainedPerformanceModeSupported">true</bool>
 
+    <!-- If the system has the input method for each display - enable per-display focus. -->
+    <bool name="config_perDisplayFocusEnabled">true</bool>
+
     <!-- The default gravity for the picture-in-picture window.
          Currently, this maps to Gravity.TOP | Gravity.RIGHT -->
     <integer name="config_defaultPictureInPictureGravity">0x35</integer>
diff --git a/imx8m/bigcypress_8mp/overlay/frameworks/base/core/res/res/values/config.xml~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/overlay/frameworks/base/core/res/res/values/config.xml~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index be3cd041..00000000
--- a/imx8m/bigcypress_8mp/overlay/frameworks/base/core/res/res/values/config.xml~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,193 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-/*
-** Copyright 2011, The Android Open Source Project
-**
-** Licensed under the Apache License, Version 2.0 (the "License");
-** you may not use this file except in compliance with the License.
-** You may obtain a copy of the License at
-**
-**     http://www.apache.org/licenses/LICENSE-2.0
-**
-** Unless required by applicable law or agreed to in writing, software
-** distributed under the License is distributed on an "AS IS" BASIS,
-** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-** See the License for the specific language governing permissions and
-** limitations under the License.
-*/
--->
-
-<!-- These resources are around just to allow their values to be customized
-     for different hardware and product builds. -->
-<resources>
-
-    <!--For Android we support eth0 now -->
-    <string translatable="false" name="config_ethernet_iface_regex">eth0</string>
-
-    <!-- List of regexpressions describing the interface (if any) that represent tetherable
-         USB interfaces.  If the device doesn't want to support tething over USB this should
-         be empty.  An example would be "usb.*" -->
-     <string-array translatable="false" name="config_tether_usb_regexs">
-       <item>usb0</item>
-     </string-array>
-
-    <!-- List of regexpressions describing the interface (if any) that represent tetherable
-         Wifi interfaces.  If the device doesn't want to support tethering over Wifi this
-         should be empty.  An example would be "softap.*" -->
-    <string-array translatable="false" name="config_tether_wifi_regexs">
-      <item>"wlan0"</item>
-    </string-array>
-
-    <!-- List of regexpressions describing the interface (if any) that represent tetherable
-         bluetooth interfaces.  If the device doesn't want to support tethering over bluetooth this
-         should be empty. -->
-    <string-array translatable="false" name="config_tether_bluetooth_regexs">
-        <item>"bt-pan"</item>
-        </string-array>
-
-    <!-- Array of ConnectivityManager.TYPE_xxxx values allowable for tethering -->
-    <!-- Common options are [1, 4] for TYPE_WIFI and TYPE_MOBILE_DUN or
-    <!== [0,1,5,7,9] for TYPE_MOBILE, TYPE_WIFI, TYPE_MOBILE_HIPRI, TYPE_BLUETOOTH and TYPE_ETHERNET -->
-    <integer-array translatable="false" name="config_tether_upstream_types">
-        <item>0</item>
-        <item>1</item>
-        <item>5</item>
-        <item>9</item>
-    </integer-array>
-
-    <!-- Flag indicating whether we should enable the automatic brightness in Settings.
-         config_hardware_automatic_brightness_available is not set, so we will use software implementation -->
-    <bool name="config_automatic_brightness_available">true</bool>
-
-    <!-- An Array of "[ConnectivityManager connectionType],
-                      [# simultaneous connection types]"  -->
-    <string-array translatable="false" name="radioAttributes">
-        <item>"1,1"</item>
-        <item>"9,1"</item>
-    </string-array>
-
-    <!-- An Array of "[Connection name],[ConnectivityManager.TYPE_xxxx],
-         [associated radio-type],[priority],[restoral-timer(ms)],[dependencyMet]  -->
-    <!-- the 5th element "resore-time" indicates the number of milliseconds to delay
-         before automatically restore the default connection.  Set -1 if the connection
-         does not require auto-restore. -->
-    <!-- the 6th element indicates boot-time dependency-met value. -->
-    <string-array translatable="false" name="networkAttributes">
-        <item>"wifi,1,1,1,-1,true"</item>
-        <item>"bluetooth,7,7,2,-1,true"</item>
-        <item>"ethernet,9,9,2,-1,true"</item>
-    </string-array>
-
-    <!-- Array of light sensor LUX values to define our levels for auto backlight brightness support.
-         The N entries of this array define N + 1 zones as follows:
-
-         Zone 0:        0 <= LUX < array[0]
-         Zone 1:        array[0] <= LUX < array[1]
-         ...
-         Zone N:        array[N - 1] <= LUX < array[N]
-         Zone N + 1:    array[N] <= LUX < infinity
-
-         Must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessLevels">
-        <item>5</item>
-        <item>15</item>
-        <item>50</item>
-        <item>100</item>
-        <item>200</item>
-        <item>400</item>
-        <item>1000</item>
-        <item>2000</item>
-        <item>3000</item>
-        <item>5000</item>
-        <item>10000</item>
-        <item>30000</item>
-    </integer-array>
-
-    <!-- Array of output values for LCD backlight corresponding to the LUX values
-         in the config_autoBrightnessLevels array.  This array should have size one greater
-         than the size of the config_autoBrightnessLevels array.
-         This must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessLcdBacklightValues">
-        <item>5</item>    <!-- 0-5 -->
-        <item>20</item>   <!-- 5-15 -->
-        <item>30</item>   <!-- 15-50 -->
-        <item>40</item>   <!-- 50-100 -->
-        <item>50</item>   <!-- 100-200 -->
-        <item>60</item>   <!-- 200-400 -->
-        <item>70</item>   <!-- 400-1000 -->
-        <item>80</item>   <!-- 1000-2000 -->
-        <item>130</item>  <!-- 2000-3000 -->
-        <item>180</item>  <!-- 3000-5000 -->
-        <item>255</item>  <!-- 5000-10000 -->
-        <item>255</item>  <!-- 10000-30000 -->
-        <item>255</item>  <!-- 30000+ -->
-    </integer-array>
-
-    <!-- Array of output values for button backlight corresponding to the LUX values
-         in the config_autoBrightnessLevels array.  This array should have size one greater
-         than the size of the config_autoBrightnessLevels array.
-         This must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessButtonBacklightValues">
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-    </integer-array>
-
-    <!-- Array of output values for keyboard backlight corresponding to the LUX values
-         in the config_autoBrightnessLevels array.  This array should have size one greater
-         than the size of the config_autoBrightnessLevels array.
-         This must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessKeyboardBacklightValues">
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-    </integer-array>
-
-    <integer name="config_screenBrightnessDim">5</integer>
-
-    <!--  Maximum number of supported users -->
-    <integer name="config_multiuserMaximumUsers">8</integer>
-    <!--  Whether Multiuser UI should be shown -->
-    <bool name="config_enableMultiUserUI">true</bool>
-
-    <!-- Whether a software navigation bar should be shown. NOTE: in the future this may be
-         autodetected from the Configuration. -->
-    <bool name="config_showNavigationBar">true</bool>
-
-    <!-- This device is not "voice capable"; it's data-only. -->
-    <bool name="config_voice_capable">false</bool>
-
-    <!-- Boolean indicating whether system support sustained performance mode. -->
-    <bool name="config_sustainedPerformanceModeSupported">true</bool>
-
-    <!-- If the system has the input method for each display - enable per-display focus. -->
-    <bool name="config_perDisplayFocusEnabled">true</bool>
-</resources>
diff --git a/imx8m/bigcypress_8mp/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 660abbe5..00000000
--- a/imx8m/bigcypress_8mp/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,24 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-/**
- * Copyright (c) 2009, The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
--->
-<resources>
-    <!-- Default for Settings.Secure.USER_SETUP_COMPLETE -->
-    <bool name="def_user_setup_complete">true</bool>
-    <bool name="def_bluetooth_on">false</bool>
-    <bool name="def_stay_on_while_plugged_in">true</bool>
-</resources>
diff --git a/imx8m/bigcypress_8mp/powerhint_imx8mp.json b/imx8m/bigcypress_8mp/powerhint_imx8mp.json
index d926e59a..572c8140 100644
--- a/imx8m/bigcypress_8mp/powerhint_imx8mp.json
+++ b/imx8m/bigcypress_8mp/powerhint_imx8mp.json
@@ -45,7 +45,7 @@
       "Name": "PowerHALMainState",
       "Path": "vendor.powerhal.camera",
       "Values": [
-        "CAMERA_STREAMING",
+        "CAMERA_STREAMING_MID",
         ""
       ],
       "Type": "Property"
@@ -54,7 +54,7 @@
       "Name": "PowerHALAudioState",
       "Path": "vendor.powerhal.audio",
       "Values": [
-        "AUDIO_LOW_LATENCY",
+        "AUDIO_STREAMING_LOW_LATENCY",
         ""
       ],
       "Type": "Property"
@@ -131,13 +131,13 @@
       "Value": "0"
     },
     {
-      "PowerHint": "CAMERA_STREAMING",
+      "PowerHint": "CAMERA_STREAMING_MID",
       "Node": "PowerHALMainState",
       "Duration": 0,
-      "Value": "CAMERA_STREAMING"
+      "Value": "CAMERA_STREAMING_MID"
     },
     {
-      "PowerHint": "CAMERA_STREAMING",
+      "PowerHint": "CAMERA_STREAMING_MID",
       "Node": "CPULittleClusterMaxFreq",
       "Duration": 0,
       "Value": "1600000"
@@ -173,28 +173,28 @@
       "Value": "1600000"
     },
     {
-      "PowerHint": "AUDIO_STREAMING",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 2000,
-      "Value": "0"
+      "PowerHint": "AUDIO_STREAMING_LOW_LATENCY",
+      "Node": "PowerHALAudioState",
+      "Duration": 0,
+      "Value": "AUDIO_STREAMING_LOW_LATENCY"
     },
     {
-      "PowerHint": "AUDIO_STREAMING",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 2000,
-      "Value": "1600000"
+      "PowerHint": "AUDIO_STREAMING_LOW_LATENCY",
+      "Node": "PMQoSCpuDmaLatency",
+      "Duration": 0,
+      "Value": "0"
     },
     {
-      "PowerHint": "AUDIO_LOW_LATENCY",
-      "Node": "PowerHALAudioState",
+      "PowerHint": "FIXED_PERFORMANCE",
+      "Node": "CPULittleClusterMaxFreq",
       "Duration": 0,
-      "Value": "AUDIO_LOW_LATENCY"
+      "Value": "1600000"
     },
     {
-      "PowerHint": "AUDIO_LOW_LATENCY",
-      "Node": "PMQoSCpuDmaLatency",
+      "PowerHint": "FIXED_PERFORMANCE",
+      "Node": "CPULittleClusterMinFreq",
       "Duration": 0,
-      "Value": "0"
+      "Value": "1600000"
     }
   ]
 }
diff --git a/imx8m/bigcypress_8mp/powerhint_imx8mp.json~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/powerhint_imx8mp.json~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 572c8140..00000000
--- a/imx8m/bigcypress_8mp/powerhint_imx8mp.json~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,200 +0,0 @@
-{
-  "Nodes": [
-    {
-      "Name": "CPULittleClusterMaxFreq",
-      "Path": "/sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq",
-      "Values": [
-        "1800000",
-        "1600000",
-        "1200000"
-      ],
-      "DefaultIndex": 0,
-      "ResetOnInit": true
-    },
-    {
-      "Name": "CPULittleClusterMinFreq",
-      "Path": "/sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq",
-      "Values": [
-        "1800000",
-        "1600000",
-        "1200000"
-      ],
-      "ResetOnInit": true
-    },
-    {
-      "Name": "TASchedtuneBoost",
-      "Path": "/dev/stune/top-app/schedtune.boost",
-      "Values": [
-        "60",
-        "10"
-      ],
-      "DefaultIndex": 1,
-      "ResetOnInit": true
-    },
-    {
-      "Name": "PMQoSCpuDmaLatency",
-      "Path": "/dev/cpu_dma_latency",
-      "Values": [
-        "0",
-        "3000"
-      ],
-      "DefaultIndex": 1,
-      "HoldFd": true
-    },
-    {
-      "Name": "PowerHALMainState",
-      "Path": "vendor.powerhal.camera",
-      "Values": [
-        "CAMERA_STREAMING_MID",
-        ""
-      ],
-      "Type": "Property"
-    },
-    {
-      "Name": "PowerHALAudioState",
-      "Path": "vendor.powerhal.audio",
-      "Values": [
-        "AUDIO_STREAMING_LOW_LATENCY",
-        ""
-      ],
-      "Type": "Property"
-    },
-    {
-      "Name": "PowerHALRenderingState",
-      "Path": "vendor.powerhal.rendering",
-      "Values": [
-        "EXPENSIVE_RENDERING",
-        ""
-      ],
-      "Type": "Property"
-    }
-  ],
-  "Actions": [
-    {
-      "PowerHint": "SUSTAINED_PERFORMANCE",
-      "Node": "CPULittleClusterMaxFreq",
-      "Duration": 0,
-      "Value": "1600000"
-    },
-    {
-      "PowerHint": "INTERACTION",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 0,
-      "Value": "1800000"
-    },
-    {
-      "PowerHint": "INTERACTION",
-      "Node": "TASchedtuneBoost",
-      "Duration": 0,
-      "Value": "60"
-    },
-    {
-      "PowerHint": "INTERACTION",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 500,
-      "Value": "0"
-    },
-    {
-      "PowerHint": "LAUNCH",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 5000,
-      "Value": "1800000"
-    },
-    {
-      "PowerHint": "LAUNCH",
-      "Node": "CPULittleClusterMaxFreq",
-      "Duration": 5000,
-      "Value": "1800000"
-    },
-    {
-      "PowerHint": "LAUNCH",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 5000,
-      "Value": "0"
-    },
-    {
-      "PowerHint": "CAMERA_LAUNCH",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 5000,
-      "Value": "1800000"
-    },
-    {
-      "PowerHint": "CAMERA_LAUNCH",
-      "Node": "CPULittleClusterMaxFreq",
-      "Duration": 5000,
-      "Value": "1800000"
-    },
-    {
-      "PowerHint": "CAMERA_LAUNCH",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 1000,
-      "Value": "0"
-    },
-    {
-      "PowerHint": "CAMERA_STREAMING_MID",
-      "Node": "PowerHALMainState",
-      "Duration": 0,
-      "Value": "CAMERA_STREAMING_MID"
-    },
-    {
-      "PowerHint": "CAMERA_STREAMING_MID",
-      "Node": "CPULittleClusterMaxFreq",
-      "Duration": 0,
-      "Value": "1600000"
-    },
-    {
-      "PowerHint": "CAMERA_SHOT",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 5000,
-      "Value": "1800000"
-    },
-    {
-      "PowerHint": "CAMERA_SHOT",
-      "Node": "CPULittleClusterMaxFreq",
-      "Duration": 5000,
-      "Value": "1800000"
-    },
-    {
-      "PowerHint": "CAMERA_SHOT",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 1000,
-      "Value": "0"
-    },
-    {
-      "PowerHint": "LOW_POWER",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 0,
-      "Value": "1200000"
-    },
-    {
-      "PowerHint": "LOW_POWER",
-      "Node": "CPULittleClusterMaxFreq",
-      "Duration": 0,
-      "Value": "1600000"
-    },
-    {
-      "PowerHint": "AUDIO_STREAMING_LOW_LATENCY",
-      "Node": "PowerHALAudioState",
-      "Duration": 0,
-      "Value": "AUDIO_STREAMING_LOW_LATENCY"
-    },
-    {
-      "PowerHint": "AUDIO_STREAMING_LOW_LATENCY",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 0,
-      "Value": "0"
-    },
-    {
-      "PowerHint": "FIXED_PERFORMANCE",
-      "Node": "CPULittleClusterMaxFreq",
-      "Duration": 0,
-      "Value": "1600000"
-    },
-    {
-      "PowerHint": "FIXED_PERFORMANCE",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 0,
-      "Value": "1600000"
-    }
-  ]
-}
diff --git a/imx8m/bigcypress_8mp/sepolicy/file_contexts b/imx8m/bigcypress_8mp/sepolicy/file_contexts
index 1cdba81e..ad88cb47 100644
--- a/imx8m/bigcypress_8mp/sepolicy/file_contexts
+++ b/imx8m/bigcypress_8mp/sepolicy/file_contexts
@@ -1,63 +1,15 @@
-<<<<<<< HEAD
-#sd boot
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/misc             u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/metadata         u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/presistdata      u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/userdata         u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/vbmeta_[ab]      u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/super            u:object_r:super_block_device:s0
-
-#emmc boot
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/misc             u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/metadata         u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/presistdata      u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/userdata         u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/vbmeta_[ab]      u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/super            u:object_r:super_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/bootloader_[ab]  u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/mem_info_[ab]    u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/idtechdata       u:object_r:idtechdata_block_device:s0
-
-# spl
-/dev/block/mmcblk2boot[01]            u:object_r:spl_block_device:s0
-/dev/block/mmcblk2boot[01]p[1-9]      u:object_r:spl_block_device:s0
-
-#peripheral
-/vendor/bin/magd                u:object_r:sensors_exec:s0
-/vendor/bin/fsl_sensor_fusion   u:object_r:sensors_exec:s0
-/dev/mma8x5x                    u:object_r:sensors_device:s0
-/dev/ttymxc[0-9]*               u:object_r:tty_device:s0
-/dev/FreescaleAccelerometer     u:object_r:sensors_device:s0
-/dev/FreescaleMagnetometer      u:object_r:sensors_device:s0
-/dev/FreescaleGyroscope         u:object_r:sensors_device:s0
-=======
 /dev/block/mmcblk2boot0                      u:object_r:emmc_boot0:s0
 /dev/block/mmcblk1                           u:object_r:sdcard:s0
 
 #peripheral
 /vendor/bin/fsl_sensor_fusion   u:object_r:sensors_exec:s0
 /dev/ttymxc[0-9]*               u:object_r:tty_device:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 /dev/sda[0-8]*                  u:object_r:fuse:s0
 
 #Thermal HAL service
 /vendor/bin/hw/android\.hardware\.thermal@2\.0-service.imx         u:object_r:hal_thermal_default_exec:s0
 #Neural Network HAL service
-<<<<<<< HEAD
-/vendor/bin/hw/android\.hardware\.neuralnetworks@1\.2-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
-=======
 /vendor/bin/hw/android\.hardware\.neuralnetworks@1\.3-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # Media Codec2 service
 /vendor/bin/hw/android\.hardware\.media\.c2@1\.0-service    u:object_r:mediacodec_exec:s0
diff --git a/imx8m/bigcypress_8mp/sepolicy/genfs_contexts b/imx8m/bigcypress_8mp/sepolicy/genfs_contexts
index 0c88bf65..c051c4d8 100644
--- a/imx8m/bigcypress_8mp/sepolicy/genfs_contexts
+++ b/imx8m/bigcypress_8mp/sepolicy/genfs_contexts
@@ -3,22 +3,13 @@ genfscon sysfs /devices/platform/soc@0/30800000.bus/30b50000.mmc/mmc_host/mmc1/m
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30b60000.mmc/mmc_host/mmc2/mmc2:0001/block/mmcblk2 u:object_r:sysfs_block_devices:s0
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30bb0000.spi/spi_master/spi0/spi0.0/mtd/mtd0/mtdblock0 u:object_r:sysfs_block_devices:s0
 genfscon sysfs /devices/platform/soc@0/32c00000.bus/32e60000.mipi_dsi/32e60000.mipi_dsi.0/backlight u:object_r:sysfs_leds:s0
-<<<<<<< HEAD
-genfscon sysfs /devices/platform/backlight/backlight/backlight u:object_r:sysfs_leds:s0
-=======
 genfscon sysfs /devices/platform/soc@0/30400000.bus/30670000.pwm/consumer:lvds_backlight/consumer/backlight u:object_r:sysfs_leds:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 #sys/class/net
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30be0000.ethernet/net                u:object_r:sysfs_net:s0
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30bf0000.ethernet/net                u:object_r:sysfs_net:s0
-<<<<<<< HEAD
-genfscon sysfs /devices/platform/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net  u:object_r:sysfs_net:s0
-genfscon sysfs /devices/platform/32f10100.usb/38100000.dwc3/gadget/net                   u:object_r:sysfs_net:s0
-=======
 genfscon sysfs /devices/platform/32f10100.usb/38100000.dwc3/gadget/net                   u:object_r:sysfs_net:s0
 genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net  u:object_r:sysfs_net:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30a30000.i2c/i2c-1/1-0050/extcon u:object_r:sysfs_extcon:s0
 
diff --git a/imx8m/bigcypress_8mp/thermal_info_config_imx8mp.json b/imx8m/bigcypress_8mp/thermal_info_config_imx8mp.json
index be6c6412..36416a7e 100755
--- a/imx8m/bigcypress_8mp/thermal_info_config_imx8mp.json
+++ b/imx8m/bigcypress_8mp/thermal_info_config_imx8mp.json
@@ -1,14 +1,18 @@
 {
+    "HotplugCPUs":[
+            "cpu2",
+            "cpu3"
+    ],
     "Sensors":[
         {
             "Name":"cpu-thermal",
             "Type":"CPU",
             "HotThreshold":[
                 "NAN",
-                "NAN",
-                "NAN",
-                85.0,
-                95.0,
+                80.0,
+                82.0,
+                86.0,
+                90.0,
                 "NAN",
                 "NAN"
             ],
diff --git a/imx8m/bigcypress_8mp/thermal_info_config_imx8mp.json~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mp/thermal_info_config_imx8mp.json~post_merge_android-11.0.0_2.0.0
deleted file mode 100755
index 36416a7e..00000000
--- a/imx8m/bigcypress_8mp/thermal_info_config_imx8mp.json~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,88 +0,0 @@
-{
-    "HotplugCPUs":[
-            "cpu2",
-            "cpu3"
-    ],
-    "Sensors":[
-        {
-            "Name":"cpu-thermal",
-            "Type":"CPU",
-            "HotThreshold":[
-                "NAN",
-                80.0,
-                82.0,
-                86.0,
-                90.0,
-                "NAN",
-                "NAN"
-            ],
-            "HotHysteresis":[
-                2.0,
-                2.0,
-                2.0,
-                2.0,
-                2.0,
-                2.0,
-                2.0
-            ],
-            "VrThreshold":"NAN",
-            "Multiplier":0.001,
-            "Monitor":true
-        },
-        {
-            "Name":"soc-thermal",
-            "Type":"CPU",
-            "HotThreshold":[
-                "NAN",
-                "NAN",
-                "NAN",
-                85.0,
-                95.0,
-                "NAN",
-                "NAN"
-            ],
-            "HotHysteresis":[
-                2.0,
-                2.0,
-                2.0,
-                2.0,
-                2.0,
-                2.0,
-                2.0
-            ],
-            "VrThreshold":"NAN",
-            "Multiplier":0.001,
-            "Monitor":true
-        },
-        {
-            "Name":"battery",
-            "Type":"BATTERY",
-            "HotThreshold":[
-                "NAN",
-                "NAN",
-                "NAN",
-                "NAN",
-                "NAN",
-                "NAN",
-                "NAN"
-            ],
-            "VrThreshold":"NAN",
-            "Multiplier":0.001,
-            "Monitor":true
-        }
-    ],
-    "CoolingDevices":[
-        {
-            "Name":"thermal-devfreq-0",
-            "Type": "CPU"
-        },
-        {
-            "Name":"thermal-devfreq-1",
-            "Type":"CPU"
-        },
-        {
-            "Name":"thermal-cpufreq-0",
-            "Type":"CPU"
-        }
-    ]
-}
diff --git a/imx8m/bigcypress_8mp/ueventd.nxp.rc b/imx8m/bigcypress_8mp/ueventd.nxp.rc
index fda9e5f4..e733de1d 100644
--- a/imx8m/bigcypress_8mp/ueventd.nxp.rc
+++ b/imx8m/bigcypress_8mp/ueventd.nxp.rc
@@ -1,21 +1,11 @@
-<<<<<<< HEAD
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/presistdata 0600   system     system
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/presistdata 0600   system     system
-=======
 /dev/block/by-name/presistdata 0600   system     system
->>>>>>> post_merge/android-11.0.0_2.0.0
 /dev/ttymxc0              0660   bluetooth  bluetooth
 /dev/snd/*                0660   system     audio
 /dev/video*               0660   system     camera
 /dev/mxc_hifi4            0660   media      drmrpc
-<<<<<<< HEAD
-/dev/mxc_hantro           0660   media      drmrpc
-/dev/mxc_hantro_vc8000e   0660   media      drmrpc
-=======
 /dev/mxc_hantro           0666   media      drmrpc
 /dev/mxc_hantro_vc8000e   0666   media      drmrpc
 /dev/vsi_daemon_ctrl      0666   media      drmrpc
->>>>>>> post_merge/android-11.0.0_2.0.0
 /dev/ion                  0666   media      drmrpc
 /dev/galcore	          0666 	 system     graphics
 /dev/graphics/fb0         0660   system     graphics
@@ -29,8 +19,5 @@
 
 /sys/devices/virtual/thermal/thermal_zone* trip_point_0_hyst 0660 system system
 /sys/devices/virtual/thermal/thermal_zone* trip_point_1_hyst 0660 system system
-<<<<<<< HEAD
 
 /dev/usb/lp0              0666   root         root
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/bigcypress_8mq/AndroidBoard.mk b/imx8m/bigcypress_8mq/AndroidBoard.mk
index cb6595f6..75defabe 100644
--- a/imx8m/bigcypress_8mq/AndroidBoard.mk
+++ b/imx8m/bigcypress_8mq/AndroidBoard.mk
@@ -1,8 +1,8 @@
 LOCAL_PATH := $(call my-dir)
 
-include device/idtech/common/build/dtbo.mk
-include device/idtech/common/build/imx-recovery.mk
-include device/idtech/common/build/gpt.mk
+include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
+include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
+include $(CONFIG_REPO_PATH)/common/build/gpt.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
 -include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/bigcypress_8mq/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mq/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 75defabe..00000000
--- a/imx8m/bigcypress_8mq/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,8 +0,0 @@
-LOCAL_PATH := $(call my-dir)
-
-include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
-include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
-include $(CONFIG_REPO_PATH)/common/build/gpt.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
--include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/bigcypress_8mq/AndroidTee.mk b/imx8m/bigcypress_8mq/AndroidTee.mk
index 72d257db..ef45e595 100644
--- a/imx8m/bigcypress_8mq/AndroidTee.mk
+++ b/imx8m/bigcypress_8mq/AndroidTee.mk
@@ -4,7 +4,7 @@ MAKE += SHELL=/bin/bash
 define build_uboot_w_tee
 	$(MAKE) -C bootable/bootloader/arm-trusted-firmware/ -B CROSS_COMPILE=aarch64-linux-android- PLAT=imx8mq V=1 SPD=opteed DECRYPTED_BUFFER_START=$(DECRYPTED_BUFFER_START) DECRYPTED_BUFFER_LEN=$(DECRYPTED_BUFFER_LEN) DECODED_BUFFER_START=$(DECODED_BUFFER_START) DECODED_BUFFER_LEN=$(DECODED_BUFFER_LEN) bl31; \
 	cp bootable/bootloader/arm-trusted-firmware/build/imx8mq/release/bl31.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.;\
-	aarch64-linux-android-objcopy -O binary out/target/product/bigcypress_8mq/optee/arm-plat-imx/core/tee.elf $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
+	aarch64-linux-android-objcopy -O binary $(PRODUCT_OUT)/optee/arm-plat-imx/core/tee.elf $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 	$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ clean; \
 	$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8M  flash_hdmi_spl_uboot; \
 	cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(PRODUCT_OUT)/u-boot-$(strip $(2)).imx;
diff --git a/imx8m/bigcypress_8mq/AndroidUboot.mk b/imx8m/bigcypress_8mq/AndroidUboot.mk
index bac0d7f6..839c4a41 100644
--- a/imx8m/bigcypress_8mq/AndroidUboot.mk
+++ b/imx8m/bigcypress_8mq/AndroidUboot.mk
@@ -2,16 +2,9 @@
 MAKE += SHELL=/bin/bash
 
 ifneq ($(AARCH64_GCC_CROSS_COMPILE),)
-<<<<<<< HEAD
-ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
-else
-ATF_TOOLCHAIN_ABS := $(realpath prebuilts/gcc/$(HOST_PREBUILT_TAG)/aarch64/aarch64-linux-android-4.9/bin)
-ATF_CROSS_COMPILE := $(ATF_TOOLCHAIN_ABS)/aarch64-linux-androidkernel-
-=======
   ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
 else
   $(error shell env AARCH64_GCC_CROSS_COMPILE is not set)
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 define build_imx_uboot
@@ -23,11 +16,7 @@ define build_imx_uboot
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/hdmi/cadence/signed_hdmi_imx8m.bin  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
-<<<<<<< HEAD
 	if [ `echo $(2) | cut -d '-' -f3` = "trusty" ] && [ `echo $(2) | rev | cut -d '-' -f1` != "uuu" ]; then \
-=======
-	if [ `echo $(2) | cut -d '-' -f2` = "trusty" ] && [ `echo $(2) | rev | cut -d '-' -f1` != "uuu" ]; then \
->>>>>>> post_merge/android-11.0.0_2.0.0
 		cp $(FSL_PROPRIETARY_PATH)/fsl-proprietary/uboot-firmware/imx8m/tee-imx8mq.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 		$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ CROSS_COMPILE="$(ATF_CROSS_COMPILE)" PLAT=`echo $(2) | cut -d '-' -f1` bl31 -B SPD=trusty 1>/dev/null || exit 1; \
 	else \
@@ -47,7 +36,6 @@ define build_imx_uboot
 	fi; \
 	if [ `echo $(2) | rev | cut -d '-' -f1 | rev` != "dual" ]; then \
 		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(UBOOT_COLLECTION)/u-boot-$(strip $(2)).imx; \
-<<<<<<< HEAD
 		if [ -f device/idtech/common/prebuilts/spl_tab_auxiliary.img ]; then \
 			dd if=device/idtech/common/prebuilts/spl_tab_auxiliary.img of=$(UBOOT_COLLECTION)/u-boot-$(strip $(2)).imx bs=1 seek=105984 conv=notrunc; \
 		fi; \
@@ -57,11 +45,6 @@ define build_imx_uboot
 		if [ -f device/idtech/common/prebuilts/spl_tab_auxiliary.img ]; then \
 			dd if=device/idtech/common/prebuilts/spl_tab_auxiliary.img of=$(UBOOT_COLLECTION)/spl-$(strip $(2)).bin bs=1 seek=105984 conv=notrunc; \
 		fi; \
-=======
-	else \
-		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(UBOOT_COLLECTION)/spl-$(strip $(2)).bin; \
-		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/u-boot-ivt.itb $(UBOOT_COLLECTION)/bootloader-$(strip $(2)).img; \
->>>>>>> post_merge/android-11.0.0_2.0.0
 	fi;
 endef
 
diff --git a/imx8m/bigcypress_8mq/BoardConfig.mk b/imx8m/bigcypress_8mq/BoardConfig.mk
index fc5cd22d..f042306e 100644
--- a/imx8m/bigcypress_8mq/BoardConfig.mk
+++ b/imx8m/bigcypress_8mq/BoardConfig.mk
@@ -1,5 +1,3 @@
-<<<<<<< HEAD
-=======
 # -------@block_infrastructure-------
 #
 # Product-specific compile-time definitions.
@@ -8,42 +6,23 @@
 include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
 
 # -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 #
 # SoC-specific compile-time definitions.
 #
 
 BOARD_SOC_TYPE := IMX8MQ
-<<<<<<< HEAD
 BOARD_SOM_TYPE := a300
 BOARD_TYPE := EVK
 BOARD_MAIN_DISPLAY_ROTATION := 270
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 BOARD_HAVE_VPU := true
 BOARD_VPU_TYPE := hantro
 HAVE_FSL_IMX_GPU2D := false
 HAVE_FSL_IMX_GPU3D := true
-<<<<<<< HEAD
-HAVE_FSL_IMX_IPU := false
 HAVE_FSL_IMX_PXP := false
-BOARD_KERNEL_BASE := 0x40400000
-TARGET_GRALLOC_VERSION := v3
 TARGET_USES_HWC2 := true
-TARGET_HWCOMPOSER_VERSION := v2.0
-USE_OPENGL_RENDERER := true
 TARGET_HAVE_VULKAN := true
-ENABLE_CFI=false
 
 SOONG_CONFIG_IMXPLUGIN += \
-                          BOARD_HAVE_VPU \
-=======
-HAVE_FSL_IMX_PXP := false
-TARGET_USES_HWC2 := true
-TARGET_HAVE_VULKAN := true
-
-SOONG_CONFIG_IMXPLUGIN += \
->>>>>>> post_merge/android-11.0.0_2.0.0
                           BOARD_VPU_TYPE
 
 SOONG_CONFIG_IMXPLUGIN_BOARD_SOC_TYPE = IMX8MQ
@@ -51,53 +30,6 @@ SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU = true
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_TYPE = hantro
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_ONLY = false
 
-<<<<<<< HEAD
-#
-# Product-specific compile-time definitions.
-#
-
-IMX_DEVICE_PATH := device/idtech/imx8m/bigcypress_8mq
-
-include device/idtech/imx8m/BoardConfigCommon.mk
-
-BUILD_TARGET_FS ?= ext4
-TARGET_USERIMAGES_USE_EXT4 := true
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-# Support gpt
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab_super.bpt
-  ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
-                           partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
-else
-  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-13GB-ab-no-product.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab-no-product.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
-  else
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
-  endif
-endif
-
-# Vendor Interface manifest and compatibility
-DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
-ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
-DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
-endif
-DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-USE_OPENGL_RENDERER := true
-
-BOARD_WLAN_DEVICE            := bcmdhd
-=======
 # -------@block_memory-------
 USE_ION_ALLOCATOR := true
 USE_GPU_ALLOCATOR := false
@@ -110,9 +42,9 @@ TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
 
 # Support gpt
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab_super.bpt
+  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab_super.bpt
   ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
+                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
                            partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
 else
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -121,14 +53,17 @@ else
                              partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
   else
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab.bpt
+    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab.bpt
     ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
+                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
   endif
 endif
 
-BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-imx8mq.img
+AB_OTA_PARTITIONS += spl_bak
+LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
+LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
+BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
 
 BOARD_USES_METADATA_PARTITION := true
 BOARD_ROOT_EXTRA_FOLDERS += metadata
@@ -137,85 +72,48 @@ BOARD_ROOT_EXTRA_FOLDERS += metadata
 ENABLE_CFI=false
 
 BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA4096
+BOARD_AVB_ALGORITHM := SHA256_RSA2048
 # The testkey_rsa4096.pem is copied from external/avb/test/data/testkey_rsa4096.pem
-BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/testkey_rsa4096.pem
+BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/idt_testkey_rsa2048.pem
 
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
+#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
+#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
+#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
 
 # -------@block_treble-------
 # Vendor Interface manifest and compatibility
 DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
+ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
+DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
+endif
 DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
 DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE := $(IMX_DEVICE_PATH)/device_framework_matrix.xml
 
 # -------@block_wifi-------
-BOARD_WLAN_DEVICE            := nxp
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_WLAN_DEVICE            := bcmdhd
 WPA_SUPPLICANT_VERSION       := VER_0_8_X
 BOARD_WPA_SUPPLICANT_DRIVER  := NL80211
 BOARD_HOSTAPD_DRIVER         := NL80211
 BOARD_HOSTAPD_PRIVATE_LIB           := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 BOARD_WPA_SUPPLICANT_PRIVATE_LIB    := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
-
-<<<<<<< HEAD
 WIFI_DRIVER_FW_PATH_PARAM := "/sys/module/brcmfmac/parameters/alternative_fw_path"
+WIFI_HIDL_FEATURE_DUAL_INTERFACE := false
 
-#WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
+# -------@block_bluetooth-------
 # BCM 1CX BT
 BOARD_HAVE_BLUETOOTH_BCM := true
-
-#BOARD_USE_SENSOR_FUSION := true
-BOARD_USE_ST_SENSOR_INPUT := true
-
-# we don't support sparse image.
-TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
-
-BOARD_HAVE_USB_CAMERA := true
-BOARD_HAVE_USB_MJPEG_CAMERA := false
-
-USE_ION_ALLOCATOR := true
-USE_GPU_ALLOCATOR := false
-
-BOARD_AVB_ENABLE := true
-TARGET_USES_MKE2FS := true
-BOARD_AVB_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_KEY_PATH := device/idtech/common/security/idt_testkey_rsa2048.pem
-
-#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
-
-# define frame buffer count
-NUM_FRAMEBUFFER_SURFACE_BUFFERS := 4
-=======
-WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-
-# -------@block_bluetooth-------
-# NXP 8997 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
 BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
 
 # -------@block_sensor-------
-BOARD_USE_SENSOR_FUSION := true
+BOARD_USE_ST_SENSOR_INPUT := true
 
 # -------@block_kernel_bootimg-------
 BOARD_KERNEL_BASE := 0x40400000
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(PRODUCT_IMX_DRM),true)
 CMASIZE=736M
 else
-<<<<<<< HEAD
 CMASIZE=800M
-=======
-CMASIZE=1280M
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 # NXP default config
@@ -228,11 +126,7 @@ BOARD_KERNEL_CMDLINE += androidboot.fbTileSupport=enable
 BOARD_KERNEL_CMDLINE += transparent_hugepage=never cma=$(CMASIZE)
 
 # display config
-<<<<<<< HEAD
 BOARD_KERNEL_CMDLINE += androidboot.lcd_density=246 androidboot.primary_display=imx-dcss androidboot.gui_resolution=1080p
-=======
-BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-dcss androidboot.gui_resolution=1080p
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # wifi config
 BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_para.conf
@@ -241,18 +135,6 @@ ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
 BOARD_KERNEL_CMDLINE += androidboot.vendor.sysrq=1
 endif
 
-<<<<<<< HEAD
-ifeq ($(TARGET_USERIMAGES_USE_UBIFS),true)
-ifeq ($(TARGET_USERIMAGES_USE_EXT4),true)
-$(error "TARGET_USERIMAGES_USE_UBIFS and TARGET_USERIMAGES_USE_EXT4 config open in same time, please only choose one target file system image")
-endif
-endif
-
-LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
-LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
-BOARD_PREBUILT_DTBOIMAGE := out/target/product/bigcypress_8mq/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-product.dtb
@@ -270,14 +152,6 @@ else # no dynamic parition feature
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-product-no-dynamic_partition.dtb
   else
-<<<<<<< HEAD
-    TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-dynamic_partition.dtb
-  endif
-endif
-
-BOARD_SEPOLICY_DIRS := \
-       device/idtech/imx8m/sepolicy \
-=======
 	TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-dynamic_partition.dtb
   endif
 endif
@@ -287,7 +161,6 @@ ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
 # -------@block_sepolicy-------
 BOARD_SEPOLICY_DIRS := \
        $(CONFIG_REPO_PATH)/imx8m/sepolicy \
->>>>>>> post_merge/android-11.0.0_2.0.0
        $(IMX_DEVICE_PATH)/sepolicy
 
 ifeq ($(PRODUCT_IMX_DRM),true)
@@ -295,16 +168,4 @@ BOARD_SEPOLICY_DIRS += \
        $(IMX_DEVICE_PATH)/sepolicy_drm
 endif
 
-<<<<<<< HEAD
-TARGET_BOARD_KERNEL_HEADERS := device/idtech/common/kernel-headers
-
-ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
-
-BOARD_USES_METADATA_PARTITION := true
-BOARD_ROOT_EXTRA_FOLDERS += metadata
-
-BOARD_PLAT_PRIVATE_SEPOLICY_DIR := device/idtech/imx8m/sepolicy_system/private
-
-AB_OTA_PARTITIONS += spl_bak
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_PLAT_PRIVATE_SEPOLICY_DIR := $(CONFIG_REPO_PATH)/imx8m/sepolicy_system/private
diff --git a/imx8m/bigcypress_8mq/SharedBoardConfig.mk b/imx8m/bigcypress_8mq/SharedBoardConfig.mk
index 9d36f4fb..1312266c 100644
--- a/imx8m/bigcypress_8mq/SharedBoardConfig.mk
+++ b/imx8m/bigcypress_8mq/SharedBoardConfig.mk
@@ -1,37 +1,18 @@
-<<<<<<< HEAD
+# -------@block_kernel_bootimg-------
+
 KERNEL_NAME := Image
 TARGET_KERNEL_ARCH := arm64
 
-#Enable this to include trusty support
-PRODUCT_IMX_TRUSTY := true
-
-#Enable this to disable product partition build.
-#IMX_NO_PRODUCT_PARTITION := true
-
 # BCM fmac wifi driver module
 BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/drivers/net/wireless/broadcom/brcm80211/brcmfmac/brcmfmac.ko \
     $(KERNEL_OUT)/drivers/net/wireless/broadcom/brcm80211/brcmutil/brcmutil.ko
-=======
-# -------@block_kernel_bootimg-------
-
-KERNEL_NAME := Image
-TARGET_KERNEL_ARCH := arm64
-
-#NXP 8997 wifi driver module
-BOARD_VENDOR_KERNEL_MODULES += \
-    $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/mlan.ko \
-    $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/moal.ko
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # mipi-panel touch driver module
 BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/drivers/input/touchscreen/synaptics_dsx/synaptics_dsx_i2c.ko
-<<<<<<< HEAD
-=======
 
 # -------@block_security-------
 #Enable this to include trusty support
 PRODUCT_IMX_TRUSTY := true
 
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/bigcypress_8mq/UbootKernelBoardConfig.mk b/imx8m/bigcypress_8mq/UbootKernelBoardConfig.mk
index 8373e063..c5eb9595 100644
--- a/imx8m/bigcypress_8mq/UbootKernelBoardConfig.mk
+++ b/imx8m/bigcypress_8mq/UbootKernelBoardConfig.mk
@@ -2,7 +2,6 @@ TARGET_BOOTLOADER_POSTFIX := bin
 UBOOT_POST_PROCESS := true
 
 # u-boot target for imx8mq_evk
-<<<<<<< HEAD
 TARGET_BOOTLOADER_CONFIG := imx8mq-lpddr4:bigcypress_8mq_evk_android_defconfig:signed
 TARGET_BOOTLOADER_CONFIG += imx8mq-lpddr4-dual:bigcypress_8mq_evk_android_dual_defconfig:signed
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
@@ -17,21 +16,6 @@ TARGET_BOOTLOADER_CONFIG += imx8mq-lpddr4-evk-uuu-mic3g:vp6820_8mq_evk_android_u
 TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
 TARGET_KERNEL_ADDITION_DEFCONF ?= android_addition_defconfig
 TARGET_KERNEL_SECURE_DEFCONF ?= android_secure_defconfig
-=======
-TARGET_BOOTLOADER_CONFIG := imx8mq:imx8mq_evk_android_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mq-dual:imx8mq_evk_android_dual_defconfig
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-  TARGET_BOOTLOADER_CONFIG += imx8mq-trusty:imx8mq_evk_android_trusty_defconfig
-  TARGET_BOOTLOADER_CONFIG += imx8mq-trusty-secure-unlock:imx8mq_evk_android_trusty_secure_unlock_defconfig
-  TARGET_BOOTLOADER_CONFIG += imx8mq-trusty-dual:imx8mq_evk_android_trusty_dual_defconfig
-endif
-
-# u-boot target used by uuu for imx8mq_evk
-TARGET_BOOTLOADER_CONFIG += imx8mq-evk-uuu:imx8mq_evk_android_uuu_defconfig
-
-TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
-# TARGET_KERNEL_ADDITION_DEFCONF ?= android_addition_defconfig
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 
 # absolute path is used, not the same as relative path used in AOSP make
diff --git a/imx8m/bigcypress_8mq/bigcypress_8mq.mk b/imx8m/bigcypress_8mq/bigcypress_8mq.mk
index c51f76e8..49b656f5 100644
--- a/imx8m/bigcypress_8mq/bigcypress_8mq.mk
+++ b/imx8m/bigcypress_8mq/bigcypress_8mq.mk
@@ -1,8 +1,9 @@
-<<<<<<< HEAD
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/bigcypress_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/bigcypress_8mq_common.mk)
 
 # Overrides
@@ -15,427 +16,3 @@ PRODUCT_NAME := bigcypress_8mq
 PRODUCT_PROPERTY_OVERRIDES += \
     persist.idt.lock_orientation=1 \
     persist.idt.audio_rerouting_device=0x400
-=======
-# -------@block_infrastructure-------
-
-CONFIG_REPO_PATH := device/nxp
-CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
-IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
-
-# configs shared between uboot, kernel and Android rootfs
-include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
-
--include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
-include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
-
-# -------@block_common_config-------
-
-# Overrides
-PRODUCT_NAME := evk_8mq
-PRODUCT_DEVICE := evk_8mq
-PRODUCT_MODEL := EVK_8MQ
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-PRODUCT_CHARACTERISTICS := tablet
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# -------@block_treble-------
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-
-# -------@block_power-------
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-PRODUCT_PACKAGES += \
-    android.hardware.power-service.imx
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mq.json
-
-# -------@block_app-------
-#Enable this to choose 32 bit user space build
-IMX8_BUILD_32BIT_ROOTFS := false
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-
-# -------@block_kernel_bootimg-------
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh
-
-# -------@block_storage-------
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
-  PRODUCT_USE_DYNAMIC_PARTITIONS := true
-  BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
-  BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-endif
-
-#Enable this to disable product partition build.
-IMX_NO_PRODUCT_PARTITION := false
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
-  PRODUCT_PACKAGES += imx_ota_postinstall
-
-  AB_OTA_POSTINSTALL_CONFIG += \
-    RUN_POSTINSTALL_vendor=true \
-    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
-    FILESYSTEM_TYPE_vendor=ext4 \
-    POSTINSTALL_OPTIONAL_vendor=false
-
-  PRODUCT_COPY_FILES += \
-    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mq-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
-endif
-
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# -------@block_security-------
-
-# Include keystore attestation keys and certificates.
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
--include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
-endif
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# hardware backed keymaster service
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-# Keymaster HAL
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-# -------@block_audio-------
-# Audio card json
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml
-
-# -------@block_camera-------
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/camera_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mq.json \
-    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-# -------@block_display-------
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# HWC2 HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.composer@2.4-service
-
-# define frame buffer count
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@4.0-impl.imx \
-    android.hardware.graphics.allocator@4.0-service.imx
-
-# RenderScript HAL
-PRODUCT_PACKAGES += \
-    android.hardware.renderscript@1.0-impl
-
-PRODUCT_PACKAGES += \
-        libg2d-opencl
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod \
-    MultiDisplay
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
-
-# -------@block_gpu-------
-PRODUCT_PACKAGES += \
-        libEGL_VIVANTE \
-        libGLESv1_CM_VIVANTE \
-        libGLESv2_VIVANTE \
-        gralloc_viv.$(TARGET_BOARD_PLATFORM) \
-        libGAL \
-        libGLSLC \
-        libVSC \
-        libgpuhelper \
-        libSPIRV_viv \
-        libvulkan_VIVANTE \
-        vulkan.$(TARGET_BOARD_PLATFORM) \
-        libCLC \
-        libLLVM_viv \
-        libOpenCL \
-        libg2d-viv \
-        libOpenVX \
-        libOpenVXU \
-        libNNVXCBinary-evis \
-        libNNVXCBinary-evis2 \
-        libNNVXCBinary-lite \
-        libOvx12VXCBinary-evis \
-        libOvx12VXCBinary-evis2 \
-        libOvx12VXCBinary-lite \
-        libNNGPUBinary-evis \
-        libNNGPUBinary-evis2 \
-        libNNGPUBinary-lite \
-        libNNGPUBinary-ulite \
-        libNNArchPerf \
-        libarchmodelSw
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# GPU openCL SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/CL/cl_sdk.mk
-
-# GPU openVX SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/nnxc_kernels/nnxc_kernels.mk
-
-# GPU openCL icdloader config file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
-
-
-# -------@block_wifi-------
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
-
-# WiFi HAL
-PRODUCT_PACKAGES += \
-    android.hardware.wifi@1.0-service \
-    wificond
-
-# WiFi RRO
-PRODUCT_PACKAGES += \
-    WifiOverlay
-
-# NXP 8997 Wifi and Bluetooth Combo Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf
-
-# Wifi regulatory
-PRODUCT_COPY_FILES += \
-    external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
-    external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
-
-# -------@block_bluetooth-------
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-# NXP 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# -------@block_usb-------
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
-
-# -------@block_multimedia_codec-------
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_PACKAGES += \
-    libg1 \
-    libhantro \
-    libcodec
-
-# imx c2 codec binary
-PRODUCT_PACKAGES += \
-    lib_vpu_wrapper \
-    lib_imx_c2_videodec_common \
-    lib_imx_c2_videodec \
-    lib_imx_c2_vpuwrapper_dec \
-    lib_imx_c2_process \
-    lib_imx_c2_process_dummy_post \
-    c2_component_register \
-    c2_component_register_ms \
-    c2_component_register_wmv9 \
-    c2_component_register_ra \
-    c2_component_register_rv
-
-ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
-ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
-INSTALL_64BIT_LIBRARY := true
-endif
--include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
-endif
-
-# -------@block_neural_network-------
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# -------@block_miscellaneous-------
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/bigcypress_8mq/bigcypress_8mq_common.mk b/imx8m/bigcypress_8mq/bigcypress_8mq_common.mk
index ded93c3b..b5b47b6c 100644
--- a/imx8m/bigcypress_8mq/bigcypress_8mq_common.mk
+++ b/imx8m/bigcypress_8mq/bigcypress_8mq_common.mk
@@ -1,235 +1,279 @@
-# This is a FSL Android Reference Design platform based on i.MX8QP ARD board
-# It will inherit from FSL core product which in turn inherit from Google generic
+# -------@block_infrastructure-------
 
-IMX_DEVICE_PATH := device/idtech/imx8m/bigcypress_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 
 # configs shared between uboot, kernel and Android rootfs
 include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
 
--include device/idtech/common/imx_path/ImxPathConfig.mk
-include device/idtech/imx8m/ProductConfigCommon.mk
+-include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
+include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
 
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab_nand.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab_nand.nxp)
-endif
-
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab.nxp)
-endif
+# -------@block_common_config-------
 
 # Overrides
 PRODUCT_NAME := bigcypress_8mq
 PRODUCT_DEVICE := bigcypress_8mq
 PRODUCT_MODEL := BIGCYPRESS_8MQ
 
+TARGET_BOOTLOADER_BOARD_NAME := EVK
+
+PRODUCT_CHARACTERISTICS := tablet
+
+DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
+
+PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
+
+# -------@block_treble-------
 PRODUCT_FULL_TREBLE_OVERRIDE := true
+
+# -------@block_power-------
 PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
 PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
 
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
+
+# Charger Mode
+PRODUCT_PRODUCT_PROPERTIES += \
+    ro.charger.no_ui=false
+
+# Do not skip charger_not_need trigger by default
+PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
+    vendor.skip.charger_not_need=0
+
+PRODUCT_PACKAGES += \
+    android.hardware.power-service.imx
+
+# Thermal HAL
+PRODUCT_PACKAGES += \
+    android.hardware.thermal@2.0-service.imx
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mq.json
+
+# -------@block_app-------
 #Enable this to choose 32 bit user space build
-#IMX8_BUILD_32BIT_ROOTFS := true
+IMX8_BUILD_32BIT_ROOTFS := false
 
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
+    $(CONFIG_REPO_PATH)/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
+    $(CONFIG_REPO_PATH)/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
+    $(CONFIG_REPO_PATH)/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
+
+# -------@block_kernel_bootimg-------
 # Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
 TARGET_USE_VENDOR_BOOT ?= true
 
+# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
+# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
+# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
+ifeq ($(TARGET_USE_VENDOR_BOOT),true)
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
+endif
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
+    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
+    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
+    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh
+
+# -------@block_storage-------
 #Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
 TARGET_USE_DYNAMIC_PARTITIONS ?= true
-#If the device is retrofit to have dynamic partition feature, set this variable to true to build
-#the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
-TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
   PRODUCT_USE_DYNAMIC_PARTITIONS := true
   BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
   BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-  ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
-    PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
-    BOARD_SUPER_PARTITION_METADATA_DEVICE := system
-    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 2952790016
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-    else
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor product
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 1610612736
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-      BOARD_SUPER_PARTITION_PRODUCT_DEVICE_SIZE := 1879048192
-    endif
-  endif
 endif
 
+#Enable this to disable product partition build.
+IMX_NO_PRODUCT_PARTITION := false
+
+$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
+
+TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
+
+ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
+  PRODUCT_PACKAGES += imx_ota_postinstall
+
+  AB_OTA_POSTINSTALL_CONFIG += \
+    RUN_POSTINSTALL_vendor=true \
+    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
+    FILESYSTEM_TYPE_vendor=ext4 \
+    POSTINSTALL_OPTIONAL_vendor=false
+
+  PRODUCT_COPY_FILES += \
+    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mq-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
+endif
+
+# fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
+    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
+    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
+    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
+    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
+
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt
+
+# -------@block_security-------
+
 # Include keystore attestation keys and certificates.
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 -include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
 endif
 
-# Copy device related config and binary to board
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
 PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_engine_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_engine_configuration.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_engine_default_stream_volumes.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_engine_default_stream_volumes.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_engine_product_strategies.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_engine_product_strategies.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_engine_stream_volumes.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_engine_stream_volumes.xml \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp \
-    $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    device/idtech/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    device/idtech/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    device/idtech/common/wifi/bcm_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf \
-    device/idtech/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
-    device/idtech/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
-    device/idtech/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
-    device/idtech/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
-    device/idtech/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt \
-    device/idtech/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
+    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
+    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
+endif
 
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
+# hardware backed keymaster service
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
+PRODUCT_PACKAGES += \
+    android.hardware.keymaster@4.0-service.trusty
 endif
 
+# Keymaster HAL
+PRODUCT_PACKAGES += \
+    android.hardware.keymaster@4.0-service-imx
 
-# Audio card json
-PRODUCT_COPY_FILES += \
-    device/idtech/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    device/idtech/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    device/idtech/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
-    device/idtech/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
-    device/idtech/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
-    device/idtech/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    device/idtech/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
-    device/idtech/common/audio-json/tlv320aic3110_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/tlv320aic3110_config.json \
-    device/idtech/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
+# new gatekeeper HAL
+PRODUCT_PACKAGES += \
+    android.hardware.gatekeeper@1.0-service.software-imx
+
+# Add Trusty OS backed gatekeeper and secure storage proxy
 
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    device/idtech/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    device/idtech/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
+PRODUCT_PACKAGES += \
+    android.hardware.gatekeeper@1.0-service.trusty \
+    storageproxyd
 endif
 
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
+# Add oem unlocking option in settings.
+PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
 
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
+#Oemlock HAL 1.0 support
+PRODUCT_PACKAGES += \
+    android.hardware.oemlock@1.0-service.imx
+endif
 
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/bigcypress_8mq/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
+# Specify rollback index for boot and vbmeta partitions
+ifneq ($(AVB_RBINDEX),)
+BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
+else
+BOARD_AVB_ROLLBACK_INDEX := 0
+endif
 
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    device/idtech/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    device/idtech/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    device/idtech/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    device/idtech/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    device/idtech/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
+ifneq ($(AVB_BOOT_RBINDEX),)
+BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
+else
+BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
+endif
 
-USE_XML_AUDIO_POLICY_CONF := 1
+$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
 
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
+#DRM Widevine 1.2 L3 support
+PRODUCT_PACKAGES += \
+    android.hardware.drm@1.3-service.widevine \
+    android.hardware.drm@1.3-service.clearkey \
+    libwvdrmcryptoplugin \
+    libwvhidl \
+    libwvdrmengine \
 
-PRODUCT_CHARACTERISTICS := tablet
+# -------@block_audio-------
+# Audio card json
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/tlv320aic3110_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/tlv320aic3110_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
 
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
+PRODUCT_PACKAGES += \
+    android.hardware.audio@6.0-impl:32 \
+    android.hardware.audio@2.0-service \
+    android.hardware.audio.effect@6.0-impl:32
 
-# GPU openCL g2d
 PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
+    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
+    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
+    $(IMX_DEVICE_PATH)/audio_policy_engine_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_engine_configuration.xml \
+    $(IMX_DEVICE_PATH)/audio_policy_engine_default_stream_volumes.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_engine_default_stream_volumes.xml \
+    $(IMX_DEVICE_PATH)/audio_policy_engine_product_strategies.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_engine_product_strategies.xml \
+    $(IMX_DEVICE_PATH)/audio_policy_engine_stream_volumes.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_engine_stream_volumes.xml
 
-# GPU openCL SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/CL/cl_sdk.mk
+# -------@block_camera-------
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/camera_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mq.json \
+    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
 
-# GPU openVX SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/nnxc_kernels/nnxc_kernels.mk
+PRODUCT_SOONG_NAMESPACES += hardware/google/camera
+PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
 
-# GPU openCL icdloader config file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
+# -------@block_display-------
+PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
 
 # HWC2 HAL
 PRODUCT_PACKAGES += \
     android.hardware.graphics.composer@2.4-service
 
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
+# define frame buffer count
 PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
+    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
 
 # Gralloc HAL
 PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@2.0-impl-2.1 \
-    android.hardware.graphics.allocator@2.0-impl \
-    android.hardware.graphics.allocator@2.0-service
+    android.hardware.graphics.mapper@4.0-impl.imx \
+    android.hardware.graphics.allocator@4.0-service.imx
 
 # RenderScript HAL
 PRODUCT_PACKAGES += \
     android.hardware.renderscript@1.0-impl
 
+PRODUCT_PACKAGES += \
+        libg2d-opencl
+
+# Multi-Display launcher
+PRODUCT_PACKAGES += \
+    MultiClientInputMethod
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
+
+# -------@block_gpu-------
 PRODUCT_PACKAGES += \
         libEGL_VIVANTE \
         libGLESv1_CM_VIVANTE \
         libGLESv2_VIVANTE \
-        gralloc_viv.imx \
+        gralloc_viv.$(TARGET_BOARD_PLATFORM) \
         libGAL \
         libGLSLC \
         libVSC \
         libgpuhelper \
         libSPIRV_viv \
         libvulkan_VIVANTE \
-        vulkan.imx \
+        vulkan.$(TARGET_BOARD_PLATFORM) \
         libCLC \
         libLLVM_viv \
         libOpenCL \
-        libg2d-opencl \
         libg2d-viv \
         libOpenVX \
         libOpenVXU \
@@ -246,58 +290,39 @@ PRODUCT_PACKAGES += \
         libNNArchPerf \
         libarchmodelSw
 
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32 \
-    android.hardware.power@1.3-service.imx \
-    android.hardware.light@2.0-impl \
-    android.hardware.light@2.0-service \
-    android.hardware.sensors@1.0-impl \
-    android.hardware.sensors@1.0-convert \
-    android.hardware.sensors@1.0-service \
-    android.hardware.configstore@1.1-service \
-    configstore@1.1.policy
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
+# GPU openCL g2d
 PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/bigcypress_8mq/thermal_info_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mq.json
+    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
 
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.2-service-vsi-npu-server
+# GPU openCL SDK header file
+-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/CL/cl_sdk.mk
 
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
+# GPU openVX SDK header file
+-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/nnxc_kernels/nnxc_kernels.mk
 
-# Bluetooth HAL
+# GPU openCL icdloader config file
+-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
+
+# -------@block_sensor-------
 PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
+    android.hardware.sensors@1.0-impl \
+    android.hardware.sensors@1.0-convert \
+    android.hardware.sensors@1.0-service
+
+# -------@block_wifi-------
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
+    $(CONFIG_REPO_PATH)/common/wifi/bcm_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
 
 # WiFi HAL
 PRODUCT_PACKAGES += \
     android.hardware.wifi@1.0-service \
-    wifilogd \
     wificond
 
 # WiFi RRO
 PRODUCT_PACKAGES += \
     WifiOverlay
 
-# BCM Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# BCM 1CX Bluetooth Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/cyw-wifi-bt/1CX_CYW4356/BCM4354A2.1CX.hcd:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/CYW4354A2.1CX.hcd
-
 # BCM 1CX Wifi Firmware
 PRODUCT_COPY_FILES += \
     vendor/nxp/imx-firmware/cyw-wifi-bt/1CX_CYW4356/brcmfmac4356-pcie.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/brcmfmac4356-pcie.bin \
@@ -309,51 +334,35 @@ PRODUCT_COPY_FILES += \
     external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
     external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
 
-# hardware backed keymaster service
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/bigcypress_8mq/camera_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mq.json \
-    device/idtech/imx8m/bigcypress_8mq/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-# Keymaster HAL
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# DRM HAL
-TARGET_ENABLE_MEDIADRM_64 := true
+# -------@block_bluetooth-------
+# Bluetooth HAL
 PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service
+    android.hardware.bluetooth@1.0-impl \
+    android.hardware.bluetooth@1.0-service
 
-# new gatekeeper HAL
+# BCM Bluetooth vendor config
 PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
+    bt_vendor.conf
 
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
+# BCM 1CX Bluetooth Firmware
+PRODUCT_COPY_FILES += \
+    vendor/nxp/imx-firmware/cyw-wifi-bt/1CX_CYW4356/BCM4354A2.1CX.hcd:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/CYW4354A2.1CX.hcd
 
-#Dumpstate HAL 1.1 support
+# -------@block_usb-------
+# Usb HAL
 PRODUCT_PACKAGES += \
-    android.hardware.dumpstate@1.1-service.imx
+    android.hardware.usb@1.1-service.imx
 
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
 
-ifneq ($(BUILD_TARGET_FS),ubifs)
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.frp.pst=/dev/block/by-name/presistdata
-endif
+# -------@block_multimedia_codec-------
+# Vendor seccomp policy files for media components:
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
+    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
+    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
+    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
 
 PRODUCT_PACKAGES += \
     libg1 \
@@ -374,39 +383,6 @@ PRODUCT_PACKAGES += \
     c2_component_register_ra \
     c2_component_register_rv
 
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# Multi-Client IME
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-IMX-DEFAULT-G2D-LIB := libg2d-viv
-
 ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 INSTALL_64BIT_LIBRARY := true
@@ -414,12 +390,54 @@ endif
 -include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
 endif
 
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
+# -------@block_neural_network-------
+# Neural Network HAL and lib
+PRODUCT_PACKAGES += \
+    libovxlib \
+    libnnrt \
+    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
 
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
+# -------@block_miscellaneous-------
 
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
+# Copy device related config and binary to board
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
+    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
+    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
+    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
+
+# ONLY devices that meet the CDD's requirements may declare these features
+PRODUCT_COPY_FILES += \
+    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
+    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
+    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
+    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
+    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
+    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
+    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
+    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
+    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
+    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
+    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
+    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
+    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
+    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
+    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
+    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
+    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
+    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
+    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
+    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
+    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
+    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
+    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
+    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
+    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
+    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
+    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
+    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
+    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
+    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
 
 # Copy Quectel vendor RIL
 PRODUCT_COPY_FILES += \
diff --git a/imx8m/bigcypress_8mq/bigcypress_8mq_drm.mk b/imx8m/bigcypress_8mq/bigcypress_8mq_drm.mk
index 5e4c3e82..9aeb13c8 100644
--- a/imx8m/bigcypress_8mq/bigcypress_8mq_drm.mk
+++ b/imx8m/bigcypress_8mq/bigcypress_8mq_drm.mk
@@ -1,46 +1,28 @@
 # This is a FSL Android Reference Design platform based on i.MX8MQ board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-<<<<<<< HEAD
-IMX_DEVICE_PATH := device/idtech/imx8m/bigcypress_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 
 PRODUCT_IMX_DRM := true
 
 # copy drm specific files before inherit bigcypress_8mq.mk, otherwise copy is ignored
-=======
-IMX_DEVICE_PATH := device/nxp/imx8m/evk_8mq
-
-PRODUCT_IMX_DRM := true
-
-# copy drm specific files before inherit evk_8mq.mk, otherwise copy is ignored
->>>>>>> post_merge/android-11.0.0_2.0.0
 PRODUCT_COPY_FILES += \
 	$(IMX_DEVICE_PATH)/audio_policy_configuration_drm.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
 	$(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.main.rc \
 	$(IMX_DEVICE_PATH)/init.imx8mq.drm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-<<<<<<< HEAD
-	$(TOPDIR)device/idtech/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
+	$(TOPDIR)$(CONFIG_REPO_PATH)/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
 
 
-$(call inherit-product, $(TOPDIR)device/idtech/imx8m/optee-packages.mk)
+$(call inherit-product, $(TOPDIR)$(CONFIG_REPO_PATH)/imx8m/optee-packages.mk)
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/bigcypress_8mq.mk)
-=======
-	$(TOPDIR)device/nxp/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
-
-
-$(call inherit-product, $(TOPDIR)device/nxp/imx8m/optee-packages.mk)
-$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/evk_8mq.mk)
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
 
 
 # Overrides
-<<<<<<< HEAD
 PRODUCT_NAME := bigcypress_8mq_drm
-=======
-PRODUCT_NAME := evk_8mq_drm
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 CFG_DRM_SECURE_DATA_PATH ?= y
 CFG_RDC_SECURE_DATA_PATH ?= y
diff --git a/imx8m/bigcypress_8mq/bigcypress_8mq_pci.mk b/imx8m/bigcypress_8mq/bigcypress_8mq_pci.mk
index b00e5b3f..a307677e 100644
--- a/imx8m/bigcypress_8mq/bigcypress_8mq_pci.mk
+++ b/imx8m/bigcypress_8mq/bigcypress_8mq_pci.mk
@@ -1,7 +1,9 @@
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/bigcypress_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/bigcypress_8mq_common.mk)
 
 # Overrides
diff --git a/imx8m/bigcypress_8mq/camera_config_imx8mq.json b/imx8m/bigcypress_8mq/camera_config_imx8mq.json
index 7e35c2e7..2c17a03c 100644
--- a/imx8m/bigcypress_8mq/camera_config_imx8mq.json
+++ b/imx8m/bigcypress_8mq/camera_config_imx8mq.json
@@ -10,8 +10,8 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
       "camera_name": "uvc",
+      "bus_info": "platform:30b80000.csi2_bridge",
       "orientation": "0",
       "buffer_type": "dma",
       "ActiveArrayWidth": "1280",
@@ -24,34 +24,6 @@
       "MaxJpegSize": "4194304",
       "MinFrameDuration": "33331760",
       "MaxFrameDuration": "300000000"
-=======
-      "camera_name": "mx6s-csi",
-      "bus_info": "platform:30b80000.csi2_bridge",
-      "orientation": "0",
-      "buffer_type": "mmap",
-      "ActiveArrayWidth": "2592",
-      "ActiveArrayHeight": "1944",
-      "PixelArrayWidth": "2592",
-      "PixelArrayHeight": "1944",
-      "PhysicalWidth": "3.6288",
-      "PhysicalHeight": "2.7216",
-      "FocalLength": "3.37",
-      "MaxJpegSize": "8388608",
-      "MinFrameDuration": "33331760",
-      "MaxFrameDuration": "300000000",
-      "OmitFrame": [
-          {
-              "width": "2592",
-              "height": "1944",
-              "omit_num": "3"
-          },
-          {
-              "width": "1920",
-              "height": "1080",
-              "omit_num": "2"
-          }
-      ]
->>>>>>> post_merge/android-11.0.0_2.0.0
     }
   ]
 }
diff --git a/imx8m/bigcypress_8mq/compatibility_matrix.xml b/imx8m/bigcypress_8mq/compatibility_matrix.xml
index 49266e7c..347491b9 100644
--- a/imx8m/bigcypress_8mq/compatibility_matrix.xml
+++ b/imx8m/bigcypress_8mq/compatibility_matrix.xml
@@ -59,7 +59,6 @@
         <name>netutils-wrapper</name>
         <version>1.0</version>
     </hal>
-<<<<<<< HEAD
     <hal format="aidl" optional="true">
         <name>android.hardware.kioskled</name>
         <interface>
@@ -67,6 +66,4 @@
             <instance>default</instance>
         </interface>
     </hal>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </compatibility-matrix>
diff --git a/imx8m/bigcypress_8mq/evk_8mq_drm.mk b/imx8m/bigcypress_8mq/evk_8mq_drm.mk
deleted file mode 100644
index fe4b31ad..00000000
--- a/imx8m/bigcypress_8mq/evk_8mq_drm.mk
+++ /dev/null
@@ -1,72 +0,0 @@
-# This is a FSL Android Reference Design platform based on i.MX8MQ board
-# It will inherit from FSL core product which in turn inherit from Google generic
-
-IMX_DEVICE_PATH := device/nxp/imx8m/evk_8mq
-
-PRODUCT_IMX_DRM := true
-
-# copy drm specific files before inherit evk_8mq.mk, otherwise copy is ignored
-PRODUCT_COPY_FILES += \
-	$(IMX_DEVICE_PATH)/audio_policy_configuration_drm.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-	$(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.main.rc \
-	$(IMX_DEVICE_PATH)/init.imx8mq.drm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-	$(TOPDIR)device/nxp/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
-
-
-$(call inherit-product, $(TOPDIR)device/nxp/imx8m/optee-packages.mk)
-$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/evk_8mq.mk)
-
-TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
-
-
-# Overrides
-PRODUCT_NAME := evk_8mq_drm
-
-CFG_DRM_SECURE_DATA_PATH ?= y
-CFG_RDC_SECURE_DATA_PATH ?= y
-
-ifeq ($(CFG_DRM_SECURE_DATA_PATH),y)
-CFG_SECURE_DATA_PATH := y
-SOONG_CONFIG_IMXPLUGIN += CFG_SECURE_DATA_PATH
-SOONG_CONFIG_IMXPLUGIN_CFG_SECURE_DATA_PATH = y
-CFG_TEE_SDP_MEM_BASE := 0xcc000000
-CFG_TEE_SDP_MEM_SIZE := 0x02000000
-ifeq ($(CFG_RDC_SECURE_DATA_PATH),y)
-DECRYPTED_BUFFER_START	:= $(CFG_TEE_SDP_MEM_BASE)
-DECRYPTED_BUFFER_LEN	:= $(CFG_TEE_SDP_MEM_SIZE)
-DECODED_BUFFER_START	:= 0xCE000000
-DECODED_BUFFER_LEN		:= 0x30000000
-endif
-endif
-
-TARGET_BOARD_DTS_CONFIG := imx8mq:imx8mq-evk-drm.dtb imx8mq-mipi:imx8mq-evk-lcdif-adv7535.dtb imx8mq-dual:imx8mq-evk-dual-display.dtb
-
-# Exoplayer
-PRODUCT_PACKAGES += \
-	exoplayer \
-
-# Playready
-PRODUCT_COPY_FILES += \
-	vendor/nxp/drm_artifacts/playready/Samples/devcert.dat:$(TARGET_COPY_OUT_VENDOR)/playready/devcert.dat \
-	vendor/nxp/drm_artifacts/playready/Samples/priv.dat:$(TARGET_COPY_OUT_VENDOR)/playready/priv.dat \
-	vendor/nxp/drm_artifacts/playready/bgroupcert.dat:$(TARGET_COPY_OUT_VENDOR)/playready/bgroupcert.dat \
-	vendor/nxp/drm_artifacts/playready/zgpriv_protected.dat:$(TARGET_COPY_OUT_VENDOR)/playready/zgpriv_protected.dat \
-
-ifneq ($(CFG_BUILD_DRM_FROM_SOURCES),y)
-PRODUCT_COPY_FILES += \
-	vendor/nxp/drm_artifacts/playready/ta/82dbae9c-9ce0-47e0-a1cb4048cfdb84aa.ta:$(TARGET_COPY_OUT_VENDOR)/lib/optee_armtz/82dbae9c-9ce0-47e0-a1cb4048cfdb84aa.ta \
-	vendor/nxp/drm_artifacts/playready/libdrmplayreadyplugin.so:$(TARGET_COPY_OUT_VENDOR)/lib64/mediadrm/libdrmplayreadyplugin.so \
-	vendor/nxp/drm_artifacts/playready/optee_playready_test:$(TARGET_COPY_OUT_VENDOR)/bin/optee_playready_test
-endif
-
-ifneq ($(CFG_BUILD_DRM_FROM_SOURCES),y)
-# Widevine
-PRODUCT_COPY_FILES += \
-	vendor/nxp/drm_artifacts/widevine/lib/liboemcrypto.so:$(TARGET_COPY_OUT_VENDOR)/lib/liboemcrypto.so \
-	vendor/nxp/drm_artifacts/widevine/lib/libwvdrmengine.so:$(TARGET_COPY_OUT_VENDOR)/lib/mediadrm/libwvdrmengine.so \
-	vendor/nxp/drm_artifacts/widevine/lib/libvtswidevine.so:$(TARGET_COPY_OUT_VENDOR)/lib/drm-vts-test-libs/libvtswidevine.so \
-	vendor/nxp/drm_artifacts/widevine/lib64/liboemcrypto.so:$(TARGET_COPY_OUT_VENDOR)/lib64/liboemcrypto.so \
-	vendor/nxp/drm_artifacts/widevine/lib64/libwvdrmengine.so:$(TARGET_COPY_OUT_VENDOR)/lib64/mediadrm/libwvdrmengine.so \
-	vendor/nxp/drm_artifacts/widevine/lib64/libvtswidevine.so:$(TARGET_COPY_OUT_VENDOR)/lib64/drm-vts-test-libs/libvtswidevine.so \
-	vendor/nxp/drm_artifacts/widevine/ta/706f6574-7765-6469-77656e6942656665.ta:$(TARGET_COPY_OUT_VENDOR)/lib/optee_armtz/706f6574-7765-6469-77656e6942656665.ta
-endif
diff --git a/imx8m/bigcypress_8mq/fstab.nxp b/imx8m/bigcypress_8mq/fstab.nxp
index 1db83d0a..73a34ecf 100644
--- a/imx8m/bigcypress_8mq/fstab.nxp
+++ b/imx8m/bigcypress_8mq/fstab.nxp
@@ -4,21 +4,12 @@
 # specify MF_CHECK, and must come before any filesystems that do specify MF_CHECK
 
 /devices/platform/soc@0/38200000.usb/* auto auto defaults voldmanaged=usb:auto
-<<<<<<< HEAD
-/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block,metadata_csum
+/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block
 /dev/block/by-name/metadata    /metadata    ext4    noatime,nosuid,nodev,discard,sync                                                wait,formattable,first_stage_mount,check
 /dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
 /dev/block/by-name/idtechdata  /mnt/vendor/idtechdata  ext4    nosuid,nodev,noatime,barrier=1                       wait,formattable
 /dev/block/zram0 none swap defaults zramsize=629145600
 /tmp /sdcard none defaults,bind recoveryonly
 
-/devices/platform/soc@0/soc@0:bus@30800000/30b50000.mmc/mmc_host* /storage/sdcard1 vfat nosuid,nodev wait,voldmanaged=sdcard1:auto,encryptable=footer
+/devices/platform/soc@0/30800000.bus/30b50000.mmc/mmc_host* /storage/sdcard1 vfat nosuid,nodev wait,voldmanaged=sdcard1:auto,encryptable=footer
 /devices/platform/soc@0/38100000.usb/* auto auto defaults voldmanaged=usb:auto
-=======
-/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block
-/dev/block/by-name/metadata    /metadata    ext4    noatime,nosuid,nodev,discard,sync                                                wait,formattable,first_stage_mount,check
-/dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
-/dev/block/zram0 none swap defaults zramsize=629145600
-/tmp /sdcard none defaults,bind recoveryonly
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/bigcypress_8mq/init.imx8mq.rc b/imx8m/bigcypress_8mq/init.imx8mq.rc
index 9e0b3c05..25355d09 100755
--- a/imx8m/bigcypress_8mq/init.imx8mq.rc
+++ b/imx8m/bigcypress_8mq/init.imx8mq.rc
@@ -7,7 +7,7 @@ on early-boot
     write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
 
     # Set NN reject model by weights md5
-    setprop WEIGHT_MD5_CHECK 1
+    setprop vendor.MODEL_BLOCK_LEVEL 1
 
     # change for FSL specific service
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
@@ -19,6 +19,10 @@ on early-boot
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
+    chown root system /sys/devices/system/cpu/cpu2/online
+    chmod 0664 /sys/devices/system/cpu/cpu2/online
+    chown root system /sys/devices/system/cpu/cpu3/online
+    chmod 0664 /sys/devices/system/cpu/cpu3/online
 
     # disable 3D composition overlay to fix video rotate problem
     setprop vendor.hwc.enable.overlay 0
diff --git a/imx8m/bigcypress_8mq/init.imx8mq.rc~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mq/init.imx8mq.rc~post_merge_android-11.0.0_2.0.0
deleted file mode 100755
index b866ebdd..00000000
--- a/imx8m/bigcypress_8mq/init.imx8mq.rc~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,51 +0,0 @@
-on early-boot
-
-    # Set OpenGLES version
-    setprop ro.opengles.version 196609
-
-    # Set GPU 3D minimum clock to 3/64
-    write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
-
-    # Set NN reject model by weights md5
-    setprop vendor.MODEL_BLOCK_LEVEL 1
-
-    # change for FSL specific service
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
-    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
-    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
-    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
-    chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
-    chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
-    chown root system /sys/devices/system/cpu/cpu2/online
-    chmod 0664 /sys/devices/system/cpu/cpu2/online
-    chown root system /sys/devices/system/cpu/cpu3/online
-    chmod 0664 /sys/devices/system/cpu/cpu3/online
-
-on property:sys.boot_completed=1
-    # Set default CPU frequency governor
-    # configure governor settings for little cluster
-    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "schedutil"
-    # The rate-limit tunable in the schedutil governor applies to transitions to both lower and higher frequencies
-    # Set up and down limit to 200us/200us
-    write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 200
-    write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 200
-    write /proc/sys/kernel/sched_util_clamp_min 512
-
-on property:sys.boot_completed=1
-    # update cpuset now that processors are up
-    write /dev/cpuset/foreground/cpus 0-3
-
-    # top-app gets all cpus
-    write /dev/cpuset/top-app/cpus 0-3
-
-    #background contains a small subset (generally one little core)
-    write /dev/cpuset/background/cpus 0
-
-    # add system-background cpuset, a new cpuset for system services
-    # that should not run on larger cores
-    # system-background is for system tasks that should only run on
-    # little cores, not on bigs to be used only by init
-    write /dev/cpuset/system-background/cpus 0-2
diff --git a/imx8m/bigcypress_8mq/init.rc b/imx8m/bigcypress_8mq/init.rc
index 0d0c1cdf..eb6f470b 100644
--- a/imx8m/bigcypress_8mq/init.rc
+++ b/imx8m/bigcypress_8mq/init.rc
@@ -1,9 +1,6 @@
 import /vendor/etc/init/hw/init.${ro.hardware}.usb.rc
 import /vendor/etc/init/hw/init.${ro.hardware}.${ro.boot.soc_type}.rc
-<<<<<<< HEAD
 import /product/etc/init/hw/init.idt.common.rc
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 service vendor.charger /system/bin/charger
     class charger
@@ -25,11 +22,7 @@ on early-init
 on early-init
     start early_init_sh
     # Set the host name which used in console
-<<<<<<< HEAD
     export HOSTNAME bigcypress_8mq
-=======
-    export HOSTNAME evk_8mq
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Due keymaster start very early so set prop here
     # Also gatekeeper share same role for keymaster
@@ -51,14 +44,6 @@ on init && property:vendor.skip.charger_not_need=0
     symlink /sdcard /mnt/sdcard
     symlink /sdcard /storage/sdcard0
 
-<<<<<<< HEAD
-    # setup the global environment
-    export CORE_REGISTER_FILE /vendor/etc/core_register
-    export COMPONENT_REGISTER_FILE /vendor/etc/component_register
-    export CONTENTPIPE_REGISTER_FILE /vendor/etc/contentpipe_register
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     # disable cursor blink for fbcon, if no splash screen support
     write /sys/class/graphics/fbcon/cursor_blink 0
 
@@ -99,65 +84,38 @@ on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charg
     start vendor.oemlock-1-0
 
 on early-boot && property:vendor.skip.charger_not_need=0
-    # For evk_8mq, when swap used about 400M, upgrade the level.
+    # For bigcypress_8mq, when swap used about 400M, upgrade the level.
     setprop ro.lmk.upgrade_pressure 87
     setprop ro.lmk.downgrade_pressure 95
     setprop ro.lmk.critical_upgrade true
 
-<<<<<<< HEAD
-    # Set permission for IIM node
-    symlink /dev/mxs_viim /dev/mxc_mem
-
-    setprop sys.hwc.disable     1
-    setprop vendor.2d.composition 0
-    setprop hwc.stretch.filter  1
-
-    #viv sdk dir
-    setprop VIVANTE_SDK_DIR /vendor/etc/viv_sdk
-=======
     setprop vendor.sys.hwc.disable     1
     setprop vendor.2d.composition 0
     setprop vendor.hwc.stretch.filter  1
 
     #viv sdk dir
     setprop vendor.VIVANTE_SDK_DIR /vendor/etc/viv_sdk
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # fsl omx graphic manager media framework property
     setprop vendor.rw.VIDEO_RENDER_NAME video_render.surface
     setprop vendor.media.fsl_codec.flag 7
 
     setprop camera.disable_zsl_mode 1
-<<<<<<< HEAD
     setprop back_camera_name mx6s-csi0
     setprop back_camera_orient 0
     setprop front_camera_name mx6s-csi1
     setprop front_camera_orient 0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
    # Tweak the mmc device read ahead buffer size
     write /sys/block/mmcblk0/queue/read_ahead_kb 2048
     write /sys/block/mmcblk1/queue/read_ahead_kb 2048
 
-<<<<<<< HEAD
     # Wifi firmware reload path
     chown wifi wifi /sys/module/brcmfmac/parameters/alternative_fw_path
 
     # Prepare for wifi
     setprop wifi.interface wlan0
 
-    # Prepare for bluetooth
-    chmod 665 /sys/class/rfkill/rfkill0/state
-    chown bluetooth bluetooth /sys/class/rfkill/rfkill0/state
-    write /sys/class/rfkill/rfkill0/state 0
-=======
-    # Prepare for wifi
-    setprop wifi.interface wlan0
-    setprop wifi.direct.interface p2p0
-    setprop wifi.concurrent.interface wlan1
->>>>>>> post_merge/android-11.0.0_2.0.0
-
     # Disable surfaceflinger back pressure propagate
     setprop debug.sf.disable_backpressure 1
 
@@ -169,11 +127,10 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0664 /sys/kernel/debug/sync/sw_sync
 
     # Default backlight device
-<<<<<<< HEAD
-    #setprop vendor.hw.backlight.dev "30a00000.mipi_dsi.0"
+    #setprop vendor.hw.backlight.dev "30a00000.mipi-dsi.0"
     # Chmod/chown FSL specific sys entry
-    #chown system system /sys/class/backlight/30a00000.mipi_dsi.0/brightness
-    #chmod 0660 /sys/class/backlight/30a00000.mipi_dsi.0/brightness
+    #chown system system /sys/class/backlight/30a00000.mipi-dsi.0/brightness
+    #chmod 0660 /sys/class/backlight/30a00000.mipi-dsi.0/brightness
     setprop vendor.hw.backlight.dev "backlight"
     chown system system /sys/class/backlight/backlight/brightness
     chmod 0660 /sys/class/backlight/backlight/brightness
@@ -185,12 +142,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0660 /sys/class/backlight/pwm_2/brightness
     chmod 0660 /sys/class/backlight/pwm_3/brightness
     chmod 0660 /sys/class/backlight/pwm_4/brightness
-=======
-    setprop vendor.hw.backlight.dev "30a00000.mipi-dsi.0"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/30a00000.mipi-dsi.0/brightness
-    chmod 0660 /sys/class/backlight/30a00000.mipi-dsi.0/brightness
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Set light sensor sysfs path and light sensor threshold lux value
     setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
@@ -202,15 +153,9 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # Enlarge limition of audio buffer allocation
     setprop ro.af.client_heap_size_kbyte 32768
 
-<<<<<<< HEAD
-    # enlarge media max memory size to 3G.
-    setprop ro.media.maxmem 3221225471
-
     setprop wifi.direct.interface p2p-dev-wlan0
     start vendor.wifi_hal_legacy
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 on boot && property:vendor.skip.charger_not_need=0
     start audioserver
     start mediadrm
@@ -236,68 +181,19 @@ service sensor_fusion /vendor/bin/fsl_sensor_fusion
     group system uhid
     oneshot
 
-<<<<<<< HEAD
 service vendor.sensors-hal-1-0 /vendor/bin/hw/android.hardware.sensors@1.0-service
     class hal
     user system
     group system wakelock input root
     capabilities BLOCK_SUSPEND SYS_NICE
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
 service watchdogd /system/bin/watchdogd 10 20
     class core
     seclabel u:r:watchdogd:s0
 
-<<<<<<< HEAD
-service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_p2p /system/bin/dhcpcd -aABKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_eth0 /system/bin/dhcpcd -ABKL eth0
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_bt-pan /system/bin/dhcpcd -ABKL
-    class main
-    disabled
-    oneshot
-
-service iprenew_wlan0 /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_p2p /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_eth0 /system/bin/dhcpcd -n eth0
-    class main
-    disabled
-    oneshot
-
-service iprenew_bt-pan /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-# bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -B -z \
-        -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
-=======
 # bugreport is triggered by holding down volume down, volume up and power
 service bugreport /system/bin/dumpstate -d -p -z
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     disabled
     oneshot
@@ -313,12 +209,6 @@ on fs && property:vendor.skip.charger_not_need=0
     # Update dm-verity state and set partition.*.verified properties
     verity_update_state
 
-<<<<<<< HEAD
-on verity-logging && property:vendor.skip.charger_not_need=0
-    exec u:r:slideshow:s0 -- /sbin/slideshow warning/verity_red_1 warning/verity_red_2
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 on post-fs && property:vendor.skip.charger_not_need=0
     # Set netd memlock rlimit to 8MB
     setrlimit 8 8388608 8388608
@@ -339,11 +229,7 @@ on post-fs-data && property:vendor.skip.charger_not_need=0
     mkdir /data/vendor/ss 0700 system system
 
     # tmp dir for opencl Compiler
-<<<<<<< HEAD
-    setprop TMPDIR /data/vendor/.opencl-cache
-=======
     setprop vendor.TMPDIR /data/vendor/.opencl-cache
->>>>>>> post_merge/android-11.0.0_2.0.0
     mkdir /data/vendor/.opencl-cache 0771 system camera
 
 on zygote-start && property:vendor.skip.charger_not_need=0
diff --git a/imx8m/bigcypress_8mq/input-port-associations.xml b/imx8m/bigcypress_8mq/input-port-associations.xml
index 53d094cf..3be04a50 100644
--- a/imx8m/bigcypress_8mq/input-port-associations.xml
+++ b/imx8m/bigcypress_8mq/input-port-associations.xml
@@ -17,13 +17,6 @@ One display can link with multi-input.
 	<port display="1" input="usb-xhci-hcd.1.auto-1.4/input0" />
 	<port display="0" input="usb-xhci-hcd.2.auto-1.4/input0" />
 	<port display="1" input="usb-xhci-hcd.2.auto-1.4/input0" />
-<<<<<<< HEAD
 	<port display="0" input="usb-xhci-hcd.1.auto-1.2/input1" />
 	<port display="1" input="usb-xhci-hcd.1.auto-1.3.4/input0" />
-=======
-	<port display="0" input="usb-xhci-hcd.1.auto-1.3.4/input0" />
-	<port display="1" input="usb-xhci-hcd.1.auto-1.3.4/input0" />
-	<port display="0" input="usb-xhci-hcd.2.auto-1.3.4/input0" />
-	<port display="1" input="usb-xhci-hcd.2.auto-1.3.4/input0" />
->>>>>>> post_merge/android-11.0.0_2.0.0
 </ports>
diff --git a/imx8m/bigcypress_8mq/manifest.xml b/imx8m/bigcypress_8mq/manifest.xml
index 5eed04eb..adad2fd1 100644
--- a/imx8m/bigcypress_8mq/manifest.xml
+++ b/imx8m/bigcypress_8mq/manifest.xml
@@ -1,10 +1,10 @@
-<manifest version="1.0" type="device" target-level="4">
+<manifest version="1.0" type="device" target-level="5">
     <kernel  target-level="5" />
     <hal format="hidl">
 	<name>android.hardware.graphics.allocator</name>
         <transport>hwbinder</transport>
 	<impl level="generic"></impl>
-	<version>2.0</version>
+	<version>4.0</version>
 	<interface>
 	    <name>IAllocator</name>
 	    <instance>default</instance>
@@ -36,14 +36,12 @@
     <hal format="hidl">
         <name>android.hardware.drm</name>
         <transport>hwbinder</transport>
-        <version>1.0</version>
+        <version>1.3</version>
         <interface>
             <name>ICryptoFactory</name>
-            <instance>default</instance>
         </interface>
         <interface>
             <name>IDrmFactory</name>
-            <instance>default</instance>
         </interface>
         <fqname>@1.3::ICryptoFactory/clearkey</fqname>
         <fqname>@1.3::IDrmFactory/clearkey</fqname>
@@ -61,7 +59,7 @@
         <name>android.hardware.graphics.mapper</name>
         <transport arch="32+64">passthrough</transport>
         <impl level="generic"></impl>
-        <version>2.1</version>
+        <version>4.0</version>
         <interface>
             <name>IMapper</name>
             <instance>default</instance>
@@ -85,15 +83,6 @@
             <instance>default</instance>
         </interface>
     </hal>
-    <hal format="hidl">
-        <name>android.hardware.configstore</name>
-        <transport>hwbinder</transport>
-        <version>1.1</version>
-        <interface>
-            <name>ISurfaceFlingerConfigs</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
     <hal format="hidl">
         <name>android.hardware.media.c2</name>
         <transport>hwbinder</transport>
@@ -116,15 +105,6 @@
             <instance>default</instance>
         </interface>
     </hal>
-    <hal format="hidl">
-        <name>android.hardware.light</name>
-        <transport>hwbinder</transport>
-        <version>2.0</version>
-        <interface>
-            <name>ILight</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
     <hal format="hidl">
         <name>android.hardware.audio</name>
         <transport>hwbinder</transport>
diff --git a/imx8m/bigcypress_8mq/manifest.xml~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mq/manifest.xml~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 9dab44ed..00000000
--- a/imx8m/bigcypress_8mq/manifest.xml~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,153 +0,0 @@
-<manifest version="1.0" type="device" target-level="5">
-    <kernel  target-level="5" />
-    <hal format="hidl">
-	<name>android.hardware.graphics.allocator</name>
-        <transport>hwbinder</transport>
-	<impl level="generic"></impl>
-	<version>4.0</version>
-	<interface>
-	    <name>IAllocator</name>
-	    <instance>default</instance>
-	</interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.graphics.composer</name>
-        <transport>hwbinder</transport>
-        <version>2.4</version>
-        <interface>
-            <name>IComposer</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-       <name>android.hardware.camera.provider</name>
-       <transport>hwbinder</transport>
-       <fqname>@2.4::ICameraProvider/external/0</fqname>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.keymaster</name>
-        <transport>hwbinder</transport>
-        <version>4.0</version>
-        <interface>
-            <name>IKeymasterDevice</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.drm</name>
-        <transport>hwbinder</transport>
-        <version>1.3</version>
-        <interface>
-            <name>ICryptoFactory</name>
-        </interface>
-        <interface>
-            <name>IDrmFactory</name>
-        </interface>
-        <fqname>@1.3::ICryptoFactory/clearkey</fqname>
-        <fqname>@1.3::IDrmFactory/clearkey</fqname>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.gatekeeper</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IGatekeeper</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.graphics.mapper</name>
-        <transport arch="32+64">passthrough</transport>
-        <impl level="generic"></impl>
-        <version>4.0</version>
-        <interface>
-            <name>IMapper</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.renderscript</name>
-        <transport arch="32+64">passthrough</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IDevice</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.media.c2</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IComponentStore</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.media.omx</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IOmx</name>
-            <instance>default</instance>
-        </interface>
-        <interface>
-            <name>IOmxStore</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.memtrack</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IMemtrack</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.audio</name>
-        <transport>hwbinder</transport>
-        <version>6.0</version>
-        <interface>
-            <name>IDevicesFactory</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.audio.effect</name>
-        <transport>hwbinder</transport>
-        <version>6.0</version>
-        <interface>
-            <name>IEffectsFactory</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.bluetooth</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IBluetoothHci</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.dumpstate</name>
-        <transport>hwbinder</transport>
-        <version>1.1</version>
-        <interface>
-            <name>IDumpstateDevice</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>nxp.hardware.display</name>
-            <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IDisplay</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-</manifest>
diff --git a/imx8m/bigcypress_8mq/overlay/frameworks/base/core/res/res/values/config.xml~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mq/overlay/frameworks/base/core/res/res/values/config.xml~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index be3cd041..00000000
--- a/imx8m/bigcypress_8mq/overlay/frameworks/base/core/res/res/values/config.xml~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,193 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-/*
-** Copyright 2011, The Android Open Source Project
-**
-** Licensed under the Apache License, Version 2.0 (the "License");
-** you may not use this file except in compliance with the License.
-** You may obtain a copy of the License at
-**
-**     http://www.apache.org/licenses/LICENSE-2.0
-**
-** Unless required by applicable law or agreed to in writing, software
-** distributed under the License is distributed on an "AS IS" BASIS,
-** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-** See the License for the specific language governing permissions and
-** limitations under the License.
-*/
--->
-
-<!-- These resources are around just to allow their values to be customized
-     for different hardware and product builds. -->
-<resources>
-
-    <!--For Android we support eth0 now -->
-    <string translatable="false" name="config_ethernet_iface_regex">eth0</string>
-
-    <!-- List of regexpressions describing the interface (if any) that represent tetherable
-         USB interfaces.  If the device doesn't want to support tething over USB this should
-         be empty.  An example would be "usb.*" -->
-     <string-array translatable="false" name="config_tether_usb_regexs">
-       <item>usb0</item>
-     </string-array>
-
-    <!-- List of regexpressions describing the interface (if any) that represent tetherable
-         Wifi interfaces.  If the device doesn't want to support tethering over Wifi this
-         should be empty.  An example would be "softap.*" -->
-    <string-array translatable="false" name="config_tether_wifi_regexs">
-      <item>"wlan0"</item>
-    </string-array>
-
-    <!-- List of regexpressions describing the interface (if any) that represent tetherable
-         bluetooth interfaces.  If the device doesn't want to support tethering over bluetooth this
-         should be empty. -->
-    <string-array translatable="false" name="config_tether_bluetooth_regexs">
-        <item>"bt-pan"</item>
-        </string-array>
-
-    <!-- Array of ConnectivityManager.TYPE_xxxx values allowable for tethering -->
-    <!-- Common options are [1, 4] for TYPE_WIFI and TYPE_MOBILE_DUN or
-    <!== [0,1,5,7,9] for TYPE_MOBILE, TYPE_WIFI, TYPE_MOBILE_HIPRI, TYPE_BLUETOOTH and TYPE_ETHERNET -->
-    <integer-array translatable="false" name="config_tether_upstream_types">
-        <item>0</item>
-        <item>1</item>
-        <item>5</item>
-        <item>9</item>
-    </integer-array>
-
-    <!-- Flag indicating whether we should enable the automatic brightness in Settings.
-         config_hardware_automatic_brightness_available is not set, so we will use software implementation -->
-    <bool name="config_automatic_brightness_available">true</bool>
-
-    <!-- An Array of "[ConnectivityManager connectionType],
-                      [# simultaneous connection types]"  -->
-    <string-array translatable="false" name="radioAttributes">
-        <item>"1,1"</item>
-        <item>"9,1"</item>
-    </string-array>
-
-    <!-- An Array of "[Connection name],[ConnectivityManager.TYPE_xxxx],
-         [associated radio-type],[priority],[restoral-timer(ms)],[dependencyMet]  -->
-    <!-- the 5th element "resore-time" indicates the number of milliseconds to delay
-         before automatically restore the default connection.  Set -1 if the connection
-         does not require auto-restore. -->
-    <!-- the 6th element indicates boot-time dependency-met value. -->
-    <string-array translatable="false" name="networkAttributes">
-        <item>"wifi,1,1,1,-1,true"</item>
-        <item>"bluetooth,7,7,2,-1,true"</item>
-        <item>"ethernet,9,9,2,-1,true"</item>
-    </string-array>
-
-    <!-- Array of light sensor LUX values to define our levels for auto backlight brightness support.
-         The N entries of this array define N + 1 zones as follows:
-
-         Zone 0:        0 <= LUX < array[0]
-         Zone 1:        array[0] <= LUX < array[1]
-         ...
-         Zone N:        array[N - 1] <= LUX < array[N]
-         Zone N + 1:    array[N] <= LUX < infinity
-
-         Must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessLevels">
-        <item>5</item>
-        <item>15</item>
-        <item>50</item>
-        <item>100</item>
-        <item>200</item>
-        <item>400</item>
-        <item>1000</item>
-        <item>2000</item>
-        <item>3000</item>
-        <item>5000</item>
-        <item>10000</item>
-        <item>30000</item>
-    </integer-array>
-
-    <!-- Array of output values for LCD backlight corresponding to the LUX values
-         in the config_autoBrightnessLevels array.  This array should have size one greater
-         than the size of the config_autoBrightnessLevels array.
-         This must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessLcdBacklightValues">
-        <item>5</item>    <!-- 0-5 -->
-        <item>20</item>   <!-- 5-15 -->
-        <item>30</item>   <!-- 15-50 -->
-        <item>40</item>   <!-- 50-100 -->
-        <item>50</item>   <!-- 100-200 -->
-        <item>60</item>   <!-- 200-400 -->
-        <item>70</item>   <!-- 400-1000 -->
-        <item>80</item>   <!-- 1000-2000 -->
-        <item>130</item>  <!-- 2000-3000 -->
-        <item>180</item>  <!-- 3000-5000 -->
-        <item>255</item>  <!-- 5000-10000 -->
-        <item>255</item>  <!-- 10000-30000 -->
-        <item>255</item>  <!-- 30000+ -->
-    </integer-array>
-
-    <!-- Array of output values for button backlight corresponding to the LUX values
-         in the config_autoBrightnessLevels array.  This array should have size one greater
-         than the size of the config_autoBrightnessLevels array.
-         This must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessButtonBacklightValues">
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-    </integer-array>
-
-    <!-- Array of output values for keyboard backlight corresponding to the LUX values
-         in the config_autoBrightnessLevels array.  This array should have size one greater
-         than the size of the config_autoBrightnessLevels array.
-         This must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessKeyboardBacklightValues">
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-    </integer-array>
-
-    <integer name="config_screenBrightnessDim">5</integer>
-
-    <!--  Maximum number of supported users -->
-    <integer name="config_multiuserMaximumUsers">8</integer>
-    <!--  Whether Multiuser UI should be shown -->
-    <bool name="config_enableMultiUserUI">true</bool>
-
-    <!-- Whether a software navigation bar should be shown. NOTE: in the future this may be
-         autodetected from the Configuration. -->
-    <bool name="config_showNavigationBar">true</bool>
-
-    <!-- This device is not "voice capable"; it's data-only. -->
-    <bool name="config_voice_capable">false</bool>
-
-    <!-- Boolean indicating whether system support sustained performance mode. -->
-    <bool name="config_sustainedPerformanceModeSupported">true</bool>
-
-    <!-- If the system has the input method for each display - enable per-display focus. -->
-    <bool name="config_perDisplayFocusEnabled">true</bool>
-</resources>
diff --git a/imx8m/bigcypress_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml b/imx8m/bigcypress_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
index 87976f74..0bf9ee21 100644
--- a/imx8m/bigcypress_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
+++ b/imx8m/bigcypress_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
@@ -21,8 +21,5 @@
     <bool name="def_user_setup_complete">true</bool>
     <bool name="def_bluetooth_on">false</bool>
     <bool name="def_stay_on_while_plugged_in">true</bool>
-<<<<<<< HEAD
     <string name="def_immersive_mode_confirmations" translatable="false">confirmed</string>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </resources>
diff --git a/imx8m/bigcypress_8mq/powerhint_imx8mq.json b/imx8m/bigcypress_8mq/powerhint_imx8mq.json
index 275fa309..3d7db6ab 100644
--- a/imx8m/bigcypress_8mq/powerhint_imx8mq.json
+++ b/imx8m/bigcypress_8mq/powerhint_imx8mq.json
@@ -47,11 +47,7 @@
       "Name": "PowerHALMainState",
       "Path": "vendor.powerhal.camera",
       "Values": [
-<<<<<<< HEAD
-        "CAMERA_STREAMING",
-=======
         "CAMERA_STREAMING_MID",
->>>>>>> post_merge/android-11.0.0_2.0.0
         ""
       ],
       "Type": "Property"
@@ -60,11 +56,7 @@
       "Name": "PowerHALAudioState",
       "Path": "vendor.powerhal.audio",
       "Values": [
-<<<<<<< HEAD
-        "AUDIO_LOW_LATENCY",
-=======
         "AUDIO_STREAMING_LOW_LATENCY",
->>>>>>> post_merge/android-11.0.0_2.0.0
         ""
       ],
       "Type": "Property"
@@ -141,15 +133,6 @@
       "Value": "0"
     },
     {
-<<<<<<< HEAD
-      "PowerHint": "CAMERA_STREAMING",
-      "Node": "PowerHALMainState",
-      "Duration": 0,
-      "Value": "CAMERA_STREAMING"
-    },
-    {
-      "PowerHint": "CAMERA_STREAMING",
-=======
       "PowerHint": "CAMERA_STREAMING_MID",
       "Node": "PowerHALMainState",
       "Duration": 0,
@@ -157,7 +140,6 @@
     },
     {
       "PowerHint": "CAMERA_STREAMING_MID",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "Node": "CPULittleClusterMaxFreq",
       "Duration": 0,
       "Value": "1300000"
@@ -193,30 +175,6 @@
       "Value": "1300000"
     },
     {
-<<<<<<< HEAD
-      "PowerHint": "AUDIO_STREAMING",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 2000,
-      "Value": "0"
-    },
-    {
-      "PowerHint": "AUDIO_STREAMING",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 2000,
-      "Value": "1000000"
-    },
-    {
-      "PowerHint": "AUDIO_LOW_LATENCY",
-      "Node": "PowerHALAudioState",
-      "Duration": 0,
-      "Value": "AUDIO_LOW_LATENCY"
-    },
-    {
-      "PowerHint": "AUDIO_LOW_LATENCY",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 0,
-      "Value": "0"
-=======
       "PowerHint": "AUDIO_STREAMING_LOW_LATENCY",
       "Node": "PowerHALAudioState",
       "Duration": 0,
@@ -239,7 +197,6 @@
       "Node": "CPULittleClusterMinFreq",
       "Duration": 0,
       "Value": "1300000"
->>>>>>> post_merge/android-11.0.0_2.0.0
     }
   ]
 }
diff --git a/imx8m/bigcypress_8mq/sepolicy/file_contexts b/imx8m/bigcypress_8mq/sepolicy/file_contexts
index 37b378a6..586e5185 100644
--- a/imx8m/bigcypress_8mq/sepolicy/file_contexts
+++ b/imx8m/bigcypress_8mq/sepolicy/file_contexts
@@ -1,50 +1,3 @@
-<<<<<<< HEAD
-#sd boot
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/misc        u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/metadata    u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/presistdata u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/userdata    u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/vbmeta_[ab]    u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/super            u:object_r:super_block_device:s0
-
-#emmc boot
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/misc             u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/metadata         u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/presistdata      u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/userdata         u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/vbmeta_[ab]      u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/super            u:object_r:super_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/bootloader_[ab]  u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/mem_info_[ab]    u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/idtechdata         u:object_r:idtechdata_block_device:s0
-
-# spl
-/dev/block/mmcblk0boot[01]            u:object_r:spl_block_device:s0
-/dev/block/mmcblk0boot[01]p[1-9]      u:object_r:spl_block_device:s0
-
-#peripheral
-/vendor/bin/magd                u:object_r:sensors_exec:s0
-/vendor/bin/fsl_sensor_fusion   u:object_r:sensors_exec:s0
-/dev/mma8x5x                    u:object_r:sensors_device:s0
-/dev/ttymxc[0-9]*               u:object_r:tty_device:s0
-/dev/FreescaleAccelerometer     u:object_r:sensors_device:s0
-/dev/FreescaleMagnetometer      u:object_r:sensors_device:s0
-/dev/FreescaleGyroscope         u:object_r:sensors_device:s0
-/dev/sda[0-8]*                  u:object_r:fuse:s0
-
-#Neural Network HAL service
-/vendor/bin/hw/android\.hardware\.neuralnetworks@1\.2-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
-=======
 /dev/block/mmcblk0boot0                      u:object_r:emmc_boot0:s0
 /dev/block/mmcblk1                           u:object_r:sdcard:s0
 
@@ -55,13 +8,11 @@
 
 #Neural Network HAL service
 /vendor/bin/hw/android\.hardware\.neuralnetworks@1\.3-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 #Thermal HAL service
 /vendor/bin/hw/android\.hardware\.thermal@2\.0-service.imx         u:object_r:hal_thermal_default_exec:s0
 
 /vendor/bin/hw/android\.hardware\.media\.c2@1\.0-service    u:object_r:mediacodec_exec:s0
-<<<<<<< HEAD
 
 #Kiosk Led file node
 /sys/devices/platform/leds/leds/(.*)/brightness     u:object_r:sysfs_idtech_kioskleds:s0
@@ -70,5 +21,3 @@
 /sys/devices/platform/leds/leds/(.*)/delay_off      u:object_r:sysfs_idtech_kioskleds:s0
 /vendor/bin/hw/android\.hardware\.kioskled@1\.0-service        u:object_r:hal_kioskled_default_exec:s0
 /vendor/bin/hw/android\.hardware\.kioskled-service             u:object_r:hal_kioskled_default_exec:s0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/bigcypress_8mq/sepolicy/genfs_contexts b/imx8m/bigcypress_8mq/sepolicy/genfs_contexts
index 51ab0e22..46f70e2c 100644
--- a/imx8m/bigcypress_8mq/sepolicy/genfs_contexts
+++ b/imx8m/bigcypress_8mq/sepolicy/genfs_contexts
@@ -1,31 +1,3 @@
-<<<<<<< HEAD
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/hctosys     u:object_r:sysfs_rtc:s0
-
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a20000.i2c/i2c-0/0-0050/power_supply u:object_r:sysfs_batteryinfo:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a20000.i2c/i2c-0/0-0050/extcon   u:object_r:sysfs_extcon:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30b40000.mmc/mmc_host/mmc0/mmc0:0001/block/mmcblk0 u:object_r:sysfs_block_devices:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30b50000.mmc/mmc_host/mmc1/mmc1:aaaa/block/mmcblk1 u:object_r:sysfs_block_devices:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30bb0000.spi/spi_master/spi3/spi3.0/mtd/mtd0/mtdblock u:object_r:sysfs_block_devices:s0
-
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a00000.mipi_dsi/30a00000.mipi_dsi.0/backlight u:object_r:sysfs_leds:s0
-genfscon sysfs /devices/platform/backlight/backlight/backlight u:object_r:sysfs_leds:s0
-
-#/sys/class/net
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30be0000.ethernet/net               u:object_r:sysfs_net:s0
-genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net u:object_r:sysfs_net:s0
-genfscon sysfs /devices/platform/soc@0/33c00000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net u:object_r:sysfs_net:s0
-
-
-# android.system.suspend@1.0-service
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30be0000.ethernet/net/eth0/wakeup0                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-powerkey/wakeup                         u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/wakeup                           u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/wakeup3                 u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/battery/wakeup4                                                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/usb/wakeup5                                                                           u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a20000.i2c/i2c-0/0-0050/power_supply/tcpm-source-psy-0-0050/wakeup6    u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/wakeup/wakeup7                           u:object_r:sysfs_wakeup:s0
-=======
 genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/hctosys     u:object_r:sysfs_rtc:s0
 
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30a20000.i2c/i2c-0/0-0050/power_supply u:object_r:sysfs_batteryinfo:s0
@@ -48,4 +20,6 @@ genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:
 genfscon sysfs /devices/virtual/power_supply/battery/wakeup4                                                                       u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/virtual/power_supply/usb/wakeup5                                                                           u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30a20000.i2c/i2c-0/0-0050/power_supply/tcpm-source-psy-0-0050/wakeup6    u:object_r:sysfs_wakeup:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
+genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/wakeup/wakeup7                           u:object_r:sysfs_wakeup:s0
+
+genfscon sysfs /devices/platform/backlight/backlight/backlight u:object_r:sysfs_leds:s0
diff --git a/imx8m/bigcypress_8mq/thermal_info_config_imx8mq.json b/imx8m/bigcypress_8mq/thermal_info_config_imx8mq.json
index 21b20736..758490bf 100755
--- a/imx8m/bigcypress_8mq/thermal_info_config_imx8mq.json
+++ b/imx8m/bigcypress_8mq/thermal_info_config_imx8mq.json
@@ -1,14 +1,18 @@
 {
+    "HotplugCPUs":[
+            "cpu2",
+            "cpu3"
+    ],
     "Sensors":[
         {
             "Name":"cpu-thermal",
             "Type":"CPU",
             "HotThreshold":[
                 "NAN",
-                "NAN",
-                "NAN",
-                85.0,
-                95.0,
+                80.0,
+                82.0,
+                86.0,
+                90.0,
                 "NAN",
                 "NAN"
             ],
diff --git a/imx8m/bigcypress_8mq/thermal_info_config_imx8mq.json~post_merge_android-11.0.0_2.0.0 b/imx8m/bigcypress_8mq/thermal_info_config_imx8mq.json~post_merge_android-11.0.0_2.0.0
deleted file mode 100755
index 758490bf..00000000
--- a/imx8m/bigcypress_8mq/thermal_info_config_imx8mq.json~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,59 +0,0 @@
-{
-    "HotplugCPUs":[
-            "cpu2",
-            "cpu3"
-    ],
-    "Sensors":[
-        {
-            "Name":"cpu-thermal",
-            "Type":"CPU",
-            "HotThreshold":[
-                "NAN",
-                80.0,
-                82.0,
-                86.0,
-                90.0,
-                "NAN",
-                "NAN"
-            ],
-            "HotHysteresis":[
-                2.0,
-                2.0,
-                2.0,
-                2.0,
-                2.0,
-                2.0,
-                2.0
-            ],
-            "VrThreshold":"NAN",
-            "Multiplier":0.001,
-            "Monitor":true
-        },
-        {
-            "Name":"battery",
-            "Type":"BATTERY",
-            "HotThreshold":[
-                "NAN",
-                "NAN",
-                "NAN",
-                "NAN",
-                "NAN",
-                "NAN",
-                "NAN"
-            ],
-            "VrThreshold":"NAN",
-            "Multiplier":0.001,
-            "Monitor":true
-        }
-    ],
-    "CoolingDevices":[
-        {
-            "Name":"thermal-devfreq-0",
-            "Type":"GPU"
-        },
-        {
-            "Name":"thermal-cpufreq-0",
-            "Type":"CPU"
-        }
-    ]
-}
diff --git a/imx8m/bigcypress_8mq/ueventd.nxp.rc b/imx8m/bigcypress_8mq/ueventd.nxp.rc
index a51ba7de..a267eeba 100644
--- a/imx8m/bigcypress_8mq/ueventd.nxp.rc
+++ b/imx8m/bigcypress_8mq/ueventd.nxp.rc
@@ -1,18 +1,9 @@
-<<<<<<< HEAD
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/presistdata 0600   system     system
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/presistdata 0600   system     system
-/dev/ttymxc2              0660   bluetooth  bluetooth
-/dev/snd/*                0660   system     audio
-/dev/video*               0660   system     camera
-/dev/mxc_hantro           0660   media      drmrpc
-=======
 /dev/block/by-name/presistdata 0600   system     system
 /dev/ttymxc2              0660   bluetooth  bluetooth
 /dev/snd/*                0660   system     audio
 /dev/video*               0660   system     camera
 /dev/mxc_hantro           0666   media      drmrpc
 /dev/vsi_daemon_ctrl      0666   media      drmrpc
->>>>>>> post_merge/android-11.0.0_2.0.0
 /dev/imxdpu               0660   media      drmrpc
 /dev/ion                  0666   media      drmrpc
 /dev/galcore              0666 	 system     graphics
@@ -26,7 +17,6 @@
 
 /sys/devices/virtual/thermal/thermal_zone* trip_point_0_hyst 0660 system system
 /sys/devices/virtual/thermal/thermal_zone* trip_point_1_hyst 0660 system system
-<<<<<<< HEAD
 
 /dev/usb/lp0              0666   root         root
 
@@ -35,5 +25,3 @@
 /sys/class/leds/* trigger 0666 root root
 /sys/class/leds/* delay_on 0666 root root
 /sys/class/leds/* delay_off 0666 root root
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_8mn/BoardConfig.mk b/imx8m/evk_8mn/BoardConfig.mk
index d7734ef9..2b60d1cf 100644
--- a/imx8m/evk_8mn/BoardConfig.mk
+++ b/imx8m/evk_8mn/BoardConfig.mk
@@ -10,6 +10,7 @@ include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
 #
 
 BOARD_SOC_TYPE := IMX8MN
+BOARD_MAIN_DISPLAY_ROTATION := 0
 BOARD_HAVE_VPU := false
 HAVE_FSL_IMX_GPU2D := false
 HAVE_FSL_IMX_GPU3D := true
diff --git a/imx8m/evk_a100/AndroidBoard.mk b/imx8m/evk_a100/AndroidBoard.mk
index 2a37c0ca..84e328fe 100644
--- a/imx8m/evk_a100/AndroidBoard.mk
+++ b/imx8m/evk_a100/AndroidBoard.mk
@@ -1,16 +1,7 @@
 LOCAL_PATH := $(call my-dir)
 
-<<<<<<< HEAD
 include device/idtech/common/build/dtbo.mk
 include device/idtech/common/build/imx-recovery.mk
 include device/idtech/common/build/gpt.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
-=======
-include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
-include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
-include $(CONFIG_REPO_PATH)/common/build/gpt.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
--include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a100/BoardConfig.mk b/imx8m/evk_a100/BoardConfig.mk
index c70d08d8..70dda5fd 100644
--- a/imx8m/evk_a100/BoardConfig.mk
+++ b/imx8m/evk_a100/BoardConfig.mk
@@ -1,19 +1,8 @@
-<<<<<<< HEAD
-=======
-# -------@block_infrastructure-------
-#
-# Product-specific compile-time definitions.
-#
-
-include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 #
 # SoC-specific compile-time definitions.
 #
 
 BOARD_SOC_TYPE := IMX8MN
-<<<<<<< HEAD
 BOARD_SOM_TYPE := a100
 BOARD_TYPE := DEVBOARD
 BOARD_MAIN_DISPLAY_ROTATION := 0
@@ -33,20 +22,11 @@ ENABLE_CFI=false
 
 SOONG_CONFIG_IMXPLUGIN += \
                         BOARD_HAVE_VPU
-=======
-BOARD_HAVE_VPU := false
-HAVE_FSL_IMX_GPU2D := false
-HAVE_FSL_IMX_GPU3D := true
-HAVE_FSL_IMX_PXP := false
-TARGET_USES_HWC2 := true
-TARGET_HAVE_VULKAN := true
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 SOONG_CONFIG_IMXPLUGIN_BOARD_SOC_TYPE = IMX8MN
 SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU = false
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_ONLY = false
 
-<<<<<<< HEAD
 #
 # Product-specific compile-time definitions.
 #
@@ -92,70 +72,12 @@ TARGET_BOOTLOADER_BOARD_NAME := EVK
 USE_OPENGL_RENDERER := true
 
 BOARD_WLAN_DEVICE            := bcmdhd
-=======
-# -------@block_memory-------
-USE_ION_ALLOCATOR := true
-USE_GPU_ALLOCATOR := false
-
-# -------@block_storage-------
-TARGET_USERIMAGES_USE_EXT4 := true
-
-# use sparse image.
-TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
-
-# Support gpt
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab_super.bpt
-  ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
-                           partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
-else
-  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-no-product.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-no-product.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
-                             partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
-  else
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
-                             partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
-  endif
-endif
-
-BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-imx8mn.img
-
-BOARD_USES_METADATA_PARTITION := true
-BOARD_ROOT_EXTRA_FOLDERS += metadata
-
-# -------@block_security-------
-ENABLE_CFI=false
-
-BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA4096
-# The testkey_rsa4096.pem is copied from external/avb/test/data/testkey_rsa4096.pem
-BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/testkey_rsa4096.pem
-
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
-
-# -------@block_treble-------
-# Vendor Interface manifest and compatibility
-DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
-DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
-DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE := $(IMX_DEVICE_PATH)/device_framework_matrix.xml
-
-# -------@block_wifi-------
-BOARD_WLAN_DEVICE            := nxp
->>>>>>> post_merge/android-11.0.0_2.0.0
 WPA_SUPPLICANT_VERSION       := VER_0_8_X
 BOARD_WPA_SUPPLICANT_DRIVER  := NL80211
 BOARD_HOSTAPD_DRIVER         := NL80211
 BOARD_HOSTAPD_PRIVATE_LIB               := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 BOARD_WPA_SUPPLICANT_PRIVATE_LIB        := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 
-<<<<<<< HEAD
 WIFI_DRIVER_FW_PATH_PARAM := "/sys/module/brcmfmac/parameters/alternative_fw_path"
 
 #BOARD_USE_SENSOR_FUSION := true
@@ -182,45 +104,20 @@ TARGET_USES_MKE2FS := true
 
 # define frame buffer count
 NUM_FRAMEBUFFER_SURFACE_BUFFERS := 3
-=======
-WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-
-# -------@block_bluetooth-------
-# NXP 8987 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
-# -------@block_sensor-------
-BOARD_USE_SENSOR_FUSION := true
-
-# -------@block_kernel_bootimg-------
-BOARD_KERNEL_BASE := 0x40400000
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 CMASIZE=800M
 
 # NXP default config
-<<<<<<< HEAD
 BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardware=freescale firmware_class.path=/vendor/firmware loop.max_part=7
-=======
-BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardware=nxp firmware_class.path=/vendor/firmware loop.max_part=7
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # memory config
 BOARD_KERNEL_CMDLINE += transparent_hugepage=never
 
 # display config
-<<<<<<< HEAD
 BOARD_KERNEL_CMDLINE += androidboot.lcd_density=294 androidboot.primary_display=imx-drm
 
 # wifi config
 BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN
-=======
-BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-drm
-
-# wifi config
-BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_para_sd8987.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # low memory device build config
 ifeq ($(LOW_MEMORY),true)
@@ -229,7 +126,6 @@ else
 BOARD_KERNEL_CMDLINE += cma=$(CMASIZE)@0x400M-0xb80M
 endif
 
-<<<<<<< HEAD
 ifeq ($(TARGET_USERIMAGES_USE_UBIFS),true)
 ifeq ($(TARGET_USERIMAGES_USE_EXT4),true)
 $(error "TARGET_USERIMAGES_USE_UBIFS and TARGET_USERIMAGES_USE_EXT4 config open in same time, please only choose one target file system image")
@@ -239,18 +135,11 @@ endif
 LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
 LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
 BOARD_PREBUILT_DTBOIMAGE := out/target/product/evk_a100/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
-=======
-ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
-BOARD_KERNEL_CMDLINE += androidboot.vendor.sysrq=1
-endif
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG := imx8mn-ddr4:imx8mn-ddr4-evk-no-product.dtb
   else
-<<<<<<< HEAD
     # imx8mn with MIPI-HDMI display, BCM wifi and support trusty
     TARGET_BOARD_DTS_CONFIG := imx8mn-ddr4:imx8mn-ddr4-evk.dtb
     TARGET_BOARD_DTS_CONFIG += imx8mn:imx8mn-evk.dtb
@@ -261,18 +150,6 @@ ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
     # imx8mn with MIPI panel display and BCM wifi
     TARGET_BOARD_DTS_CONFIG += imx8mn-mipi-panel:imx8mn-evk-rm67191.dtb
     # imx8mn with MIPI-HDMI display and BCM wifi and M7 image
-=======
-    # imx8mn with MIPI-HDMI display, wifi and support trusty
-    TARGET_BOARD_DTS_CONFIG := imx8mn-ddr4:imx8mn-ddr4-evk.dtb
-    TARGET_BOARD_DTS_CONFIG += imx8mn:imx8mn-evk.dtb
-    # imx8mn with MIPI panel display and wifi
-    TARGET_BOARD_DTS_CONFIG += imx8mn-ddr4-mipi-panel:imx8mn-ddr4-evk-rm67191.dtb
-    # imx8mn with MIPI-HDMI display and wifi and M7 image
-    TARGET_BOARD_DTS_CONFIG += imx8mn-ddr4-rpmsg:imx8mn-ddr4-evk-rpmsg.dtb
-    # imx8mn with MIPI panel display and wifi
-    TARGET_BOARD_DTS_CONFIG += imx8mn-mipi-panel:imx8mn-evk-rm67191.dtb
-    # imx8mn with MIPI-HDMI display and wifi and M7 image
->>>>>>> post_merge/android-11.0.0_2.0.0
     TARGET_BOARD_DTS_CONFIG += imx8mn-rpmsg:imx8mn-evk-rpmsg.dtb
   endif
 else
@@ -283,7 +160,6 @@ else
   endif
 endif
 
-<<<<<<< HEAD
 BOARD_SEPOLICY_DIRS := \
        device/idtech/imx8m/sepolicy \
        $(IMX_DEVICE_PATH)/sepolicy
@@ -296,12 +172,3 @@ BOARD_USES_METADATA_PARTITION := true
 BOARD_ROOT_EXTRA_FOLDERS += metadata
 
 BOARD_PLAT_PRIVATE_SEPOLICY_DIR := device/idtech/imx8m/sepolicy_system/private
-=======
-ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
-
-# -------@block_sepolicy-------
-BOARD_SEPOLICY_DIRS := \
-       $(CONFIG_REPO_PATH)/imx8m/sepolicy \
-       $(IMX_DEVICE_PATH)/sepolicy
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a100/android_addition_defconfig b/imx8m/evk_a100/android_addition_defconfig
index 4841ff13..af03a131 100644
--- a/imx8m/evk_a100/android_addition_defconfig
+++ b/imx8m/evk_a100/android_addition_defconfig
@@ -1,4 +1,3 @@
-<<<<<<< HEAD
 CONFIG_WLAN_VENDOR_NXP=y
 CONFIG_MXMWIFIEX=m
 CONFIG_CLD_HL_SDIO_CORE=y
@@ -250,7 +249,3 @@ CONFIG_BCM_SBA_RAID=m
 # CONFIG_MMC_SDHCI_MSM is not set
 # CONFIG_MMC_SDHI is not set
 # CONFIG_MMC_DW_EXYNOS is not set
-=======
-CONFIG_LIBNVDIMM=y
-CONFIG_OF_PMEM=y
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a100/camera_config_imx8mn.json b/imx8m/evk_a100/camera_config_imx8mn.json
index d24519d9..b3713f24 100644
--- a/imx8m/evk_a100/camera_config_imx8mn.json
+++ b/imx8m/evk_a100/camera_config_imx8mn.json
@@ -10,7 +10,6 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
       "camera_name": "mxc-isi-cap",
       "orientation": "0",
       "buffer_type": "dma",
@@ -38,20 +37,6 @@
       "PhysicalHeight": "1.512",
       "FocalLength": "3.42",
       "MaxJpegSize": "4194304",
-=======
-      "camera_name": "mxc_isi.0.capture",
-      "orientation": "0",
-      "mplane": "1",
-      "buffer_type": "dma",
-      "ActiveArrayWidth": "2592",
-      "ActiveArrayHeight": "1944",
-      "PixelArrayWidth": "2592",
-      "PixelArrayHeight": "1944",
-      "PhysicalWidth": "3.6288",
-      "PhysicalHeight": "2.7216",
-      "FocalLength": "3.37",
-      "MaxJpegSize": "8388608",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "MinFrameDuration": "33331760",
       "MaxFrameDuration": "300000000"
     }
diff --git a/imx8m/evk_a100/evk_8mn.mk b/imx8m/evk_a100/evk_8mn.mk
index d1ecc763..ad643048 100644
--- a/imx8m/evk_a100/evk_8mn.mk
+++ b/imx8m/evk_a100/evk_8mn.mk
@@ -1,39 +1,23 @@
-<<<<<<< HEAD
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
 IMX_DEVICE_PATH := device/fsl/imx8m/evk_8mn
-=======
-# -------@block_infrastructure-------
-
-CONFIG_REPO_PATH := device/nxp
-CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
-IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # configs shared between uboot, kernel and Android rootfs
 include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
 
-<<<<<<< HEAD
 -include device/fsl/common/imx_path/ImxPathConfig.mk
 include device/fsl/imx8m/ProductConfigCommon.mk
 
 ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.freescale),)
 $(shell touch $(IMX_DEVICE_PATH)/fstab.freescale)
 endif
-=======
--include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
-include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
-
-# -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # Overrides
 PRODUCT_NAME := evk_8mn
 PRODUCT_DEVICE := evk_8mn
 PRODUCT_MODEL := EVK_8MN
 
-<<<<<<< HEAD
 PRODUCT_FULL_TREBLE_OVERRIDE := true
 
 #Enable this to choose 32 bit user space build
@@ -65,118 +49,11 @@ ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   endif
 endif
 
-=======
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-PRODUCT_CHARACTERISTICS := tablet
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# -------@block_treble-------
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-
-# -------@block_power-------
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/powerhint_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mn.json
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-PRODUCT_PACKAGES += \
-    android.hardware.power-service.imx
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mn.json
-
-# -------@block_app-------
-#Enable this to choose 32 bit user space build
-IMX8_BUILD_32BIT_ROOTFS := false
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml
-
-# -------@block_kernel_bootimg-------
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh
-
-# -------@block_storage-------
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
-  PRODUCT_USE_DYNAMIC_PARTITIONS := true
-  BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
-  BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-endif
-
-#Enable this to disable product partition build.
-IMX_NO_PRODUCT_PARTITION := false
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
-  PRODUCT_PACKAGES += imx_ota_postinstall
-
-  AB_OTA_POSTINSTALL_CONFIG += \
-    RUN_POSTINSTALL_vendor=true \
-    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
-    FILESYSTEM_TYPE_vendor=ext4 \
-    POSTINSTALL_OPTIONAL_vendor=false
-
-  PRODUCT_COPY_FILES += \
-    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mn-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
-endif
-
-# fastboot_imx_flashall scripts, imx-sdcard-partition script uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# -------@block_security-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Include keystore attestation keys and certificates.
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 -include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
 endif
 
-<<<<<<< HEAD
 # Include Android Go config for low memory device.
 ifeq ($(LOW_MEMORY),true)
 $(call inherit-product, build/target/product/go_defaults.mk)
@@ -298,155 +175,27 @@ PRODUCT_PACKAGES += \
     android.hardware.graphics.mapper@2.0-impl-2.1 \
     android.hardware.graphics.allocator@2.0-impl \
     android.hardware.graphics.allocator@2.0-service
-=======
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# Keymaster HAL
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.3-service.clearkey \
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-# Resume on Reboot support
-PRODUCT_PACKAGES += \
-    android.hardware.rebootescrow-service.default
-
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rebootescrow.device=/dev/block/pmem0
-
-# -------@block_audio-------
-# Audio card json
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32
-
-PRODUCT_COPY_FILES += \
-    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mn/imx8mn_mcu_demo.img:imx8mn_mcu_demo.img \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml
-
-# -------@block_camera-------
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/camera_config_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mn.json
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-# -------@block_display-------
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# HWC2 HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.composer@2.4-service
-
-
-# define frame buffer count
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@4.0-impl.imx \
-    android.hardware.graphics.allocator@4.0-service.imx
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # RenderScript HAL
 PRODUCT_PACKAGES += \
     android.hardware.renderscript@1.0-impl
 
 PRODUCT_PACKAGES += \
-<<<<<<< HEAD
     libEGL_VIVANTE \
     libGLESv1_CM_VIVANTE \
     libGLESv2_VIVANTE \
     gralloc_viv.imx \
-=======
-    libg2d-opencl
-
-# -------@block_gpu-------
-
-PRODUCT_PACKAGES += \
-    libEGL_VIVANTE \
-    libGLESv1_CM_VIVANTE \
-    libGLESv2_VIVANTE \
-    gralloc_viv.$(TARGET_BOARD_PLATFORM) \
->>>>>>> post_merge/android-11.0.0_2.0.0
     libGAL \
     libGLSLC \
     libVSC \
     libgpuhelper \
     libSPIRV_viv \
     libvulkan_VIVANTE \
-<<<<<<< HEAD
     vulkan.imx \
     libCLC \
     libLLVM_viv \
     libOpenCL \
     libg2d-opencl \
-=======
-    vulkan.$(TARGET_BOARD_PLATFORM) \
-    libCLC \
-    libLLVM_viv \
-    libOpenCL \
->>>>>>> post_merge/android-11.0.0_2.0.0
     libg2d-viv \
     libOpenVX \
     libOpenVXU \
@@ -461,7 +210,6 @@ PRODUCT_PACKAGES += \
     libNNGPUBinary-lite \
     libNNGPUBinary-ulite \
     libNNArchPerf \
-<<<<<<< HEAD
     libarchmodelSw \
     gatekeeper.imx
 
@@ -499,48 +247,22 @@ PRODUCT_PACKAGES += \
 # NXP 8987 Bluetooth vendor config
 PRODUCT_PACKAGES += \
     bt_vendor.conf
-=======
-    libarchmodelSw
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# -------@block_wifi-------
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # WiFi HAL
 PRODUCT_PACKAGES += \
     android.hardware.wifi@1.0-service \
-<<<<<<< HEAD
     wifilogd \
     wificond
 
 # NXP 8987 Wifi and Bluetooth Combo Firmware
 PRODUCT_COPY_FILES += \
     vendor/nxp/imx-firmware/nxp/FwImage_8987/sdiouart8987_combo_v0.bin:vendor/firmware/sdiouart8987_combo_v0.bin
-=======
-    wificond
-
-# WiFi RROs
-PRODUCT_PACKAGES += \
-    WifiOverlay
-
-# NXP 8987 Wifi and Bluetooth Combo Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8987/sdiouart8987_combo_v0.bin:vendor/firmware/sdiouart8987_combo_v0.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para_sd8987.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # Wifi regulatory
 PRODUCT_COPY_FILES += \
     external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
     external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
 
-<<<<<<< HEAD
 # Keymaster HAL
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 PRODUCT_PACKAGES += \
@@ -570,38 +292,10 @@ endif
 # ro.product.first_api_level indicates the first api level the device has commercially launched on.
 PRODUCT_PROPERTY_OVERRIDES += \
     ro.product.first_api_level=28
-=======
-# -------@block_bluetooth-------
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-# NXP 8987 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# -------@block_usb-------
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
-
-# -------@block_multimedia_codec-------
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 PRODUCT_PACKAGES += \
     DirectAudioPlayer
 
-<<<<<<< HEAD
 # Add oem unlocking option in settings.
 PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
 PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
@@ -637,13 +331,6 @@ PRODUCT_PACKAGES += \
 endif
 
 IMX-DEFAULT-G2D-LIB := libg2d-opencl
-=======
-# imx c2 codec binary
-PRODUCT_PACKAGES += \
-    c2_component_register \
-    c2_component_register_ms \
-    c2_component_register_ra
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
@@ -652,7 +339,6 @@ endif
 -include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
 endif
 
-<<<<<<< HEAD
 # imx c2 codec binary
 PRODUCT_PACKAGES += \
     c2_component_register \
@@ -660,64 +346,3 @@ PRODUCT_PACKAGES += \
     c2_component_register_ra
 
 $(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-=======
-# -------@block_memory-------
-# Include Android Go config for low memory device.
-ifeq ($(LOW_MEMORY),true)
-$(call inherit-product, build/target/product/go_defaults.mk)
-endif
-
-# -------@block_neural_network-------
-# Neural Network HAL and Lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# -------@block_miscellaneous-------
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.imx8mn.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mn.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a100/init.imx8mn.rc b/imx8m/evk_a100/init.imx8mn.rc
index 0a7d497f..9eabc266 100755
--- a/imx8m/evk_a100/init.imx8mn.rc
+++ b/imx8m/evk_a100/init.imx8mn.rc
@@ -7,11 +7,7 @@ on early-boot
     write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
 
     # Set NN reject model by weights md5
-<<<<<<< HEAD
     setprop WEIGHT_MD5_CHECK 1
-=======
-    setprop vendor.MODEL_BLOCK_LEVEL 1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # change for FSL specific service
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
@@ -23,13 +19,6 @@ on early-boot
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
-<<<<<<< HEAD
-=======
-    chown root system /sys/devices/system/cpu/cpu2/online
-    chmod 0664 /sys/devices/system/cpu/cpu2/online
-    chown root system /sys/devices/system/cpu/cpu3/online
-    chmod 0664 /sys/devices/system/cpu/cpu3/online
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on property:sys.boot_completed=1
     # Set default CPU frequency governor
@@ -39,10 +28,6 @@ on property:sys.boot_completed=1
     # Set up and down limit to 200us/200us
     write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 200
     write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 200
-<<<<<<< HEAD
-=======
-    write /proc/sys/kernel/sched_util_clamp_min 512
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on property:sys.boot_completed=1
     # update cpuset now that processors are up
@@ -59,7 +44,6 @@ on property:sys.boot_completed=1
     # system-background is for system tasks that should only run on
     # little cores, not on bigs to be used only by init
     write /dev/cpuset/system-background/cpus 0-2
-<<<<<<< HEAD
 
 on init
     #IDtech added for AB ota update bootloader
@@ -67,5 +51,3 @@ on init
     symlink   /dev/block/mmcblk2boot1p1   /dev/block/by-name/spl_b
     symlink   /dev/block/mmcblk2boot0p2   /dev/block/by-name/spl_bak_a
     symlink   /dev/block/mmcblk2boot1p2   /dev/block/by-name/spl_bak_b
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a100/init.rc b/imx8m/evk_a100/init.rc
index a70a2cb8..bd433731 100644
--- a/imx8m/evk_a100/init.rc
+++ b/imx8m/evk_a100/init.rc
@@ -1,28 +1,11 @@
 import /vendor/etc/init/hw/init.${ro.hardware}.usb.rc
 import /vendor/etc/init/hw/init.${ro.hardware}.${ro.boot.soc_type}.rc
-<<<<<<< HEAD
 import /init.idtech.rc
-=======
-
-service vendor.charger /system/bin/charger
-    class charger
-    user system
-    group system wakelock input
-    capabilities SYS_BOOT
-    file /dev/kmsg w
-    file /sys/fs/pstore/console-ramoops-0 r
-    file /sys/fs/pstore/console-ramoops r
-    file /proc/last_kmsg r
-
-on charger
-    start vendor.charger
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on early-init
     # mount the debugfs
     mount debugfs none /sys/kernel/debug/ mode=0755
 
-<<<<<<< HEAD
     # Mount binderfs
     mkdir /dev/binderfs
     mount binder binder /dev/binderfs stats=global
@@ -39,12 +22,6 @@ on early-init
 
 on early-init
     start early_init_sh
-=======
-on early-init
-    start early_init_sh
-    # Set the host name which used in console
-    export HOSTNAME evk_8mn
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Due keymaster start very early so set prop here
     # Also gatekeeper share same role for keymaster
@@ -52,32 +29,18 @@ on early-init
     setprop ro.hardware.gatekeeper ${ro.boot.keystore}
     setprop vendor.storageproxyd ${ro.boot.keystore}
 
-<<<<<<< HEAD
 on init
-=======
-    # Use ro.boot.lcd_density to override ro.sf.lcd_density
-    setprop ro.sf.lcd_density ${ro.boot.lcd_density}
-
-# Skip charger_not_need trigger for charger mode
-on early-init && property:ro.boot.mode=charger
-    setprop vendor.skip.charger_not_need 1
-
-on init && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     start watchdogd
 
     # Support legacy paths
     symlink /sdcard /mnt/sdcard
     symlink /sdcard /storage/sdcard0
 
-<<<<<<< HEAD
     # setup the global environment
     export CORE_REGISTER_FILE /vendor/etc/core_register
     export COMPONENT_REGISTER_FILE /vendor/etc/component_register
     export CONTENTPIPE_REGISTER_FILE /vendor/etc/contentpipe_register
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     # disable cursor blink for fbcon, if no splash screen support
     write /sys/class/graphics/fbcon/cursor_blink 0
 
@@ -103,7 +66,6 @@ on init && property:vendor.skip.charger_not_need=0
     write /dev/stune/rt/schedtune.boost 50
     write /dev/stune/rt/schedtune.prefer_idle 1
 
-<<<<<<< HEAD
 on late-fs
     # Start keymaster service
     start vendor.keymaster-3-0-${ro.boot.keystore}
@@ -115,29 +77,11 @@ on late-fs && property:vendor.storageproxyd=trusty
     start vendor.oemlock-1-0
 
 on early-boot
-=======
-on late-fs && property:vendor.skip.charger_not_need=0
-    # Start keymaster/gatekeeper service
-    start vendor.gatekeeper-1-0-${ro.boot.keystore}
-    start vendor.keymaster-4-0-${ro.boot.keystore}
-    setprop vendor.powerhal.init 1
-
-    # Wait for keymaster
-    exec_start wait_for_keymaster
-
-    mount_all /vendor/etc/fstab.nxp --late
-
-on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
-    start vendor.oemlock-1-0
-
-on early-boot && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     # For evk_8mn, when swap used about 400M, upgrade the level.
     setprop ro.lmk.upgrade_pressure 80
     setprop ro.lmk.downgrade_pressure 95
     setprop ro.lmk.critical_upgrade true
 
-<<<<<<< HEAD
     # Set the host name which used in console
     export HOSTNAME evk_a100
 
@@ -152,13 +96,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # fsl omx graphic manager media framework property
     setprop rw.VIDEO_RENDER_NAME video_render.surface
     setprop media.fsl_codec.flag 7
-=======
-    setprop vendor.hwc.stretch.filter  1
-
-    # fsl omx graphic manager media framework property
-    setprop vendor.rw.VIDEO_RENDER_NAME video_render.surface
-    setprop vendor.media.fsl_codec.flag 7
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     setprop camera.disable_zsl_mode 1
 
@@ -169,7 +106,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     write /sys/block/mmcblk1/queue/read_ahead_kb 2048
     write /sys/block/mmcblk2/queue/read_ahead_kb 2048
 
-<<<<<<< HEAD
     # Set period_us for usb audio
     setprop ro.audio.usb.period_us 20000
 
@@ -192,12 +128,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
 
     # prepare for ril
     setprop ro.ril.wake_lock_timeout 300
-=======
-    # Prepare for wifi
-    setprop wifi.interface wlan0
-    setprop wifi.direct.interface p2p0
-    setprop wifi.concurrent.interface wlan1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Set tracefs permission to 755
     chmod 0755 /sys/kernel/debug/tracing
@@ -207,7 +137,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0664 /sys/kernel/debug/sync/sw_sync
 
     # Default backlight device
-<<<<<<< HEAD
     #setprop hw.backlight.dev "32e10000.dsi_controller.0"
     setprop hw.backlight.dev "backlight"
     # Chmod/chown FSL specific sys entry
@@ -230,16 +159,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
 
     # Dectect DSF streams when scanning media
     setprop ro.FSL_DSF_PARSER 1
-=======
-    setprop vendor.hw.backlight.dev "32e10000.dsi_controller.0"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/32e10000.dsi_controller.0/brightness
-    chmod 0660 /sys/class/backlight/32e10000.dsi_controller.0/brightness
-
-    # Set light sensor sysfs path and light sensor threshold lux value
-    setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
-    setprop vendor.ro.lightsensor.threshold  20
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Allow DSD file(duration larger than 10s) can play
     setprop audio.offload.min.duration.secs 10
@@ -247,12 +166,9 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # Enlarge limition of audio buffer allocation
     setprop ro.af.client_heap_size_kbyte 32768
 
-<<<<<<< HEAD
     # enlarge media max memory size to 3G.
     setprop ro.media.maxmem 3221225471
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     start vendor.wifi_hal_legacy
 
 
@@ -262,10 +178,6 @@ service wpa_supplicant /vendor/bin/hw/wpa_supplicant \
     interface android.hardware.wifi.supplicant@1.0::ISupplicant default
     interface android.hardware.wifi.supplicant@1.1::ISupplicant default
     interface android.hardware.wifi.supplicant@1.2::ISupplicant default
-<<<<<<< HEAD
-=======
-    interface android.hardware.wifi.supplicant@1.3::ISupplicant default
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     socket wpa_wlan0 dgram 660 wifi wifi
     disabled
@@ -275,7 +187,6 @@ service sensor_fusion /vendor/bin/fsl_sensor_fusion
     class late_start
     seclabel u:r:sensors:s0
     user system
-<<<<<<< HEAD
     group input
     oneshot
 
@@ -285,17 +196,11 @@ service vendor.sensors-hal-1-0 /vendor/bin/hw/android.hardware.sensors@1.0-servi
     group system wakelock input root
     capabilities BLOCK_SUSPEND SYS_NICE
 
-=======
-    group system uhid
-    oneshot
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
 service watchdogd /system/bin/watchdogd 10 20
     class core
     seclabel u:r:watchdogd:s0
 
-<<<<<<< HEAD
 service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
     class main
     disabled
@@ -339,34 +244,20 @@ service iprenew_bt-pan /system/bin/dhcpcd -n
 # bugreport is triggered by holding down volume down, volume up and power
 service bugreport /system/bin/dumpstate -d -p -B -z \
         -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
-=======
-# bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -z
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     disabled
     oneshot
     keycodes 114 115 116
 
-<<<<<<< HEAD
 on boot
-=======
-on boot && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     start audioserver
     start mediadrm
     start media
     start drm
 
-<<<<<<< HEAD
 on fs
 # mount ext4 partitions
     mount_all /vendor/etc/fstab.freescale --early
-=======
-on fs && property:vendor.skip.charger_not_need=0
-# mount ext4 partitions
-    mount_all /vendor/etc/fstab.nxp --early
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Adjust parameters for dm-verity device
     write /sys/block/dm-0/queue/read_ahead_kb 4096
@@ -374,23 +265,15 @@ on fs && property:vendor.skip.charger_not_need=0
     # Update dm-verity state and set partition.*.verified properties
     verity_update_state
 
-<<<<<<< HEAD
 on verity-logging
     exec u:r:slideshow:s0 -- /sbin/slideshow warning/verity_red_1 warning/verity_red_2
 
 on post-fs
-=======
-on post-fs && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     # Set netd memlock rlimit to 8MB
     setrlimit 8 8388608 8388608
 
     # Turn on swap
-<<<<<<< HEAD
     swapon_all /vendor/etc/fstab.freescale
-=======
-    swapon_all /vendor/etc/fstab.nxp
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Swap in only 1 page at a time
     write /proc/sys/vm/page-cluster 0
@@ -399,17 +282,12 @@ on post-fs && property:vendor.skip.charger_not_need=0
     chown system system /proc/pagetypeinfo
     chmod 0440 /proc/pagetypeinfo
 
-<<<<<<< HEAD
 on post-fs-data
-=======
-on post-fs-data && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     setprop vold.post_fs_data_done 1
     # create temp node for secure storage proxy
     mkdir /data/vendor/ss 0700 system system
 
     # tmp dir for opencl Compiler
-<<<<<<< HEAD
     setprop TMPDIR /data/vendor/.opencl-cache
     mkdir /data/vendor/.opencl-cache 0771 system camera
 
@@ -424,39 +302,19 @@ on zygote-start
     chown dhcp dhcp /data/misc/dhcp
 
 service early_init_sh /vendor/bin/init.insmod.sh /vendor/etc/early.init.cfg sys.all.early_init.ready
-=======
-    setprop vendor.TMPDIR /data/vendor/.opencl-cache
-    mkdir /data/vendor/.opencl-cache 0771 system camera
-
-on zygote-start && property:vendor.skip.charger_not_need=0
-    # Create the directories used by the Wireless subsystem
-    mkdir /data/vendor/wifi 0771 wifi wifi
-    mkdir /data/vendor/wifi/wpa 0770 wifi wifi
-    mkdir /data/vendor/wifi/wpa/sockets 0770 wifi wifi
-
-service early_init_sh /vendor/bin/init.insmod.sh /vendor/etc/early.init.cfg vendor.all.early_init.ready
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     user root
     group root system
     disabled
     oneshot
 
-<<<<<<< HEAD
 on property:sys.boot_completed=1 && property:vendor.storageproxyd=trusty
-=======
-on property:sys.boot_completed=1 && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     start storageproxyd
 
 service storageproxyd /vendor/bin/storageproxyd -p /data/vendor/ss -r /dev/mmcblk2rpmb -d /dev/trusty-ipc-dev0
    group system
 
-<<<<<<< HEAD
 on property:ro.boot.vendor.sysrq=1
-=======
-on property:ro.boot.vendor.sysrq=1 && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     write /proc/sys/kernel/sysrq 1
 
 # setenv append_bootargs androidboot.usb.debugging=1
diff --git a/imx8m/evk_a200/AndroidBoard.mk b/imx8m/evk_a200/AndroidBoard.mk
index 8e81d296..e9cf443e 100644
--- a/imx8m/evk_a200/AndroidBoard.mk
+++ b/imx8m/evk_a200/AndroidBoard.mk
@@ -1,18 +1,8 @@
 LOCAL_PATH := $(call my-dir)
 
-<<<<<<< HEAD
 include device/idtech/common/build/dtbo.mk
 include device/idtech/common/build/imx-recovery.mk
 include device/idtech/common/build/gpt.mk
 #TODO add imx8mp target
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
-=======
-include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
-include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
-include $(CONFIG_REPO_PATH)/common/build/gpt.mk
-#TODO add imx8mp target
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
--include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a200/AndroidUboot.mk b/imx8m/evk_a200/AndroidUboot.mk
index 70a02a7e..9405e681 100644
--- a/imx8m/evk_a200/AndroidUboot.mk
+++ b/imx8m/evk_a200/AndroidUboot.mk
@@ -2,16 +2,10 @@
 MAKE += SHELL=/bin/bash
 
 ifneq ($(AARCH64_GCC_CROSS_COMPILE),)
-<<<<<<< HEAD
 ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
 else
 ATF_TOOLCHAIN_ABS := $(realpath prebuilts/gcc/$(HOST_PREBUILT_TAG)/aarch64/aarch64-linux-android-4.9/bin)
 ATF_CROSS_COMPILE := $(ATF_TOOLCHAIN_ABS)/aarch64-linux-androidkernel-
-=======
-  ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
-else
-  $(error shell env AARCH64_GCC_CROSS_COMPILE is not set)
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 define build_imx_uboot
@@ -22,11 +16,7 @@ define build_imx_uboot
 	cp $(UBOOT_OUT)/arch/arm/dts/imx8mp-evk.dtb $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
-<<<<<<< HEAD
 	if [ `echo $(2) | cut -d '-' -f3` = "trusty" ]; then \
-=======
-	if [ `echo $(2) | cut -d '-' -f2` = "trusty" ]; then \
->>>>>>> post_merge/android-11.0.0_2.0.0
 		cp $(FSL_PROPRIETARY_PATH)/fsl-proprietary/uboot-firmware/imx8m/tee-imx8mp.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 		$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ CROSS_COMPILE="$(ATF_CROSS_COMPILE)" PLAT=`echo $(2) | cut -d '-' -f1` bl31 -B SPD=trusty 1>/dev/null || exit 1; \
 	else \
diff --git a/imx8m/evk_a200/BoardConfig.mk b/imx8m/evk_a200/BoardConfig.mk
index 2c41dc46..08d5c823 100644
--- a/imx8m/evk_a200/BoardConfig.mk
+++ b/imx8m/evk_a200/BoardConfig.mk
@@ -1,30 +1,15 @@
-<<<<<<< HEAD
-=======
-# -------@block_infrastructure-------
-#
-# Product-specific compile-time definitions.
-#
-
-include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
-
-# -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 #
 # SoC-specific compile-time definitions.
 #
 
 BOARD_SOC_TYPE := IMX8MP
-<<<<<<< HEAD
 BOARD_SOM_TYPE := a200
 BOARD_TYPE := DEVBOARD
 BOARD_MAIN_DISPLAY_ROTATION := 0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 BOARD_HAVE_VPU := true
 BOARD_VPU_TYPE := hantro
 HAVE_FSL_IMX_GPU2D := false
 HAVE_FSL_IMX_GPU3D := true
-<<<<<<< HEAD
 HAVE_FSL_IMX_IPU := false
 HAVE_FSL_IMX_PXP := false
 BOARD_KERNEL_BASE := 0x40400000
@@ -38,13 +23,6 @@ ENABLE_CFI=false
 
 SOONG_CONFIG_IMXPLUGIN += \
                         BOARD_HAVE_VPU \
-=======
-HAVE_FSL_IMX_PXP := false
-TARGET_USES_HWC2 := true
-TARGET_HAVE_VULKAN := true
-
-SOONG_CONFIG_IMXPLUGIN += \
->>>>>>> post_merge/android-11.0.0_2.0.0
                         BOARD_VPU_TYPE
 
 SOONG_CONFIG_IMXPLUGIN_BOARD_SOC_TYPE = IMX8MP
@@ -52,7 +30,6 @@ SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU = true
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_TYPE = hantro
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_ONLY = false
 
-<<<<<<< HEAD
 #
 # Product-specific compile-time definitions.
 #
@@ -97,65 +74,6 @@ TARGET_BOOTLOADER_BOARD_NAME := EVK
 
 USE_OPENGL_RENDERER := true
 
-=======
-
-
-# -------@block_memory-------
-USE_ION_ALLOCATOR := true
-USE_GPU_ALLOCATOR := false
-
-# -------@block_storage-------
-
-TARGET_USERIMAGES_USE_EXT4 := true
-
-# use sparse image.
-TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
-
-# Support gpt
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab_super.bpt
-  ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
-                           partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
-else
-  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-no-product.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-no-product.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
-                             partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
-  else
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
-                             partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
-  endif
-endif
-
-BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-imx8mp.img
-
-BOARD_USES_METADATA_PARTITION := true
-BOARD_ROOT_EXTRA_FOLDERS += metadata
-
-# -------@block_security-------
-ENABLE_CFI=false
-
-BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA4096
-# The testkey_rsa4096.pem is copied from external/avb/test/data/testkey_rsa4096.pem
-BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/testkey_rsa4096.pem
-
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
-
-# -------@block_treble-------
-# Vendor Interface manifest and compatibility
-DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
-DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
-DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE := $(IMX_DEVICE_PATH)/device_framework_matrix.xml
-
-# -------@block_wifi-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 # NXP 8997 WIFI
 BOARD_WLAN_DEVICE            := nxp
 WPA_SUPPLICANT_VERSION       := VER_0_8_X
@@ -165,7 +83,6 @@ BOARD_HOSTAPD_PRIVATE_LIB               := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 BOARD_WPA_SUPPLICANT_PRIVATE_LIB        := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 
 WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-<<<<<<< HEAD
 
 # NXP 8997 BT
 BOARD_HAVE_BLUETOOTH_NXP := true
@@ -201,42 +118,17 @@ BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardw
 
 # memory config
 BOARD_KERNEL_CMDLINE += transparent_hugepage=never
-=======
-# -------@block_bluetooth-------
-# NXP 8997 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
-# -------@block_sensor-------
-BOARD_USE_SENSOR_FUSION := true
-
-# -------@block_kernel_bootimg-------
-BOARD_KERNEL_BASE := 0x40400000
-
-CMASIZE=960M
-# NXP default config
-BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardware=nxp firmware_class.path=/vendor/firmware loop.max_part=7
-
-# memory config
-BOARD_KERNEL_CMDLINE += transparent_hugepage=never
-BOARD_KERNEL_CMDLINE += swiotlb=65536
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # display config
 BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-drm
 
 # wifi config
-<<<<<<< HEAD
 BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN
-=======
-BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_para.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # low memory device build config
 ifeq ($(LOW_MEMORY),true)
 BOARD_KERNEL_CMDLINE += cma=320M@0x400M-0xb80M androidboot.displaymode=720p galcore.contiguousSize=33554432
 else
-<<<<<<< HEAD
 BOARD_KERNEL_CMDLINE += cma=$(CMASIZE)@0x400M-0xb80M
 endif
 
@@ -249,14 +141,6 @@ endif
 LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
 LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
 BOARD_PREBUILT_DTBOIMAGE := out/target/product/evk_a200/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
-=======
-BOARD_KERNEL_CMDLINE += cma=$(CMASIZE)@0x400M-0x1000M
-endif
-
-ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
-BOARD_KERNEL_CMDLINE += androidboot.vendor.sysrq=1
-endif
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -276,13 +160,6 @@ ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
     TARGET_BOARD_DTS_CONFIG += imx8mp-lvds-panel:imx8mp-evk-jdi-wuxga-lvds-panel.dtb
     # Support MIPI panel
     TARGET_BOARD_DTS_CONFIG += imx8mp-mipi-panel:imx8mp-evk-rm67191.dtb
-<<<<<<< HEAD
-=======
-    #Used to support powersave
-    TARGET_BOARD_DTS_CONFIG += imx8mp-powersave:imx8mp-evk-powersave.dtb
-    #Used to support powersave and mcu image
-    TARGET_BOARD_DTS_CONFIG += imx8mp-powersave-non-rpmsg:imx8mp-evk-powersave-non-rpmsg.dtb
->>>>>>> post_merge/android-11.0.0_2.0.0
   endif
 else # no dynamic parition feature
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -292,7 +169,6 @@ else # no dynamic parition feature
   endif
 endif
 
-<<<<<<< HEAD
 BOARD_SEPOLICY_DIRS := \
        device/idtech/imx8m/sepolicy \
        $(IMX_DEVICE_PATH)/sepolicy
@@ -303,12 +179,3 @@ ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
 
 BOARD_USES_METADATA_PARTITION := true
 BOARD_ROOT_EXTRA_FOLDERS += metadata
-=======
-ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
-
-# -------@block_sepolicy-------
-BOARD_SEPOLICY_DIRS := \
-       $(CONFIG_REPO_PATH)/imx8m/sepolicy \
-       $(IMX_DEVICE_PATH)/sepolicy
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a200/UbootKernelBoardConfig.mk b/imx8m/evk_a200/UbootKernelBoardConfig.mk
index f059224c..e65f2311 100644
--- a/imx8m/evk_a200/UbootKernelBoardConfig.mk
+++ b/imx8m/evk_a200/UbootKernelBoardConfig.mk
@@ -3,7 +3,6 @@ TARGET_BOOTLOADER_POSTFIX := bin
 UBOOT_POST_PROCESS := true
 
 # u-boot target
-<<<<<<< HEAD
 TARGET_BOOTLOADER_CONFIG := imx8mp-devboard:imx8mp_a200_devboard_android_defconfig
 TARGET_BOOTLOADER_CONFIG += imx8mp-devboard-trusty:imx8mp_a200_devboard_android_trusty_defconfig
 TARGET_BOOTLOADER_CONFIG += imx8mp-devboard-trusty-secure-unlock:imx8mp_a200_devboard_android_trusty_secure_unlock_defconfig
@@ -15,25 +14,6 @@ TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
 
 TARGET_KERNEL_ADDITION_DEFCONF := android_addition_defconfig
 TARGET_KERNEL_SECURE_DEFCONF ?= android_secure_defconfig
-=======
-TARGET_BOOTLOADER_CONFIG := imx8mp:imx8mp_evk_android_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty:imx8mp_evk_android_trusty_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty-secure-unlock:imx8mp_evk_android_trusty_secure_unlock_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-dual:imx8mp_evk_android_dual_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty-dual:imx8mp_evk_android_trusty_dual_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-evk-uuu:imx8mp_evk_android_uuu_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-powersave:imx8mp_evk_android_powersave_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty-powersave:imx8mp_evk_android_trusty_powersave_defconfig
-
-ifeq ($(IMX8MP_USES_GKI),true)
-TARGET_KERNEL_DEFCONFIG := gki_defconfig
-TARGET_KERNEL_GKI_DEFCONF:= android_gki_defconfig
-else
-TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
-endif
-
-TARGET_KERNEL_ADDITION_DEFCONF := android_addition_defconfig
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 
 # absolute path is used, not the same as relative path used in AOSP make
diff --git a/imx8m/evk_a200/android_addition_defconfig b/imx8m/evk_a200/android_addition_defconfig
index 8a5ccedf..92a37046 100644
--- a/imx8m/evk_a200/android_addition_defconfig
+++ b/imx8m/evk_a200/android_addition_defconfig
@@ -1,4 +1,3 @@
-<<<<<<< HEAD
 CONFIG_CLD_HL_SDIO_CORE=y
 CONFIG_IDG_SPI=y
 # CONFIG_USB_NET_QMI_WWAN is not set
@@ -249,7 +248,3 @@ CONFIG_BCM_SBA_RAID=m
 # CONFIG_MMC_SDHCI_MSM is not set
 # CONFIG_MMC_SDHI is not set
 # CONFIG_MMC_DW_EXYNOS is not set
-=======
-CONFIG_LIBNVDIMM=y
-CONFIG_OF_PMEM=y
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a200/audio_policy_configuration.xml b/imx8m/evk_a200/audio_policy_configuration.xml
index d61a5fae..250131bf 100644
--- a/imx8m/evk_a200/audio_policy_configuration.xml
+++ b/imx8m/evk_a200/audio_policy_configuration.xml
@@ -29,7 +29,6 @@
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
                              samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
                 </mixPort>
-<<<<<<< HEAD
                 <mixPort name="esai output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT|AUDIO_OUTPUT_FLAG_HW_AV_SYNC">
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
                              samplingRates="48000,96000,192000,384000,768000"
@@ -41,15 +40,6 @@
                 <mixPort name="dsd output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT|AUDIO_OUTPUT_FLAG_COMPRESS_OFFLOAD">
                     <profile name="" format="AUDIO_FORMAT_DSD"
                              samplingRates="2822400,5644800,11289600,22579200" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
-=======
-                <mixPort name="lpa output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT|AUDIO_OUTPUT_FLAG_HW_AV_SYNC">
-                    <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
-                             samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
-                </mixPort>
-                <mixPort name="hi-res output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT|AUDIO_OUTPUT_FLAG_HW_AV_SYNC">
-                    <profile name="" format="AUDIO_FORMAT_PCM_FLOAT"
-                             samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
->>>>>>> post_merge/android-11.0.0_2.0.0
                 </mixPort>
                 <mixPort name="hdmi output" role="source">
                     <profile name="" format="AUDIO_FORMAT_PCM_8_24_BIT"
@@ -59,13 +49,6 @@
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
                              samplingRates="16000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
                 </mixPort>
-<<<<<<< HEAD
-=======
-                <mixPort name="passthrough output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT">
-                    <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
-                             samplingRates="32000,44100,48000,88200,96000,176400,192000" channelMasks="AUDIO_CHANNEL_NONE"/>
-                </mixPort>
->>>>>>> post_merge/android-11.0.0_2.0.0
 
                 <mixPort name="primary input" role="sink">
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
@@ -103,7 +86,6 @@
                 <route type="mix" sink="Speaker"
                        sources="primary output"/>
                 <route type="mix" sink="Wired Headphones"
-<<<<<<< HEAD
                        sources="dsd output,esai output,primary output"/>
                 <route type="mix" sink="Wired Headset"
                        sources="dsd output,esai output,primary output"/>
@@ -111,15 +93,6 @@
                        sources="dsd output,esai output,primary output"/>
                 <route type="mix" sink="HDMI Out"
                        sources="hdmi output"/>
-=======
-                       sources="primary output"/>
-                <route type="mix" sink="Wired Headset"
-                       sources="primary output"/>
-                <route type="mix" sink="Line-Out"
-                       sources="hi-res output,lpa output,primary output"/>
-                <route type="mix" sink="HDMI Out"
-                       sources="passthrough output,hdmi output"/>
->>>>>>> post_merge/android-11.0.0_2.0.0
                 <route type="mix" sink="BT SCO Headset"
                        sources="bt sco output"/>
                 <route type="mix" sink="BT SCO CarKit"
diff --git a/imx8m/evk_a200/camera_config_imx8mp.json b/imx8m/evk_a200/camera_config_imx8mp.json
index 2b591a17..5c4aa5b6 100644
--- a/imx8m/evk_a200/camera_config_imx8mp.json
+++ b/imx8m/evk_a200/camera_config_imx8mp.json
@@ -10,13 +10,8 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
       "camera_name": "viv_v4l2_device",
       "device_node": "/dev/video1",
-=======
-      "camera_name": "viv_v4l20",
-      "bus_info": "platform:viv0",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "orientation": "0",
       "buffer_type": "mmap",
       "ActiveArrayWidth": "1920",
@@ -32,14 +27,8 @@
     },
     {
       "camera_type": "front",
-<<<<<<< HEAD
       "camera_name": "mxc-isi-cap",
       "orientation": "0",
-=======
-      "camera_name": "mxc_isi.1.capture",
-      "orientation": "0",
-      "mplane": "1",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "buffer_type": "dma",
       "ActiveArrayWidth": "2592",
       "ActiveArrayHeight": "1944",
diff --git a/imx8m/evk_a200/evk_8mp.mk b/imx8m/evk_a200/evk_8mp.mk
index dff79437..7d552bcb 100644
--- a/imx8m/evk_a200/evk_8mp.mk
+++ b/imx8m/evk_a200/evk_8mp.mk
@@ -1,19 +1,11 @@
-<<<<<<< HEAD
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
 IMX_DEVICE_PATH := device/nxp/imx8m/evk_8mp
-=======
-# -------@block_infrastructure-------
-CONFIG_REPO_PATH := device/nxp
-CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
-IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # configs shared between uboot, kernel and Android rootfs
 include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
 
-<<<<<<< HEAD
 -include device/nxp/common/imx_path/ImxPathConfig.mk
 include device/nxp/imx8m/ProductConfigCommon.mk
 
@@ -21,116 +13,32 @@ ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.nxp),)
 $(shell touch $(IMX_DEVICE_PATH)/fstab.nxp)
 endif
 
-=======
--include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
-include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
-
-# -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Overrides
 PRODUCT_NAME := evk_8mp
 PRODUCT_DEVICE := evk_8mp
 PRODUCT_MODEL := EVK_8MP
 
-<<<<<<< HEAD
 PRODUCT_FULL_TREBLE_OVERRIDE := true
 PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
 PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
 
 #Enable this to choose 32 bit user space build
 #IMX8_BUILD_32BIT_ROOTFS := true
-=======
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-PRODUCT_CHARACTERISTICS := tablet
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# -------@block_treble-------
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-
-# -------@block_power-------
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/powerhint_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mp.json
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-
-PRODUCT_PACKAGES += \
-    android.hardware.power-service.imx
-
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mp.json
-
-
-# -------@block_app-------
-
-#Enable this to choose 32 bit user space build
-IMX8_BUILD_32BIT_ROOTFS := false
-
-# Set permission for GMS packages
-PRODUCT_COPY_FILES += \
-	  $(CONFIG_REPO_PATH)/imx8m/permissions/privapp-permissions-imx.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/privapp.permissions-imx.xml
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml
-
-# -------@block_kernel_bootimg-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
 TARGET_USE_VENDOR_BOOT ?= true
 
-<<<<<<< HEAD
 #Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
 TARGET_USE_DYNAMIC_PARTITIONS ?= true
 #If the device is retrofit to have dynamic partition feature, set this variable to true to build
 #the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
 TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
-=======
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc
-
-
-# -------@block_storage-------
-
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
   PRODUCT_USE_DYNAMIC_PARTITIONS := true
   BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
   BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-<<<<<<< HEAD
   ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
     PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
     BOARD_SUPER_PARTITION_METADATA_DEVICE := system
@@ -147,50 +55,11 @@ ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   endif
 endif
 
-=======
-endif
-
-#Enable this to disable product partition build.
-IMX_NO_PRODUCT_PARTITION := false
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
-  PRODUCT_PACKAGES += imx_ota_postinstall
-
-  AB_OTA_POSTINSTALL_CONFIG += \
-    RUN_POSTINSTALL_vendor=true \
-    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
-    FILESYSTEM_TYPE_vendor=ext4 \
-    POSTINSTALL_OPTIONAL_vendor=false
-
-  PRODUCT_COPY_FILES += \
-    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mp-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
-endif
-
-
-# fastboot_imx_flashall scripts, imx-sdcard-partition script uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# -------@block_security-------
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Include keystore attestation keys and certificates.
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 -include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
 endif
 
-<<<<<<< HEAD
 # Include Android Go config for low memory device.
 ifeq ($(LOW_MEMORY),true)
 $(call inherit-product, build/target/product/go_defaults.mk)
@@ -320,126 +189,10 @@ PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
 PRODUCT_COPY_FILES += \
     $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
 
-=======
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# Keymaster HAL
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-# Resume on Reboot support
-PRODUCT_PACKAGES += \
-    android.hardware.rebootescrow-service.default
-
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rebootescrow.device=/dev/block/pmem0
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-# -------@block_audio-------
-
-# Audio card json
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/audio-json/wm8960_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8960_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/hdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/hdmi_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32
-
-
-PRODUCT_COPY_FILES += \
-    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mp/imx8mp_mcu_demo.img:imx8mp_mcu_demo.img \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml
-
-# -------@block_camera-------
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mp.json \
-    $(IMX_DEVICE_PATH)/ov5640_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/ov5640_camera_config_imx8mp.json \
-    $(IMX_DEVICE_PATH)/isp_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp_camera_config_imx8mp.json \
-    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-# Copy isp files to board
-ISP_PROPRIETARY := $(FSL_PROPRIETARY_PATH)/fsl-proprietary/isp
-PRODUCT_COPY_FILES += \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/bin,$(TARGET_COPY_OUT_VENDOR)/bin) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/lib64,$(TARGET_COPY_OUT_VENDOR)/lib64) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/config,$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp)
-
-# ISP camera feature demo
-PRODUCT_PACKAGES += \
-    CameraXBasic
-
-# -------@block_display-------
-
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 # HWC2 HAL
 PRODUCT_PACKAGES += \
     android.hardware.graphics.composer@2.4-service
 
-<<<<<<< HEAD
 # Charger Mode
 PRODUCT_PRODUCT_PROPERTIES += \
     ro.charger.no_ui=false
@@ -453,63 +206,27 @@ PRODUCT_PACKAGES += \
     android.hardware.graphics.mapper@2.0-impl-2.1 \
     android.hardware.graphics.allocator@2.0-impl \
     android.hardware.graphics.allocator@2.0-service
-=======
-# define frame buffer count
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@4.0-impl.imx \
-    android.hardware.graphics.allocator@4.0-service.imx
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # RenderScript HAL
 PRODUCT_PACKAGES += \
     android.hardware.renderscript@1.0-impl
 
 PRODUCT_PACKAGES += \
-<<<<<<< HEAD
     libEGL_VIVANTE \
     libGLESv1_CM_VIVANTE \
     libGLESv2_VIVANTE \
     gralloc_viv.imx \
-=======
-    libg2d-opencl
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod \
-    MultiDisplay
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
-
-# -------@block_gpu-------
-PRODUCT_PACKAGES += \
-    libEGL_VIVANTE \
-    libGLESv1_CM_VIVANTE \
-    libGLESv2_VIVANTE \
-    gralloc_viv.$(TARGET_BOARD_PLATFORM) \
->>>>>>> post_merge/android-11.0.0_2.0.0
     libGAL \
     libGLSLC \
     libVSC \
     libgpuhelper \
     libSPIRV_viv \
     libvulkan_VIVANTE \
-<<<<<<< HEAD
     vulkan.imx \
     libCLC \
     libLLVM_viv \
     libOpenCL \
     libg2d-opencl \
-=======
-    vulkan.$(TARGET_BOARD_PLATFORM) \
-    libCLC \
-    libLLVM_viv \
-    libOpenCL \
->>>>>>> post_merge/android-11.0.0_2.0.0
     libg2d-viv \
     libOpenVX \
     libOpenVXU \
@@ -526,7 +243,6 @@ PRODUCT_PACKAGES += \
     libNNArchPerf \
     libarchmodelSw
 
-<<<<<<< HEAD
 PRODUCT_PACKAGES += \
     android.hardware.audio@6.0-impl:32 \
     android.hardware.audio@2.0-service \
@@ -563,25 +279,11 @@ PRODUCT_PACKAGES += \
 #nxp 8997 Bluetooth vendor config
 PRODUCT_PACKAGES += \
     bt_vendor.conf
-=======
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# -------@block_wifi-------
-
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # WiFi HAL
 PRODUCT_PACKAGES += \
     android.hardware.wifi@1.0-service \
-<<<<<<< HEAD
     wifilogd \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     wificond
 
 # WiFi RRO
@@ -591,19 +293,13 @@ PRODUCT_PACKAGES += \
 # nxp 8997 wifi and bluetooth combo Firmware
 PRODUCT_COPY_FILES += \
     vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
-<<<<<<< HEAD
     vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf
-=======
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para_powersave.conf:vendor/firmware/wifi_mod_para_powersave.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # Wifi regulatory
 PRODUCT_COPY_FILES += \
     external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
     external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
 
-<<<<<<< HEAD
 # Keymaster HAL
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 PRODUCT_PACKAGES += \
@@ -627,37 +323,6 @@ ifneq ($(BUILD_TARGET_FS),ubifs)
 PRODUCT_PROPERTY_OVERRIDES += \
     ro.frp.pst=/dev/block/by-name/presistdata
 endif
-=======
-# -------@block_bluetooth-------
-
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-#nxp 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# -------@block_usb-------
-
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
-
-# -------@block_multimedia_codec-------
-
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 PRODUCT_PACKAGES += \
     libg1 \
@@ -704,7 +369,6 @@ PRODUCT_PACKAGES += \
 PRODUCT_PACKAGES += \
     DirectAudioPlayer
 
-<<<<<<< HEAD
 # Tensorflow lite camera demo
 PRODUCT_PACKAGES += \
                     tflitecamerademo
@@ -759,8 +423,6 @@ endif
 
 IMX-DEFAULT-G2D-LIB := libg2d-opencl
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 INSTALL_64BIT_LIBRARY := true
@@ -772,7 +434,6 @@ endif
 -include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp/imx_dsp_8mp.mk
 endif
 
-<<<<<<< HEAD
 # Included GMS package
 $(call inherit-product-if-exists, vendor/partner_gms/products/gms.mk)
 PRODUCT_SOONG_NAMESPACES += vendor/partner_gms
@@ -790,71 +451,3 @@ PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
 $(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
 
 $(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-=======
-# -------@block_memory-------
-
-# Include Android Go config for low memory device.
-ifeq ($(LOW_MEMORY),true)
-$(call inherit-product, build/target/product/go_defaults.mk)
-endif
-
-# -------@block_neural_network-------
-
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# -------@block_miscellaneous-------
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.imx8mp.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mp.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
-# Included GMS package
-$(call inherit-product-if-exists, vendor/partner_gms/products/gms.mk)
-PRODUCT_SOONG_NAMESPACES += vendor/partner_gms
-
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a200/init.imx8mp.rc b/imx8m/evk_a200/init.imx8mp.rc
index 468e7ae7..2f28d0ea 100755
--- a/imx8m/evk_a200/init.imx8mp.rc
+++ b/imx8m/evk_a200/init.imx8mp.rc
@@ -16,13 +16,6 @@ on early-boot
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
-<<<<<<< HEAD
-=======
-    chown root system /sys/devices/system/cpu/cpu2/online
-    chmod 0664 /sys/devices/system/cpu/cpu2/online
-    chown root system /sys/devices/system/cpu/cpu3/online
-    chmod 0664 /sys/devices/system/cpu/cpu3/online
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on property:sys.boot_completed=1
     # Set default CPU frequency governor
@@ -32,13 +25,6 @@ on property:sys.boot_completed=1
     # Set up and down limit to 200us/200us
     write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 200
     write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 200
-<<<<<<< HEAD
-=======
-    write /proc/sys/kernel/sched_util_clamp_min 512
-    write /sys/devices/platform/soc@0/30c00000.bus/30e20000.audio-blk-ctrl/power/control auto
-    write /sys/devices/platform/soc@0/32c00000.bus/32ec0000.media-blk-ctrl/power/control auto
-    write /sys/devices/platform/soc@0/30c00000.bus/32fc0000.hdmi-blk-ctrl/power/control auto
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on property:sys.boot_completed=1
     # update cpuset now that processors are up
@@ -63,7 +49,6 @@ on early-boot
 service isp_media_server /vendor/bin/isp_media_server /vendor/etc/configs/isp/daA3840_30mc_1080P.json
     group camera
     oneshot
-<<<<<<< HEAD
 
 on init
     #IDtech added for AB ota update bootloader
@@ -71,5 +56,3 @@ on init
     symlink   /dev/block/mmcblk2boot1p1   /dev/block/by-name/spl_b
     symlink   /dev/block/mmcblk2boot0p2   /dev/block/by-name/spl_bak_a
     symlink   /dev/block/mmcblk2boot1p2   /dev/block/by-name/spl_bak_b
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a200/init.rc b/imx8m/evk_a200/init.rc
index 533ff374..33d25212 100644
--- a/imx8m/evk_a200/init.rc
+++ b/imx8m/evk_a200/init.rc
@@ -1,28 +1,11 @@
 import /vendor/etc/init/hw/init.${ro.hardware}.usb.rc
 import /vendor/etc/init/hw/init.${ro.hardware}.${ro.boot.soc_type}.rc
-<<<<<<< HEAD
 import /init.idtech.rc
-=======
-
-service vendor.charger /system/bin/charger
-    class charger
-    user system
-    group system wakelock input
-    capabilities SYS_BOOT
-    file /dev/kmsg w
-    file /sys/fs/pstore/console-ramoops-0 r
-    file /sys/fs/pstore/console-ramoops r
-    file /proc/last_kmsg r
-
-on charger
-    start vendor.charger
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on early-init
     # mount the debugfs
     mount debugfs none /sys/kernel/debug/ mode=0755
 
-<<<<<<< HEAD
     # Mount binderfs
     mkdir /dev/binderfs
     mount binder binder /dev/binderfs stats=global
@@ -39,12 +22,6 @@ on early-init
 
 on early-init
     start early_init_sh
-=======
-on early-init
-    start early_init_sh
-    # Set the host name which used in console
-    export HOSTNAME evk_8mp
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Due keymaster start very early so set prop here
     # Also gatekeeper share same role for keymaster
@@ -52,32 +29,18 @@ on early-init
     setprop ro.hardware.gatekeeper ${ro.boot.keystore}
     setprop vendor.storageproxyd ${ro.boot.keystore}
 
-<<<<<<< HEAD
 on init
-=======
-    # Use ro.boot.lcd_density to override ro.sf.lcd_density
-    setprop ro.sf.lcd_density ${ro.boot.lcd_density}
-
-# Skip charger_not_need trigger for charger mode
-on early-init && property:ro.boot.mode=charger
-    setprop vendor.skip.charger_not_need 1
-
-on init && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     start watchdogd
 
     # Support legacy paths
     symlink /sdcard /mnt/sdcard
     symlink /sdcard /storage/sdcard0
 
-<<<<<<< HEAD
     # setup the global environment
     export CORE_REGISTER_FILE /vendor/etc/core_register
     export COMPONENT_REGISTER_FILE /vendor/etc/component_register
     export CONTENTPIPE_REGISTER_FILE /vendor/etc/contentpipe_register
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     # disable cursor blink for fbcon, if no splash screen support
     write /sys/class/graphics/fbcon/cursor_blink 0
 
@@ -103,7 +66,6 @@ on init && property:vendor.skip.charger_not_need=0
     write /dev/stune/rt/schedtune.boost 50
     write /dev/stune/rt/schedtune.prefer_idle 1
 
-<<<<<<< HEAD
 on late-fs
     # Start keymaster service
     start vendor.keymaster-3-0-${ro.boot.keystore}
@@ -115,29 +77,11 @@ on late-fs && property:vendor.storageproxyd=trusty
     start vendor.oemlock-1-0
 
 on early-boot
-=======
-on late-fs && property:vendor.skip.charger_not_need=0
-    # Start keymaster/gatekeeper service
-    start vendor.gatekeeper-1-0-${ro.boot.keystore}
-    start vendor.keymaster-4-0-${ro.boot.keystore}
-    setprop vendor.powerhal.init 1
-
-    # Wait for keymaster
-    exec_start wait_for_keymaster
-
-    mount_all /vendor/etc/fstab.nxp --late
-
-on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
-    start vendor.oemlock-1-0
-
-on early-boot && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     # For evk_8mp, when swap used about 400M, upgrade the level.
     setprop ro.lmk.upgrade_pressure 93
     setprop ro.lmk.downgrade_pressure 99
     setprop ro.lmk.critical_upgrade true
 
-<<<<<<< HEAD
     # Set the host name which used in console
     export HOSTNAME evk_a200
 
@@ -148,21 +92,13 @@ on early-boot && property:vendor.skip.charger_not_need=0
     setprop ro.tether.denied false
 
     setprop hwc.stretch.filter  1
-=======
-    setprop vendor.hwc.stretch.filter  1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Default g2d [dpu|pxp|viv] lib to be used
     setprop vendor.imx.default-g2d viv
 
     # fsl omx graphic manager media framework property
-<<<<<<< HEAD
     setprop rw.VIDEO_RENDER_NAME video_render.surface
     setprop media.fsl_codec.flag 7
-=======
-    setprop vendor.rw.VIDEO_RENDER_NAME video_render.surface
-    setprop vendor.media.fsl_codec.flag 7
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     setprop camera.disable_zsl_mode 1
 
@@ -173,18 +109,14 @@ on early-boot && property:vendor.skip.charger_not_need=0
     write /sys/block/mmcblk1/queue/read_ahead_kb 2048
     write /sys/block/mmcblk2/queue/read_ahead_kb 2048
 
-<<<<<<< HEAD
     # Set period_us for usb audio
     setprop ro.audio.usb.period_us 20000
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     # Prepare for wifi
     setprop wifi.interface wlan0
     setprop wifi.direct.interface p2p0
     setprop wifi.concurrent.interface wlan1
 
-<<<<<<< HEAD
     setprop persist.service.bdroid.bdaddr 22:22:67:C6:69:73
 
     # Use ro.boot.lcd_density to override ro.sf.lcd_density
@@ -193,8 +125,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # prepare for ril
     setprop ro.ril.wake_lock_timeout 300
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     # Set tracefs permission to 755
     chmod 0755 /sys/kernel/debug/tracing
 
@@ -203,33 +133,17 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0664 /sys/kernel/debug/sync/sw_sync
 
     # Default backlight device
-<<<<<<< HEAD
     setprop hw.backlight.dev "32e60000.mipi_dsi.0"
-=======
-    setprop vendor.hw.backlight.dev "32e60000.mipi_dsi.0"
->>>>>>> post_merge/android-11.0.0_2.0.0
     # Chmod/chown FSL specific sys entry
     chown system system /sys/class/backlight/32e60000.mipi_dsi.0/brightness
     chmod 0660 /sys/class/backlight/32e60000.mipi_dsi.0/brightness
 
-<<<<<<< HEAD
     # Set light sensor sysfs path and light sensor threshold lux value
     setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
     setprop ro.lightsensor.threshold  20
 
     # Dectect DSF streams when scanning media
     setprop ro.FSL_DSF_PARSER 1
-=======
-    # Backup backlight device
-    setprop vendor.hw.backlight_backup.dev "lvds_backlight"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/lvds_backlight/brightness
-    chmod 0660 /sys/class/backlight/lvds_backlight/brightness
-
-    # Set light sensor sysfs path and light sensor threshold lux value
-    setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
-    setprop vendor.ro.lightsensor.threshold  20
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Allow DSD file(duration larger than 10s) can play
     setprop audio.offload.min.duration.secs 10
@@ -237,12 +151,9 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # Enlarge limition of audio buffer allocation
     setprop ro.af.client_heap_size_kbyte 32768
 
-<<<<<<< HEAD
     # enlarge media max memory size to 3G.
     setprop ro.media.maxmem 3221225471
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     start vendor.wifi_hal_legacy
 
 service wpa_supplicant /vendor/bin/hw/wpa_supplicant \
@@ -251,10 +162,6 @@ service wpa_supplicant /vendor/bin/hw/wpa_supplicant \
     interface android.hardware.wifi.supplicant@1.0::ISupplicant default
     interface android.hardware.wifi.supplicant@1.1::ISupplicant default
     interface android.hardware.wifi.supplicant@1.2::ISupplicant default
-<<<<<<< HEAD
-=======
-    interface android.hardware.wifi.supplicant@1.3::ISupplicant default
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     socket wpa_wlan0 dgram 660 wifi wifi
     disabled
@@ -264,7 +171,6 @@ service sensor_fusion /vendor/bin/fsl_sensor_fusion
     class late_start
     seclabel u:r:sensors:s0
     user system
-<<<<<<< HEAD
     group input
     oneshot
 
@@ -274,17 +180,11 @@ service vendor.sensors-hal-1-0 /vendor/bin/hw/android.hardware.sensors@1.0-servi
     group system wakelock input root
     capabilities BLOCK_SUSPEND SYS_NICE
 
-=======
-    group system uhid
-    oneshot
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
 service watchdogd /system/bin/watchdogd 10 20
     class core
     seclabel u:r:watchdogd:s0
 
-<<<<<<< HEAD
 service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
     class main
     disabled
@@ -328,34 +228,20 @@ service iprenew_bt-pan /system/bin/dhcpcd -n
 # bugreport is triggered by holding down volume down, volume up and power
 service bugreport /system/bin/dumpstate -d -p -B -z \
         -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
-=======
-# bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -z
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     disabled
     oneshot
     keycodes 114 115 116
 
-<<<<<<< HEAD
 on boot
-=======
-on boot && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     start audioserver
     start mediadrm
     start media
     start drm
 
-<<<<<<< HEAD
 on fs
 # mount ext4 partitions
     mount_all /vendor/etc/fstab.freescale --early
-=======
-on fs && property:vendor.skip.charger_not_need=0
-# mount ext4 partitions
-    mount_all /vendor/etc/fstab.nxp --early
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Adjust parameters for dm-verity device
     write /sys/block/dm-0/queue/read_ahead_kb 4096
@@ -363,23 +249,15 @@ on fs && property:vendor.skip.charger_not_need=0
     # Update dm-verity state and set partition.*.verified properties
     verity_update_state
 
-<<<<<<< HEAD
 on verity-logging
     exec u:r:slideshow:s0 -- /sbin/slideshow warning/verity_red_1 warning/verity_red_2
 
 on post-fs
-=======
-on post-fs && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     # Set netd memlock rlimit to 8MB
     setrlimit 8 8388608 8388608
 
     # Turn on swap
-<<<<<<< HEAD
     swapon_all /vendor/etc/fstab.freescale
-=======
-    swapon_all /vendor/etc/fstab.nxp
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Swap in only 1 page at a time
     write /proc/sys/vm/page-cluster 0
@@ -388,17 +266,12 @@ on post-fs && property:vendor.skip.charger_not_need=0
     chown system system /proc/pagetypeinfo
     chmod 0440 /proc/pagetypeinfo
 
-<<<<<<< HEAD
 on post-fs-data
-=======
-on post-fs-data && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     setprop vold.post_fs_data_done 1
     # create temp node for secure storage proxy
     mkdir /data/vendor/ss 0700 system system
 
     # tmp dir for opencl Compiler
-<<<<<<< HEAD
     setprop TMPDIR /data/vendor/.opencl-cache
     mkdir /data/vendor/.opencl-cache 0771 system camera
 
@@ -413,53 +286,21 @@ on zygote-start
     chown dhcp dhcp /data/misc/dhcp
 
 service early_init_sh /vendor/bin/init.insmod.sh /vendor/etc/early.init.cfg sys.all.early_init.ready
-=======
-    setprop vendor.TMPDIR /data/vendor/.opencl-cache
-    mkdir /data/vendor/.opencl-cache 0771 system camera
-
-on zygote-start && property:vendor.skip.charger_not_need=0
-    # Create the directories used by the Wireless subsystem
-    mkdir /data/vendor/wifi 0771 wifi wifi
-    mkdir /data/vendor/wifi/wpa 0770 wifi wifi
-    mkdir /data/vendor/wifi/wpa/sockets 0770 wifi wifi
-
-service early_init_sh /vendor/bin/init.insmod.sh /vendor/etc/early.init.cfg vendor.all.early_init.ready
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     user root
     group root system
     disabled
     oneshot
 
-<<<<<<< HEAD
 on property:sys.boot_completed=1 && property:vendor.storageproxyd=trusty
-=======
-on property:sys.boot_completed=1 && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     start storageproxyd
 
 service storageproxyd /vendor/bin/storageproxyd -p /data/vendor/ss -r /dev/mmcblk2rpmb -d /dev/trusty-ipc-dev0
    group system
 
-<<<<<<< HEAD
 on property:ro.boot.vendor.sysrq=1
-=======
-on property:ro.boot.vendor.sysrq=1 && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     write /proc/sys/kernel/sysrq 1
 
 # setenv append_bootargs androidboot.usb.debugging=1
 on property:ro.boot.usb.debugging=1
     setprop persist.sys.usb.config adb
-<<<<<<< HEAD
-=======
-
-# setenv append_bootargs androidboot.powersave.usb=true
-on property:ro.boot.powersave.usb=true
-    # enable platform/32f10100.usb runtime_pm
-    write /sys/devices/platform/soc@0/32f10100.usb/38100000.dwc3/power/control auto
-
-    #enable platform/32f10108.usb runtime_pm
-    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/power/control auto
-    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/xhci-hcd.0.auto/power/control auto
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a300/AndroidBoard.mk b/imx8m/evk_a300/AndroidBoard.mk
index 2a37c0ca..84e328fe 100644
--- a/imx8m/evk_a300/AndroidBoard.mk
+++ b/imx8m/evk_a300/AndroidBoard.mk
@@ -1,16 +1,7 @@
 LOCAL_PATH := $(call my-dir)
 
-<<<<<<< HEAD
 include device/idtech/common/build/dtbo.mk
 include device/idtech/common/build/imx-recovery.mk
 include device/idtech/common/build/gpt.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
-=======
-include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
-include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
-include $(CONFIG_REPO_PATH)/common/build/gpt.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
--include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a300/AndroidUboot.mk b/imx8m/evk_a300/AndroidUboot.mk
index bac0d7f6..06a2fe2a 100644
--- a/imx8m/evk_a300/AndroidUboot.mk
+++ b/imx8m/evk_a300/AndroidUboot.mk
@@ -2,16 +2,10 @@
 MAKE += SHELL=/bin/bash
 
 ifneq ($(AARCH64_GCC_CROSS_COMPILE),)
-<<<<<<< HEAD
 ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
 else
 ATF_TOOLCHAIN_ABS := $(realpath prebuilts/gcc/$(HOST_PREBUILT_TAG)/aarch64/aarch64-linux-android-4.9/bin)
 ATF_CROSS_COMPILE := $(ATF_TOOLCHAIN_ABS)/aarch64-linux-androidkernel-
-=======
-  ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
-else
-  $(error shell env AARCH64_GCC_CROSS_COMPILE is not set)
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 define build_imx_uboot
@@ -23,11 +17,7 @@ define build_imx_uboot
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/hdmi/cadence/signed_hdmi_imx8m.bin  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
-<<<<<<< HEAD
 	if [ `echo $(2) | cut -d '-' -f3` = "trusty" ] && [ `echo $(2) | rev | cut -d '-' -f1` != "uuu" ]; then \
-=======
-	if [ `echo $(2) | cut -d '-' -f2` = "trusty" ] && [ `echo $(2) | rev | cut -d '-' -f1` != "uuu" ]; then \
->>>>>>> post_merge/android-11.0.0_2.0.0
 		cp $(FSL_PROPRIETARY_PATH)/fsl-proprietary/uboot-firmware/imx8m/tee-imx8mq.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 		$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ CROSS_COMPILE="$(ATF_CROSS_COMPILE)" PLAT=`echo $(2) | cut -d '-' -f1` bl31 -B SPD=trusty 1>/dev/null || exit 1; \
 	else \
@@ -47,7 +37,6 @@ define build_imx_uboot
 	fi; \
 	if [ `echo $(2) | rev | cut -d '-' -f1 | rev` != "dual" ]; then \
 		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(UBOOT_COLLECTION)/u-boot-$(strip $(2)).imx; \
-<<<<<<< HEAD
 		if [ -f device/idtech/common/prebuilts/spl_tab_auxiliary.img ]; then \
 			dd if=device/idtech/common/prebuilts/spl_tab_auxiliary.img of=$(UBOOT_COLLECTION)/u-boot-$(strip $(2)).imx bs=1 seek=105984 conv=notrunc; \
 		fi; \
@@ -57,11 +46,6 @@ define build_imx_uboot
 		if [ -f device/idtech/common/prebuilts/spl_tab_auxiliary.img ]; then \
 			dd if=device/idtech/common/prebuilts/spl_tab_auxiliary.img of=$(UBOOT_COLLECTION)/spl-$(strip $(2)).bin bs=1 seek=105984 conv=notrunc; \
 		fi; \
-=======
-	else \
-		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(UBOOT_COLLECTION)/spl-$(strip $(2)).bin; \
-		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/u-boot-ivt.itb $(UBOOT_COLLECTION)/bootloader-$(strip $(2)).img; \
->>>>>>> post_merge/android-11.0.0_2.0.0
 	fi;
 endef
 
diff --git a/imx8m/evk_a300/BoardConfig.mk b/imx8m/evk_a300/BoardConfig.mk
index fc5926fa..54c52d0f 100644
--- a/imx8m/evk_a300/BoardConfig.mk
+++ b/imx8m/evk_a300/BoardConfig.mk
@@ -1,30 +1,15 @@
-<<<<<<< HEAD
-=======
-# -------@block_infrastructure-------
-#
-# Product-specific compile-time definitions.
-#
-
-include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
-
-# -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 #
 # SoC-specific compile-time definitions.
 #
 
 BOARD_SOC_TYPE := IMX8MQ
-<<<<<<< HEAD
 BOARD_SOM_TYPE := a300
 BOARD_TYPE := DEVBOARD
 BOARD_MAIN_DISPLAY_ROTATION := 0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 BOARD_HAVE_VPU := true
 BOARD_VPU_TYPE := hantro
 HAVE_FSL_IMX_GPU2D := false
 HAVE_FSL_IMX_GPU3D := true
-<<<<<<< HEAD
 HAVE_FSL_IMX_IPU := false
 HAVE_FSL_IMX_PXP := false
 BOARD_KERNEL_BASE := 0x40400000
@@ -38,13 +23,6 @@ ENABLE_CFI=false
 
 SOONG_CONFIG_IMXPLUGIN += \
                           BOARD_HAVE_VPU \
-=======
-HAVE_FSL_IMX_PXP := false
-TARGET_USES_HWC2 := true
-TARGET_HAVE_VULKAN := true
-
-SOONG_CONFIG_IMXPLUGIN += \
->>>>>>> post_merge/android-11.0.0_2.0.0
                           BOARD_VPU_TYPE
 
 SOONG_CONFIG_IMXPLUGIN_BOARD_SOC_TYPE = IMX8MQ
@@ -52,7 +30,6 @@ SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU = true
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_TYPE = hantro
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_ONLY = false
 
-<<<<<<< HEAD
 #
 # Product-specific compile-time definitions.
 #
@@ -98,70 +75,12 @@ TARGET_BOOTLOADER_BOARD_NAME := EVK
 USE_OPENGL_RENDERER := true
 
 BOARD_WLAN_DEVICE            := bcmdhd
-=======
-# -------@block_memory-------
-USE_ION_ALLOCATOR := true
-USE_GPU_ALLOCATOR := false
-
-# -------@block_storage-------
-TARGET_USERIMAGES_USE_EXT4 := true
-
-# use sparse image.
-TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
-
-# Support gpt
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab_super.bpt
-  ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
-                           partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
-else
-  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-no-product.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-no-product.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
-                             partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
-  else
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
-                             partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
-  endif
-endif
-
-BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-imx8mq.img
-
-BOARD_USES_METADATA_PARTITION := true
-BOARD_ROOT_EXTRA_FOLDERS += metadata
-
-# -------@block_security-------
-ENABLE_CFI=false
-
-BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA4096
-# The testkey_rsa4096.pem is copied from external/avb/test/data/testkey_rsa4096.pem
-BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/testkey_rsa4096.pem
-
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
-
-# -------@block_treble-------
-# Vendor Interface manifest and compatibility
-DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
-DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
-DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE := $(IMX_DEVICE_PATH)/device_framework_matrix.xml
-
-# -------@block_wifi-------
-BOARD_WLAN_DEVICE            := nxp
->>>>>>> post_merge/android-11.0.0_2.0.0
 WPA_SUPPLICANT_VERSION       := VER_0_8_X
 BOARD_WPA_SUPPLICANT_DRIVER  := NL80211
 BOARD_HOSTAPD_DRIVER         := NL80211
 BOARD_HOSTAPD_PRIVATE_LIB           := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 BOARD_WPA_SUPPLICANT_PRIVATE_LIB    := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 
-<<<<<<< HEAD
 WIFI_DRIVER_FW_PATH_PARAM := "/sys/module/brcmfmac/parameters/alternative_fw_path"
 
 #WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
@@ -190,37 +109,15 @@ BOARD_AVB_KEY_PATH := device/idtech/common/security/idt_testkey_rsa2048.pem
 
 # define frame buffer count
 NUM_FRAMEBUFFER_SURFACE_BUFFERS := 4
-=======
-WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-
-# -------@block_bluetooth-------
-# NXP 8997 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
-# -------@block_sensor-------
-BOARD_USE_SENSOR_FUSION := true
-
-# -------@block_kernel_bootimg-------
-BOARD_KERNEL_BASE := 0x40400000
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(PRODUCT_IMX_DRM),true)
 CMASIZE=736M
 else
-<<<<<<< HEAD
 CMASIZE=800M
 endif
 
 # NXP default config
 BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc0 androidboot.hardware=freescale firmware_class.path=/vendor/firmware loop.max_part=7
-=======
-CMASIZE=1280M
-endif
-
-# NXP default config
-BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc0 androidboot.hardware=nxp firmware_class.path=/vendor/firmware loop.max_part=7
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # framebuffer config
 BOARD_KERNEL_CMDLINE += androidboot.fbTileSupport=enable
@@ -229,7 +126,6 @@ BOARD_KERNEL_CMDLINE += androidboot.fbTileSupport=enable
 BOARD_KERNEL_CMDLINE += transparent_hugepage=never cma=$(CMASIZE)
 
 # display config
-<<<<<<< HEAD
 BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=mxsfb-drm androidboot.gui_resolution=1080p
 
 # wifi config
@@ -244,17 +140,6 @@ endif
 LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
 LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
 BOARD_PREBUILT_DTBOIMAGE := out/target/product/evk_a300/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
-=======
-BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-dcss androidboot.gui_resolution=1080p
-
-# wifi config
-BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_para.conf
-
-ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
-BOARD_KERNEL_CMDLINE += androidboot.vendor.sysrq=1
-endif
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-product.dtb
@@ -272,24 +157,12 @@ else # no dynamic parition feature
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-product-no-dynamic_partition.dtb
   else
-<<<<<<< HEAD
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-dynamic_partition.dtb
   endif
 endif
 
 BOARD_SEPOLICY_DIRS := \
        device/idtech/imx8m/sepolicy \
-=======
-	TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-dynamic_partition.dtb
-  endif
-endif
-
-ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
-
-# -------@block_sepolicy-------
-BOARD_SEPOLICY_DIRS := \
-       $(CONFIG_REPO_PATH)/imx8m/sepolicy \
->>>>>>> post_merge/android-11.0.0_2.0.0
        $(IMX_DEVICE_PATH)/sepolicy
 
 ifeq ($(PRODUCT_IMX_DRM),true)
@@ -297,7 +170,6 @@ BOARD_SEPOLICY_DIRS += \
        $(IMX_DEVICE_PATH)/sepolicy_drm
 endif
 
-<<<<<<< HEAD
 TARGET_BOARD_KERNEL_HEADERS := device/idtech/common/kernel-headers
 
 ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
@@ -308,5 +180,3 @@ BOARD_ROOT_EXTRA_FOLDERS += metadata
 BOARD_PLAT_PRIVATE_SEPOLICY_DIR := device/idtech/imx8m/sepolicy_system/private
 
 AB_OTA_PARTITIONS += spl_bak
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a300/audio_policy_configuration.xml b/imx8m/evk_a300/audio_policy_configuration.xml
index a29efbb1..ec5349e6 100644
--- a/imx8m/evk_a300/audio_policy_configuration.xml
+++ b/imx8m/evk_a300/audio_policy_configuration.xml
@@ -21,18 +21,12 @@
         <module name="primary" halVersion="2.0">
             <attachedDevices>
                 <item>Speaker</item>
-<<<<<<< HEAD
                 <item>Wired Headphones</item>
                 <item>Built-In Mic</item>
                 <item>Wired-In Headsets</item>
             </attachedDevices>
             <defaultOutputDevice>Wired Headphones</defaultOutputDevice>
             <defaultInputDevice>Wired-In Headsets</defaultInputDevice>
-=======
-                <item>Built-In Mic</item>
-            </attachedDevices>
-            <defaultOutputDevice>Speaker</defaultOutputDevice>
->>>>>>> post_merge/android-11.0.0_2.0.0
             <mixPorts>
                 <mixPort name="primary output" role="source" flags="AUDIO_OUTPUT_FLAG_PRIMARY">
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
@@ -82,11 +76,8 @@
                 </devicePort>
                 <devicePort tagName="BT SCO Headset Mic" type="AUDIO_DEVICE_IN_BLUETOOTH_SCO_HEADSET" role="source">
                 </devicePort>
-<<<<<<< HEAD
                 <devicePort tagName="Wired-In Headsets" type="AUDIO_DEVICE_IN_WIRED_HEADSET" role="source">
                 </devicePort>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
             </devicePorts>
             <routes>
                 <route type="mix" sink="Speaker"
@@ -103,11 +94,7 @@
                        sources="bt sco output"/>
 
                 <route type="mix" sink="primary input"
-<<<<<<< HEAD
                        sources="Wired-In Headsets,Built-In Mic,Spdif-In,BT SCO Headset Mic"/>
-=======
-                       sources="Built-In Mic,Spdif-In,BT SCO Headset Mic"/>
->>>>>>> post_merge/android-11.0.0_2.0.0
             </routes>
         </module>
 
diff --git a/imx8m/evk_a300/evk_8mq.mk b/imx8m/evk_a300/evk_8mq.mk
index 27ee02ba..020f88f9 100644
--- a/imx8m/evk_a300/evk_8mq.mk
+++ b/imx8m/evk_a300/evk_8mq.mk
@@ -1,20 +1,11 @@
-<<<<<<< HEAD
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
 IMX_DEVICE_PATH := device/nxp/imx8m/evk_8mq
-=======
-# -------@block_infrastructure-------
-
-CONFIG_REPO_PATH := device/nxp
-CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
-IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # configs shared between uboot, kernel and Android rootfs
 include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
 
-<<<<<<< HEAD
 -include device/nxp/common/imx_path/ImxPathConfig.mk
 include device/nxp/imx8m/ProductConfigCommon.mk
 
@@ -25,19 +16,12 @@ endif
 ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.nxp),)
 $(shell touch $(IMX_DEVICE_PATH)/fstab.nxp)
 endif
-=======
--include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
-include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
-
-# -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # Overrides
 PRODUCT_NAME := evk_8mq
 PRODUCT_DEVICE := evk_8mq
 PRODUCT_MODEL := EVK_8MQ
 
-<<<<<<< HEAD
 PRODUCT_FULL_TREBLE_OVERRIDE := true
 PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
 PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
@@ -53,78 +37,12 @@ TARGET_USE_DYNAMIC_PARTITIONS ?= true
 #If the device is retrofit to have dynamic partition feature, set this variable to true to build
 #the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
 TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
-=======
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-PRODUCT_CHARACTERISTICS := tablet
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# -------@block_treble-------
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-
-# -------@block_power-------
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-PRODUCT_PACKAGES += \
-    android.hardware.power-service.imx
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mq.json
-
-# -------@block_app-------
-#Enable this to choose 32 bit user space build
-IMX8_BUILD_32BIT_ROOTFS := false
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-
-# -------@block_kernel_bootimg-------
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh
-
-# -------@block_storage-------
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
   PRODUCT_USE_DYNAMIC_PARTITIONS := true
   BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
   BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-<<<<<<< HEAD
   ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
     PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
     BOARD_SUPER_PARTITION_METADATA_DEVICE := system
@@ -141,49 +59,11 @@ ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   endif
 endif
 
-=======
-endif
-
-#Enable this to disable product partition build.
-IMX_NO_PRODUCT_PARTITION := false
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
-  PRODUCT_PACKAGES += imx_ota_postinstall
-
-  AB_OTA_POSTINSTALL_CONFIG += \
-    RUN_POSTINSTALL_vendor=true \
-    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
-    FILESYSTEM_TYPE_vendor=ext4 \
-    POSTINSTALL_OPTIONAL_vendor=false
-
-  PRODUCT_COPY_FILES += \
-    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mq-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
-endif
-
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# -------@block_security-------
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Include keystore attestation keys and certificates.
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 -include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
 endif
 
-<<<<<<< HEAD
 # Copy device related config and binary to board
 PRODUCT_COPY_FILES += \
     $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
@@ -299,104 +179,11 @@ PRODUCT_COPY_FILES += \
 
 # GPU openCL icdloader config file
 -include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
-=======
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# hardware backed keymaster service
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-# Keymaster HAL
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-# -------@block_audio-------
-# Audio card json
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml
-
-# -------@block_camera-------
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/camera_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mq.json \
-    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-# -------@block_display-------
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # HWC2 HAL
 PRODUCT_PACKAGES += \
     android.hardware.graphics.composer@2.4-service
 
-<<<<<<< HEAD
 # Charger Mode
 PRODUCT_PRODUCT_PROPERTIES += \
     ro.charger.no_ui=false
@@ -410,63 +197,27 @@ PRODUCT_PACKAGES += \
     android.hardware.graphics.mapper@2.0-impl-2.1 \
     android.hardware.graphics.allocator@2.0-impl \
     android.hardware.graphics.allocator@2.0-service
-=======
-# define frame buffer count
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@4.0-impl.imx \
-    android.hardware.graphics.allocator@4.0-service.imx
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # RenderScript HAL
 PRODUCT_PACKAGES += \
     android.hardware.renderscript@1.0-impl
 
 PRODUCT_PACKAGES += \
-<<<<<<< HEAD
         libEGL_VIVANTE \
         libGLESv1_CM_VIVANTE \
         libGLESv2_VIVANTE \
         gralloc_viv.imx \
-=======
-        libg2d-opencl
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod \
-    MultiDisplay
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
-
-# -------@block_gpu-------
-PRODUCT_PACKAGES += \
-        libEGL_VIVANTE \
-        libGLESv1_CM_VIVANTE \
-        libGLESv2_VIVANTE \
-        gralloc_viv.$(TARGET_BOARD_PLATFORM) \
->>>>>>> post_merge/android-11.0.0_2.0.0
         libGAL \
         libGLSLC \
         libVSC \
         libgpuhelper \
         libSPIRV_viv \
         libvulkan_VIVANTE \
-<<<<<<< HEAD
         vulkan.imx \
         libCLC \
         libLLVM_viv \
         libOpenCL \
         libg2d-opencl \
-=======
-        vulkan.$(TARGET_BOARD_PLATFORM) \
-        libCLC \
-        libLLVM_viv \
-        libOpenCL \
->>>>>>> post_merge/android-11.0.0_2.0.0
         libg2d-viv \
         libOpenVX \
         libOpenVXU \
@@ -483,7 +234,6 @@ PRODUCT_PACKAGES += \
         libNNArchPerf \
         libarchmodelSw
 
-<<<<<<< HEAD
 PRODUCT_PACKAGES += \
     android.hardware.audio@6.0-impl:32 \
     android.hardware.audio@2.0-service \
@@ -514,47 +264,21 @@ PRODUCT_PACKAGES += \
 PRODUCT_PACKAGES += \
     android.hardware.bluetooth@1.0-impl \
     android.hardware.bluetooth@1.0-service
-=======
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# GPU openCL SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/CL/cl_sdk.mk
-
-# GPU openVX SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/nnxc_kernels/nnxc_kernels.mk
-
-# GPU openCL icdloader config file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
-
-
-# -------@block_wifi-------
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # WiFi HAL
 PRODUCT_PACKAGES += \
     android.hardware.wifi@1.0-service \
-<<<<<<< HEAD
     wifilogd \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     wificond
 
 # WiFi RRO
 PRODUCT_PACKAGES += \
     WifiOverlay
 
-<<<<<<< HEAD
 # NXP 8997 Bluetooth vendor config
 PRODUCT_PACKAGES += \
     bt_vendor.conf
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 # NXP 8997 Wifi and Bluetooth Combo Firmware
 PRODUCT_COPY_FILES += \
     vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
@@ -565,7 +289,6 @@ PRODUCT_COPY_FILES += \
     external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
     external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
 
-<<<<<<< HEAD
 # hardware backed keymaster service
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 PRODUCT_PACKAGES += \
@@ -611,33 +334,6 @@ ifneq ($(BUILD_TARGET_FS),ubifs)
 PRODUCT_PROPERTY_OVERRIDES += \
     ro.frp.pst=/dev/block/by-name/presistdata
 endif
-=======
-# -------@block_bluetooth-------
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-# NXP 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# -------@block_usb-------
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
-
-# -------@block_multimedia_codec-------
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 PRODUCT_PACKAGES += \
     libg1 \
@@ -658,7 +354,6 @@ PRODUCT_PACKAGES += \
     c2_component_register_ra \
     c2_component_register_rv
 
-<<<<<<< HEAD
 # Add oem unlocking option in settings.
 PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
 PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
@@ -697,8 +392,6 @@ PRODUCT_PACKAGES += \
 
 IMX-DEFAULT-G2D-LIB := libg2d-viv
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 INSTALL_64BIT_LIBRARY := true
@@ -706,65 +399,9 @@ endif
 -include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
 endif
 
-<<<<<<< HEAD
 PRODUCT_SOONG_NAMESPACES += hardware/google/camera
 PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
 
 $(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
 
 $(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-=======
-# -------@block_neural_network-------
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# -------@block_miscellaneous-------
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a300/init.imx8mq.rc b/imx8m/evk_a300/init.imx8mq.rc
index 01f07c48..038c07d6 100755
--- a/imx8m/evk_a300/init.imx8mq.rc
+++ b/imx8m/evk_a300/init.imx8mq.rc
@@ -7,11 +7,7 @@ on early-boot
     write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
 
     # Set NN reject model by weights md5
-<<<<<<< HEAD
     setprop WEIGHT_MD5_CHECK 1
-=======
-    setprop vendor.MODEL_BLOCK_LEVEL 1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # change for FSL specific service
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
@@ -23,13 +19,6 @@ on early-boot
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
-<<<<<<< HEAD
-=======
-    chown root system /sys/devices/system/cpu/cpu2/online
-    chmod 0664 /sys/devices/system/cpu/cpu2/online
-    chown root system /sys/devices/system/cpu/cpu3/online
-    chmod 0664 /sys/devices/system/cpu/cpu3/online
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on property:sys.boot_completed=1
     # Set default CPU frequency governor
@@ -39,10 +28,6 @@ on property:sys.boot_completed=1
     # Set up and down limit to 200us/200us
     write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 200
     write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 200
-<<<<<<< HEAD
-=======
-    write /proc/sys/kernel/sched_util_clamp_min 512
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on property:sys.boot_completed=1
     # update cpuset now that processors are up
@@ -59,7 +44,6 @@ on property:sys.boot_completed=1
     # system-background is for system tasks that should only run on
     # little cores, not on bigs to be used only by init
     write /dev/cpuset/system-background/cpus 0-2
-<<<<<<< HEAD
 
 on init
     #IDtech added for AB ota update bootloader
@@ -67,5 +51,3 @@ on init
     symlink   /dev/block/mmcblk0boot1p1   /dev/block/by-name/spl_b
     symlink   /dev/block/mmcblk0boot0p2   /dev/block/by-name/spl_bak_a
     symlink   /dev/block/mmcblk0boot1p2   /dev/block/by-name/spl_bak_b
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/evk_a300/init.rc b/imx8m/evk_a300/init.rc
index 17ede86d..f482abf0 100644
--- a/imx8m/evk_a300/init.rc
+++ b/imx8m/evk_a300/init.rc
@@ -1,28 +1,11 @@
 import /vendor/etc/init/hw/init.${ro.hardware}.usb.rc
 import /vendor/etc/init/hw/init.${ro.hardware}.${ro.boot.soc_type}.rc
-<<<<<<< HEAD
 import /init.idtech.rc
-=======
-
-service vendor.charger /system/bin/charger
-    class charger
-    user system
-    group system wakelock input
-    capabilities SYS_BOOT
-    file /dev/kmsg w
-    file /sys/fs/pstore/console-ramoops-0 r
-    file /sys/fs/pstore/console-ramoops r
-    file /proc/last_kmsg r
-
-on charger
-    start vendor.charger
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on early-init
     # mount the debugfs
     mount debugfs none /sys/kernel/debug/ mode=0755
 
-<<<<<<< HEAD
     # Mount binderfs
     mkdir /dev/binderfs
     mount binder binder /dev/binderfs stats=global
@@ -39,12 +22,6 @@ on early-init
 
 on early-init
     start early_init_sh
-=======
-on early-init
-    start early_init_sh
-    # Set the host name which used in console
-    export HOSTNAME evk_8mq
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Due keymaster start very early so set prop here
     # Also gatekeeper share same role for keymaster
@@ -52,32 +29,18 @@ on early-init
     setprop ro.hardware.gatekeeper ${ro.boot.keystore}
     setprop vendor.storageproxyd ${ro.boot.keystore}
 
-<<<<<<< HEAD
 on init
-=======
-    # Use ro.boot.lcd_density to override ro.sf.lcd_density
-    setprop ro.sf.lcd_density ${ro.boot.lcd_density}
-
-# Skip charger_not_need trigger for charger mode
-on early-init && property:ro.boot.mode=charger
-    setprop vendor.skip.charger_not_need 1
-
-on init && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     start watchdogd
 
     # Support legacy paths
     symlink /sdcard /mnt/sdcard
     symlink /sdcard /storage/sdcard0
 
-<<<<<<< HEAD
     # setup the global environment
     export CORE_REGISTER_FILE /vendor/etc/core_register
     export COMPONENT_REGISTER_FILE /vendor/etc/component_register
     export CONTENTPIPE_REGISTER_FILE /vendor/etc/contentpipe_register
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     # disable cursor blink for fbcon, if no splash screen support
     write /sys/class/graphics/fbcon/cursor_blink 0
 
@@ -103,7 +66,6 @@ on init && property:vendor.skip.charger_not_need=0
     write /dev/stune/rt/schedtune.boost 50
     write /dev/stune/rt/schedtune.prefer_idle 1
 
-<<<<<<< HEAD
 on late-fs
     # Start keymaster service
     start vendor.keymaster-3-0-${ro.boot.keystore}
@@ -115,29 +77,11 @@ on late-fs && property:vendor.storageproxyd=trusty
     start vendor.oemlock-1-0
 
 on early-boot
-=======
-on late-fs && property:vendor.skip.charger_not_need=0
-    # Start keymaster/gatekeeper service
-    start vendor.gatekeeper-1-0-${ro.boot.keystore}
-    start vendor.keymaster-4-0-${ro.boot.keystore}
-    setprop vendor.powerhal.init 1
-
-    # Wait for keymaster
-    exec_start wait_for_keymaster
-
-    mount_all /vendor/etc/fstab.nxp --late
-
-on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
-    start vendor.oemlock-1-0
-
-on early-boot && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     # For evk_8mq, when swap used about 400M, upgrade the level.
     setprop ro.lmk.upgrade_pressure 87
     setprop ro.lmk.downgrade_pressure 95
     setprop ro.lmk.critical_upgrade true
 
-<<<<<<< HEAD
     # Set the host name which used in console
     export HOSTNAME evk_a300
 
@@ -163,26 +107,11 @@ on early-boot && property:vendor.skip.charger_not_need=0
     setprop back_camera_orient 0
     setprop front_camera_name mx6s-csi1
     setprop front_camera_orient 0
-=======
-    setprop vendor.sys.hwc.disable     1
-    setprop vendor.2d.composition 0
-    setprop vendor.hwc.stretch.filter  1
-
-    #viv sdk dir
-    setprop vendor.VIVANTE_SDK_DIR /vendor/etc/viv_sdk
-
-    # fsl omx graphic manager media framework property
-    setprop vendor.rw.VIDEO_RENDER_NAME video_render.surface
-    setprop vendor.media.fsl_codec.flag 7
-
-    setprop camera.disable_zsl_mode 1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
    # Tweak the mmc device read ahead buffer size
     write /sys/block/mmcblk0/queue/read_ahead_kb 2048
     write /sys/block/mmcblk1/queue/read_ahead_kb 2048
 
-<<<<<<< HEAD
     # Set period_us for usb audio
     setprop ro.audio.usb.period_us 20000
 
@@ -204,12 +133,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
 
     # Use ro.boot.lcd_density to override ro.sf.lcd_density
     setprop ro.sf.lcd_density ${ro.boot.lcd_density}
-=======
-    # Prepare for wifi
-    setprop wifi.interface wlan0
-    setprop wifi.direct.interface p2p0
-    setprop wifi.concurrent.interface wlan1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Disable surfaceflinger back pressure propagate
     setprop debug.sf.disable_backpressure 1
@@ -222,7 +145,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0664 /sys/kernel/debug/sync/sw_sync
 
     # Default backlight device
-<<<<<<< HEAD
     #setprop hw.backlight.dev "30a00000.mipi_dsi.0"
     # Chmod/chown FSL specific sys entry
     #chown system system /sys/class/backlight/30a00000.mipi_dsi.0/brightness
@@ -245,16 +167,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
 
     # Dectect DSF streams when scanning media
     setprop ro.FSL_DSF_PARSER 1
-=======
-    setprop vendor.hw.backlight.dev "30a00000.mipi-dsi.0"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/30a00000.mipi-dsi.0/brightness
-    chmod 0660 /sys/class/backlight/30a00000.mipi-dsi.0/brightness
-
-    # Set light sensor sysfs path and light sensor threshold lux value
-    setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
-    setprop vendor.ro.lightsensor.threshold  20
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Allow DSD file(duration larger than 10s) can play
     setprop audio.offload.min.duration.secs 10
@@ -262,7 +174,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # Enlarge limition of audio buffer allocation
     setprop ro.af.client_heap_size_kbyte 32768
 
-<<<<<<< HEAD
     # enlarge media max memory size to 3G.
     setprop ro.media.maxmem 3221225471
 
@@ -270,9 +181,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     start vendor.wifi_hal_legacy
 
 on boot
-=======
-on boot && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     start audioserver
     start mediadrm
     start media
@@ -284,10 +192,6 @@ service wpa_supplicant /vendor/bin/hw/wpa_supplicant \
     interface android.hardware.wifi.supplicant@1.0::ISupplicant default
     interface android.hardware.wifi.supplicant@1.1::ISupplicant default
     interface android.hardware.wifi.supplicant@1.2::ISupplicant default
-<<<<<<< HEAD
-=======
-    interface android.hardware.wifi.supplicant@1.3::ISupplicant default
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     socket wpa_wlan0 dgram 660 wifi wifi
     disabled
@@ -297,7 +201,6 @@ service sensor_fusion /vendor/bin/fsl_sensor_fusion
     class late_start
     seclabel u:r:sensors:s0
     user system
-<<<<<<< HEAD
     group input
     oneshot
 
@@ -307,17 +210,11 @@ service vendor.sensors-hal-1-0 /vendor/bin/hw/android.hardware.sensors@1.0-servi
     group system wakelock input root
     capabilities BLOCK_SUSPEND SYS_NICE
 
-=======
-    group system uhid
-    oneshot
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
 service watchdogd /system/bin/watchdogd 10 20
     class core
     seclabel u:r:watchdogd:s0
 
-<<<<<<< HEAD
 service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
     class main
     disabled
@@ -361,24 +258,14 @@ service iprenew_bt-pan /system/bin/dhcpcd -n
 # bugreport is triggered by holding down volume down, volume up and power
 service bugreport /system/bin/dumpstate -d -p -B -z \
         -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
-=======
-# bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -z
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     disabled
     oneshot
     keycodes 114 115 116
 
-<<<<<<< HEAD
 on fs
 # mount ext4 partitions
     mount_all /vendor/etc/fstab.freescale --early
-=======
-on fs && property:vendor.skip.charger_not_need=0
-# mount ext4 partitions
-    mount_all /vendor/etc/fstab.nxp --early
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Adjust parameters for dm-verity device
     write /sys/block/dm-0/queue/read_ahead_kb 4096
@@ -386,23 +273,15 @@ on fs && property:vendor.skip.charger_not_need=0
     # Update dm-verity state and set partition.*.verified properties
     verity_update_state
 
-<<<<<<< HEAD
 on verity-logging
     exec u:r:slideshow:s0 -- /sbin/slideshow warning/verity_red_1 warning/verity_red_2
 
 on post-fs
-=======
-on post-fs && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     # Set netd memlock rlimit to 8MB
     setrlimit 8 8388608 8388608
 
     # Turn on swap
-<<<<<<< HEAD
     swapon_all /vendor/etc/fstab.freescale
-=======
-    swapon_all /vendor/etc/fstab.nxp
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Swap in only 1 page at a time
     write /proc/sys/vm/page-cluster 0
@@ -411,17 +290,12 @@ on post-fs && property:vendor.skip.charger_not_need=0
     chown system system /proc/pagetypeinfo
     chmod 0440 /proc/pagetypeinfo
 
-<<<<<<< HEAD
 on post-fs-data
-=======
-on post-fs-data && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     setprop vold.post_fs_data_done 1
     # create temp node for secure storage proxy
     mkdir /data/vendor/ss 0700 system system
 
     # tmp dir for opencl Compiler
-<<<<<<< HEAD
     setprop TMPDIR /data/vendor/.opencl-cache
     mkdir /data/vendor/.opencl-cache 0771 system camera
 
@@ -436,40 +310,20 @@ on zygote-start
     chown dhcp dhcp /data/misc/dhcp
 
 service early_init_sh /vendor/bin/init.insmod.sh /vendor/etc/early.init.cfg sys.all.early_init.ready
-=======
-    setprop vendor.TMPDIR /data/vendor/.opencl-cache
-    mkdir /data/vendor/.opencl-cache 0771 system camera
-
-on zygote-start && property:vendor.skip.charger_not_need=0
-    # Create the directories used by the Wireless subsystem
-    mkdir /data/vendor/wifi 0771 wifi wifi
-    mkdir /data/vendor/wifi/wpa 0770 wifi wifi
-    mkdir /data/vendor/wifi/wpa/sockets 0770 wifi wifi
-
-service early_init_sh /vendor/bin/init.insmod.sh /vendor/etc/early.init.cfg vendor.all.early_init.ready
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     user root
     group root system
     disabled
     oneshot
 
-<<<<<<< HEAD
 on property:sys.boot_completed=1 && property:vendor.storageproxyd=trusty
-=======
-on property:sys.boot_completed=1 && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     start storageproxyd
 
 service storageproxyd /vendor/bin/storageproxyd -p /data/vendor/ss -r /dev/mmcblk0rpmb -d /dev/trusty-ipc-dev0
    group system
 
 
-<<<<<<< HEAD
 on property:ro.boot.vendor.sysrq=1
-=======
-on property:ro.boot.vendor.sysrq=1 && property:vendor.skip.charger_not_need=0
->>>>>>> post_merge/android-11.0.0_2.0.0
     write /proc/sys/kernel/sysrq 1
 
 # setenv append_bootargs androidboot.usb.debugging=1
diff --git a/imx8m/kingscanyon_8mq/AndroidBoard.mk b/imx8m/kingscanyon_8mq/AndroidBoard.mk
index cb6595f6..75defabe 100644
--- a/imx8m/kingscanyon_8mq/AndroidBoard.mk
+++ b/imx8m/kingscanyon_8mq/AndroidBoard.mk
@@ -1,8 +1,8 @@
 LOCAL_PATH := $(call my-dir)
 
-include device/idtech/common/build/dtbo.mk
-include device/idtech/common/build/imx-recovery.mk
-include device/idtech/common/build/gpt.mk
+include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
+include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
+include $(CONFIG_REPO_PATH)/common/build/gpt.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
 -include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/kingscanyon_8mq/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0 b/imx8m/kingscanyon_8mq/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 75defabe..00000000
--- a/imx8m/kingscanyon_8mq/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,8 +0,0 @@
-LOCAL_PATH := $(call my-dir)
-
-include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
-include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
-include $(CONFIG_REPO_PATH)/common/build/gpt.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
--include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/kingscanyon_8mq/AndroidTee.mk b/imx8m/kingscanyon_8mq/AndroidTee.mk
index 96af4355..ef45e595 100644
--- a/imx8m/kingscanyon_8mq/AndroidTee.mk
+++ b/imx8m/kingscanyon_8mq/AndroidTee.mk
@@ -4,11 +4,7 @@ MAKE += SHELL=/bin/bash
 define build_uboot_w_tee
 	$(MAKE) -C bootable/bootloader/arm-trusted-firmware/ -B CROSS_COMPILE=aarch64-linux-android- PLAT=imx8mq V=1 SPD=opteed DECRYPTED_BUFFER_START=$(DECRYPTED_BUFFER_START) DECRYPTED_BUFFER_LEN=$(DECRYPTED_BUFFER_LEN) DECODED_BUFFER_START=$(DECODED_BUFFER_START) DECODED_BUFFER_LEN=$(DECODED_BUFFER_LEN) bl31; \
 	cp bootable/bootloader/arm-trusted-firmware/build/imx8mq/release/bl31.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.;\
-<<<<<<< HEAD
-	aarch64-linux-android-objcopy -O binary out/target/product/kingscanyon_8mq/optee/arm-plat-imx/core/tee.elf $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
-=======
-	aarch64-linux-android-objcopy -O binary out/target/product/evk_8mq/optee/arm-plat-imx/core/tee.elf $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
->>>>>>> post_merge/android-11.0.0_2.0.0
+	aarch64-linux-android-objcopy -O binary $(PRODUCT_OUT)/optee/arm-plat-imx/core/tee.elf $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 	$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ clean; \
 	$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8M  flash_hdmi_spl_uboot; \
 	cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(PRODUCT_OUT)/u-boot-$(strip $(2)).imx;
diff --git a/imx8m/kingscanyon_8mq/AndroidUboot.mk b/imx8m/kingscanyon_8mq/AndroidUboot.mk
index 1d614056..dc84d931 100644
--- a/imx8m/kingscanyon_8mq/AndroidUboot.mk
+++ b/imx8m/kingscanyon_8mq/AndroidUboot.mk
@@ -2,16 +2,9 @@
 MAKE += SHELL=/bin/bash
 
 ifneq ($(AARCH64_GCC_CROSS_COMPILE),)
-<<<<<<< HEAD
-ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
-else
-ATF_TOOLCHAIN_ABS := $(realpath prebuilts/gcc/$(HOST_PREBUILT_TAG)/aarch64/aarch64-linux-android-4.9/bin)
-ATF_CROSS_COMPILE := $(ATF_TOOLCHAIN_ABS)/aarch64-linux-androidkernel-
-=======
   ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
 else
   $(error shell env AARCH64_GCC_CROSS_COMPILE is not set)
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 define build_imx_uboot
@@ -19,19 +12,11 @@ define build_imx_uboot
 	cp $(UBOOT_OUT)/u-boot-nodtb.$(strip $(1)) $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(UBOOT_OUT)/spl/u-boot-spl.bin  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(UBOOT_OUT)/tools/mkimage  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/mkimage_uboot; \
-<<<<<<< HEAD
 	cp $(UBOOT_OUT)/arch/arm/dts/idt_imx8mq_evt-0_ibr210_evt-0.dtb  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/imx8mq-evk.dtb; \
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/hdmi/cadence/signed_hdmi_imx8m.bin  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
 	if [ `echo $(2) | cut -d '-' -f3` = "trusty" ] && [ `echo $(2) | rev | cut -d '-' -f1` != "uuu" ]; then \
-=======
-	cp $(UBOOT_OUT)/arch/arm/dts/imx8mq-evk.dtb  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
-	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/hdmi/cadence/signed_hdmi_imx8m.bin  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
-	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
-	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
-	if [ `echo $(2) | cut -d '-' -f2` = "trusty" ] && [ `echo $(2) | rev | cut -d '-' -f1` != "uuu" ]; then \
->>>>>>> post_merge/android-11.0.0_2.0.0
 		cp $(FSL_PROPRIETARY_PATH)/fsl-proprietary/uboot-firmware/imx8m/tee-imx8mq.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 		$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ CROSS_COMPILE="$(ATF_CROSS_COMPILE)" PLAT=`echo $(2) | cut -d '-' -f1` bl31 -B SPD=trusty 1>/dev/null || exit 1; \
 	else \
@@ -51,7 +36,6 @@ define build_imx_uboot
 	fi; \
 	if [ `echo $(2) | rev | cut -d '-' -f1 | rev` != "dual" ]; then \
 		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(UBOOT_COLLECTION)/u-boot-$(strip $(2)).imx; \
-<<<<<<< HEAD
 		if [ -f device/idtech/common/prebuilts/spl_tab_auxiliary.img ]; then \
 			dd if=device/idtech/common/prebuilts/spl_tab_auxiliary.img of=$(UBOOT_COLLECTION)/u-boot-$(strip $(2)).imx bs=1 seek=105984 conv=notrunc; \
 		fi; \
@@ -61,11 +45,6 @@ define build_imx_uboot
 		if [ -f device/idtech/common/prebuilts/spl_tab_auxiliary.img ]; then \
 			dd if=device/idtech/common/prebuilts/spl_tab_auxiliary.img of=$(UBOOT_COLLECTION)/spl-$(strip $(2)).bin bs=1 seek=105984 conv=notrunc; \
 		fi; \
-=======
-	else \
-		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(UBOOT_COLLECTION)/spl-$(strip $(2)).bin; \
-		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/u-boot-ivt.itb $(UBOOT_COLLECTION)/bootloader-$(strip $(2)).img; \
->>>>>>> post_merge/android-11.0.0_2.0.0
 	fi;
 endef
 
diff --git a/imx8m/kingscanyon_8mq/BoardConfig.mk b/imx8m/kingscanyon_8mq/BoardConfig.mk
index 2940f7ff..e21779de 100644
--- a/imx8m/kingscanyon_8mq/BoardConfig.mk
+++ b/imx8m/kingscanyon_8mq/BoardConfig.mk
@@ -1,5 +1,3 @@
-<<<<<<< HEAD
-=======
 # -------@block_infrastructure-------
 #
 # Product-specific compile-time definitions.
@@ -8,42 +6,23 @@
 include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
 
 # -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 #
 # SoC-specific compile-time definitions.
 #
 
 BOARD_SOC_TYPE := IMX8MQ
-<<<<<<< HEAD
 BOARD_SOM_TYPE := imx8mq
 BOARD_TYPE := IBR210
 BOARD_MAIN_DISPLAY_ROTATION := 0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 BOARD_HAVE_VPU := true
 BOARD_VPU_TYPE := hantro
 HAVE_FSL_IMX_GPU2D := false
 HAVE_FSL_IMX_GPU3D := true
-<<<<<<< HEAD
-HAVE_FSL_IMX_IPU := false
-HAVE_FSL_IMX_PXP := false
-BOARD_KERNEL_BASE := 0x40400000
-TARGET_GRALLOC_VERSION := v3
-TARGET_USES_HWC2 := true
-TARGET_HWCOMPOSER_VERSION := v2.0
-USE_OPENGL_RENDERER := true
-TARGET_HAVE_VULKAN := true
-ENABLE_CFI=false
-
-SOONG_CONFIG_IMXPLUGIN += \
-                          BOARD_HAVE_VPU \
-=======
 HAVE_FSL_IMX_PXP := false
 TARGET_USES_HWC2 := true
 TARGET_HAVE_VULKAN := true
 
 SOONG_CONFIG_IMXPLUGIN += \
->>>>>>> post_merge/android-11.0.0_2.0.0
                           BOARD_VPU_TYPE
 
 SOONG_CONFIG_IMXPLUGIN_BOARD_SOC_TYPE = IMX8MQ
@@ -51,50 +30,6 @@ SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU = true
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_TYPE = hantro
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_ONLY = false
 
-<<<<<<< HEAD
-#
-# Product-specific compile-time definitions.
-#
-
-IMX_DEVICE_PATH := device/idtech/imx8m/kingscanyon_8mq
-
-include device/idtech/imx8m/BoardConfigCommon.mk
-
-BUILD_TARGET_FS ?= ext4
-TARGET_USERIMAGES_USE_EXT4 := true
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-# Support gpt
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab_super.bpt
-  ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
-                           partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
-else
-  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-13GB-ab-no-product.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab-no-product.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
-  else
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
-  endif
-endif
-
-# Vendor Interface manifest and compatibility
-DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
-DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-USE_OPENGL_RENDERER := true
-
-BOARD_WLAN_DEVICE            := qcwcn
-=======
 # -------@block_memory-------
 USE_ION_ALLOCATOR := true
 USE_GPU_ALLOCATOR := false
@@ -107,9 +42,9 @@ TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
 
 # Support gpt
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab_super.bpt
+  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab_super.bpt
   ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
+                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
                            partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
 else
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -118,14 +53,17 @@ else
                              partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
   else
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab.bpt
+    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab.bpt
     ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
+                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
   endif
 endif
 
-BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-imx8mq.img
+AB_OTA_PARTITIONS += spl_bak
+LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
+LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
+BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
 
 BOARD_USES_METADATA_PARTITION := true
 BOARD_ROOT_EXTRA_FOLDERS += metadata
@@ -134,23 +72,25 @@ BOARD_ROOT_EXTRA_FOLDERS += metadata
 ENABLE_CFI=false
 
 BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA4096
+BOARD_AVB_ALGORITHM := SHA256_RSA2048
 # The testkey_rsa4096.pem is copied from external/avb/test/data/testkey_rsa4096.pem
-BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/testkey_rsa4096.pem
+BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/idt_testkey_rsa2048.pem
 
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
+#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
+#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
+#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
 
 # -------@block_treble-------
 # Vendor Interface manifest and compatibility
 DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
+ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
+DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
+endif
 DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
 DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE := $(IMX_DEVICE_PATH)/device_framework_matrix.xml
 
 # -------@block_wifi-------
-BOARD_WLAN_DEVICE            := nxp
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_WLAN_DEVICE            := qcwcn
 WPA_SUPPLICANT_VERSION       := VER_0_8_X
 BOARD_WPA_SUPPLICANT_DRIVER  := NL80211
 BOARD_HOSTAPD_DRIVER         := NL80211
@@ -159,11 +99,10 @@ BOARD_WPA_SUPPLICANT_PRIVATE_LIB    := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 
 WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
 
-<<<<<<< HEAD
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
+# -------@block_bluetooth-------
 # Qcom 1CQ(QCA6174) BT
 BOARD_HAVE_BLUETOOTH_QCOM := true
+BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
 BOARD_HAS_QCA_BT_ROME := true
 BOARD_HAVE_BLUETOOTH_BLUEZ := false
 QCOM_BT_USE_SIBS := true
@@ -171,40 +110,11 @@ ifeq ($(QCOM_BT_USE_SIBS), true)
     WCNSS_FILTER_USES_SIBS := true
 endif
 
-BOARD_USE_SENSOR_FUSION := true
-
-# we don't support sparse image.
-TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
-
-BOARD_HAVE_USB_CAMERA := true
-BOARD_HAVE_USB_MJPEG_CAMERA := false
-
-USE_ION_ALLOCATOR := true
-USE_GPU_ALLOCATOR := false
-
-BOARD_AVB_ENABLE := true
-TARGET_USES_MKE2FS := true
-BOARD_AVB_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_KEY_PATH := device/idtech/common/security/idt_testkey_rsa2048.pem
-
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
-
-# define frame buffer count
-NUM_FRAMEBUFFER_SURFACE_BUFFERS := 4
-=======
-# -------@block_bluetooth-------
-# NXP 8997 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
 # -------@block_sensor-------
 BOARD_USE_SENSOR_FUSION := true
 
 # -------@block_kernel_bootimg-------
 BOARD_KERNEL_BASE := 0x40400000
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(PRODUCT_IMX_DRM),true)
 CMASIZE=736M
@@ -222,11 +132,7 @@ BOARD_KERNEL_CMDLINE += androidboot.fbTileSupport=enable
 BOARD_KERNEL_CMDLINE += transparent_hugepage=never cma=$(CMASIZE)
 
 # display config
-<<<<<<< HEAD
-BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=mxsfb-drm androidboot.gui_resolution=1080p androidboot.displaymode=4kp60
-=======
-BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-dcss androidboot.gui_resolution=1080p
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-dcss androidboot.gui_resolution=1080p androidboot.displaymode=4kp60
 
 # wifi config
 BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_para.conf
@@ -235,28 +141,12 @@ ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
 BOARD_KERNEL_CMDLINE += androidboot.vendor.sysrq=1
 endif
 
-<<<<<<< HEAD
-ifeq ($(TARGET_USERIMAGES_USE_UBIFS),true)
-ifeq ($(TARGET_USERIMAGES_USE_EXT4),true)
-$(error "TARGET_USERIMAGES_USE_UBIFS and TARGET_USERIMAGES_USE_EXT4 config open in same time, please only choose one target file system image")
-endif
-endif
-
-LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
-LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
-BOARD_PREBUILT_DTBOIMAGE := out/target/product/kingscanyon_8mq/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-product.dtb
   else
     # imx8mq with HDMI display
-<<<<<<< HEAD
-    TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk.dtb
-=======
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-pcie1-m2.dtb
->>>>>>> post_merge/android-11.0.0_2.0.0
     # imx8mq with MIPI-HDMI display
     TARGET_BOARD_DTS_CONFIG += imx8mq-mipi:imx8mq-evk-lcdif-adv7535.dtb
     # imx8mq with HDMI and MIPI-HDMI display
@@ -268,14 +158,6 @@ else # no dynamic parition feature
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-product-no-dynamic_partition.dtb
   else
-<<<<<<< HEAD
-    TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-dynamic_partition.dtb
-  endif
-endif
-
-BOARD_SEPOLICY_DIRS := \
-       device/idtech/imx8m/sepolicy \
-=======
 	TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-dynamic_partition.dtb
   endif
 endif
@@ -285,7 +167,6 @@ ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
 # -------@block_sepolicy-------
 BOARD_SEPOLICY_DIRS := \
        $(CONFIG_REPO_PATH)/imx8m/sepolicy \
->>>>>>> post_merge/android-11.0.0_2.0.0
        $(IMX_DEVICE_PATH)/sepolicy
 
 ifeq ($(PRODUCT_IMX_DRM),true)
@@ -293,16 +174,4 @@ BOARD_SEPOLICY_DIRS += \
        $(IMX_DEVICE_PATH)/sepolicy_drm
 endif
 
-<<<<<<< HEAD
-TARGET_BOARD_KERNEL_HEADERS := device/idtech/common/kernel-headers
-
-ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
-
-BOARD_USES_METADATA_PARTITION := true
-BOARD_ROOT_EXTRA_FOLDERS += metadata
-
-BOARD_PLAT_PRIVATE_SEPOLICY_DIR := device/idtech/imx8m/sepolicy_system/private
-
-AB_OTA_PARTITIONS += spl_bak
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_PLAT_PRIVATE_SEPOLICY_DIR := $(CONFIG_REPO_PATH)/imx8m/sepolicy_system/private
diff --git a/imx8m/kingscanyon_8mq/SharedBoardConfig.mk b/imx8m/kingscanyon_8mq/SharedBoardConfig.mk
index 42a4243d..e79687af 100644
--- a/imx8m/kingscanyon_8mq/SharedBoardConfig.mk
+++ b/imx8m/kingscanyon_8mq/SharedBoardConfig.mk
@@ -1,36 +1,17 @@
-<<<<<<< HEAD
-KERNEL_NAME := Image
-TARGET_KERNEL_ARCH := arm64
-
-#Enable this to include trusty support
-PRODUCT_IMX_TRUSTY := true
-
-#Enable this to disable product partition build.
-#IMX_NO_PRODUCT_PARTITION := true
-
-# QCA qcacld wifi driver module
-BOARD_VENDOR_KERNEL_MODULES += \
-    $(KERNEL_OUT)/drivers/net/wireless/qcacld-2.0/wlan.ko
-=======
 # -------@block_kernel_bootimg-------
 
 KERNEL_NAME := Image
 TARGET_KERNEL_ARCH := arm64
 
-#NXP 8997 wifi driver module
+# QCA qcacld wifi driver module
 BOARD_VENDOR_KERNEL_MODULES += \
-    $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/mlan.ko \
-    $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/moal.ko
->>>>>>> post_merge/android-11.0.0_2.0.0
+    $(KERNEL_OUT)/drivers/net/wireless/qcacld-2.0/wlan.ko
 
 # mipi-panel touch driver module
 BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/drivers/input/touchscreen/synaptics_dsx/synaptics_dsx_i2c.ko
-<<<<<<< HEAD
-=======
 
 # -------@block_security-------
 #Enable this to include trusty support
 PRODUCT_IMX_TRUSTY := true
 
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/kingscanyon_8mq/UbootKernelBoardConfig.mk b/imx8m/kingscanyon_8mq/UbootKernelBoardConfig.mk
index 8a2a7f1e..a351c5db 100644
--- a/imx8m/kingscanyon_8mq/UbootKernelBoardConfig.mk
+++ b/imx8m/kingscanyon_8mq/UbootKernelBoardConfig.mk
@@ -2,7 +2,6 @@ TARGET_BOOTLOADER_POSTFIX := bin
 UBOOT_POST_PROCESS := true
 
 # u-boot target for imx8mq_evk
-<<<<<<< HEAD
 TARGET_BOOTLOADER_CONFIG := imx8mq-lpddr4:kingscanyon_8mq_ibr210_android_defconfig:signed
 TARGET_BOOTLOADER_CONFIG += imx8mq-lpddr4-dual:kingscanyon_8mq_ibr210_android_dual_defconfig:signed
 
@@ -12,21 +11,6 @@ TARGET_BOOTLOADER_CONFIG += imx8mq-lpddr4-evk-uuu-mic3g:kingscanyon_8mq_ibr210_a
 TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
 TARGET_KERNEL_ADDITION_DEFCONF ?= android_addition_defconfig
 TARGET_KERNEL_SECURE_DEFCONF ?= android_secure_defconfig
-=======
-TARGET_BOOTLOADER_CONFIG := imx8mq:imx8mq_evk_android_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mq-dual:imx8mq_evk_android_dual_defconfig
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-  TARGET_BOOTLOADER_CONFIG += imx8mq-trusty:imx8mq_evk_android_trusty_defconfig
-  TARGET_BOOTLOADER_CONFIG += imx8mq-trusty-secure-unlock:imx8mq_evk_android_trusty_secure_unlock_defconfig
-  TARGET_BOOTLOADER_CONFIG += imx8mq-trusty-dual:imx8mq_evk_android_trusty_dual_defconfig
-endif
-
-# u-boot target used by uuu for imx8mq_evk
-TARGET_BOOTLOADER_CONFIG += imx8mq-evk-uuu:imx8mq_evk_android_uuu_defconfig
-
-TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
-# TARGET_KERNEL_ADDITION_DEFCONF ?= android_addition_defconfig
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 
 # absolute path is used, not the same as relative path used in AOSP make
diff --git a/imx8m/kingscanyon_8mq/camera_config_imx8mq.json b/imx8m/kingscanyon_8mq/camera_config_imx8mq.json
index 0d8ed9ec..a8bde1a0 100644
--- a/imx8m/kingscanyon_8mq/camera_config_imx8mq.json
+++ b/imx8m/kingscanyon_8mq/camera_config_imx8mq.json
@@ -11,7 +11,7 @@
     {
       "camera_type": "back",
       "camera_name": "mx6s-csi",
-      "bus_info": "platform:32e20000.csi1_bridge",
+      "bus_info": "platform:30b80000.csi2_bridge",
       "orientation": "0",
       "buffer_type": "mmap",
       "ActiveArrayWidth": "2592",
diff --git a/imx8m/kingscanyon_8mq/camera_config_imx8mq.json~post_merge_android-11.0.0_2.0.0 b/imx8m/kingscanyon_8mq/camera_config_imx8mq.json~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index a8bde1a0..00000000
--- a/imx8m/kingscanyon_8mq/camera_config_imx8mq.json~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,41 +0,0 @@
-{
-  "__readme": [
-    "Basic Camera HAL v3 configuration."
-  ],
-
-  "hal_version": "3",
-  "cam_blit_copy": "GPU_3D",
-  "cam_blit_csc": "CPU",
-
-  "camera_metadata": [
-    {
-      "camera_type": "back",
-      "camera_name": "mx6s-csi",
-      "bus_info": "platform:30b80000.csi2_bridge",
-      "orientation": "0",
-      "buffer_type": "mmap",
-      "ActiveArrayWidth": "2592",
-      "ActiveArrayHeight": "1944",
-      "PixelArrayWidth": "2592",
-      "PixelArrayHeight": "1944",
-      "PhysicalWidth": "3.6288",
-      "PhysicalHeight": "2.7216",
-      "FocalLength": "3.37",
-      "MaxJpegSize": "8388608",
-      "MinFrameDuration": "33331760",
-      "MaxFrameDuration": "300000000",
-      "OmitFrame": [
-          {
-              "width": "2592",
-              "height": "1944",
-              "omit_num": "3"
-          },
-          {
-              "width": "1920",
-              "height": "1080",
-              "omit_num": "2"
-          }
-      ]
-    }
-  ]
-}
diff --git a/imx8m/kingscanyon_8mq/compatibility_matrix.xml b/imx8m/kingscanyon_8mq/compatibility_matrix.xml
index 49266e7c..347491b9 100644
--- a/imx8m/kingscanyon_8mq/compatibility_matrix.xml
+++ b/imx8m/kingscanyon_8mq/compatibility_matrix.xml
@@ -59,7 +59,6 @@
         <name>netutils-wrapper</name>
         <version>1.0</version>
     </hal>
-<<<<<<< HEAD
     <hal format="aidl" optional="true">
         <name>android.hardware.kioskled</name>
         <interface>
@@ -67,6 +66,4 @@
             <instance>default</instance>
         </interface>
     </hal>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </compatibility-matrix>
diff --git a/imx8m/kingscanyon_8mq/evk_8mq_drm.mk b/imx8m/kingscanyon_8mq/evk_8mq_drm.mk
deleted file mode 100644
index fe4b31ad..00000000
--- a/imx8m/kingscanyon_8mq/evk_8mq_drm.mk
+++ /dev/null
@@ -1,72 +0,0 @@
-# This is a FSL Android Reference Design platform based on i.MX8MQ board
-# It will inherit from FSL core product which in turn inherit from Google generic
-
-IMX_DEVICE_PATH := device/nxp/imx8m/evk_8mq
-
-PRODUCT_IMX_DRM := true
-
-# copy drm specific files before inherit evk_8mq.mk, otherwise copy is ignored
-PRODUCT_COPY_FILES += \
-	$(IMX_DEVICE_PATH)/audio_policy_configuration_drm.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-	$(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.main.rc \
-	$(IMX_DEVICE_PATH)/init.imx8mq.drm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-	$(TOPDIR)device/nxp/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
-
-
-$(call inherit-product, $(TOPDIR)device/nxp/imx8m/optee-packages.mk)
-$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/evk_8mq.mk)
-
-TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
-
-
-# Overrides
-PRODUCT_NAME := evk_8mq_drm
-
-CFG_DRM_SECURE_DATA_PATH ?= y
-CFG_RDC_SECURE_DATA_PATH ?= y
-
-ifeq ($(CFG_DRM_SECURE_DATA_PATH),y)
-CFG_SECURE_DATA_PATH := y
-SOONG_CONFIG_IMXPLUGIN += CFG_SECURE_DATA_PATH
-SOONG_CONFIG_IMXPLUGIN_CFG_SECURE_DATA_PATH = y
-CFG_TEE_SDP_MEM_BASE := 0xcc000000
-CFG_TEE_SDP_MEM_SIZE := 0x02000000
-ifeq ($(CFG_RDC_SECURE_DATA_PATH),y)
-DECRYPTED_BUFFER_START	:= $(CFG_TEE_SDP_MEM_BASE)
-DECRYPTED_BUFFER_LEN	:= $(CFG_TEE_SDP_MEM_SIZE)
-DECODED_BUFFER_START	:= 0xCE000000
-DECODED_BUFFER_LEN		:= 0x30000000
-endif
-endif
-
-TARGET_BOARD_DTS_CONFIG := imx8mq:imx8mq-evk-drm.dtb imx8mq-mipi:imx8mq-evk-lcdif-adv7535.dtb imx8mq-dual:imx8mq-evk-dual-display.dtb
-
-# Exoplayer
-PRODUCT_PACKAGES += \
-	exoplayer \
-
-# Playready
-PRODUCT_COPY_FILES += \
-	vendor/nxp/drm_artifacts/playready/Samples/devcert.dat:$(TARGET_COPY_OUT_VENDOR)/playready/devcert.dat \
-	vendor/nxp/drm_artifacts/playready/Samples/priv.dat:$(TARGET_COPY_OUT_VENDOR)/playready/priv.dat \
-	vendor/nxp/drm_artifacts/playready/bgroupcert.dat:$(TARGET_COPY_OUT_VENDOR)/playready/bgroupcert.dat \
-	vendor/nxp/drm_artifacts/playready/zgpriv_protected.dat:$(TARGET_COPY_OUT_VENDOR)/playready/zgpriv_protected.dat \
-
-ifneq ($(CFG_BUILD_DRM_FROM_SOURCES),y)
-PRODUCT_COPY_FILES += \
-	vendor/nxp/drm_artifacts/playready/ta/82dbae9c-9ce0-47e0-a1cb4048cfdb84aa.ta:$(TARGET_COPY_OUT_VENDOR)/lib/optee_armtz/82dbae9c-9ce0-47e0-a1cb4048cfdb84aa.ta \
-	vendor/nxp/drm_artifacts/playready/libdrmplayreadyplugin.so:$(TARGET_COPY_OUT_VENDOR)/lib64/mediadrm/libdrmplayreadyplugin.so \
-	vendor/nxp/drm_artifacts/playready/optee_playready_test:$(TARGET_COPY_OUT_VENDOR)/bin/optee_playready_test
-endif
-
-ifneq ($(CFG_BUILD_DRM_FROM_SOURCES),y)
-# Widevine
-PRODUCT_COPY_FILES += \
-	vendor/nxp/drm_artifacts/widevine/lib/liboemcrypto.so:$(TARGET_COPY_OUT_VENDOR)/lib/liboemcrypto.so \
-	vendor/nxp/drm_artifacts/widevine/lib/libwvdrmengine.so:$(TARGET_COPY_OUT_VENDOR)/lib/mediadrm/libwvdrmengine.so \
-	vendor/nxp/drm_artifacts/widevine/lib/libvtswidevine.so:$(TARGET_COPY_OUT_VENDOR)/lib/drm-vts-test-libs/libvtswidevine.so \
-	vendor/nxp/drm_artifacts/widevine/lib64/liboemcrypto.so:$(TARGET_COPY_OUT_VENDOR)/lib64/liboemcrypto.so \
-	vendor/nxp/drm_artifacts/widevine/lib64/libwvdrmengine.so:$(TARGET_COPY_OUT_VENDOR)/lib64/mediadrm/libwvdrmengine.so \
-	vendor/nxp/drm_artifacts/widevine/lib64/libvtswidevine.so:$(TARGET_COPY_OUT_VENDOR)/lib64/drm-vts-test-libs/libvtswidevine.so \
-	vendor/nxp/drm_artifacts/widevine/ta/706f6574-7765-6469-77656e6942656665.ta:$(TARGET_COPY_OUT_VENDOR)/lib/optee_armtz/706f6574-7765-6469-77656e6942656665.ta
-endif
diff --git a/imx8m/kingscanyon_8mq/fstab.nxp b/imx8m/kingscanyon_8mq/fstab.nxp
index 1db83d0a..73a34ecf 100644
--- a/imx8m/kingscanyon_8mq/fstab.nxp
+++ b/imx8m/kingscanyon_8mq/fstab.nxp
@@ -4,21 +4,12 @@
 # specify MF_CHECK, and must come before any filesystems that do specify MF_CHECK
 
 /devices/platform/soc@0/38200000.usb/* auto auto defaults voldmanaged=usb:auto
-<<<<<<< HEAD
-/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block,metadata_csum
+/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block
 /dev/block/by-name/metadata    /metadata    ext4    noatime,nosuid,nodev,discard,sync                                                wait,formattable,first_stage_mount,check
 /dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
 /dev/block/by-name/idtechdata  /mnt/vendor/idtechdata  ext4    nosuid,nodev,noatime,barrier=1                       wait,formattable
 /dev/block/zram0 none swap defaults zramsize=629145600
 /tmp /sdcard none defaults,bind recoveryonly
 
-/devices/platform/soc@0/soc@0:bus@30800000/30b50000.mmc/mmc_host* /storage/sdcard1 vfat nosuid,nodev wait,voldmanaged=sdcard1:auto,encryptable=footer
+/devices/platform/soc@0/30800000.bus/30b50000.mmc/mmc_host* /storage/sdcard1 vfat nosuid,nodev wait,voldmanaged=sdcard1:auto,encryptable=footer
 /devices/platform/soc@0/38100000.usb/* auto auto defaults voldmanaged=usb:auto
-=======
-/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block
-/dev/block/by-name/metadata    /metadata    ext4    noatime,nosuid,nodev,discard,sync                                                wait,formattable,first_stage_mount,check
-/dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
-/dev/block/zram0 none swap defaults zramsize=629145600
-/tmp /sdcard none defaults,bind recoveryonly
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/kingscanyon_8mq/init.imx8mq.rc b/imx8m/kingscanyon_8mq/init.imx8mq.rc
index 71d142d3..25355d09 100755
--- a/imx8m/kingscanyon_8mq/init.imx8mq.rc
+++ b/imx8m/kingscanyon_8mq/init.imx8mq.rc
@@ -7,11 +7,7 @@ on early-boot
     write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
 
     # Set NN reject model by weights md5
-<<<<<<< HEAD
-    setprop WEIGHT_MD5_CHECK 1
-=======
     setprop vendor.MODEL_BLOCK_LEVEL 1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # change for FSL specific service
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
@@ -23,16 +19,13 @@ on early-boot
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
-<<<<<<< HEAD
-
-    # disable 3D composition overlay to fix video rotate problem
-    setprop vendor.hwc.enable.overlay 0
-=======
     chown root system /sys/devices/system/cpu/cpu2/online
     chmod 0664 /sys/devices/system/cpu/cpu2/online
     chown root system /sys/devices/system/cpu/cpu3/online
     chmod 0664 /sys/devices/system/cpu/cpu3/online
->>>>>>> post_merge/android-11.0.0_2.0.0
+
+    # disable 3D composition overlay to fix video rotate problem
+    setprop vendor.hwc.enable.overlay 0
 
 on property:sys.boot_completed=1
     # Set default CPU frequency governor
@@ -59,7 +52,6 @@ on property:sys.boot_completed=1
     # system-background is for system tasks that should only run on
     # little cores, not on bigs to be used only by init
     write /dev/cpuset/system-background/cpus 0-2
-<<<<<<< HEAD
 
 on init
     #IDtech added for AB ota update bootloader
@@ -67,5 +59,3 @@ on init
     symlink   /dev/block/mmcblk0boot1p1   /dev/block/by-name/spl_b
     symlink   /dev/block/mmcblk0boot0p2   /dev/block/by-name/spl_bak_a
     symlink   /dev/block/mmcblk0boot1p2   /dev/block/by-name/spl_bak_b
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/kingscanyon_8mq/init.rc b/imx8m/kingscanyon_8mq/init.rc
index 8c1f3b28..e8f276a1 100644
--- a/imx8m/kingscanyon_8mq/init.rc
+++ b/imx8m/kingscanyon_8mq/init.rc
@@ -1,9 +1,6 @@
 import /vendor/etc/init/hw/init.${ro.hardware}.usb.rc
 import /vendor/etc/init/hw/init.${ro.hardware}.${ro.boot.soc_type}.rc
-<<<<<<< HEAD
 import /product/etc/init/hw/init.idt.common.rc
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 service vendor.charger /system/bin/charger
     class charger
@@ -25,11 +22,7 @@ on early-init
 on early-init
     start early_init_sh
     # Set the host name which used in console
-<<<<<<< HEAD
     export HOSTNAME kingscanyon_8mq
-=======
-    export HOSTNAME evk_8mq
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Due keymaster start very early so set prop here
     # Also gatekeeper share same role for keymaster
@@ -51,14 +44,6 @@ on init && property:vendor.skip.charger_not_need=0
     symlink /sdcard /mnt/sdcard
     symlink /sdcard /storage/sdcard0
 
-<<<<<<< HEAD
-    # setup the global environment
-    export CORE_REGISTER_FILE /vendor/etc/core_register
-    export COMPONENT_REGISTER_FILE /vendor/etc/component_register
-    export CONTENTPIPE_REGISTER_FILE /vendor/etc/contentpipe_register
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     # disable cursor blink for fbcon, if no splash screen support
     write /sys/class/graphics/fbcon/cursor_blink 0
 
@@ -99,68 +84,37 @@ on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charg
     start vendor.oemlock-1-0
 
 on early-boot && property:vendor.skip.charger_not_need=0
-<<<<<<< HEAD
     # For kingscanyon_8mq, when swap used about 400M, upgrade the level.
-=======
-    # For evk_8mq, when swap used about 400M, upgrade the level.
->>>>>>> post_merge/android-11.0.0_2.0.0
     setprop ro.lmk.upgrade_pressure 87
     setprop ro.lmk.downgrade_pressure 95
     setprop ro.lmk.critical_upgrade true
 
-<<<<<<< HEAD
-    # Set permission for IIM node
-    symlink /dev/mxs_viim /dev/mxc_mem
-
-    setprop sys.hwc.disable     1
-    setprop vendor.2d.composition 0
-    setprop hwc.stretch.filter  1
-
-    #viv sdk dir
-    setprop VIVANTE_SDK_DIR /vendor/etc/viv_sdk
-=======
     setprop vendor.sys.hwc.disable     1
     setprop vendor.2d.composition 0
     setprop vendor.hwc.stretch.filter  1
 
     #viv sdk dir
     setprop vendor.VIVANTE_SDK_DIR /vendor/etc/viv_sdk
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # fsl omx graphic manager media framework property
     setprop vendor.rw.VIDEO_RENDER_NAME video_render.surface
     setprop vendor.media.fsl_codec.flag 7
 
     setprop camera.disable_zsl_mode 1
-<<<<<<< HEAD
     setprop front_camera_name mx6s-csi
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
    # Tweak the mmc device read ahead buffer size
     write /sys/block/mmcblk0/queue/read_ahead_kb 2048
     write /sys/block/mmcblk1/queue/read_ahead_kb 2048
 
-<<<<<<< HEAD
     # Wifi firmware reload path
     chown wifi wifi /sys/module/brcmfmac/parameters/alternative_fw_path
 
     # Prepare for wifi
     setprop wifi.interface wlan0
 
-    # Prepare for bluetooth
-    chmod 665 /sys/class/rfkill/rfkill0/state
-    chown bluetooth bluetooth /sys/class/rfkill/rfkill0/state
-    write /sys/class/rfkill/rfkill0/state 0
-
     setprop vendor.qcom.bluetooth.soc rome_uart
     setprop vendor.wc_transport.start_hci false
-=======
-    # Prepare for wifi
-    setprop wifi.interface wlan0
-    setprop wifi.direct.interface p2p0
-    setprop wifi.concurrent.interface wlan1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Disable surfaceflinger back pressure propagate
     setprop debug.sf.disable_backpressure 1
@@ -173,17 +127,10 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0664 /sys/kernel/debug/sync/sw_sync
 
     # Default backlight device
-<<<<<<< HEAD
-    setprop vendor.hw.backlight.dev "30a00000.mipi_dsi.0"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/30a00000.mipi_dsi.0/brightness
-    chmod 0660 /sys/class/backlight/30a00000.mipi_dsi.0/brightness
-=======
     setprop vendor.hw.backlight.dev "30a00000.mipi-dsi.0"
     # Chmod/chown FSL specific sys entry
     chown system system /sys/class/backlight/30a00000.mipi-dsi.0/brightness
     chmod 0660 /sys/class/backlight/30a00000.mipi-dsi.0/brightness
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Set light sensor sysfs path and light sensor threshold lux value
     setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
@@ -195,15 +142,9 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # Enlarge limition of audio buffer allocation
     setprop ro.af.client_heap_size_kbyte 32768
 
-<<<<<<< HEAD
-    # enlarge media max memory size to 3G.
-    setprop ro.media.maxmem 3221225471
-
     setprop wifi.concurrent.interface p2p0
     start vendor.wifi_hal_legacy
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 on boot && property:vendor.skip.charger_not_need=0
     start audioserver
     start mediadrm
@@ -234,60 +175,13 @@ service watchdogd /system/bin/watchdogd 10 20
     class core
     seclabel u:r:watchdogd:s0
 
-<<<<<<< HEAD
-service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_p2p /system/bin/dhcpcd -aABKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_eth0 /system/bin/dhcpcd -ABKL eth0
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_bt-pan /system/bin/dhcpcd -ABKL
-    class main
-    disabled
-    oneshot
-
-service iprenew_wlan0 /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_p2p /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_eth0 /system/bin/dhcpcd -n eth0
-    class main
-    disabled
-    oneshot
-
-service iprenew_bt-pan /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-# bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -B -z \
-        -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
-=======
 # bugreport is triggered by holding down volume down, volume up and power
 service bugreport /system/bin/dumpstate -d -p -z
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     disabled
     oneshot
     keycodes 114 115 116
 
-<<<<<<< HEAD
 on property:vendor.wc_transport.start_hci=true
     start start_hci_filter
 
@@ -312,8 +206,6 @@ service hci_filter_root /vendor/bin/wcnss_filter
     group bluetooth diag system
     disabled
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 on fs && property:vendor.skip.charger_not_need=0
 # mount ext4 partitions
     mount_all /vendor/etc/fstab.nxp --early
@@ -324,12 +216,6 @@ on fs && property:vendor.skip.charger_not_need=0
     # Update dm-verity state and set partition.*.verified properties
     verity_update_state
 
-<<<<<<< HEAD
-on verity-logging && property:vendor.skip.charger_not_need=0
-    exec u:r:slideshow:s0 -- /sbin/slideshow warning/verity_red_1 warning/verity_red_2
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 on post-fs && property:vendor.skip.charger_not_need=0
     # Set netd memlock rlimit to 8MB
     setrlimit 8 8388608 8388608
@@ -350,11 +236,7 @@ on post-fs-data && property:vendor.skip.charger_not_need=0
     mkdir /data/vendor/ss 0700 system system
 
     # tmp dir for opencl Compiler
-<<<<<<< HEAD
-    setprop TMPDIR /data/vendor/.opencl-cache
-=======
     setprop vendor.TMPDIR /data/vendor/.opencl-cache
->>>>>>> post_merge/android-11.0.0_2.0.0
     mkdir /data/vendor/.opencl-cache 0771 system camera
 
 on zygote-start && property:vendor.skip.charger_not_need=0
diff --git a/imx8m/kingscanyon_8mq/input-port-associations.xml b/imx8m/kingscanyon_8mq/input-port-associations.xml
index fda0a8df..d5f8fa39 100644
--- a/imx8m/kingscanyon_8mq/input-port-associations.xml
+++ b/imx8m/kingscanyon_8mq/input-port-associations.xml
@@ -21,8 +21,4 @@ One display can link with multi-input.
 	<port display="1" input="usb-xhci-hcd.1.auto-1.3.4/input0" />
 	<port display="0" input="usb-xhci-hcd.2.auto-1.3.4/input0" />
 	<port display="1" input="usb-xhci-hcd.2.auto-1.3.4/input0" />
-<<<<<<< HEAD
-	<port display="0" input="usb-xhci-hcd.1.auto-1.3/input0" />
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </ports>
diff --git a/imx8m/kingscanyon_8mq/kingscanyon_8mq.mk b/imx8m/kingscanyon_8mq/kingscanyon_8mq.mk
index 23c64351..86325472 100644
--- a/imx8m/kingscanyon_8mq/kingscanyon_8mq.mk
+++ b/imx8m/kingscanyon_8mq/kingscanyon_8mq.mk
@@ -1,61 +1,21 @@
-<<<<<<< HEAD
-# This is a FSL Android Reference Design platform based on i.MX8QP ARD board
-# It will inherit from FSL core product which in turn inherit from Google generic
-
-IMX_DEVICE_PATH := device/idtech/imx8m/kingscanyon_8mq
-=======
 # -------@block_infrastructure-------
 
-CONFIG_REPO_PATH := device/nxp
+CONFIG_REPO_PATH := device/idtech
 CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
 IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # configs shared between uboot, kernel and Android rootfs
 include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
 
-<<<<<<< HEAD
--include device/idtech/common/imx_path/ImxPathConfig.mk
-include device/idtech/imx8m/ProductConfigCommon.mk
-
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab_nand.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab_nand.nxp)
-endif
-
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab.nxp)
-endif
-
-# Overrides
-PRODUCT_NAME := kingscanyon_8mq
-PRODUCT_DEVICE := kingscanyon_8mq
-PRODUCT_MODEL := KINSCANYON_8MQ
-
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-#Enable this to choose 32 bit user space build
-#IMX8_BUILD_32BIT_ROOTFS := true
-
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-#If the device is retrofit to have dynamic partition feature, set this variable to true to build
-#the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
-TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
-=======
 -include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
 include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
 
 # -------@block_common_config-------
 
 # Overrides
-PRODUCT_NAME := evk_8mq
-PRODUCT_DEVICE := evk_8mq
-PRODUCT_MODEL := EVK_8MQ
+PRODUCT_NAME := kingscanyon_8mq
+PRODUCT_DEVICE := kingscanyon_8mq
+PRODUCT_MODEL := KINGSCANYON_8MQ
 
 TARGET_BOOTLOADER_BOARD_NAME := EVK
 
@@ -98,6 +58,9 @@ IMX8_BUILD_32BIT_ROOTFS := false
 
 PRODUCT_COPY_FILES += \
     $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
+    $(CONFIG_REPO_PATH)/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
+    $(CONFIG_REPO_PATH)/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
+    $(CONFIG_REPO_PATH)/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
 
 # -------@block_kernel_bootimg-------
 # Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
@@ -120,31 +83,12 @@ PRODUCT_COPY_FILES += \
 # -------@block_storage-------
 #Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
 TARGET_USE_DYNAMIC_PARTITIONS ?= true
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
   PRODUCT_USE_DYNAMIC_PARTITIONS := true
   BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
   BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-<<<<<<< HEAD
-  ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
-    PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
-    BOARD_SUPER_PARTITION_METADATA_DEVICE := system
-    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 2952790016
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-    else
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor product
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 1610612736
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-      BOARD_SUPER_PARTITION_PRODUCT_DEVICE_SIZE := 1879048192
-    endif
-  endif
-endif
-
-=======
 endif
 
 #Enable this to disable product partition build.
@@ -178,139 +122,18 @@ PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
     $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
 
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt
+
 # -------@block_security-------
 
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Include keystore attestation keys and certificates.
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 -include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
 endif
 
-<<<<<<< HEAD
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp \
-    $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    device/idtech/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    device/idtech/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    device/idtech/common/wifi/qca_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf \
-    device/idtech/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
-    device/idtech/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
-    device/idtech/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
-    device/idtech/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
-    device/idtech/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt \
-    device/idtech/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-
-# Audio card json
-PRODUCT_COPY_FILES += \
-    device/idtech/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    device/idtech/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    device/idtech/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
-    device/idtech/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
-    device/idtech/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
-    device/idtech/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    device/idtech/common/audio-json/ibr210_rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
-    device/idtech/common/audio-json/tlv320aic3110_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/tlv320aic3110_config.json \
-    device/idtech/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    device/idtech/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    device/idtech/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/kingscanyon_8mq/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
-
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    device/idtech/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    device/idtech/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    device/idtech/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    device/idtech/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    device/idtech/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-USE_XML_AUDIO_POLICY_CONF := 1
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_CHARACTERISTICS := tablet
-
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# GPU openCL SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/CL/cl_sdk.mk
-
-# GPU openVX SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/nnxc_kernels/nnxc_kernels.mk
-
-# GPU openCL icdloader config file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
-=======
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
@@ -380,6 +203,8 @@ PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
     $(CONFIG_REPO_PATH)/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
     $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/ibr210_rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/tlv320aic3110_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/tlv320aic3110_config.json \
     $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
 
 PRODUCT_PACKAGES += \
@@ -401,27 +226,11 @@ PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
 
 # -------@block_display-------
 PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # HWC2 HAL
 PRODUCT_PACKAGES += \
     android.hardware.graphics.composer@2.4-service
 
-<<<<<<< HEAD
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@2.0-impl-2.1 \
-    android.hardware.graphics.allocator@2.0-impl \
-    android.hardware.graphics.allocator@2.0-service
-=======
 # define frame buffer count
 PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
     ro.surface_flinger.max_frame_buffer_acquired_buffers=3
@@ -430,25 +239,17 @@ PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
 PRODUCT_PACKAGES += \
     android.hardware.graphics.mapper@4.0-impl.imx \
     android.hardware.graphics.allocator@4.0-service.imx
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # RenderScript HAL
 PRODUCT_PACKAGES += \
     android.hardware.renderscript@1.0-impl
 
 PRODUCT_PACKAGES += \
-<<<<<<< HEAD
-        libEGL_VIVANTE \
-        libGLESv1_CM_VIVANTE \
-        libGLESv2_VIVANTE \
-        gralloc_viv.imx \
-=======
         libg2d-opencl
 
 # Multi-Display launcher
 PRODUCT_PACKAGES += \
-    MultiClientInputMethod \
-    MultiDisplay
+    MultiClientInputMethod
 
 PRODUCT_COPY_FILES += \
     $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
@@ -459,25 +260,16 @@ PRODUCT_PACKAGES += \
         libGLESv1_CM_VIVANTE \
         libGLESv2_VIVANTE \
         gralloc_viv.$(TARGET_BOARD_PLATFORM) \
->>>>>>> post_merge/android-11.0.0_2.0.0
         libGAL \
         libGLSLC \
         libVSC \
         libgpuhelper \
         libSPIRV_viv \
         libvulkan_VIVANTE \
-<<<<<<< HEAD
-        vulkan.imx \
-        libCLC \
-        libLLVM_viv \
-        libOpenCL \
-        libg2d-opencl \
-=======
         vulkan.$(TARGET_BOARD_PLATFORM) \
         libCLC \
         libLLVM_viv \
         libOpenCL \
->>>>>>> post_merge/android-11.0.0_2.0.0
         libg2d-viv \
         libOpenVX \
         libOpenVXU \
@@ -494,37 +286,6 @@ PRODUCT_PACKAGES += \
         libNNArchPerf \
         libarchmodelSw
 
-<<<<<<< HEAD
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32 \
-    android.hardware.power@1.3-service.imx \
-    android.hardware.light@2.0-impl \
-    android.hardware.light@2.0-service \
-    android.hardware.configstore@1.1-service \
-    configstore@1.1.policy
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/kingscanyon_8mq/thermal_info_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mq.json
-
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.2-service-vsi-npu-server
-
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.1-service.btlinux
-=======
 # GPU openCL g2d
 PRODUCT_COPY_FILES += \
     $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
@@ -542,23 +303,17 @@ PRODUCT_COPY_FILES += \
 # -------@block_wifi-------
 PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
+    $(CONFIG_REPO_PATH)/common/wifi/qca_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
 
 # WiFi HAL
 PRODUCT_PACKAGES += \
     android.hardware.wifi@1.0-service \
-<<<<<<< HEAD
-    wifilogd \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     wificond
 
 # WiFi RRO
 PRODUCT_PACKAGES += \
     WifiOverlay
 
-<<<<<<< HEAD
 # Qcom WiFi Firmware
 PRODUCT_COPY_FILES += \
     vendor/nxp/qca-wifi-bt/1CQ_QCA6174A_LEA_2.0/lib/firmware/qca6174/bdwlan30.bin:vendor/firmware/bdwlan30.bin \
@@ -567,82 +322,24 @@ PRODUCT_COPY_FILES += \
     vendor/nxp/qca-wifi-bt/1CQ_QCA6174A_LEA_2.0/lib/firmware/qca6174/utf30.bin:vendor/firmware/utf30.bin \
     vendor/nxp/qca-wifi-bt/1CQ_QCA6174A_LEA_2.0/lib/firmware/wlan/qca6174/qcom_cfg.ini:vendor/firmware/wlan/qcom_cfg.ini
 
-# Qcom Bluetooth Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/qca-wifi-bt/1CQ_QCA6174A_LEA_2.0/lib/firmware/nvm_tlv_3.2.bin:vendor/firmware/nvm_tlv_3.2.bin \
-    vendor/nxp/qca-wifi-bt/1CQ_QCA6174A_LEA_2.0/lib/firmware/rampatch_tlv_3.2.tlv:vendor/firmware/rampatch_tlv_3.2.tlv \
-    vendor/nxp/qca-wifi-bt/qca_proprietary/Android_HAL/wcnss_filter_8mq:vendor/bin/wcnss_filter \
-    vendor/nxp/qca-wifi-bt/qca/rampatch_00130302.bin:vendor/firmware/qca/rampatch_00130302.bin \
-    vendor/nxp/qca-wifi-bt/qca/rampatch_usb_00000302.bin:vendor/firmware/qca/rampatch_usb_00000302.bin \
-    vendor/nxp/qca-wifi-bt/qca/nvm_usb_00000302.bin:vendor/firmware/qca/nvm_usb_00000302.bin
-=======
-# NXP 8997 Wifi and Bluetooth Combo Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
-
 # Wifi regulatory
 PRODUCT_COPY_FILES += \
     external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
     external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
 
-<<<<<<< HEAD
-# hardware backed keymaster service
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/kingscanyon_8mq/camera_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mq.json \
-    device/idtech/imx8m/kingscanyon_8mq/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-# Keymaster HAL
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# DRM HAL
-TARGET_ENABLE_MEDIADRM_64 := true
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-#Dumpstate HAL 1.1 support
-PRODUCT_PACKAGES += \
-    android.hardware.dumpstate@1.1-service.imx
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-ifneq ($(BUILD_TARGET_FS),ubifs)
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.frp.pst=/dev/block/by-name/presistdata
-endif
-=======
 # -------@block_bluetooth-------
 # Bluetooth HAL
 PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
+    android.hardware.bluetooth@1.1-service.btlinux
 
-# NXP 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
+# Qcom Bluetooth Firmware
+PRODUCT_COPY_FILES += \
+    vendor/nxp/qca-wifi-bt/1CQ_QCA6174A_LEA_2.0/lib/firmware/nvm_tlv_3.2.bin:vendor/firmware/nvm_tlv_3.2.bin \
+    vendor/nxp/qca-wifi-bt/1CQ_QCA6174A_LEA_2.0/lib/firmware/rampatch_tlv_3.2.tlv:vendor/firmware/rampatch_tlv_3.2.tlv \
+    vendor/nxp/qca-wifi-bt/qca_proprietary/Android_HAL/wcnss_filter_8mq:vendor/bin/wcnss_filter \
+    vendor/nxp/qca-wifi-bt/qca/rampatch_00130302.bin:vendor/firmware/qca/rampatch_00130302.bin \
+    vendor/nxp/qca-wifi-bt/qca/rampatch_usb_00000302.bin:vendor/firmware/qca/rampatch_usb_00000302.bin \
+    vendor/nxp/qca-wifi-bt/qca/nvm_usb_00000302.bin:vendor/firmware/qca/nvm_usb_00000302.bin
 
 # -------@block_usb-------
 # Usb HAL
@@ -659,7 +356,6 @@ PRODUCT_COPY_FILES += \
     $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
     $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
     $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 PRODUCT_PACKAGES += \
     libg1 \
@@ -680,42 +376,6 @@ PRODUCT_PACKAGES += \
     c2_component_register_ra \
     c2_component_register_rv
 
-<<<<<<< HEAD
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# Multi-Client IME
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-IMX-DEFAULT-G2D-LIB := libg2d-viv
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 INSTALL_64BIT_LIBRARY := true
@@ -723,35 +383,6 @@ endif
 -include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
 endif
 
-<<<<<<< HEAD
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-#AMS
-PRODUCT_PACKAGES += \
-    deviceadmin \
-    appmanager \
-    amsconnector \
-    amsclouddrive \
-    amsbootmediasync \
-    welcomeapp \
-    diagnosis \
-    otaupdater \
-    peripheralmanager \
-    watchdog
-
-# Enable kernel log for diagnosis
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.logd.kernel=true
-
-PRODUCT_PACKAGES += \
-    android.hardware.kioskled-service \
-    android.hardware.kioskled
-=======
 # -------@block_neural_network-------
 # Neural Network HAL and lib
 PRODUCT_PACKAGES += \
@@ -759,10 +390,6 @@ PRODUCT_PACKAGES += \
     libnnrt \
     android.hardware.neuralnetworks@1.3-service-vsi-npu-server
 
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
 # -------@block_miscellaneous-------
 
 # Copy device related config and binary to board
@@ -805,4 +432,23 @@ PRODUCT_COPY_FILES += \
     frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
     frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
 
->>>>>>> post_merge/android-11.0.0_2.0.0
+#AMS
+PRODUCT_PACKAGES += \
+    deviceadmin \
+    appmanager \
+    amsconnector \
+    amsclouddrive \
+    amsbootmediasync \
+    welcomeapp \
+    diagnosis \
+    otaupdater \
+    peripheralmanager \
+    watchdog
+
+# Enable kernel log for diagnosis
+PRODUCT_PROPERTY_OVERRIDES += \
+    ro.logd.kernel=true
+
+PRODUCT_PACKAGES += \
+    android.hardware.kioskled-service \
+    android.hardware.kioskled
diff --git a/imx8m/kingscanyon_8mq/kingscanyon_8mq_drm.mk b/imx8m/kingscanyon_8mq/kingscanyon_8mq_drm.mk
index 71bf2f7d..ac6efa0a 100644
--- a/imx8m/kingscanyon_8mq/kingscanyon_8mq_drm.mk
+++ b/imx8m/kingscanyon_8mq/kingscanyon_8mq_drm.mk
@@ -1,46 +1,28 @@
 # This is a FSL Android Reference Design platform based on i.MX8MQ board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-<<<<<<< HEAD
-IMX_DEVICE_PATH := device/idtech/imx8m/kingscanyon_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 
 PRODUCT_IMX_DRM := true
 
 # copy drm specific files before inherit kingscanyon_8mq.mk, otherwise copy is ignored
-=======
-IMX_DEVICE_PATH := device/nxp/imx8m/evk_8mq
-
-PRODUCT_IMX_DRM := true
-
-# copy drm specific files before inherit evk_8mq.mk, otherwise copy is ignored
->>>>>>> post_merge/android-11.0.0_2.0.0
 PRODUCT_COPY_FILES += \
 	$(IMX_DEVICE_PATH)/audio_policy_configuration_drm.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
 	$(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.main.rc \
 	$(IMX_DEVICE_PATH)/init.imx8mq.drm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-<<<<<<< HEAD
-	$(TOPDIR)device/idtech/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
+	$(TOPDIR)$(CONFIG_REPO_PATH)/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
 
 
-$(call inherit-product, $(TOPDIR)device/idtech/imx8m/optee-packages.mk)
+$(call inherit-product, $(TOPDIR)$(CONFIG_REPO_PATH)/imx8m/optee-packages.mk)
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/kingscanyon_8mq.mk)
-=======
-	$(TOPDIR)device/nxp/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
-
-
-$(call inherit-product, $(TOPDIR)device/nxp/imx8m/optee-packages.mk)
-$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/evk_8mq.mk)
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
 
 
 # Overrides
-<<<<<<< HEAD
 PRODUCT_NAME := kingscanyon_8mq_drm
-=======
-PRODUCT_NAME := evk_8mq_drm
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 CFG_DRM_SECURE_DATA_PATH ?= y
 CFG_RDC_SECURE_DATA_PATH ?= y
diff --git a/imx8m/kingscanyon_8mq/manifest.xml b/imx8m/kingscanyon_8mq/manifest.xml
index 4c68c19a..594acf9f 100644
--- a/imx8m/kingscanyon_8mq/manifest.xml
+++ b/imx8m/kingscanyon_8mq/manifest.xml
@@ -96,15 +96,6 @@
             <instance>default</instance>
         </interface>
     </hal>
-    <hal format="hidl">
-        <name>android.hardware.memtrack</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IMemtrack</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
     <hal format="hidl">
         <name>android.hardware.audio</name>
         <transport>hwbinder</transport>
diff --git a/imx8m/kingscanyon_8mq/manifest.xml~post_merge_android-11.0.0_2.0.0 b/imx8m/kingscanyon_8mq/manifest.xml~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 9dab44ed..00000000
--- a/imx8m/kingscanyon_8mq/manifest.xml~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,153 +0,0 @@
-<manifest version="1.0" type="device" target-level="5">
-    <kernel  target-level="5" />
-    <hal format="hidl">
-	<name>android.hardware.graphics.allocator</name>
-        <transport>hwbinder</transport>
-	<impl level="generic"></impl>
-	<version>4.0</version>
-	<interface>
-	    <name>IAllocator</name>
-	    <instance>default</instance>
-	</interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.graphics.composer</name>
-        <transport>hwbinder</transport>
-        <version>2.4</version>
-        <interface>
-            <name>IComposer</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-       <name>android.hardware.camera.provider</name>
-       <transport>hwbinder</transport>
-       <fqname>@2.4::ICameraProvider/external/0</fqname>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.keymaster</name>
-        <transport>hwbinder</transport>
-        <version>4.0</version>
-        <interface>
-            <name>IKeymasterDevice</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.drm</name>
-        <transport>hwbinder</transport>
-        <version>1.3</version>
-        <interface>
-            <name>ICryptoFactory</name>
-        </interface>
-        <interface>
-            <name>IDrmFactory</name>
-        </interface>
-        <fqname>@1.3::ICryptoFactory/clearkey</fqname>
-        <fqname>@1.3::IDrmFactory/clearkey</fqname>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.gatekeeper</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IGatekeeper</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.graphics.mapper</name>
-        <transport arch="32+64">passthrough</transport>
-        <impl level="generic"></impl>
-        <version>4.0</version>
-        <interface>
-            <name>IMapper</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.renderscript</name>
-        <transport arch="32+64">passthrough</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IDevice</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.media.c2</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IComponentStore</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.media.omx</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IOmx</name>
-            <instance>default</instance>
-        </interface>
-        <interface>
-            <name>IOmxStore</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.memtrack</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IMemtrack</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.audio</name>
-        <transport>hwbinder</transport>
-        <version>6.0</version>
-        <interface>
-            <name>IDevicesFactory</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.audio.effect</name>
-        <transport>hwbinder</transport>
-        <version>6.0</version>
-        <interface>
-            <name>IEffectsFactory</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.bluetooth</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IBluetoothHci</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>android.hardware.dumpstate</name>
-        <transport>hwbinder</transport>
-        <version>1.1</version>
-        <interface>
-            <name>IDumpstateDevice</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-        <name>nxp.hardware.display</name>
-            <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IDisplay</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-</manifest>
diff --git a/imx8m/kingscanyon_8mq/overlay/frameworks/base/core/res/res/values/config.xml b/imx8m/kingscanyon_8mq/overlay/frameworks/base/core/res/res/values/config.xml
index dff81bd6..4722b491 100644
--- a/imx8m/kingscanyon_8mq/overlay/frameworks/base/core/res/res/values/config.xml
+++ b/imx8m/kingscanyon_8mq/overlay/frameworks/base/core/res/res/values/config.xml
@@ -190,7 +190,6 @@
 
     <!-- If the system has the input method for each display - enable per-display focus. -->
     <bool name="config_perDisplayFocusEnabled">true</bool>
-<<<<<<< HEAD
 
     <!-- The default gravity for the picture-in-picture window.
          Currently, this maps to Gravity.TOP | Gravity.RIGHT -->
@@ -198,6 +197,4 @@
 
     <!-- Flag indicating whether orientation is able to change by application.-->
     <bool name="config_orientation_lock_available">true</bool>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </resources>
diff --git a/imx8m/kingscanyon_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml b/imx8m/kingscanyon_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
index 87976f74..0bf9ee21 100644
--- a/imx8m/kingscanyon_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
+++ b/imx8m/kingscanyon_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
@@ -21,8 +21,5 @@
     <bool name="def_user_setup_complete">true</bool>
     <bool name="def_bluetooth_on">false</bool>
     <bool name="def_stay_on_while_plugged_in">true</bool>
-<<<<<<< HEAD
     <string name="def_immersive_mode_confirmations" translatable="false">confirmed</string>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </resources>
diff --git a/imx8m/kingscanyon_8mq/powerhint_imx8mq.json b/imx8m/kingscanyon_8mq/powerhint_imx8mq.json
index 275fa309..3d7db6ab 100644
--- a/imx8m/kingscanyon_8mq/powerhint_imx8mq.json
+++ b/imx8m/kingscanyon_8mq/powerhint_imx8mq.json
@@ -47,11 +47,7 @@
       "Name": "PowerHALMainState",
       "Path": "vendor.powerhal.camera",
       "Values": [
-<<<<<<< HEAD
-        "CAMERA_STREAMING",
-=======
         "CAMERA_STREAMING_MID",
->>>>>>> post_merge/android-11.0.0_2.0.0
         ""
       ],
       "Type": "Property"
@@ -60,11 +56,7 @@
       "Name": "PowerHALAudioState",
       "Path": "vendor.powerhal.audio",
       "Values": [
-<<<<<<< HEAD
-        "AUDIO_LOW_LATENCY",
-=======
         "AUDIO_STREAMING_LOW_LATENCY",
->>>>>>> post_merge/android-11.0.0_2.0.0
         ""
       ],
       "Type": "Property"
@@ -141,15 +133,6 @@
       "Value": "0"
     },
     {
-<<<<<<< HEAD
-      "PowerHint": "CAMERA_STREAMING",
-      "Node": "PowerHALMainState",
-      "Duration": 0,
-      "Value": "CAMERA_STREAMING"
-    },
-    {
-      "PowerHint": "CAMERA_STREAMING",
-=======
       "PowerHint": "CAMERA_STREAMING_MID",
       "Node": "PowerHALMainState",
       "Duration": 0,
@@ -157,7 +140,6 @@
     },
     {
       "PowerHint": "CAMERA_STREAMING_MID",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "Node": "CPULittleClusterMaxFreq",
       "Duration": 0,
       "Value": "1300000"
@@ -193,30 +175,6 @@
       "Value": "1300000"
     },
     {
-<<<<<<< HEAD
-      "PowerHint": "AUDIO_STREAMING",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 2000,
-      "Value": "0"
-    },
-    {
-      "PowerHint": "AUDIO_STREAMING",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 2000,
-      "Value": "1000000"
-    },
-    {
-      "PowerHint": "AUDIO_LOW_LATENCY",
-      "Node": "PowerHALAudioState",
-      "Duration": 0,
-      "Value": "AUDIO_LOW_LATENCY"
-    },
-    {
-      "PowerHint": "AUDIO_LOW_LATENCY",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 0,
-      "Value": "0"
-=======
       "PowerHint": "AUDIO_STREAMING_LOW_LATENCY",
       "Node": "PowerHALAudioState",
       "Duration": 0,
@@ -239,7 +197,6 @@
       "Node": "CPULittleClusterMinFreq",
       "Duration": 0,
       "Value": "1300000"
->>>>>>> post_merge/android-11.0.0_2.0.0
     }
   ]
 }
diff --git a/imx8m/kingscanyon_8mq/sepolicy/file_contexts b/imx8m/kingscanyon_8mq/sepolicy/file_contexts
index 6c93b5d1..586e5185 100644
--- a/imx8m/kingscanyon_8mq/sepolicy/file_contexts
+++ b/imx8m/kingscanyon_8mq/sepolicy/file_contexts
@@ -1,50 +1,3 @@
-<<<<<<< HEAD
-#sd boot
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/misc        u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/metadata    u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/presistdata u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/userdata    u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/vbmeta_[ab]    u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/super            u:object_r:super_block_device:s0
-
-#emmc boot
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/misc             u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/metadata         u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/presistdata      u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/userdata         u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/vbmeta_[ab]      u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/super            u:object_r:super_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/bootloader_[ab]  u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/mem_info_[ab]    u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/idtechdata       u:object_r:idtechdata_block_device:s0
-
-# spl
-/dev/block/mmcblk0boot[01]            u:object_r:spl_block_device:s0
-/dev/block/mmcblk0boot[01]p[1-9]      u:object_r:spl_block_device:s0
-
-#peripheral
-/vendor/bin/magd                u:object_r:sensors_exec:s0
-/vendor/bin/fsl_sensor_fusion   u:object_r:sensors_exec:s0
-/dev/mma8x5x                    u:object_r:sensors_device:s0
-/dev/ttymxc[0-9]*               u:object_r:tty_device:s0
-/dev/FreescaleAccelerometer     u:object_r:sensors_device:s0
-/dev/FreescaleMagnetometer      u:object_r:sensors_device:s0
-/dev/FreescaleGyroscope         u:object_r:sensors_device:s0
-/dev/sda[0-8]*                  u:object_r:fuse:s0
-
-#Neural Network HAL service
-/vendor/bin/hw/android\.hardware\.neuralnetworks@1\.2-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
-=======
 /dev/block/mmcblk0boot0                      u:object_r:emmc_boot0:s0
 /dev/block/mmcblk1                           u:object_r:sdcard:s0
 
@@ -55,13 +8,11 @@
 
 #Neural Network HAL service
 /vendor/bin/hw/android\.hardware\.neuralnetworks@1\.3-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 #Thermal HAL service
 /vendor/bin/hw/android\.hardware\.thermal@2\.0-service.imx         u:object_r:hal_thermal_default_exec:s0
 
 /vendor/bin/hw/android\.hardware\.media\.c2@1\.0-service    u:object_r:mediacodec_exec:s0
-<<<<<<< HEAD
 
 #Kiosk Led file node
 /sys/devices/platform/leds/leds/(.*)/brightness     u:object_r:sysfs_idtech_kioskleds:s0
@@ -70,5 +21,3 @@
 /sys/devices/platform/leds/leds/(.*)/delay_off      u:object_r:sysfs_idtech_kioskleds:s0
 /vendor/bin/hw/android\.hardware\.kioskled@1\.0-service        u:object_r:hal_kioskled_default_exec:s0
 /vendor/bin/hw/android\.hardware\.kioskled-service             u:object_r:hal_kioskled_default_exec:s0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/kingscanyon_8mq/sepolicy/genfs_contexts b/imx8m/kingscanyon_8mq/sepolicy/genfs_contexts
index 7455a8dd..4f53c329 100644
--- a/imx8m/kingscanyon_8mq/sepolicy/genfs_contexts
+++ b/imx8m/kingscanyon_8mq/sepolicy/genfs_contexts
@@ -1,37 +1,3 @@
-<<<<<<< HEAD
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/hctosys     u:object_r:sysfs_rtc:s0
-
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a20000.i2c/i2c-0/0-0050/power_supply u:object_r:sysfs_batteryinfo:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a20000.i2c/i2c-0/0-0050/extcon   u:object_r:sysfs_extcon:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30b40000.mmc/mmc_host/mmc0/mmc0:0001/block/mmcblk0 u:object_r:sysfs_block_devices:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30b50000.mmc/mmc_host/mmc1/mmc1:aaaa/block/mmcblk1 u:object_r:sysfs_block_devices:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30bb0000.spi/spi_master/spi3/spi3.0/mtd/mtd0/mtdblock u:object_r:sysfs_block_devices:s0
-
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a00000.mipi_dsi/30a00000.mipi_dsi.0/backlight u:object_r:sysfs_leds:s0
-
-#/sys/class/net
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30be0000.ethernet/net               u:object_r:sysfs_net:s0
-genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net u:object_r:sysfs_net:s0
-genfscon sysfs /devices/platform/soc@0/33c00000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net u:object_r:sysfs_net:s0
-
-
-# android.system.suspend@1.0-service
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30be0000.ethernet/net/eth0/wakeup0                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30be0000.ethernet/net/eth0/wakeup5                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-powerkey/wakeup                         u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/wakeup                           u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/wakeup2                 u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/wakeup3                 u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/battery/wakeup3                                                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/battery/wakeup4                                                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/usb/wakeup4                                                                           u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/usb/wakeup5                                                                           u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a20000.i2c/i2c-0/0-0050/power_supply/tcpm-source-psy-0-0050/wakeup6    u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/wakeup/wakeup7                           u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/38200000.usb/xhci-hcd.1.auto/usb1/1-1/1-1.1/1-1.1:1.2/0003:046D:C52B.0003/0003:046D:[a-fA-F0-9]*.[a-fA-F0-9]*/power_supply/hidpp_battery_[01]/wakeup[0-9]* u:object_r:sysfs_wakeup:s0
-# ibr210 as external connection
-genfscon sysfs /devices/platform/usb-id/extcon          u:object_r:sysfs_extcon:s0
-=======
 genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/hctosys     u:object_r:sysfs_rtc:s0
 
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30a20000.i2c/i2c-0/0-0050/power_supply u:object_r:sysfs_batteryinfo:s0
@@ -48,10 +14,17 @@ genfscon sysfs /devices/platform/soc@0/33c00000.pcie/pci0001:00/0001:00:00.0/000
 
 # android.system.suspend@1.0-service
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30be0000.ethernet/net/eth0/wakeup0                                       u:object_r:sysfs_wakeup:s0
+genfscon sysfs /devices/platform/soc@0/30800000.bus/30be0000.ethernet/net/eth0/wakeup5                                       u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-powerkey/wakeup                         u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-rtc-lp/wakeup                           u:object_r:sysfs_wakeup:s0
+genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/wakeup2                 u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/wakeup3                 u:object_r:sysfs_wakeup:s0
+genfscon sysfs /devices/virtual/power_supply/battery/wakeup3                                                                       u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/virtual/power_supply/battery/wakeup4                                                                       u:object_r:sysfs_wakeup:s0
+genfscon sysfs /devices/virtual/power_supply/usb/wakeup4                                                                           u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/virtual/power_supply/usb/wakeup5                                                                           u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30a20000.i2c/i2c-0/0-0050/power_supply/tcpm-source-psy-0-0050/wakeup6    u:object_r:sysfs_wakeup:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
+genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/wakeup/wakeup7                           u:object_r:sysfs_wakeup:s0
+genfscon sysfs /devices/platform/soc@0/38200000.usb/xhci-hcd.1.auto/usb1/1-1/1-1.1/1-1.1:1.2/0003:046D:C52B.0003/0003:046D:[a-fA-F0-9]*.[a-fA-F0-9]*/power_supply/hidpp_battery_[01]/wakeup[0-9]* u:object_r:sysfs_wakeup:s0
+# ibr210 as external connection
+genfscon sysfs /devices/platform/usb-id/extcon          u:object_r:sysfs_extcon:s0
diff --git a/imx8m/kingscanyon_8mq/thermal_info_config_imx8mq.json b/imx8m/kingscanyon_8mq/thermal_info_config_imx8mq.json
index 0702f138..758490bf 100755
--- a/imx8m/kingscanyon_8mq/thermal_info_config_imx8mq.json
+++ b/imx8m/kingscanyon_8mq/thermal_info_config_imx8mq.json
@@ -1,28 +1,18 @@
 {
-<<<<<<< HEAD
-=======
     "HotplugCPUs":[
             "cpu2",
             "cpu3"
     ],
->>>>>>> post_merge/android-11.0.0_2.0.0
     "Sensors":[
         {
             "Name":"cpu-thermal",
             "Type":"CPU",
             "HotThreshold":[
                 "NAN",
-<<<<<<< HEAD
-                "NAN",
-                "NAN",
-                85.0,
-                95.0,
-=======
                 80.0,
                 82.0,
                 86.0,
                 90.0,
->>>>>>> post_merge/android-11.0.0_2.0.0
                 "NAN",
                 "NAN"
             ],
diff --git a/imx8m/kingscanyon_8mq/ueventd.nxp.rc b/imx8m/kingscanyon_8mq/ueventd.nxp.rc
index 7e3a134a..f188543a 100644
--- a/imx8m/kingscanyon_8mq/ueventd.nxp.rc
+++ b/imx8m/kingscanyon_8mq/ueventd.nxp.rc
@@ -1,18 +1,9 @@
-<<<<<<< HEAD
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/presistdata 0600   system     system
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/presistdata 0600   system     system
-/dev/ttymxc3              0660   bluetooth  bluetooth
-/dev/snd/*                0660   system     audio
-/dev/video*               0660   system     camera
-/dev/mxc_hantro           0660   media      drmrpc
-=======
 /dev/block/by-name/presistdata 0600   system     system
-/dev/ttymxc2              0660   bluetooth  bluetooth
+/dev/ttymxc3              0660   bluetooth  bluetooth
 /dev/snd/*                0660   system     audio
 /dev/video*               0660   system     camera
 /dev/mxc_hantro           0666   media      drmrpc
 /dev/vsi_daemon_ctrl      0666   media      drmrpc
->>>>>>> post_merge/android-11.0.0_2.0.0
 /dev/imxdpu               0660   media      drmrpc
 /dev/ion                  0666   media      drmrpc
 /dev/galcore              0666 	 system     graphics
@@ -26,7 +17,6 @@
 
 /sys/devices/virtual/thermal/thermal_zone* trip_point_0_hyst 0660 system system
 /sys/devices/virtual/thermal/thermal_zone* trip_point_1_hyst 0660 system system
-<<<<<<< HEAD
 
 /dev/usb/lp0              0666   root         root
 
@@ -35,5 +25,3 @@
 /sys/class/leds/* trigger 0666 root root
 /sys/class/leds/* delay_on 0666 root root
 /sys/class/leds/* delay_off 0666 root root
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/sepolicy/file_contexts b/imx8m/sepolicy/file_contexts
index 29c881b9..bd71a50c 100644
--- a/imx8m/sepolicy/file_contexts
+++ b/imx8m/sepolicy/file_contexts
@@ -111,6 +111,13 @@
 /dev/block/by-name/userdata                  u:object_r:userdata_block_device:s0
 /dev/block/by-name/vbmeta_[ab]               u:object_r:vbmeta_block_device:s0
 /dev/block/by-name/super                     u:object_r:super_block_device:s0
+/dev/block/by-name/bootloader_[ab]           u:object_r:bootloader_block_device:s0
+/dev/block/by-name/mem_info_[ab]             u:object_r:bootloader_block_device:s0
+/dev/block/by-name/idtechdata                u:object_r:idtechdata_block_device:s0
+
+# spl
+/dev/block/mmcblk0boot[01]                   u:object_r:spl_block_device:s0
+/dev/block/mmcblk0boot[01]p[1-9]             u:object_r:spl_block_device:s0
 
 /vendor/bin/hw/android\.hardware\.camera\.provider@2\.6-service-google       u:object_r:hal_camera_default_exec:s0
 
diff --git a/imx8m/vp6820_8mn/AndroidBoard.mk b/imx8m/vp6820_8mn/AndroidBoard.mk
index cb6595f6..75defabe 100644
--- a/imx8m/vp6820_8mn/AndroidBoard.mk
+++ b/imx8m/vp6820_8mn/AndroidBoard.mk
@@ -1,8 +1,8 @@
 LOCAL_PATH := $(call my-dir)
 
-include device/idtech/common/build/dtbo.mk
-include device/idtech/common/build/imx-recovery.mk
-include device/idtech/common/build/gpt.mk
+include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
+include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
+include $(CONFIG_REPO_PATH)/common/build/gpt.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
 -include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/vp6820_8mn/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0 b/imx8m/vp6820_8mn/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 75defabe..00000000
--- a/imx8m/vp6820_8mn/AndroidBoard.mk~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,8 +0,0 @@
-LOCAL_PATH := $(call my-dir)
-
-include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
-include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
-include $(CONFIG_REPO_PATH)/common/build/gpt.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
--include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/vp6820_8mn/AndroidUboot.mk b/imx8m/vp6820_8mn/AndroidUboot.mk
index 27455170..53e81435 100644
--- a/imx8m/vp6820_8mn/AndroidUboot.mk
+++ b/imx8m/vp6820_8mn/AndroidUboot.mk
@@ -2,16 +2,9 @@
 MAKE += SHELL=/bin/bash
 
 ifneq ($(AARCH64_GCC_CROSS_COMPILE),)
-<<<<<<< HEAD
-ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
-else
-ATF_TOOLCHAIN_ABS := $(realpath prebuilts/gcc/$(HOST_PREBUILT_TAG)/aarch64/aarch64-linux-android-4.9/bin)
-ATF_CROSS_COMPILE := $(ATF_TOOLCHAIN_ABS)/aarch64-linux-androidkernel-
-=======
   ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
 else
   $(error shell env AARCH64_GCC_CROSS_COMPILE is not set)
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 define build_imx_uboot
@@ -27,11 +20,7 @@ define build_imx_uboot
 		cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	fi; \
 	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
-<<<<<<< HEAD
 	if [ `echo $(2) | cut -d '-' -f3` = "trusty" ]; then \
-=======
-	if [ `echo $(2) | cut -d '-' -f2` = "trusty" ]; then \
->>>>>>> post_merge/android-11.0.0_2.0.0
 		cp $(FSL_PROPRIETARY_PATH)/fsl-proprietary/uboot-firmware/imx8m/tee-imx8mn.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 		$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ CROSS_COMPILE="$(ATF_CROSS_COMPILE)" PLAT=`echo $(2) | cut -d '-' -f1` bl31 -B SPD=trusty 1>/dev/null || exit 1; \
 	else \
@@ -43,7 +32,6 @@ define build_imx_uboot
 	cp $(IMX_PATH)/arm-trusted-firmware/build/`echo $(2) | cut -d '-' -f1`/release/bl31.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/bl31.bin; \
 	$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ clean; \
 	if [ `echo $(2) | cut -d '-' -f2` = "ddr4" ]; then \
-<<<<<<< HEAD
 		if [ `echo $(2) | rev | cut -d '-' -f1 | rev` != "dual" ]; then \
 		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN flash_ddr4_evk || exit 1; \
 		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN print_fit_hab_ddr4 || exit 1; \
@@ -59,16 +47,6 @@ define build_imx_uboot
 		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN flash_evk_no_hdmi_dual_bootloader || exit 1; \
 		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN PRINT_FIT_HAB_OFFSET=0x0 print_fit_hab || exit 1; \
 		fi; \
-=======
-		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN  flash_ddr4_evk || exit 1; \
-		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN print_fit_hab_ddr4 || exit 1; \
-	elif [ `echo $(2) | rev | cut -d '-' -f1 | rev` != "dual" ]; then \
-		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN flash_spl_uboot || exit 1; \
-		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN print_fit_hab || exit 1; \
-	else \
-		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN flash_evk_no_hdmi_dual_bootloader || exit 1; \
-		$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8MN PRINT_FIT_HAB_OFFSET=0x0 print_fit_hab || exit 1; \
->>>>>>> post_merge/android-11.0.0_2.0.0
 	fi; \
 	if [ `echo $(2) | rev | cut -d '-' -f1 | rev` != "dual" ]; then \
 		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(UBOOT_COLLECTION)/u-boot-$(strip $(2)).imx; \
diff --git a/imx8m/vp6820_8mn/BoardConfig.mk b/imx8m/vp6820_8mn/BoardConfig.mk
index 01e7769c..5403b522 100644
--- a/imx8m/vp6820_8mn/BoardConfig.mk
+++ b/imx8m/vp6820_8mn/BoardConfig.mk
@@ -1,5 +1,3 @@
-<<<<<<< HEAD
-=======
 # -------@block_infrastructure-------
 #
 # Product-specific compile-time definitions.
@@ -7,91 +5,25 @@
 
 include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
 
->>>>>>> post_merge/android-11.0.0_2.0.0
 #
 # SoC-specific compile-time definitions.
 #
 
 BOARD_SOC_TYPE := IMX8MN
-<<<<<<< HEAD
 BOARD_SOM_TYPE := a100
 BOARD_TYPE := DEVBOARD
 BOARD_MAIN_DISPLAY_ROTATION := 0
 BOARD_HAVE_VPU := false
 HAVE_FSL_IMX_GPU2D := false
 HAVE_FSL_IMX_GPU3D := true
-HAVE_FSL_IMX_IPU := false
-HAVE_FSL_IMX_PXP := false
-BOARD_KERNEL_BASE := 0x40400000
-TARGET_GRALLOC_VERSION := v3
-TARGET_USES_HWC2 := true
-TARGET_HWCOMPOSER_VERSION := v2.0
-USE_OPENGL_RENDERER := true
-TARGET_HAVE_VULKAN := true
-ENABLE_CFI=false
-
-SOONG_CONFIG_IMXPLUGIN += \
-                        BOARD_HAVE_VPU
-=======
-BOARD_HAVE_VPU := false
-HAVE_FSL_IMX_GPU2D := false
-HAVE_FSL_IMX_GPU3D := true
 HAVE_FSL_IMX_PXP := false
 TARGET_USES_HWC2 := true
 TARGET_HAVE_VULKAN := true
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 SOONG_CONFIG_IMXPLUGIN_BOARD_SOC_TYPE = IMX8MN
 SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU = false
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_ONLY = false
 
-<<<<<<< HEAD
-#
-# Product-specific compile-time definitions.
-#
-
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mn
-
-include device/idtech/imx8m/BoardConfigCommon.mk
-
-BUILD_TARGET_FS ?= ext4
-TARGET_USERIMAGES_USE_EXT4 := true
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-# Support gpt
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab_super.bpt
-  ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
-                           partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
-else
-  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-13GB-ab-no-product.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab-no-product.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
-  else
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
-  endif
-endif
-
-# Vendor Interface manifest and compatibility
-DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
-ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
-DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
-endif
-DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-USE_OPENGL_RENDERER := true
-
-BOARD_WLAN_DEVICE            := bcmdhd
-=======
 # -------@block_memory-------
 USE_ION_ALLOCATOR := true
 USE_GPU_ALLOCATOR := false
@@ -104,9 +36,9 @@ TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
 
 # Support gpt
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab_super.bpt
+  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab_super.bpt
   ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
+                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
                            partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
 else
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -115,14 +47,16 @@ else
                              partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
   else
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab.bpt
+    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab.bpt
     ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
+                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
   endif
 endif
 
-BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-imx8mn.img
+LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
+LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
+BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
 
 BOARD_USES_METADATA_PARTITION := true
 BOARD_ROOT_EXTRA_FOLDERS += metadata
@@ -131,75 +65,43 @@ BOARD_ROOT_EXTRA_FOLDERS += metadata
 ENABLE_CFI=false
 
 BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA4096
+BOARD_AVB_ALGORITHM := SHA256_RSA2048
 # The testkey_rsa4096.pem is copied from external/avb/test/data/testkey_rsa4096.pem
-BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/testkey_rsa4096.pem
+BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/idt_testkey_rsa2048.pem
 
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
+#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
+#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
+#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
 
 # -------@block_treble-------
 # Vendor Interface manifest and compatibility
 DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
+ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
+DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
+endif
 DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
 DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE := $(IMX_DEVICE_PATH)/device_framework_matrix.xml
 
 # -------@block_wifi-------
-BOARD_WLAN_DEVICE            := nxp
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_WLAN_DEVICE            := bcmdhd
 WPA_SUPPLICANT_VERSION       := VER_0_8_X
 BOARD_WPA_SUPPLICANT_DRIVER  := NL80211
 BOARD_HOSTAPD_DRIVER         := NL80211
 BOARD_HOSTAPD_PRIVATE_LIB               := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 BOARD_WPA_SUPPLICANT_PRIVATE_LIB        := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
-
-<<<<<<< HEAD
 WIFI_DRIVER_FW_PATH_PARAM := "/sys/module/brcmfmac/parameters/alternative_fw_path"
+WIFI_HIDL_FEATURE_DUAL_INTERFACE := false
 
-#BOARD_USE_SENSOR_FUSION := true
-BOARD_USE_ST_SENSOR_INPUT := true
-
-# we don't support sparse image.
-TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
-
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
+# -------@block_bluetooth-------
 # BCM 1MW BT
 BOARD_HAVE_BLUETOOTH_BCM := true
-
-BOARD_HAVE_USB_CAMERA := true
-BOARD_HAVE_USB_MJPEG_CAMERA := false
-
-USE_ION_ALLOCATOR := true
-USE_GPU_ALLOCATOR := false
-
-BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_KEY_PATH := device/idtech/common/security/idt_testkey_rsa2048.pem
-
-#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
-
-TARGET_USES_MKE2FS := true
-
-# define frame buffer count
-NUM_FRAMEBUFFER_SURFACE_BUFFERS := 3
-=======
-WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-
-# -------@block_bluetooth-------
-# NXP 8987 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
 BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
 
 # -------@block_sensor-------
-BOARD_USE_SENSOR_FUSION := true
+BOARD_USE_ST_SENSOR_INPUT := true
 
 # -------@block_kernel_bootimg-------
 BOARD_KERNEL_BASE := 0x40400000
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 CMASIZE=800M
 
@@ -210,11 +112,7 @@ BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardw
 BOARD_KERNEL_CMDLINE += transparent_hugepage=never
 
 # display config
-<<<<<<< HEAD
 BOARD_KERNEL_CMDLINE += androidboot.lcd_density=294 androidboot.primary_display=imx-drm
-=======
-BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-drm
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # wifi config
 BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_para_sd8987.conf
@@ -230,35 +128,11 @@ ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
 BOARD_KERNEL_CMDLINE += androidboot.vendor.sysrq=1
 endif
 
-<<<<<<< HEAD
-ifeq ($(TARGET_USERIMAGES_USE_UBIFS),true)
-ifeq ($(TARGET_USERIMAGES_USE_EXT4),true)
-$(error "TARGET_USERIMAGES_USE_UBIFS and TARGET_USERIMAGES_USE_EXT4 config open in same time, please only choose one target file system image")
-endif
-endif
-
-LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
-LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
-BOARD_PREBUILT_DTBOIMAGE := out/target/product/vp6820_8mn/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG := imx8mn-ddr4:imx8mn-ddr4-evk-no-product.dtb
   else
-<<<<<<< HEAD
-    # imx8mn with MIPI-HDMI display, BCM wifi and support trusty
-    TARGET_BOARD_DTS_CONFIG := imx8mn-ddr4:imx8mn-ddr4-evk.dtb
-    TARGET_BOARD_DTS_CONFIG += imx8mn:imx8mn-evk.dtb
-    # imx8mn with MIPI panel display and BCM wifi
-    TARGET_BOARD_DTS_CONFIG += imx8mn-ddr4-mipi-panel:imx8mn-ddr4-evk-rm67191.dtb
-    # imx8mn with MIPI-HDMI display and BCM wifi and M7 image
-    TARGET_BOARD_DTS_CONFIG += imx8mn-ddr4-rpmsg:imx8mn-ddr4-evk-rpmsg.dtb
-    # imx8mn with MIPI panel display and BCM wifi
-    TARGET_BOARD_DTS_CONFIG += imx8mn-mipi-panel:imx8mn-evk-rm67191.dtb
-    # imx8mn with MIPI-HDMI display and BCM wifi and M7 image
-=======
     # imx8mn with MIPI-HDMI display, wifi and support trusty
     TARGET_BOARD_DTS_CONFIG := imx8mn-ddr4:imx8mn-ddr4-evk.dtb
     TARGET_BOARD_DTS_CONFIG += imx8mn:imx8mn-evk.dtb
@@ -269,7 +143,6 @@ ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
     # imx8mn with MIPI panel display and wifi
     TARGET_BOARD_DTS_CONFIG += imx8mn-mipi-panel:imx8mn-evk-rm67191.dtb
     # imx8mn with MIPI-HDMI display and wifi and M7 image
->>>>>>> post_merge/android-11.0.0_2.0.0
     TARGET_BOARD_DTS_CONFIG += imx8mn-rpmsg:imx8mn-evk-rpmsg.dtb
   endif
 else
@@ -280,20 +153,6 @@ else
   endif
 endif
 
-<<<<<<< HEAD
-BOARD_SEPOLICY_DIRS := \
-       device/idtech/imx8m/sepolicy \
-       $(IMX_DEVICE_PATH)/sepolicy
-
-TARGET_BOARD_KERNEL_HEADERS := device/idtech/common/kernel-headers
-
-ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
-
-BOARD_USES_METADATA_PARTITION := true
-BOARD_ROOT_EXTRA_FOLDERS += metadata
-
-BOARD_PLAT_PRIVATE_SEPOLICY_DIR := device/idtech/imx8m/sepolicy_system/private
-=======
 ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
 
 # -------@block_sepolicy-------
@@ -301,4 +160,4 @@ BOARD_SEPOLICY_DIRS := \
        $(CONFIG_REPO_PATH)/imx8m/sepolicy \
        $(IMX_DEVICE_PATH)/sepolicy
 
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_PLAT_PRIVATE_SEPOLICY_DIR := $(CONFIG_REPO_PATH)/imx8m/sepolicy_system/private
diff --git a/imx8m/vp6820_8mn/SharedBoardConfig.mk b/imx8m/vp6820_8mn/SharedBoardConfig.mk
index 69217adc..7b5c326a 100644
--- a/imx8m/vp6820_8mn/SharedBoardConfig.mk
+++ b/imx8m/vp6820_8mn/SharedBoardConfig.mk
@@ -1,36 +1,15 @@
-<<<<<<< HEAD
+# -------@block_kernel_bootimg-------
 KERNEL_NAME := Image
 TARGET_KERNEL_ARCH := arm64
 
-#Enable this to config 1GB ddr on evk_imx8mn
-#LOW_MEMORY := true
-
-#Enable this to include trusty support
-PRODUCT_IMX_TRUSTY := true
-
-#Enable this to disable product partition build.
-#IMX_NO_PRODUCT_PARTITION := true
-
 # BCM fmac wifi driver module
 BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/drivers/net/wireless/broadcom/brcm80211/brcmfmac/brcmfmac.ko \
     $(KERNEL_OUT)/drivers/net/wireless/broadcom/brcm80211/brcmutil/brcmutil.ko
-=======
-# -------@block_kernel_bootimg-------
-KERNEL_NAME := Image
-TARGET_KERNEL_ARCH := arm64
-
-# NXP 8987 wifi driver module
-BOARD_VENDOR_KERNEL_MODULES += \
-    $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/mlan.ko \
-    $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/moal.ko
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # mipi-panel touch driver module
 BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/drivers/input/touchscreen/synaptics_dsx/synaptics_dsx_i2c.ko
-<<<<<<< HEAD
-=======
 
 # -------@block_memory-------
 #Enable this to config 1GB ddr on evk_imx8mn
@@ -40,4 +19,3 @@ LOW_MEMORY := false
 #Enable this to include trusty support
 PRODUCT_IMX_TRUSTY := true
 
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mn/android_addition_defconfig b/imx8m/vp6820_8mn/android_addition_defconfig
index 8b86be05..9f6f26f6 100644
--- a/imx8m/vp6820_8mn/android_addition_defconfig
+++ b/imx8m/vp6820_8mn/android_addition_defconfig
@@ -1,6 +1,5 @@
 CONFIG_LIBNVDIMM=y
 CONFIG_OF_PMEM=y
-<<<<<<< HEAD
 CONFIG_IDG_SPI=y
 # CONFIG_USB_NET_QMI_WWAN is not set
 CONFIG_SINGLE_LOGO=y
@@ -249,5 +248,3 @@ CONFIG_BCM_SBA_RAID=m
 # CONFIG_MMC_SDHCI_MSM is not set
 # CONFIG_MMC_SDHI is not set
 # CONFIG_MMC_DW_EXYNOS is not set
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mn/audio_policy_configuration.xml b/imx8m/vp6820_8mn/audio_policy_configuration.xml
index d49e0392..61800f55 100644
--- a/imx8m/vp6820_8mn/audio_policy_configuration.xml
+++ b/imx8m/vp6820_8mn/audio_policy_configuration.xml
@@ -21,13 +21,9 @@
         <module name="primary" halVersion="2.0">
             <attachedDevices>
                 <item>Speaker</item>
-<<<<<<< HEAD
                 <item>Wired Headphones</item>
                 <item>Built-In Mic</item>
                 <item>Wired-In Headsets</item>
-=======
-                <item>Built-In Mic</item>
->>>>>>> post_merge/android-11.0.0_2.0.0
             </attachedDevices>
             <defaultOutputDevice>Speaker</defaultOutputDevice>
             <mixPorts>
@@ -62,11 +58,8 @@
                 </devicePort>
                 <devicePort tagName="Spdif-In" type="AUDIO_DEVICE_IN_AUX_DIGITAL" role="source">
                 </devicePort>
-<<<<<<< HEAD
                 <devicePort tagName="Wired-In Headsets" type="AUDIO_DEVICE_IN_WIRED_HEADSET" role="source">
                 </devicePort>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
                 <devicePort tagName="BT SCO Headset Mic" type="AUDIO_DEVICE_IN_BLUETOOTH_SCO_HEADSET" role="source">
                 </devicePort>
             </devicePorts>
@@ -83,11 +76,7 @@
                        sources="bt sco output"/>
 
                 <route type="mix" sink="primary input"
-<<<<<<< HEAD
                        sources="Wired-In Headsets,Built-In Mic,Spdif-In,BT SCO Headset Mic"/>
-=======
-                       sources="Built-In Mic,Spdif-In,BT SCO Headset Mic"/>
->>>>>>> post_merge/android-11.0.0_2.0.0
             </routes>
         </module>
 
diff --git a/imx8m/vp6820_8mn/camera_config_imx8mn.json b/imx8m/vp6820_8mn/camera_config_imx8mn.json
index bf587e7c..978babcc 100644
--- a/imx8m/vp6820_8mn/camera_config_imx8mn.json
+++ b/imx8m/vp6820_8mn/camera_config_imx8mn.json
@@ -10,20 +10,6 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
-      "camera_name": "mxc-isi-cap",
-      "orientation": "0",
-      "mplane": "1",
-      "buffer_type": "dma",
-      "ActiveArrayWidth": "1920",
-      "ActiveArrayHeight": "1080",
-      "PixelArrayWidth": "1920",
-      "PixelArrayHeight": "1080",
-      "PhysicalWidth": "2.688",
-      "PhysicalHeight": "1.512",
-      "FocalLength": "3.42",
-      "MaxJpegSize": "4194304",
-=======
       "camera_name": "mxc_isi.0.capture",
       "orientation": "0",
       "mplane": "1",
@@ -36,7 +22,6 @@
       "PhysicalHeight": "2.7216",
       "FocalLength": "3.37",
       "MaxJpegSize": "8388608",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "MinFrameDuration": "33331760",
       "MaxFrameDuration": "300000000"
     }
diff --git a/imx8m/vp6820_8mn/evk_8mn.mk b/imx8m/vp6820_8mn/evk_8mn.mk
deleted file mode 100644
index 44ff7729..00000000
--- a/imx8m/vp6820_8mn/evk_8mn.mk
+++ /dev/null
@@ -1,379 +0,0 @@
-# This is a FSL Android Reference Design platform based on i.MX8QP ARD board
-# It will inherit from FSL core product which in turn inherit from Google generic
-
-IMX_DEVICE_PATH := device/nxp/imx8m/evk_8mn
-
-# configs shared between uboot, kernel and Android rootfs
-include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
-
--include device/nxp/common/imx_path/ImxPathConfig.mk
-include device/nxp/imx8m/ProductConfigCommon.mk
-
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab.nxp)
-endif
-
-# Overrides
-PRODUCT_NAME := evk_8mn
-PRODUCT_DEVICE := evk_8mn
-PRODUCT_MODEL := EVK_8MN
-
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-#Enable this to choose 32 bit user space build
-#IMX8_BUILD_32BIT_ROOTFS := true
-
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-#If the device is retrofit to have dynamic partition feature, set this variable to true to build
-#the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
-TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
-
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
-  PRODUCT_USE_DYNAMIC_PARTITIONS := true
-  BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
-  BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-  ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
-    PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
-    BOARD_SUPER_PARTITION_METADATA_DEVICE := system
-    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 2952790016
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-    else
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor product
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 1610612736
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-      BOARD_SUPER_PARTITION_PRODUCT_DEVICE_SIZE := 1879048192
-    endif
-  endif
-endif
-
-# Include keystore attestation keys and certificates.
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
--include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
-endif
-
-# Include Android Go config for low memory device.
-ifeq ($(LOW_MEMORY),true)
-$(call inherit-product, build/target/product/go_defaults.mk)
-endif
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mn/imx8mn_mcu_demo.img:imx8mn_mcu_demo.img \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp \
-    $(IMX_DEVICE_PATH)/init.imx8mn.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mn.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    device/nxp/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    device/nxp/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    device/nxp/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-# Audio card json
-PRODUCT_COPY_FILES += \
-    device/nxp/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    device/nxp/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    device/nxp/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
-    device/nxp/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    device/nxp/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    device/nxp/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    device/nxp/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-PRODUCT_COPY_FILES += \
-    device/nxp/imx8m/evk_8mn/camera_config_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mn.json
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    device/nxp/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    device/nxp/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_COPY_FILES += \
-    device/nxp/imx8m/evk_8mn/powerhint_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mn.json
-
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    device/nxp/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    device/nxp/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    device/nxp/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    device/nxp/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    device/nxp/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-
-USE_XML_AUDIO_POLICY_CONF := 1
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_CHARACTERISTICS := tablet
-
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# HWC2 HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.composer@2.4-service
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@2.0-impl-2.1 \
-    android.hardware.graphics.allocator@2.0-impl \
-    android.hardware.graphics.allocator@2.0-service
-
-# RenderScript HAL
-PRODUCT_PACKAGES += \
-    android.hardware.renderscript@1.0-impl
-
-PRODUCT_PACKAGES += \
-    libEGL_VIVANTE \
-    libGLESv1_CM_VIVANTE \
-    libGLESv2_VIVANTE \
-    gralloc_viv.imx \
-    libGAL \
-    libGLSLC \
-    libVSC \
-    libgpuhelper \
-    libSPIRV_viv \
-    libvulkan_VIVANTE \
-    vulkan.imx \
-    libCLC \
-    libLLVM_viv \
-    libOpenCL \
-    libg2d-opencl \
-    libg2d-viv \
-    libOpenVX \
-    libOpenVXU \
-    libNNVXCBinary-evis \
-    libNNVXCBinary-evis2 \
-    libNNVXCBinary-lite \
-    libOvx12VXCBinary-evis \
-    libOvx12VXCBinary-evis2 \
-    libOvx12VXCBinary-lite \
-    libNNGPUBinary-evis \
-    libNNGPUBinary-evis2 \
-    libNNGPUBinary-lite \
-    libNNGPUBinary-ulite \
-    libNNArchPerf \
-    libarchmodelSw
-
-# Neural Network HAL and Lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.2-service-vsi-npu-server
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32 \
-    android.hardware.power@1.3-service.imx \
-    android.hardware.light@2.0-impl \
-    android.hardware.light@2.0-service \
-    android.hardware.configstore@1.1-service \
-    configstore@1.1.policy
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    device/nxp/imx8m/evk_8mn/thermal_info_config_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mn.json \
-    device/nxp/imx8m/evk_8mn/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-# NXP 8987 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# WiFi HAL
-PRODUCT_PACKAGES += \
-    android.hardware.wifi@1.0-service \
-    wifilogd \
-    wificond
-
-# WiFi RROs
-PRODUCT_PACKAGES += \
-    WifiOverlay
-
-# NXP 8987 Wifi and Bluetooth Combo Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8987/sdiouart8987_combo_v0.bin:vendor/firmware/sdiouart8987_combo_v0.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para_sd8987.conf
-
-# Wifi regulatory
-PRODUCT_COPY_FILES += \
-    external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
-    external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
-
-# Keymaster HAL
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# DRM HAL
-TARGET_ENABLE_MEDIADRM_64 := true
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-ifneq ($(BUILD_TARGET_FS),ubifs)
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.frp.pst=/dev/block/by-name/presistdata
-endif
-
-PRODUCT_PACKAGES += \
-    DirectAudioPlayer
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-#Dumpstate HAL 1.1 support
-PRODUCT_PACKAGES += \
-    android.hardware.dumpstate@1.1-service.imx
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-IMX-DEFAULT-G2D-LIB := libg2d-opencl
-
-ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
-ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
-INSTALL_64BIT_LIBRARY := true
-endif
--include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
-endif
-
-# imx c2 codec binary
-PRODUCT_PACKAGES += \
-    c2_component_register \
-    c2_component_register_ms \
-    c2_component_register_ra
-
-# Resume on Reboot support
-PRODUCT_PACKAGES += \
-    android.hardware.rebootescrow-service.default
-
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rebootescrow.device=/dev/block/pmem0
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
diff --git a/imx8m/vp6820_8mn/evk_8mn.mk~post_merge_android-11.0.0_2.0.0 b/imx8m/vp6820_8mn/evk_8mn.mk~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index e215fe8f..00000000
--- a/imx8m/vp6820_8mn/evk_8mn.mk~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,405 +0,0 @@
-# -------@block_infrastructure-------
-
-CONFIG_REPO_PATH := device/nxp
-CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
-IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
-
-# configs shared between uboot, kernel and Android rootfs
-include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
-
--include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
-include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
-
-# -------@block_common_config-------
-
-# Overrides
-PRODUCT_NAME := evk_8mn
-PRODUCT_DEVICE := evk_8mn
-PRODUCT_MODEL := EVK_8MN
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-PRODUCT_CHARACTERISTICS := tablet
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# -------@block_treble-------
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-
-# -------@block_power-------
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/powerhint_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mn.json
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-PRODUCT_PACKAGES += \
-    android.hardware.power-service.imx
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mn.json
-
-# -------@block_app-------
-#Enable this to choose 32 bit user space build
-IMX8_BUILD_32BIT_ROOTFS := false
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml
-
-# -------@block_kernel_bootimg-------
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh
-
-# -------@block_storage-------
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
-  PRODUCT_USE_DYNAMIC_PARTITIONS := true
-  BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
-  BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-endif
-
-#Enable this to disable product partition build.
-IMX_NO_PRODUCT_PARTITION := false
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
-  PRODUCT_PACKAGES += imx_ota_postinstall
-
-  AB_OTA_POSTINSTALL_CONFIG += \
-    RUN_POSTINSTALL_vendor=true \
-    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
-    FILESYSTEM_TYPE_vendor=ext4 \
-    POSTINSTALL_OPTIONAL_vendor=false
-
-  PRODUCT_COPY_FILES += \
-    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mn-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
-endif
-
-# fastboot_imx_flashall scripts, imx-sdcard-partition script uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# -------@block_security-------
-# Include keystore attestation keys and certificates.
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
--include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
-endif
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# Keymaster HAL
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.3-service.clearkey \
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-# Resume on Reboot support
-PRODUCT_PACKAGES += \
-    android.hardware.rebootescrow-service.default
-
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rebootescrow.device=/dev/block/pmem0
-
-# -------@block_audio-------
-# Audio card json
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32
-
-PRODUCT_COPY_FILES += \
-    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mn/imx8mn_mcu_demo.img:imx8mn_mcu_demo.img \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml
-
-# -------@block_camera-------
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/camera_config_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mn.json
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-# -------@block_display-------
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# HWC2 HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.composer@2.4-service
-
-
-# define frame buffer count
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@4.0-impl.imx \
-    android.hardware.graphics.allocator@4.0-service.imx
-
-# RenderScript HAL
-PRODUCT_PACKAGES += \
-    android.hardware.renderscript@1.0-impl
-
-PRODUCT_PACKAGES += \
-    libg2d-opencl
-
-# -------@block_gpu-------
-
-PRODUCT_PACKAGES += \
-    libEGL_VIVANTE \
-    libGLESv1_CM_VIVANTE \
-    libGLESv2_VIVANTE \
-    gralloc_viv.$(TARGET_BOARD_PLATFORM) \
-    libGAL \
-    libGLSLC \
-    libVSC \
-    libgpuhelper \
-    libSPIRV_viv \
-    libvulkan_VIVANTE \
-    vulkan.$(TARGET_BOARD_PLATFORM) \
-    libCLC \
-    libLLVM_viv \
-    libOpenCL \
-    libg2d-viv \
-    libOpenVX \
-    libOpenVXU \
-    libNNVXCBinary-evis \
-    libNNVXCBinary-evis2 \
-    libNNVXCBinary-lite \
-    libOvx12VXCBinary-evis \
-    libOvx12VXCBinary-evis2 \
-    libOvx12VXCBinary-lite \
-    libNNGPUBinary-evis \
-    libNNGPUBinary-evis2 \
-    libNNGPUBinary-lite \
-    libNNGPUBinary-ulite \
-    libNNArchPerf \
-    libarchmodelSw
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# -------@block_wifi-------
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
-
-# WiFi HAL
-PRODUCT_PACKAGES += \
-    android.hardware.wifi@1.0-service \
-    wificond
-
-# WiFi RROs
-PRODUCT_PACKAGES += \
-    WifiOverlay
-
-# NXP 8987 Wifi and Bluetooth Combo Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8987/sdiouart8987_combo_v0.bin:vendor/firmware/sdiouart8987_combo_v0.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para_sd8987.conf
-
-# Wifi regulatory
-PRODUCT_COPY_FILES += \
-    external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
-    external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
-
-# -------@block_bluetooth-------
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-# NXP 8987 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# -------@block_usb-------
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
-
-# -------@block_multimedia_codec-------
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_PACKAGES += \
-    DirectAudioPlayer
-
-# imx c2 codec binary
-PRODUCT_PACKAGES += \
-    c2_component_register \
-    c2_component_register_ms \
-    c2_component_register_ra
-
-ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
-ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
-INSTALL_64BIT_LIBRARY := true
-endif
--include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
-endif
-
-# -------@block_memory-------
-# Include Android Go config for low memory device.
-ifeq ($(LOW_MEMORY),true)
-$(call inherit-product, build/target/product/go_defaults.mk)
-endif
-
-# -------@block_neural_network-------
-# Neural Network HAL and Lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# -------@block_miscellaneous-------
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.imx8mn.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mn.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
diff --git a/imx8m/vp6820_8mn/fstab.nxp b/imx8m/vp6820_8mn/fstab.nxp
index 9ac3f931..637bf7f9 100644
--- a/imx8m/vp6820_8mn/fstab.nxp
+++ b/imx8m/vp6820_8mn/fstab.nxp
@@ -4,7 +4,7 @@
 # specify MF_CHECK, and must come before any filesystems that do specify MF_CHECK
 
 /devices/platform/soc@0/32c00000.bus/32e40000.usb/* auto auto defaults voldmanaged=usb:auto
-/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block,metadata_csum
+/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block
 /dev/block/by-name/metadata    /metadata    ext4    noatime,nosuid,nodev,discard,sync                                                wait,formattable,first_stage_mount,check
 /dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
 /dev/block/by-name/idtechdata  /mnt/vendor/idtechdata  ext4    nosuid,nodev,noatime,barrier=1                       wait,formattable
diff --git a/imx8m/vp6820_8mn/init.imx8mn.rc b/imx8m/vp6820_8mn/init.imx8mn.rc
index eab2141e..4b2629ff 100755
--- a/imx8m/vp6820_8mn/init.imx8mn.rc
+++ b/imx8m/vp6820_8mn/init.imx8mn.rc
@@ -7,11 +7,7 @@ on early-boot
     write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
 
     # Set NN reject model by weights md5
-<<<<<<< HEAD
-    setprop WEIGHT_MD5_CHECK 1
-=======
     setprop vendor.MODEL_BLOCK_LEVEL 1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # change for FSL specific service
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
@@ -23,13 +19,10 @@ on early-boot
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
-<<<<<<< HEAD
-=======
     chown root system /sys/devices/system/cpu/cpu2/online
     chmod 0664 /sys/devices/system/cpu/cpu2/online
     chown root system /sys/devices/system/cpu/cpu3/online
     chmod 0664 /sys/devices/system/cpu/cpu3/online
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on property:sys.boot_completed=1
     # Set default CPU frequency governor
@@ -56,7 +49,6 @@ on property:sys.boot_completed=1
     # system-background is for system tasks that should only run on
     # little cores, not on bigs to be used only by init
     write /dev/cpuset/system-background/cpus 0-2
-<<<<<<< HEAD
 
 on init
     #IDtech added for AB ota update bootloader
@@ -64,5 +56,3 @@ on init
     symlink   /dev/block/mmcblk2boot1p1   /dev/block/by-name/spl_b
     symlink   /dev/block/mmcblk2boot0p2   /dev/block/by-name/spl_bak_a
     symlink   /dev/block/mmcblk2boot1p2   /dev/block/by-name/spl_bak_b
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mn/init.rc b/imx8m/vp6820_8mn/init.rc
index c1bead91..4576e5fa 100644
--- a/imx8m/vp6820_8mn/init.rc
+++ b/imx8m/vp6820_8mn/init.rc
@@ -1,9 +1,6 @@
 import /vendor/etc/init/hw/init.${ro.hardware}.usb.rc
 import /vendor/etc/init/hw/init.${ro.hardware}.${ro.boot.soc_type}.rc
-<<<<<<< HEAD
 import /product/etc/init/hw/init.idt.common.rc
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 service vendor.charger /system/bin/charger
     class charger
@@ -25,11 +22,7 @@ on early-init
 on early-init
     start early_init_sh
     # Set the host name which used in console
-<<<<<<< HEAD
     export HOSTNAME vp6820_8mn
-=======
-    export HOSTNAME evk_8mn
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Due keymaster start very early so set prop here
     # Also gatekeeper share same role for keymaster
@@ -51,14 +44,6 @@ on init && property:vendor.skip.charger_not_need=0
     symlink /sdcard /mnt/sdcard
     symlink /sdcard /storage/sdcard0
 
-<<<<<<< HEAD
-    # setup the global environment
-    export CORE_REGISTER_FILE /vendor/etc/core_register
-    export COMPONENT_REGISTER_FILE /vendor/etc/component_register
-    export CONTENTPIPE_REGISTER_FILE /vendor/etc/contentpipe_register
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     # disable cursor blink for fbcon, if no splash screen support
     write /sys/class/graphics/fbcon/cursor_blink 0
 
@@ -99,19 +84,12 @@ on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charg
     start vendor.oemlock-1-0
 
 on early-boot && property:vendor.skip.charger_not_need=0
-    # For evk_8mn, when swap used about 400M, upgrade the level.
+    # For vp6820_8mn, when swap used about 400M, upgrade the level.
     setprop ro.lmk.upgrade_pressure 80
     setprop ro.lmk.downgrade_pressure 95
     setprop ro.lmk.critical_upgrade true
 
-<<<<<<< HEAD
-    # Set permission for IIM node
-    symlink /dev/mxs_viim /dev/mxc_mem
-
-    setprop hwc.stretch.filter  1
-=======
     setprop vendor.hwc.stretch.filter  1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # fsl omx graphic manager media framework property
     setprop vendor.rw.VIDEO_RENDER_NAME video_render.surface
@@ -126,7 +104,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     write /sys/block/mmcblk1/queue/read_ahead_kb 2048
     write /sys/block/mmcblk2/queue/read_ahead_kb 2048
 
-<<<<<<< HEAD
     # Wifi firmware reload path
     chown wifi wifi /sys/module/brcmfmac/parameters/alternative_fw_path
 
@@ -134,17 +111,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     setprop wifi.interface wlan0
     setprop wifi.direct.interface p2p-dev-wlan0
 
-    # Prepare for bluetooth
-    chmod 665 /sys/class/rfkill/rfkill0/state
-    chown bluetooth bluetooth /sys/class/rfkill/rfkill0/state
-    write /sys/class/rfkill/rfkill0/state 0
-=======
-    # Prepare for wifi
-    setprop wifi.interface wlan0
-    setprop wifi.direct.interface p2p0
-    setprop wifi.concurrent.interface wlan1
->>>>>>> post_merge/android-11.0.0_2.0.0
-
     # Set tracefs permission to 755
     chmod 0755 /sys/kernel/debug/tracing
 
@@ -153,12 +119,11 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0664 /sys/kernel/debug/sync/sw_sync
 
     # Default backlight device
-<<<<<<< HEAD
     #setprop vendor.hw.backlight.dev "32e10000.dsi_controller.0"
-    setprop vendor.hw.backlight.dev "backlight"
     # Chmod/chown FSL specific sys entry
     #chown system system /sys/class/backlight/32e10000.dsi_controller.0/brightness
     #chmod 0660 /sys/class/backlight/32e10000.dsi_controller.0/brightness
+    setprop vendor.hw.backlight.dev "backlight"
     chown system system /sys/class/backlight/backlight/brightness
     chmod 0660 /sys/class/backlight/backlight/brightness
 
@@ -169,12 +134,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0660 /sys/class/backlight/pwm_2/brightness
     chmod 0660 /sys/class/backlight/pwm_3/brightness
     chmod 0660 /sys/class/backlight/pwm_4/brightness
-=======
-    setprop vendor.hw.backlight.dev "32e10000.dsi_controller.0"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/32e10000.dsi_controller.0/brightness
-    chmod 0660 /sys/class/backlight/32e10000.dsi_controller.0/brightness
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Set light sensor sysfs path and light sensor threshold lux value
     setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
@@ -186,12 +145,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # Enlarge limition of audio buffer allocation
     setprop ro.af.client_heap_size_kbyte 32768
 
-<<<<<<< HEAD
-    # enlarge media max memory size to 3G.
-    setprop ro.media.maxmem 3221225471
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     start vendor.wifi_hal_legacy
 
 
@@ -214,68 +167,19 @@ service sensor_fusion /vendor/bin/fsl_sensor_fusion
     group system uhid
     oneshot
 
-<<<<<<< HEAD
 service vendor.sensors-hal-1-0 /vendor/bin/hw/android.hardware.sensors@1.0-service
     class hal
     user system
     group system wakelock input root
     capabilities BLOCK_SUSPEND SYS_NICE
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
 service watchdogd /system/bin/watchdogd 10 20
     class core
     seclabel u:r:watchdogd:s0
 
-<<<<<<< HEAD
-service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_p2p /system/bin/dhcpcd -aABKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_eth0 /system/bin/dhcpcd -ABKL eth0
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_bt-pan /system/bin/dhcpcd -ABKL
-    class main
-    disabled
-    oneshot
-
-service iprenew_wlan0 /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_p2p /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_eth0 /system/bin/dhcpcd -n eth0
-    class main
-    disabled
-    oneshot
-
-service iprenew_bt-pan /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-# bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -B -z \
-        -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
-=======
 # bugreport is triggered by holding down volume down, volume up and power
 service bugreport /system/bin/dumpstate -d -p -z
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     disabled
     oneshot
@@ -297,12 +201,6 @@ on fs && property:vendor.skip.charger_not_need=0
     # Update dm-verity state and set partition.*.verified properties
     verity_update_state
 
-<<<<<<< HEAD
-on verity-logging && property:vendor.skip.charger_not_need=0
-    exec u:r:slideshow:s0 -- /sbin/slideshow warning/verity_red_1 warning/verity_red_2
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 on post-fs && property:vendor.skip.charger_not_need=0
     # Set netd memlock rlimit to 8MB
     setrlimit 8 8388608 8388608
@@ -323,11 +221,7 @@ on post-fs-data && property:vendor.skip.charger_not_need=0
     mkdir /data/vendor/ss 0700 system system
 
     # tmp dir for opencl Compiler
-<<<<<<< HEAD
-    setprop TMPDIR /data/vendor/.opencl-cache
-=======
     setprop vendor.TMPDIR /data/vendor/.opencl-cache
->>>>>>> post_merge/android-11.0.0_2.0.0
     mkdir /data/vendor/.opencl-cache 0771 system camera
 
 on zygote-start && property:vendor.skip.charger_not_need=0
diff --git a/imx8m/vp6820_8mn/manifest.xml b/imx8m/vp6820_8mn/manifest.xml
index c0ac3743..ea7deb5f 100644
--- a/imx8m/vp6820_8mn/manifest.xml
+++ b/imx8m/vp6820_8mn/manifest.xml
@@ -1,18 +1,10 @@
-<<<<<<< HEAD
-<manifest version="1.0" type="device" target-level="4">
-=======
 <manifest version="1.0" type="device" target-level="5">
->>>>>>> post_merge/android-11.0.0_2.0.0
     <kernel  target-level="5" />
     <hal format="hidl">
 	<name>android.hardware.graphics.allocator</name>
         <transport>hwbinder</transport>
 	<impl level="generic"></impl>
-<<<<<<< HEAD
-	<version>2.0</version>
-=======
 	<version>4.0</version>
->>>>>>> post_merge/android-11.0.0_2.0.0
 	<interface>
 	    <name>IAllocator</name>
 	    <instance>default</instance>
@@ -39,17 +31,6 @@
     <hal format="hidl">
         <name>android.hardware.drm</name>
         <transport>hwbinder</transport>
-<<<<<<< HEAD
-        <version>1.0</version>
-        <interface>
-            <name>ICryptoFactory</name>
-            <instance>default</instance>
-        </interface>
-        <interface>
-            <name>IDrmFactory</name>
-            <instance>default</instance>
-        </interface>
-=======
         <version>1.3</version>
         <interface>
             <name>ICryptoFactory</name>
@@ -59,7 +40,6 @@
         </interface>
         <fqname>@1.3::ICryptoFactory/clearkey</fqname>
         <fqname>@1.3::IDrmFactory/clearkey</fqname>
->>>>>>> post_merge/android-11.0.0_2.0.0
     </hal>
     <hal format="hidl">
         <name>android.hardware.gatekeeper</name>
@@ -74,11 +54,7 @@
         <name>android.hardware.graphics.mapper</name>
         <transport arch="32+64">passthrough</transport>
         <impl level="generic"></impl>
-<<<<<<< HEAD
-        <version>2.1</version>
-=======
         <version>4.0</version>
->>>>>>> post_merge/android-11.0.0_2.0.0
         <interface>
             <name>IMapper</name>
             <instance>default</instance>
@@ -94,7 +70,6 @@
         </interface>
     </hal>
     <hal format="hidl">
-<<<<<<< HEAD
         <name>android.hardware.sensors</name>
         <transport>hwbinder</transport>
         <version>1.0</version>
@@ -104,17 +79,6 @@
         </interface>
     </hal>
     <hal format="hidl">
-        <name>android.hardware.configstore</name>
-        <transport>hwbinder</transport>
-        <version>1.1</version>
-        <interface>
-            <name>ISurfaceFlingerConfigs</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
         <name>android.hardware.media.c2</name>
         <transport>hwbinder</transport>
         <version>1.0</version>
@@ -136,23 +100,6 @@
             <instance>default</instance>
         </interface>
     </hal>
-    <hal format="hidl">
-<<<<<<< HEAD
-        <name>android.hardware.light</name>
-        <transport>hwbinder</transport>
-        <version>2.0</version>
-        <interface>
-            <name>ILight</name>
-=======
-        <name>android.hardware.memtrack</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IMemtrack</name>
->>>>>>> post_merge/android-11.0.0_2.0.0
-            <instance>default</instance>
-        </interface>
-    </hal>
     <hal format="hidl">
         <name>android.hardware.audio</name>
         <transport>hwbinder</transport>
diff --git a/imx8m/vp6820_8mn/overlay/frameworks/base/core/res/res/values/config.xml~post_merge_android-11.0.0_2.0.0 b/imx8m/vp6820_8mn/overlay/frameworks/base/core/res/res/values/config.xml~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index 0d89ad5b..00000000
--- a/imx8m/vp6820_8mn/overlay/frameworks/base/core/res/res/values/config.xml~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,190 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-/*
-** Copyright 2011, The Android Open Source Project
-**
-** Licensed under the Apache License, Version 2.0 (the "License");
-** you may not use this file except in compliance with the License.
-** You may obtain a copy of the License at
-**
-**     http://www.apache.org/licenses/LICENSE-2.0
-**
-** Unless required by applicable law or agreed to in writing, software
-** distributed under the License is distributed on an "AS IS" BASIS,
-** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-** See the License for the specific language governing permissions and
-** limitations under the License.
-*/
--->
-
-<!-- These resources are around just to allow their values to be customized
-     for different hardware and product builds. -->
-<resources>
-
-    <!--For Android we support eth0 now -->
-    <string translatable="false" name="config_ethernet_iface_regex">eth0</string>
-
-    <!-- List of regexpressions describing the interface (if any) that represent tetherable
-         USB interfaces.  If the device doesn't want to support tething over USB this should
-         be empty.  An example would be "usb.*" -->
-     <string-array translatable="false" name="config_tether_usb_regexs">
-       <item>usb0</item>
-     </string-array>
-
-    <!-- List of regexpressions describing the interface (if any) that represent tetherable
-         Wifi interfaces.  If the device doesn't want to support tethering over Wifi this
-         should be empty.  An example would be "softap.*" -->
-    <string-array translatable="false" name="config_tether_wifi_regexs">
-      <item>"wlan0"</item>
-    </string-array>
-
-    <!-- List of regexpressions describing the interface (if any) that represent tetherable
-         bluetooth interfaces.  If the device doesn't want to support tethering over bluetooth this
-         should be empty. -->
-    <string-array translatable="false" name="config_tether_bluetooth_regexs">
-        <item>"bt-pan"</item>
-        </string-array>
-
-    <!-- Array of ConnectivityManager.TYPE_xxxx values allowable for tethering -->
-    <!-- Common options are [1, 4] for TYPE_WIFI and TYPE_MOBILE_DUN or
-    <!== [0,1,5,7,9] for TYPE_MOBILE, TYPE_WIFI, TYPE_MOBILE_HIPRI, TYPE_BLUETOOTH and TYPE_ETHERNET -->
-    <integer-array translatable="false" name="config_tether_upstream_types">
-        <item>0</item>
-        <item>1</item>
-        <item>5</item>
-        <item>9</item>
-    </integer-array>
-
-    <!-- Flag indicating whether we should enable the automatic brightness in Settings.
-         config_hardware_automatic_brightness_available is not set, so we will use software implementation -->
-    <bool name="config_automatic_brightness_available">true</bool>
-
-    <!-- An Array of "[ConnectivityManager connectionType],
-                      [# simultaneous connection types]"  -->
-    <string-array translatable="false" name="radioAttributes">
-        <item>"1,1"</item>
-        <item>"9,1"</item>
-    </string-array>
-
-    <!-- An Array of "[Connection name],[ConnectivityManager.TYPE_xxxx],
-         [associated radio-type],[priority],[restoral-timer(ms)],[dependencyMet]  -->
-    <!-- the 5th element "resore-time" indicates the number of milliseconds to delay
-         before automatically restore the default connection.  Set -1 if the connection
-         does not require auto-restore. -->
-    <!-- the 6th element indicates boot-time dependency-met value. -->
-    <string-array translatable="false" name="networkAttributes">
-        <item>"wifi,1,1,1,-1,true"</item>
-        <item>"bluetooth,7,7,2,-1,true"</item>
-        <item>"ethernet,9,9,2,-1,true"</item>
-    </string-array>
-
-    <!-- Array of light sensor LUX values to define our levels for auto backlight brightness support.
-         The N entries of this array define N + 1 zones as follows:
-
-         Zone 0:        0 <= LUX < array[0]
-         Zone 1:        array[0] <= LUX < array[1]
-         ...
-         Zone N:        array[N - 1] <= LUX < array[N]
-         Zone N + 1:    array[N] <= LUX < infinity
-
-         Must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessLevels">
-        <item>5</item>
-        <item>15</item>
-        <item>50</item>
-        <item>100</item>
-        <item>200</item>
-        <item>400</item>
-        <item>1000</item>
-        <item>2000</item>
-        <item>3000</item>
-        <item>5000</item>
-        <item>10000</item>
-        <item>30000</item>
-    </integer-array>
-
-    <!-- Array of output values for LCD backlight corresponding to the LUX values
-         in the config_autoBrightnessLevels array.  This array should have size one greater
-         than the size of the config_autoBrightnessLevels array.
-         This must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessLcdBacklightValues">
-        <item>5</item>    <!-- 0-5 -->
-        <item>20</item>   <!-- 5-15 -->
-        <item>30</item>   <!-- 15-50 -->
-        <item>40</item>   <!-- 50-100 -->
-        <item>50</item>   <!-- 100-200 -->
-        <item>60</item>   <!-- 200-400 -->
-        <item>70</item>   <!-- 400-1000 -->
-        <item>80</item>   <!-- 1000-2000 -->
-        <item>130</item>  <!-- 2000-3000 -->
-        <item>180</item>  <!-- 3000-5000 -->
-        <item>255</item>  <!-- 5000-10000 -->
-        <item>255</item>  <!-- 10000-30000 -->
-        <item>255</item>  <!-- 30000+ -->
-    </integer-array>
-
-    <!-- Array of output values for button backlight corresponding to the LUX values
-         in the config_autoBrightnessLevels array.  This array should have size one greater
-         than the size of the config_autoBrightnessLevels array.
-         This must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessButtonBacklightValues">
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-    </integer-array>
-
-    <!-- Array of output values for keyboard backlight corresponding to the LUX values
-         in the config_autoBrightnessLevels array.  This array should have size one greater
-         than the size of the config_autoBrightnessLevels array.
-         This must be overridden in platform specific overlays -->
-    <integer-array name="config_autoBrightnessKeyboardBacklightValues">
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-        <item>0</item>
-    </integer-array>
-
-    <integer name="config_screenBrightnessDim">5</integer>
-
-    <!--  Maximum number of supported users -->
-    <integer name="config_multiuserMaximumUsers">8</integer>
-    <!--  Whether Multiuser UI should be shown -->
-    <bool name="config_enableMultiUserUI">true</bool>
-
-    <!-- Whether a software navigation bar should be shown. NOTE: in the future this may be
-         autodetected from the Configuration. -->
-    <bool name="config_showNavigationBar">true</bool>
-
-    <!-- This device is not "voice capable"; it's data-only. -->
-    <bool name="config_voice_capable">false</bool>
-
-    <!-- Boolean indicating whether system support sustained performance mode. -->
-    <bool name="config_sustainedPerformanceModeSupported">true</bool>
-</resources>
diff --git a/imx8m/vp6820_8mn/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml b/imx8m/vp6820_8mn/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
index 87976f74..0bf9ee21 100644
--- a/imx8m/vp6820_8mn/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
+++ b/imx8m/vp6820_8mn/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
@@ -21,8 +21,5 @@
     <bool name="def_user_setup_complete">true</bool>
     <bool name="def_bluetooth_on">false</bool>
     <bool name="def_stay_on_while_plugged_in">true</bool>
-<<<<<<< HEAD
     <string name="def_immersive_mode_confirmations" translatable="false">confirmed</string>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </resources>
diff --git a/imx8m/vp6820_8mn/sepolicy/file_contexts b/imx8m/vp6820_8mn/sepolicy/file_contexts
index a883cae5..ccbdc5a3 100644
--- a/imx8m/vp6820_8mn/sepolicy/file_contexts
+++ b/imx8m/vp6820_8mn/sepolicy/file_contexts
@@ -1,53 +1,9 @@
-<<<<<<< HEAD
-#sd boot
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/misc             u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/metadata         u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/presistdata      u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/userdata         u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/vbmeta_[ab]      u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/super            u:object_r:super_block_device:s0
-
-#emmc boot
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/misc             u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/metadata         u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/presistdata      u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/userdata         u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/vbmeta_[ab]      u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/super            u:object_r:super_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/bootloader_[ab]  u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/mem_info_[ab]    u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/idtechdata       u:object_r:idtechdata_block_device:s0
-
-# spl
-/dev/block/mmcblk2boot[01]            u:object_r:spl_block_device:s0
-/dev/block/mmcblk2boot[01]p[1-9]      u:object_r:spl_block_device:s0
-
-#peripheral
-/vendor/bin/magd                u:object_r:sensors_exec:s0
-/vendor/bin/fsl_sensor_fusion   u:object_r:sensors_exec:s0
-/dev/mma8x5x                    u:object_r:sensors_device:s0
-/dev/ttymxc[0-9]*               u:object_r:tty_device:s0
-/dev/FreescaleAccelerometer     u:object_r:sensors_device:s0
-/dev/FreescaleMagnetometer      u:object_r:sensors_device:s0
-/dev/FreescaleGyroscope         u:object_r:sensors_device:s0
-=======
 /dev/block/mmcblk2boot0                      u:object_r:emmc_boot0:s0
 /dev/block/mmcblk1                           u:object_r:sdcard:s0
 
 #peripheral
 /vendor/bin/fsl_sensor_fusion   u:object_r:sensors_exec:s0
 /dev/ttymxc[0-9]*               u:object_r:tty_device:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 /dev/sda[0-8]*                  u:object_r:fuse:s0
 
 #Thermal HAL service
@@ -56,10 +12,6 @@
 /vendor/bin/hw/android\.hardware\.media\.c2@1\.0-service    u:object_r:mediacodec_exec:s0
 
 #Neural Network HAL service
-<<<<<<< HEAD
-/vendor/bin/hw/android\.hardware\.neuralnetworks@1\.2-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
-=======
 /vendor/bin/hw/android\.hardware\.neuralnetworks@1\.3-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 /dev/block/pmem0  u:object_r:rebootescrow_device:s0
diff --git a/imx8m/vp6820_8mn/sepolicy/genfs_contexts b/imx8m/vp6820_8mn/sepolicy/genfs_contexts
index 57fd87c8..c2fd2502 100644
--- a/imx8m/vp6820_8mn/sepolicy/genfs_contexts
+++ b/imx8m/vp6820_8mn/sepolicy/genfs_contexts
@@ -5,10 +5,6 @@ genfscon sysfs /devices/platform/soc@0/30800000.bus/30b50000.mmc/mmc_host/mmc1/m
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30b60000.mmc/mmc_host/mmc2/mmc2:0001/block/mmcblk2 u:object_r:sysfs_block_devices:s0
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30bb0000.spi/spi_master/spi3/spi3.0/mtd/mtd0/mtdblock0/ u:object_r:sysfs_block_devices:s0
 genfscon sysfs /devices/platform/soc@0/32c00000.bus/32e10000.dsi_controller/32e10000.dsi_controller.0/backlight u:object_r:sysfs_leds:s0
-<<<<<<< HEAD
-genfscon sysfs /devices/platform/backlight/backlight/backlight u:object_r:sysfs_leds:s0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 #sys/class/net
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30be0000.ethernet/net                                u:object_r:sysfs_net:s0
@@ -25,9 +21,8 @@ genfscon sysfs /devices/platform/soc@0/30800000.bus/30a30000.i2c/i2c-1/1-0050/po
 
 # for dumpstate to access the stat file
 genfscon sysfs /devices/platform/b8500000.pmem/ndbus0/region0/namespace0.0/block/pmem0                                            u:object_r:sysfs_block_devices:s0
-<<<<<<< HEAD
 
 # vp6820 type c controller as external connection
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30a40000.i2c/i2c-2/2-0067/extcon   u:object_r:sysfs_extcon:s0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
+
+genfscon sysfs /devices/platform/backlight/backlight/backlight u:object_r:sysfs_leds:s0
diff --git a/imx8m/vp6820_8mn/thermal_info_config_imx8mn.json b/imx8m/vp6820_8mn/thermal_info_config_imx8mn.json
index 0702f138..758490bf 100755
--- a/imx8m/vp6820_8mn/thermal_info_config_imx8mn.json
+++ b/imx8m/vp6820_8mn/thermal_info_config_imx8mn.json
@@ -1,28 +1,18 @@
 {
-<<<<<<< HEAD
-=======
     "HotplugCPUs":[
             "cpu2",
             "cpu3"
     ],
->>>>>>> post_merge/android-11.0.0_2.0.0
     "Sensors":[
         {
             "Name":"cpu-thermal",
             "Type":"CPU",
             "HotThreshold":[
                 "NAN",
-<<<<<<< HEAD
-                "NAN",
-                "NAN",
-                85.0,
-                95.0,
-=======
                 80.0,
                 82.0,
                 86.0,
                 90.0,
->>>>>>> post_merge/android-11.0.0_2.0.0
                 "NAN",
                 "NAN"
             ],
diff --git a/imx8m/vp6820_8mn/ueventd.nxp.rc b/imx8m/vp6820_8mn/ueventd.nxp.rc
index e5c5fd47..0c2537a7 100644
--- a/imx8m/vp6820_8mn/ueventd.nxp.rc
+++ b/imx8m/vp6820_8mn/ueventd.nxp.rc
@@ -1,9 +1,4 @@
-<<<<<<< HEAD
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/presistdata 0600   system     system
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/presistdata 0600   system     system
-=======
 /dev/block/by-name/presistdata 0600   system     system
->>>>>>> post_merge/android-11.0.0_2.0.0
 /dev/ttymxc0              0660   bluetooth  bluetooth
 /dev/snd/*                0660   system     audio
 /dev/video*               0660   system     camera
@@ -22,12 +17,9 @@
 
 /sys/devices/virtual/thermal/thermal_zone* trip_point_0_hyst 0660 system system
 /sys/devices/virtual/thermal/thermal_zone* trip_point_1_hyst 0660 system system
-<<<<<<< HEAD
 
 #quectel port
 /dev/ttyUSB*              0660   radio        radio
 /dev/cdc-wdm*             0660   radio        radio
 /dev/qcqmi*               0660   radio        radio
 /dev/cdc-acm*             0660   radio        radio
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mn/vp6820_8mn.mk b/imx8m/vp6820_8mn/vp6820_8mn.mk
index 7df7fb04..3e643a43 100644
--- a/imx8m/vp6820_8mn/vp6820_8mn.mk
+++ b/imx8m/vp6820_8mn/vp6820_8mn.mk
@@ -1,57 +1,21 @@
-<<<<<<< HEAD
-# This is a FSL Android Reference Design platform based on i.MX8QP ARD board
-# It will inherit from FSL core product which in turn inherit from Google generic
-
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mn
-=======
 # -------@block_infrastructure-------
 
-CONFIG_REPO_PATH := device/nxp
+CONFIG_REPO_PATH := device/idtech
 CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
 IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # configs shared between uboot, kernel and Android rootfs
 include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
 
-<<<<<<< HEAD
--include device/idtech/common/imx_path/ImxPathConfig.mk
-include device/idtech/imx8m/ProductConfigCommon.mk
-
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab.nxp)
-endif
-
-# Overrides
-PRODUCT_NAME := vp6820_8mn
-PRODUCT_DEVICE := vp6820_8mn
-PRODUCT_MODEL := VP6820_8MN
-
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-#Enable this to choose 32 bit user space build
-#IMX8_BUILD_32BIT_ROOTFS := true
-
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-#If the device is retrofit to have dynamic partition feature, set this variable to true to build
-#the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
-TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
-=======
 -include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
 include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
 
 # -------@block_common_config-------
 
 # Overrides
-PRODUCT_NAME := evk_8mn
-PRODUCT_DEVICE := evk_8mn
-PRODUCT_MODEL := EVK_8MN
+PRODUCT_NAME := vp6820_8mn
+PRODUCT_DEVICE := vp6820_8mn
+PRODUCT_MODEL := VP6820_8MN
 
 TARGET_BOOTLOADER_BOARD_NAME := EVK
 
@@ -94,7 +58,10 @@ IMX8_BUILD_32BIT_ROOTFS := false
 
 # Copy device related config and binary to board
 PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml
+    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
+    $(CONFIG_REPO_PATH)/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
+    $(CONFIG_REPO_PATH)/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
+    $(CONFIG_REPO_PATH)/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
 
 # -------@block_kernel_bootimg-------
 # Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
@@ -117,31 +84,12 @@ PRODUCT_COPY_FILES += \
 # -------@block_storage-------
 #Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
 TARGET_USE_DYNAMIC_PARTITIONS ?= true
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
   PRODUCT_USE_DYNAMIC_PARTITIONS := true
   BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
   BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-<<<<<<< HEAD
-  ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
-    PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
-    BOARD_SUPER_PARTITION_METADATA_DEVICE := system
-    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 2952790016
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-    else
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor product
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 1610612736
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-      BOARD_SUPER_PARTITION_PRODUCT_DEVICE_SIZE := 1879048192
-    endif
-  endif
-endif
-
-=======
 endif
 
 #Enable this to disable product partition build.
@@ -175,135 +123,17 @@ PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
     $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
 
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt
+
 # -------@block_security-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Include keystore attestation keys and certificates.
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 -include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
 endif
 
-<<<<<<< HEAD
-# Include Android Go config for low memory device.
-ifeq ($(LOW_MEMORY),true)
-$(call inherit-product, build/target/product/go_defaults.mk)
-endif
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mn/imx8mn_mcu_demo.img:imx8mn_mcu_demo.img \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp \
-    $(IMX_DEVICE_PATH)/init.imx8mn.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mn.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    device/idtech/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    device/idtech/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    device/idtech/common/wifi/bcm_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf \
-    device/idtech/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
-    device/idtech/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
-    device/idtech/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
-    device/idtech/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
-    device/idtech/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt \
-    device/idtech/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-# Audio card json
-PRODUCT_COPY_FILES += \
-    device/idtech/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    device/idtech/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    device/idtech/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
-    device/idtech/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    device/idtech/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
-    device/idtech/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    device/idtech/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    device/idtech/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/vp6820_8mn/camera_config_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mn.json
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/vp6820_8mn/powerhint_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mn.json
-
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    device/idtech/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    device/idtech/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    device/idtech/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    device/idtech/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    device/idtech/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-
-USE_XML_AUDIO_POLICY_CONF := 1
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_CHARACTERISTICS := tablet
-
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-=======
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
@@ -372,6 +202,7 @@ PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
     $(CONFIG_REPO_PATH)/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
     $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
     $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
 
 PRODUCT_PACKAGES += \
@@ -397,27 +228,11 @@ PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
 
 # -------@block_display-------
 PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # HWC2 HAL
 PRODUCT_PACKAGES += \
     android.hardware.graphics.composer@2.4-service
 
-<<<<<<< HEAD
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@2.0-impl-2.1 \
-    android.hardware.graphics.allocator@2.0-impl \
-    android.hardware.graphics.allocator@2.0-service
-=======
 
 # define frame buffer count
 PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
@@ -427,21 +242,18 @@ PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
 PRODUCT_PACKAGES += \
     android.hardware.graphics.mapper@4.0-impl.imx \
     android.hardware.graphics.allocator@4.0-service.imx
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # RenderScript HAL
 PRODUCT_PACKAGES += \
     android.hardware.renderscript@1.0-impl
 
 PRODUCT_PACKAGES += \
-<<<<<<< HEAD
-    libEGL_VIVANTE \
-    libGLESv1_CM_VIVANTE \
-    libGLESv2_VIVANTE \
-    gralloc_viv.imx \
-=======
     libg2d-opencl
 
+# Multi-Display launcher
+PRODUCT_PACKAGES += \
+    MultiClientInputMethod
+
 # -------@block_gpu-------
 
 PRODUCT_PACKAGES += \
@@ -449,25 +261,16 @@ PRODUCT_PACKAGES += \
     libGLESv1_CM_VIVANTE \
     libGLESv2_VIVANTE \
     gralloc_viv.$(TARGET_BOARD_PLATFORM) \
->>>>>>> post_merge/android-11.0.0_2.0.0
     libGAL \
     libGLSLC \
     libVSC \
     libgpuhelper \
     libSPIRV_viv \
     libvulkan_VIVANTE \
-<<<<<<< HEAD
-    vulkan.imx \
-    libCLC \
-    libLLVM_viv \
-    libOpenCL \
-    libg2d-opencl \
-=======
     vulkan.$(TARGET_BOARD_PLATFORM) \
     libCLC \
     libLLVM_viv \
     libOpenCL \
->>>>>>> post_merge/android-11.0.0_2.0.0
     libg2d-viv \
     libOpenVX \
     libOpenVXU \
@@ -484,129 +287,55 @@ PRODUCT_PACKAGES += \
     libNNArchPerf \
     libarchmodelSw
 
-<<<<<<< HEAD
-# Neural Network HAL and Lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.2-service-vsi-npu-server
+# GPU openCL g2d
+PRODUCT_COPY_FILES += \
+    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
 
+# -------@block_sensor-------
 PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32 \
-    android.hardware.power@1.3-service.imx \
-    android.hardware.light@2.0-impl \
-    android.hardware.light@2.0-service \
     android.hardware.sensors@1.0-impl \
     android.hardware.sensors@1.0-convert \
-    android.hardware.sensors@1.0-service \
-    android.hardware.configstore@1.1-service \
-    configstore@1.1.policy
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/evk_8mn/thermal_info_config_imx8mn.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mn.json \
-    device/idtech/imx8m/evk_8mn/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-# BCM Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# BCM 1MW Bluetooth Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/cyw-wifi-bt/1MW_CYW43455/BCM4345C0.1MW.hcd:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/CYW4345C0.1MW.hcd
-=======
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
+    android.hardware.sensors@1.0-service
 
 # -------@block_wifi-------
 PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
     $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # WiFi HAL
 PRODUCT_PACKAGES += \
     android.hardware.wifi@1.0-service \
-<<<<<<< HEAD
-    wifilogd \
     wificond
 
-# BCM 1MW Wifi Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/cyw-wifi-bt/1MW_CYW43455/brcmfmac43455-sdio.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/brcmfmac43455-sdio.bin \
-    vendor/nxp/imx-firmware/cyw-wifi-bt/1MW_CYW43455/brcmfmac43455-sdio.clm_blob:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/brcmfmac43455-sdio.clm_blob \
-    vendor/nxp/imx-firmware/cyw-wifi-bt/1MW_CYW43455/brcmfmac43455-sdio.txt:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/brcmfmac43455-sdio.txt
-
-=======
-    wificond
-
->>>>>>> post_merge/android-11.0.0_2.0.0
 # WiFi RROs
 PRODUCT_PACKAGES += \
     WifiOverlay
 
-<<<<<<< HEAD
-=======
-# NXP 8987 Wifi and Bluetooth Combo Firmware
+# BCM 1MW Wifi Firmware
 PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8987/sdiouart8987_combo_v0.bin:vendor/firmware/sdiouart8987_combo_v0.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para_sd8987.conf
+    vendor/nxp/imx-firmware/cyw-wifi-bt/1MW_CYW43455/brcmfmac43455-sdio.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/brcmfmac43455-sdio.bin \
+    vendor/nxp/imx-firmware/cyw-wifi-bt/1MW_CYW43455/brcmfmac43455-sdio.clm_blob:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/brcmfmac43455-sdio.clm_blob \
+    vendor/nxp/imx-firmware/cyw-wifi-bt/1MW_CYW43455/brcmfmac43455-sdio.txt:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/brcmfmac43455-sdio.txt
 
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Wifi regulatory
 PRODUCT_COPY_FILES += \
     external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
     external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
 
-<<<<<<< HEAD
-# Keymaster HAL
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# DRM HAL
-TARGET_ENABLE_MEDIADRM_64 := true
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-ifneq ($(BUILD_TARGET_FS),ubifs)
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.frp.pst=/dev/block/by-name/presistdata
-endif
-=======
 # -------@block_bluetooth-------
 # Bluetooth HAL
 PRODUCT_PACKAGES += \
     android.hardware.bluetooth@1.0-impl \
     android.hardware.bluetooth@1.0-service
 
-# NXP 8987 Bluetooth vendor config
+# BCM Bluetooth vendor config
 PRODUCT_PACKAGES += \
     bt_vendor.conf
 
+# BCM 1MW Bluetooth Firmware
+PRODUCT_COPY_FILES += \
+    vendor/nxp/imx-firmware/cyw-wifi-bt/1MW_CYW43455/BCM4345C0.1MW.hcd:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/CYW4345C0.1MW.hcd
+
 # -------@block_usb-------
 # Usb HAL
 PRODUCT_PACKAGES += \
@@ -622,58 +351,15 @@ PRODUCT_COPY_FILES += \
     $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
     $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
     $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 PRODUCT_PACKAGES += \
     DirectAudioPlayer
 
-<<<<<<< HEAD
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-#Dumpstate HAL 1.1 support
-PRODUCT_PACKAGES += \
-    android.hardware.dumpstate@1.1-service.imx
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-IMX-DEFAULT-G2D-LIB := libg2d-opencl
-=======
 # imx c2 codec binary
 PRODUCT_PACKAGES += \
     c2_component_register \
     c2_component_register_ms \
     c2_component_register_ra
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
@@ -682,61 +368,6 @@ endif
 -include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
 endif
 
-<<<<<<< HEAD
-# imx c2 codec binary
-PRODUCT_PACKAGES += \
-    c2_component_register \
-    c2_component_register_ms \
-    c2_component_register_ra
-
-# Resume on Reboot support
-PRODUCT_PACKAGES += \
-    android.hardware.rebootescrow-service.default
-
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rebootescrow.device=/dev/block/pmem0
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-# Copy Quectel vendor RIL
-PRODUCT_COPY_FILES += \
-    vendor/quectel/libstdc++.so:/vendor/lib64/libstdc++.so \
-    vendor/quectel/libQuectelreference-ril.so:/vendor/lib64/libQuectelreference-ril.so \
-    vendor/quectel/ql-ril.conf:/system/etc/ql-ril.conf \
-    vendor/quectel/apns-conf.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/apns-conf.xml  \
-    vendor/quectel/chat:/system/bin/chat \
-    vendor/quectel/ip-down:/system/etc/ppp/ip-down \
-    vendor/quectel/ip-up:/system/etc/ppp/ip-up \
-    vendor/quectel/QAndroidLog:/system/bin/QAndroidLog \
-    vendor/quectel/QFlash:/system/bin/QFlash \
-    vendor/quectel/T1.LinuxData-OTA-DataService_V01.cfg:/system/data/T1.LinuxData-OTA-DataService_V01.cfg \
-    vendor/quectel/T2.RegServ-CotextAct_V01.cfg:/system/data/T2.RegServ-CotextAct_V01.cfg \
-    vendor/quectel/T3.SimpleData_V01.cfg:/system/data/T3.SimpleData_V01.cfg \
-    vendor/quectel/T4.Throughput_V01.cfg:/system/data/T4.Throughput_V01.cfg \
-    vendor/quectel/T5.COMMON_V01.cfg:/system/data/T5.COMMON_V01.cfg \
-    vendor/quectel/T6.FullMessage.SimpleLogPacket_V01.cfg:/system/data/T6.FullMessage.SimpleLogPacket_V01.cfg
-
-#AMS
-PRODUCT_PACKAGES += \
-    deviceadmin \
-    appmanager \
-    amsconnector \
-    amsclouddrive \
-    amsbootmediasync \
-    welcomeapp \
-    diagnosis \
-    otaupdater \
-    watchdog
-
-# Enable kernel log for diagnosis
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.logd.kernel=true
-=======
 # -------@block_memory-------
 # Include Android Go config for low memory device.
 ifeq ($(LOW_MEMORY),true)
@@ -796,4 +427,36 @@ PRODUCT_COPY_FILES += \
     frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
     frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
 
->>>>>>> post_merge/android-11.0.0_2.0.0
+# Copy Quectel vendor RIL
+PRODUCT_COPY_FILES += \
+    vendor/quectel/libstdc++.so:/vendor/lib64/libstdc++.so \
+    vendor/quectel/libQuectelreference-ril.so:/vendor/lib64/libQuectelreference-ril.so \
+    vendor/quectel/ql-ril.conf:/system/etc/ql-ril.conf \
+    vendor/quectel/apns-conf.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/apns-conf.xml  \
+    vendor/quectel/chat:/system/bin/chat \
+    vendor/quectel/ip-down:/system/etc/ppp/ip-down \
+    vendor/quectel/ip-up:/system/etc/ppp/ip-up \
+    vendor/quectel/QAndroidLog:/system/bin/QAndroidLog \
+    vendor/quectel/QFlash:/system/bin/QFlash \
+    vendor/quectel/T1.LinuxData-OTA-DataService_V01.cfg:/system/data/T1.LinuxData-OTA-DataService_V01.cfg \
+    vendor/quectel/T2.RegServ-CotextAct_V01.cfg:/system/data/T2.RegServ-CotextAct_V01.cfg \
+    vendor/quectel/T3.SimpleData_V01.cfg:/system/data/T3.SimpleData_V01.cfg \
+    vendor/quectel/T4.Throughput_V01.cfg:/system/data/T4.Throughput_V01.cfg \
+    vendor/quectel/T5.COMMON_V01.cfg:/system/data/T5.COMMON_V01.cfg \
+    vendor/quectel/T6.FullMessage.SimpleLogPacket_V01.cfg:/system/data/T6.FullMessage.SimpleLogPacket_V01.cfg
+
+#AMS
+PRODUCT_PACKAGES += \
+    deviceadmin \
+    appmanager \
+    amsconnector \
+    amsclouddrive \
+    amsbootmediasync \
+    welcomeapp \
+    diagnosis \
+    otaupdater \
+    watchdog
+
+# Enable kernel log for diagnosis
+PRODUCT_PROPERTY_OVERRIDES += \
+    ro.logd.kernel=true
diff --git a/imx8m/vp6820_8mn/vp6820_8mn_pci.mk b/imx8m/vp6820_8mn/vp6820_8mn_pci.mk
index 61c1e794..68807286 100644
--- a/imx8m/vp6820_8mn/vp6820_8mn_pci.mk
+++ b/imx8m/vp6820_8mn/vp6820_8mn_pci.mk
@@ -1,7 +1,9 @@
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mn
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mn.mk)
 
 # Overrides
diff --git a/imx8m/vp6820_8mn/vp6820_8mn_pcidev.mk b/imx8m/vp6820_8mn/vp6820_8mn_pcidev.mk
index 4ef8eece..52ad6a39 100644
--- a/imx8m/vp6820_8mn/vp6820_8mn_pcidev.mk
+++ b/imx8m/vp6820_8mn/vp6820_8mn_pcidev.mk
@@ -1,7 +1,9 @@
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mn
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mn.mk)
 
 # Overrides
diff --git a/imx8m/vp6820_8mp/AndroidBoard.mk b/imx8m/vp6820_8mp/AndroidBoard.mk
index e92ce609..75193153 100644
--- a/imx8m/vp6820_8mp/AndroidBoard.mk
+++ b/imx8m/vp6820_8mp/AndroidBoard.mk
@@ -1,15 +1,9 @@
 LOCAL_PATH := $(call my-dir)
 
-<<<<<<< HEAD
-include device/idtech/common/build/dtbo.mk
-include device/idtech/common/build/imx-recovery.mk
-include device/idtech/common/build/gpt.mk
-=======
 include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
 include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
 include $(CONFIG_REPO_PATH)/common/build/gpt.mk
 #TODO add imx8mp target
->>>>>>> post_merge/android-11.0.0_2.0.0
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
 -include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/vp6820_8mp/AndroidUboot.mk b/imx8m/vp6820_8mp/AndroidUboot.mk
index 70a02a7e..cfb66ae6 100644
--- a/imx8m/vp6820_8mp/AndroidUboot.mk
+++ b/imx8m/vp6820_8mp/AndroidUboot.mk
@@ -2,16 +2,9 @@
 MAKE += SHELL=/bin/bash
 
 ifneq ($(AARCH64_GCC_CROSS_COMPILE),)
-<<<<<<< HEAD
-ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
-else
-ATF_TOOLCHAIN_ABS := $(realpath prebuilts/gcc/$(HOST_PREBUILT_TAG)/aarch64/aarch64-linux-android-4.9/bin)
-ATF_CROSS_COMPILE := $(ATF_TOOLCHAIN_ABS)/aarch64-linux-androidkernel-
-=======
   ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
 else
   $(error shell env AARCH64_GCC_CROSS_COMPILE is not set)
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 define build_imx_uboot
@@ -22,11 +15,7 @@ define build_imx_uboot
 	cp $(UBOOT_OUT)/arch/arm/dts/imx8mp-evk.dtb $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
-<<<<<<< HEAD
 	if [ `echo $(2) | cut -d '-' -f3` = "trusty" ]; then \
-=======
-	if [ `echo $(2) | cut -d '-' -f2` = "trusty" ]; then \
->>>>>>> post_merge/android-11.0.0_2.0.0
 		cp $(FSL_PROPRIETARY_PATH)/fsl-proprietary/uboot-firmware/imx8m/tee-imx8mp.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 		$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ CROSS_COMPILE="$(ATF_CROSS_COMPILE)" PLAT=`echo $(2) | cut -d '-' -f1` bl31 -B SPD=trusty 1>/dev/null || exit 1; \
 	else \
diff --git a/imx8m/vp6820_8mp/BoardConfig.mk b/imx8m/vp6820_8mp/BoardConfig.mk
index 3ca6eba7..91465122 100644
--- a/imx8m/vp6820_8mp/BoardConfig.mk
+++ b/imx8m/vp6820_8mp/BoardConfig.mk
@@ -1,5 +1,3 @@
-<<<<<<< HEAD
-=======
 # -------@block_infrastructure-------
 #
 # Product-specific compile-time definitions.
@@ -8,42 +6,23 @@
 include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
 
 # -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 #
 # SoC-specific compile-time definitions.
 #
 
 BOARD_SOC_TYPE := IMX8MP
-<<<<<<< HEAD
 BOARD_SOM_TYPE := a200
 BOARD_TYPE := DEVBOARD
 BOARD_MAIN_DISPLAY_ROTATION := 0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 BOARD_HAVE_VPU := true
 BOARD_VPU_TYPE := hantro
 HAVE_FSL_IMX_GPU2D := false
 HAVE_FSL_IMX_GPU3D := true
-<<<<<<< HEAD
-HAVE_FSL_IMX_IPU := false
 HAVE_FSL_IMX_PXP := false
-BOARD_KERNEL_BASE := 0x40400000
-TARGET_GRALLOC_VERSION := v3
 TARGET_USES_HWC2 := true
-TARGET_HWCOMPOSER_VERSION := v2.0
-USE_OPENGL_RENDERER := true
 TARGET_HAVE_VULKAN := true
-ENABLE_CFI=false
 
 SOONG_CONFIG_IMXPLUGIN += \
-                        BOARD_HAVE_VPU \
-=======
-HAVE_FSL_IMX_PXP := false
-TARGET_USES_HWC2 := true
-TARGET_HAVE_VULKAN := true
-
-SOONG_CONFIG_IMXPLUGIN += \
->>>>>>> post_merge/android-11.0.0_2.0.0
                         BOARD_VPU_TYPE
 
 SOONG_CONFIG_IMXPLUGIN_BOARD_SOC_TYPE = IMX8MP
@@ -51,52 +30,6 @@ SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU = true
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_TYPE = hantro
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_ONLY = false
 
-<<<<<<< HEAD
-#
-# Product-specific compile-time definitions.
-#
-
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mp
-
-include device/idtech/imx8m/BoardConfigCommon.mk
-
-BUILD_TARGET_FS ?= ext4
-TARGET_USERIMAGES_USE_EXT4 := true
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-# Support gpt
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab_super.bpt
-  ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
-                           partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
-else
-  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-13GB-ab-no-product.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab-no-product.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
-  else
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
-  endif
-endif
-
-# Vendor Interface manifest and compatibility
-DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
-ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
-DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
-endif
-DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-USE_OPENGL_RENDERER := true
-
-=======
 
 
 # -------@block_memory-------
@@ -112,9 +45,9 @@ TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
 
 # Support gpt
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab_super.bpt
+  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab_super.bpt
   ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
+                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
                            partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
 else
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -123,14 +56,16 @@ else
                              partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
   else
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab.bpt
+    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab.bpt
     ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
+                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
   endif
 endif
 
-BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-imx8mp.img
+LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
+LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
+BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
 
 BOARD_USES_METADATA_PARTITION := true
 BOARD_ROOT_EXTRA_FOLDERS += metadata
@@ -139,22 +74,24 @@ BOARD_ROOT_EXTRA_FOLDERS += metadata
 ENABLE_CFI=false
 
 BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA4096
+BOARD_AVB_ALGORITHM := SHA256_RSA2048
 # The testkey_rsa4096.pem is copied from external/avb/test/data/testkey_rsa4096.pem
-BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/testkey_rsa4096.pem
+BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/idt_testkey_rsa2048.pem
 
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
+#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
+#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
+#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
 
 # -------@block_treble-------
 # Vendor Interface manifest and compatibility
 DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
+ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
+DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
+endif
 DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
 DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE := $(IMX_DEVICE_PATH)/device_framework_matrix.xml
 
 # -------@block_wifi-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 # NXP 8997 WIFI
 BOARD_WLAN_DEVICE            := nxp
 WPA_SUPPLICANT_VERSION       := VER_0_8_X
@@ -164,56 +101,18 @@ BOARD_HOSTAPD_PRIVATE_LIB               := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 BOARD_WPA_SUPPLICANT_PRIVATE_LIB        := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 
 WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-<<<<<<< HEAD
-
-# NXP 8997 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
-
-# NXP 8997 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
-
-#BOARD_USE_SENSOR_FUSION := true
-BOARD_USE_ST_SENSOR_INPUT := true
-
-# we don't support sparse image.
-TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
-
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
-BOARD_HAVE_USB_CAMERA := true
-BOARD_HAVE_USB_MJPEG_CAMERA := false
-
-USE_ION_ALLOCATOR := true
-USE_GPU_ALLOCATOR := false
-
-BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_KEY_PATH := device/idtech/common/security/idt_testkey_rsa2048.pem
-
-#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
-
-TARGET_USES_MKE2FS := true
-
-# define frame buffer count
-NUM_FRAMEBUFFER_SURFACE_BUFFERS := 3
-
-CMASIZE=800M
-=======
 # -------@block_bluetooth-------
 # NXP 8997 BT
 BOARD_HAVE_BLUETOOTH_NXP := true
 BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
 
 # -------@block_sensor-------
-BOARD_USE_SENSOR_FUSION := true
+BOARD_USE_ST_SENSOR_INPUT := true
 
 # -------@block_kernel_bootimg-------
 BOARD_KERNEL_BASE := 0x40400000
 
 CMASIZE=960M
->>>>>>> post_merge/android-11.0.0_2.0.0
 # NXP default config
 BOARD_KERNEL_CMDLINE := init=/init androidboot.console=ttymxc1 androidboot.hardware=nxp firmware_class.path=/vendor/firmware loop.max_part=7
 
@@ -231,30 +130,13 @@ BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_pa
 ifeq ($(LOW_MEMORY),true)
 BOARD_KERNEL_CMDLINE += cma=320M@0x400M-0xb80M androidboot.displaymode=720p galcore.contiguousSize=33554432
 else
-<<<<<<< HEAD
-BOARD_KERNEL_CMDLINE += cma=$(CMASIZE)@0x400M-0xb80M
-=======
 BOARD_KERNEL_CMDLINE += cma=$(CMASIZE)@0x400M-0x1000M
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
 BOARD_KERNEL_CMDLINE += androidboot.vendor.sysrq=1
 endif
 
-<<<<<<< HEAD
-ifeq ($(TARGET_USERIMAGES_USE_UBIFS),true)
-ifeq ($(TARGET_USERIMAGES_USE_EXT4),true)
-$(error "TARGET_USERIMAGES_USE_UBIFS and TARGET_USERIMAGES_USE_EXT4 config open in same time, please only choose one target file system image")
-endif
-endif
-
-LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
-LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
-BOARD_PREBUILT_DTBOIMAGE := out/target/product/vp6820_8mp/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG := imx8mp:imx8mp-evk-no-product.dtb
@@ -273,13 +155,10 @@ ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
     TARGET_BOARD_DTS_CONFIG += imx8mp-lvds-panel:imx8mp-evk-jdi-wuxga-lvds-panel.dtb
     # Support MIPI panel
     TARGET_BOARD_DTS_CONFIG += imx8mp-mipi-panel:imx8mp-evk-rm67191.dtb
-<<<<<<< HEAD
-=======
     #Used to support powersave
     TARGET_BOARD_DTS_CONFIG += imx8mp-powersave:imx8mp-evk-powersave.dtb
     #Used to support powersave and mcu image
     TARGET_BOARD_DTS_CONFIG += imx8mp-powersave-non-rpmsg:imx8mp-evk-powersave-non-rpmsg.dtb
->>>>>>> post_merge/android-11.0.0_2.0.0
   endif
 else # no dynamic parition feature
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -289,20 +168,6 @@ else # no dynamic parition feature
   endif
 endif
 
-<<<<<<< HEAD
-BOARD_SEPOLICY_DIRS := \
-       device/idtech/imx8m/sepolicy \
-       $(IMX_DEVICE_PATH)/sepolicy
-
-TARGET_BOARD_KERNEL_HEADERS := device/idtech/common/kernel-headers
-
-ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
-
-BOARD_USES_METADATA_PARTITION := true
-BOARD_ROOT_EXTRA_FOLDERS += metadata
-
-BOARD_PLAT_PRIVATE_SEPOLICY_DIR := device/idtech/imx8m/sepolicy_system/private
-=======
 ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
 
 # -------@block_sepolicy-------
@@ -310,4 +175,4 @@ BOARD_SEPOLICY_DIRS := \
        $(CONFIG_REPO_PATH)/imx8m/sepolicy \
        $(IMX_DEVICE_PATH)/sepolicy
 
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_PLAT_PRIVATE_SEPOLICY_DIR := $(CONFIG_REPO_PATH)/imx8m/sepolicy_system/private
diff --git a/imx8m/vp6820_8mp/SharedBoardConfig.mk b/imx8m/vp6820_8mp/SharedBoardConfig.mk
index 2f318ad1..454762ef 100644
--- a/imx8m/vp6820_8mp/SharedBoardConfig.mk
+++ b/imx8m/vp6820_8mp/SharedBoardConfig.mk
@@ -1,32 +1,12 @@
-<<<<<<< HEAD
-KERNEL_NAME := Image
-TARGET_KERNEL_ARCH := arm64
-#IMX8MP_USES_GKI := true
-
-#Enable this to config 1GB ddr on evk_imx8mp
-#LOW_MEMORY := true
-
-#Enable this to include trusty support
-PRODUCT_IMX_TRUSTY := true
-
-#Enable this to disable product partition build.
-#IMX_NO_PRODUCT_PARTITION := true
-
-#NXP 8997 wifi driver module
-BOARD_VENDOR_KERNEL_MODULES += \
-    $(KERNEL_OUT)/drivers/net/wireless/nxp/mxm_wifiex/wlan_src/mlan.ko \
-    $(KERNEL_OUT)/drivers/net/wireless/nxp/mxm_wifiex/wlan_src/moal.ko
-=======
 # -------@block_kernel_bootimg-------
 KERNEL_NAME := Image
 TARGET_KERNEL_ARCH := arm64
-IMX8MP_USES_GKI := true
+#IMX8MP_USES_GKI := true
 
 #NXP 8997 wifi driver module
 BOARD_VENDOR_KERNEL_MODULES += \
     $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/mlan.ko \
     $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/moal.ko
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # CONFIG_IMX_SDMA: imx-sdma.ko, sdma used for audio
 # CONFIG_SND_SOC_IMX_PCM_DMA: imx-pcm-dma-common.ko, used for fsl_micfil
@@ -40,11 +20,6 @@ BOARD_VENDOR_KERNEL_MODULES += \
 # CONFIG_SND_SOC_BT_SCO: snd-soc-bt-sco.ko, bt sco driver
 # CONFIG_SND_SIMPLE_CARD: snd-soc-simple-card-utils.ko snd-soc-simple-card.ko, simple audio card used for bt sco
 # CONFIG_RTC_DRV_SNVS: rtc-snvs.ko, snvs rtc driver
-<<<<<<< HEAD
-# CONFIG_USB_XHCI_HCD: xhci-hcd.ko xhci-pci.ko xhci-plat-hcd.ko, usb host driver
-# CONFIG_KEYBOARD_SNVS_PWRKEY: snvs_pwrkey.ko, snvs power key driver
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 # CONFIG_STAGING_MEDIA: able to build drivers/staging/media/
 # CONFIG_IMX_MBOX: imx-mailbox.ko, imx mailbox driver
 # CONFIG_I2C_RPBUS: virtio_rpmsg_bus.ko, virtio rpmsg bus driver
@@ -54,19 +29,6 @@ BOARD_VENDOR_KERNEL_MODULES += \
 # CONFIG_MXC_HANTRO_VC8000E: hx280enc_vc8000e.ko, vpu encoder driver
 # CONFIG_MXC_HANTRO_845: hantrodec_845s.ko, vpu decoder driver
 
-<<<<<<< HEAD
-ifneq ($(IMX8MP_USES_GKI),)
-BOARD_VENDOR_KERNEL_MODULES += \
-    $(KERNEL_OUT)/drivers/mxc/gpu-viv/galcore.ko \
-    $(KERNEL_OUT)/drivers/dma/imx-sdma.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/imx-pcm-dma-common.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-micfil.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-micfil.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-aud2htx.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-easrc.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-sai.ko \
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-utils.ko \
-=======
 ifeq ($(IMX8MP_USES_GKI),true)
 BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/drivers/mxc/gpu-viv/galcore.ko \
@@ -79,24 +41,16 @@ BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-asrc.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-easrc.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-sai.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/gpu/drm/bridge/synopsys/dw-hdmi-cec.ko \
     $(KERNEL_OUT)/drivers/gpu/drm/bridge/synopsys/dw-hdmi-gp-audio.ko \
     $(KERNEL_OUT)/sound/soc/codecs/snd-soc-hdmi-codec.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-cdnhdmi.ko \
     $(KERNEL_OUT)/sound/soc/codecs/snd-soc-wm8960.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-wm8960.ko \
-    $(KERNEL_OUT)/sound/soc/codecs/snd-soc-bt-sco.ko \
-    $(KERNEL_OUT)/sound/soc/generic/snd-soc-simple-card-utils.ko \
-    $(KERNEL_OUT)/sound/soc/generic/snd-soc-simple-card.ko \
-=======
     $(KERNEL_OUT)/sound/soc/codecs/snd-soc-bt-sco.ko \
     $(KERNEL_OUT)/sound/soc/generic/snd-soc-simple-card-utils.ko \
     $(KERNEL_OUT)/sound/soc/generic/snd-soc-simple-card.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-audmux.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-asoc-card.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-dsp-audiomix.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-fsl-dsp.ko \
     $(KERNEL_OUT)/drivers/mxc/hantro_vc8000e/hx280enc_vc8000e.ko \
@@ -112,13 +66,6 @@ BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/sound/soc/codecs/snd-soc-rpmsg-wm8960-i2c.ko \
     $(KERNEL_OUT)/sound/soc/fsl/snd-soc-imx-rpmsg.ko \
     $(KERNEL_OUT)/drivers/rtc/rtc-snvs.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/usb/host/xhci-hcd.ko \
-    $(KERNEL_OUT)/drivers/usb/host/xhci-pci.ko \
-    $(KERNEL_OUT)/drivers/usb/host/xhci-plat-hcd.ko \
-    $(KERNEL_OUT)/drivers/input/keyboard/snvs_pwrkey.ko \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/pci/controller/dwc/pci-imx6.ko \
     $(KERNEL_OUT)/drivers/ptp/ptp.ko \
     $(KERNEL_OUT)/drivers/pps/pps_core.ko \
@@ -161,11 +108,8 @@ endif
 # CONFIG_TYPEC_TCPCI: tcpci.ko
 # CONFIG_PHY_FSL_IMX8MQ_USB: phy-fsl-imx8mq-usb.ko
 # CONFIG_PHY_FSL_IMX_PCIE: phy-fsl-imx8-pcie.ko
-<<<<<<< HEAD
-=======
 # CONFIG_USB_XHCI_HCD: xhci-hcd.ko xhci-pci.ko xhci-plat-hcd.ko, usb host driver
 # CONFIG_KEYBOARD_SNVS_PWRKEY: snvs_pwrkey.ko, snvs power key driver
->>>>>>> post_merge/android-11.0.0_2.0.0
 # CONFIG_RESET_IMX7: reset-imx7.ko
 # CONFIG_RESET_IMX_HDMIMIX: reset-imx-audiomix.ko
 # CONFIG_RESET_IMX_AUDIOMIX: reset-imx-hdmimix.ko
@@ -179,16 +123,6 @@ endif
 # CONFIG_VIDEO_OV5640: ov5640.ko, ov5640 sensor driver
 # CONFIG_VIDEO_IMX_CAPTURE: imx8-media-dev.ko, imx8-isi-cap.ko, imx8-isi-hw.ko, imx8-isi-m2m.ko, imx8-mipi-csi2-sam.ko, imx isi and mipi driver
 
-<<<<<<< HEAD
-ifneq ($(IMX8MP_USES_GKI),)
-BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
-    $(KERNEL_OUT)/drivers/clk/imx/clk-audiomix.ko \
-    $(KERNEL_OUT)/drivers/clk/imx/clk-gate-shared.ko \
-    $(KERNEL_OUT)/drivers/clk/imx/clk-imx8mp.ko \
-    $(KERNEL_OUT)/drivers/clk/imx/clk-hdmimix.ko \
-    $(KERNEL_OUT)/drivers/clocksource/timer-imx-sysctr.ko \
-    $(KERNEL_OUT)/drivers/soc/imx/imx8m_pm_domains.ko \
-=======
 ifeq ($(IMX8MP_USES_GKI),true)
 BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
     $(KERNEL_OUT)/drivers/soc/imx/soc-imx8m.ko \
@@ -198,45 +132,26 @@ BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
     $(KERNEL_OUT)/drivers/clk/imx/clk-blk-ctrl.ko \
     $(KERNEL_OUT)/drivers/soc/imx/imx8m_pm_domains.ko \
     $(KERNEL_OUT)/drivers/clocksource/timer-imx-sysctr.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/soc/imx/busfreq-imx8mq.ko \
     $(KERNEL_OUT)/drivers/irqchip/irq-imx-irqsteer.ko \
     $(KERNEL_OUT)/drivers/pinctrl/freescale/pinctrl-imx.ko \
     $(KERNEL_OUT)/drivers/pinctrl/freescale/pinctrl-imx8mp.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/gpio/gpio-generic.ko \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/gpio/gpio-mxc.ko \
     $(KERNEL_OUT)/drivers/tty/serial/imx.ko \
     $(KERNEL_OUT)/drivers/watchdog/imx2_wdt.ko \
     $(KERNEL_OUT)/drivers/i2c/busses/i2c-imx.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/mfd/pca9450.ko \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/regulator/pca9450-regulator.ko \
     $(KERNEL_OUT)/drivers/pwm/pwm-imx27.ko \
     $(KERNEL_OUT)/drivers/video/backlight/pwm_bl.ko \
     $(KERNEL_OUT)/drivers/mmc/host/cqhci.ko \
     $(KERNEL_OUT)/drivers/mmc/host/sdhci-esdhc-imx.ko \
     $(KERNEL_OUT)/drivers/staging/android/ion/heaps/ion_cma_heap.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/mfd/imx-audiomix.ko \
-    $(KERNEL_OUT)/drivers/reset/reset-imx7.ko \
-    $(KERNEL_OUT)/drivers/reset/reset-imx-audiomix.ko \
-    $(KERNEL_OUT)/drivers/reset/reset-imx-hdmimix.ko \
-=======
     $(KERNEL_OUT)/drivers/reset/reset-imx7.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/phy/freescale/phy-fsl-imx8mp-lvds.ko \
     $(KERNEL_OUT)/drivers/phy/freescale/phy-fsl-samsung-hdmi.ko \
     $(KERNEL_OUT)/drivers/phy/freescale/phy-fsl-imx8mq-usb.ko \
     $(KERNEL_OUT)/drivers/phy/freescale/phy-fsl-imx8-pcie.ko \
-<<<<<<< HEAD
-=======
     $(KERNEL_OUT)/drivers/input/keyboard/snvs_pwrkey.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/input/touchscreen/synaptics_dsx/synaptics_dsx_i2c.ko \
     $(KERNEL_OUT)/drivers/gpu/imx/lcdif/imx-lcdif-core.ko \
     $(KERNEL_OUT)/drivers/gpu/drm/bridge/adv7511/adv7511.ko \
@@ -259,23 +174,10 @@ BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
     $(KERNEL_OUT)/drivers/usb/dwc3/dwc3-imx8mp.ko \
     $(KERNEL_OUT)/drivers/usb/dwc3/dwc3.ko \
     $(KERNEL_OUT)/drivers/usb/typec/mux/gpio-switch.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/usb/typec/tcpm/tcpci.ko \
-    $(KERNEL_OUT)/drivers/power/supply/dummy_battery.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-fiq.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-arm64-fiq.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-ipc.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-irq.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-log.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-mem.ko \
-    $(KERNEL_OUT)/drivers/trusty/trusty-virtio.ko \
-=======
     $(KERNEL_OUT)/drivers/usb/host/xhci-hcd.ko \
     $(KERNEL_OUT)/drivers/usb/host/xhci-pci.ko \
     $(KERNEL_OUT)/drivers/usb/host/xhci-plat-hcd.ko \
     $(KERNEL_OUT)/drivers/power/supply/dummy_battery.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/nvmem/nvmem-imx-ocotp.ko \
     $(KERNEL_OUT)/drivers/thermal/device_cooling.ko \
     $(KERNEL_OUT)/drivers/thermal/imx8mm_thermal.ko \
@@ -283,31 +185,22 @@ BOARD_VENDOR_RAMDISK_KERNEL_MODULES +=     \
     $(KERNEL_OUT)/drivers/cpufreq/imx-cpufreq-dt.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-media-dev.ko \
     $(KERNEL_OUT)/drivers/media/v4l2-core/v4l2-fwnode.ko \
-<<<<<<< HEAD
-    $(KERNEL_OUT)/drivers/media/v4l2-core/v4l2-mem2mem.ko \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(KERNEL_OUT)/drivers/media/i2c/ov5640.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-capture.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-isi-cap.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-isi-hw.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-isi-m2m.ko \
     $(KERNEL_OUT)/drivers/staging/media/imx/imx8-mipi-csi2-sam.ko \
-<<<<<<< HEAD
-=======
     $(KERNEL_OUT)/drivers/trusty/trusty-core.ko \
     $(KERNEL_OUT)/drivers/trusty/trusty-irq.ko \
     $(KERNEL_OUT)/drivers/trusty/trusty-log.ko \
     $(KERNEL_OUT)/drivers/trusty/trusty-virtio.ko \
     $(KERNEL_OUT)/drivers/trusty/trusty-ipc.ko \
->>>>>>> post_merge/android-11.0.0_2.0.0
     $(TARGET_OUT_INTERMEDIATES)/VVCAM_OBJ/vvcam-video.ko \
     $(TARGET_OUT_INTERMEDIATES)/VVCAM_OBJ/vvcam-isp.ko \
     $(TARGET_OUT_INTERMEDIATES)/VVCAM_OBJ/vvcam-dwe.ko \
     $(TARGET_OUT_INTERMEDIATES)/VVCAM_OBJ/basler-camera-driver-vvcam.ko
 endif
-<<<<<<< HEAD
-=======
 
 # -------@block_memory-------
 #Enable this to config 1GB ddr on evk_imx8mp
@@ -316,4 +209,3 @@ LOW_MEMORY := false
 # -------@block_security-------
 #Enable this to include trusty support
 PRODUCT_IMX_TRUSTY := true
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mp/UbootKernelBoardConfig.mk b/imx8m/vp6820_8mp/UbootKernelBoardConfig.mk
index 48e8f13c..f7bcc3d5 100644
--- a/imx8m/vp6820_8mp/UbootKernelBoardConfig.mk
+++ b/imx8m/vp6820_8mp/UbootKernelBoardConfig.mk
@@ -3,27 +3,16 @@ TARGET_BOOTLOADER_POSTFIX := bin
 UBOOT_POST_PROCESS := true
 
 # u-boot target
-<<<<<<< HEAD
 TARGET_BOOTLOADER_CONFIG := imx8mp-lpddr4:vp6820_8mp_evk_android_defconfig:signed
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-trusty:vp6820_8mp_evk_android_trusty_defconfig
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-trusty-secure-unlock:vp6820_8mp_evk_android_trusty_secure_unlock_defconfig
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-dual:vp6820_8mp_evk_android_dual_defconfig:signed
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-trusty-dual:vp6820_8mp_evk_android_trusty_dual_defconfig
 TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-evk-uuu-mic6g:vp6820_8mp_evk_android_uuu_mic6g_defconfig:signed
-
-ifneq ($(IMX8MP_USES_GKI),)
-=======
-TARGET_BOOTLOADER_CONFIG := imx8mp:imx8mp_evk_android_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty:imx8mp_evk_android_trusty_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty-secure-unlock:imx8mp_evk_android_trusty_secure_unlock_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-dual:imx8mp_evk_android_dual_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty-dual:imx8mp_evk_android_trusty_dual_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-evk-uuu:imx8mp_evk_android_uuu_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-powersave:imx8mp_evk_android_powersave_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mp-trusty-powersave:imx8mp_evk_android_trusty_powersave_defconfig
+#TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-powersave:vp6820_8mp_evk_android_powersave_defconfig
+#TARGET_BOOTLOADER_CONFIG += imx8mp-lpddr4-trusty-powersave:vp6820_8mp_evk_android_trusty_powersave_defconfig
 
 ifeq ($(IMX8MP_USES_GKI),true)
->>>>>>> post_merge/android-11.0.0_2.0.0
 TARGET_KERNEL_DEFCONFIG := gki_defconfig
 TARGET_KERNEL_GKI_DEFCONF:= android_gki_defconfig
 else
@@ -31,10 +20,7 @@ TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
 endif
 
 TARGET_KERNEL_ADDITION_DEFCONF := android_addition_defconfig
-<<<<<<< HEAD
 TARGET_KERNEL_SECURE_DEFCONF ?= android_secure_defconfig
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 
 # absolute path is used, not the same as relative path used in AOSP make
diff --git a/imx8m/vp6820_8mp/android_addition_defconfig b/imx8m/vp6820_8mp/android_addition_defconfig
index f0e59e00..6c15a77b 100644
--- a/imx8m/vp6820_8mp/android_addition_defconfig
+++ b/imx8m/vp6820_8mp/android_addition_defconfig
@@ -1,6 +1,5 @@
 CONFIG_LIBNVDIMM=y
 CONFIG_OF_PMEM=y
-<<<<<<< HEAD
 CONFIG_IDG_SPI=y
 # CONFIG_USB_NET_QMI_WWAN is not set
 CONFIG_SINGLE_LOGO=y
@@ -253,5 +252,3 @@ CONFIG_WLAN_VENDOR_MARVELL=m
 # CONFIG_MMC_SDHCI_MSM is not set
 # CONFIG_MMC_SDHI is not set
 # CONFIG_MMC_DW_EXYNOS is not set
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mp/android_gki_defconfig b/imx8m/vp6820_8mp/android_gki_defconfig
index 22f7c51f..bb220eff 100644
--- a/imx8m/vp6820_8mp/android_gki_defconfig
+++ b/imx8m/vp6820_8mp/android_gki_defconfig
@@ -1,10 +1,7 @@
 CONFIG_ARCH_MXC=y
-<<<<<<< HEAD
-=======
 CONFIG_SOC_IMX8M=m
 CONFIG_SOC_IMX_MU=m
 CONFIG_MXC_CLK=m
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_CLK_IMX8MP=m
 CONFIG_DEVICE_THERMAL=m
 CONFIG_IMX8MM_THERMAL=m
@@ -16,19 +13,11 @@ CONFIG_SERIAL_IMX=m
 CONFIG_SERIAL_IMX_CONSOLE=m
 CONFIG_IMX2_WDT=m
 CONFIG_I2C_IMX=m
-<<<<<<< HEAD
-CONFIG_MFD_PCA9450=m
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_REGULATOR_PCA9450=m
 CONFIG_PWM_IMX27=m
 CONFIG_BACKLIGHT_PWM=m
 CONFIG_MMC_SDHCI_ESDHC_IMX=m
 CONFIG_ION_CMA_HEAP=m
-<<<<<<< HEAD
-CONFIG_MFD_IMX_AUDIOMIX=m
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_PHY_FSL_IMX8MP_LVDS=m
 CONFIG_PHY_SAMSUNG_HDMI_PHY=m
 CONFIG_MXC_GPU_VIV=m
@@ -52,25 +41,15 @@ CONFIG_MEDIA_USB_SUPPORT=y
 CONFIG_USB_VIDEO_CLASS=y
 CONFIG_USB_XHCI_HCD=m
 CONFIG_TYPEC_SWITCH_GPIO=m
-<<<<<<< HEAD
-CONFIG_TYPEC_TCPCI=m
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 CONFIG_IMX_SDMA=m
 CONFIG_SND_IMX_SOC=m
 CONFIG_SND_SOC_IMX_MICFIL=m
-<<<<<<< HEAD
-CONFIG_SND_SOC_FSL_EASRC=m
-CONFIG_SND_SOC_IMX_CDNHDMI=m
-CONFIG_SND_SOC_IMX_WM8960=m
-=======
 CONFIG_SND_SOC_FSL_ASRC=m
 CONFIG_SND_SOC_FSL_EASRC=m
 CONFIG_SND_SOC_IMX_CDNHDMI=m
 CONFIG_SND_SOC_WM8960=m
 CONFIG_SND_SOC_FSL_ASOC_CARD=m
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_SND_SOC_BT_SCO=m
 CONFIG_SND_SIMPLE_CARD=m
 CONFIG_SND_SOC_FSL_DSP=m
@@ -110,11 +89,6 @@ CONFIG_MXC_HANTRO_845=m
 CONFIG_BATTERY_DUMMY=m
 
 CONFIG_RESET_IMX7=m
-<<<<<<< HEAD
-CONFIG_RESET_IMX_HDMIMIX=m
-CONFIG_RESET_IMX_AUDIOMIX=m
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 CONFIG_IMX8M_BUSFREQ=m
 CONFIG_IMX_IRQSTEER=m
 CONFIG_GPIO_MXC=m
@@ -126,10 +100,7 @@ CONFIG_INIT_STACK_NONE=y
 CONFIG_NVMEM_IMX_OCOTP=m
 CONFIG_CPUFREQ_DT=m
 CONFIG_ARM_IMX_CPUFREQ_DT=m
-<<<<<<< HEAD
-=======
 
 CONFIG_STATIC_USERMODEHELPER_PATH="/system/bin/sh"
 
 CONFIG_FORCE_MAX_ZONEORDER=14
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mp/audio_policy_configuration.xml b/imx8m/vp6820_8mp/audio_policy_configuration.xml
index 54299dd9..17b12ec5 100644
--- a/imx8m/vp6820_8mp/audio_policy_configuration.xml
+++ b/imx8m/vp6820_8mp/audio_policy_configuration.xml
@@ -33,13 +33,10 @@
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
                              samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
                 </mixPort>
-<<<<<<< HEAD
-=======
                 <mixPort name="hi-res output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT|AUDIO_OUTPUT_FLAG_HW_AV_SYNC">
                     <profile name="" format="AUDIO_FORMAT_PCM_FLOAT"
                              samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
                 </mixPort>
->>>>>>> post_merge/android-11.0.0_2.0.0
                 <mixPort name="hdmi output" role="source">
                     <profile name="" format="AUDIO_FORMAT_PCM_8_24_BIT"
                              samplingRates="48000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
@@ -48,13 +45,10 @@
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
                              samplingRates="16000" channelMasks="AUDIO_CHANNEL_OUT_STEREO"/>
                 </mixPort>
-<<<<<<< HEAD
-=======
                 <mixPort name="passthrough output" role="source" flags="AUDIO_OUTPUT_FLAG_DIRECT">
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
                              samplingRates="32000,44100,48000,88200,96000,176400,192000" channelMasks="AUDIO_CHANNEL_NONE"/>
                 </mixPort>
->>>>>>> post_merge/android-11.0.0_2.0.0
 
                 <mixPort name="primary input" role="sink">
                     <profile name="" format="AUDIO_FORMAT_PCM_16_BIT"
@@ -96,15 +90,9 @@
                 <route type="mix" sink="Wired Headset"
                        sources="primary output"/>
                 <route type="mix" sink="Line-Out"
-<<<<<<< HEAD
-                       sources="lpa output,primary output"/>
-                <route type="mix" sink="HDMI Out"
-                       sources="hdmi output"/>
-=======
                        sources="hi-res output,lpa output,primary output"/>
                 <route type="mix" sink="HDMI Out"
                        sources="passthrough output,hdmi output"/>
->>>>>>> post_merge/android-11.0.0_2.0.0
                 <route type="mix" sink="BT SCO Headset"
                        sources="bt sco output"/>
                 <route type="mix" sink="BT SCO CarKit"
diff --git a/imx8m/vp6820_8mp/camera_config_imx8mp.json b/imx8m/vp6820_8mp/camera_config_imx8mp.json
index 6d11d881..0c030b95 100644
--- a/imx8m/vp6820_8mp/camera_config_imx8mp.json
+++ b/imx8m/vp6820_8mp/camera_config_imx8mp.json
@@ -10,13 +10,8 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
-      "camera_name": "viv_v4l2_device",
-      "device_node": "/dev/video1",
-=======
       "camera_name": "viv_v4l20",
       "bus_info": "platform:viv0",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "orientation": "0",
       "buffer_type": "mmap",
       "ActiveArrayWidth": "1920",
@@ -32,11 +27,7 @@
     },
     {
       "camera_type": "front",
-<<<<<<< HEAD
-      "camera_name": "mxc-isi-cap",
-=======
       "camera_name": "mxc_isi.1.capture",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "orientation": "0",
       "mplane": "1",
       "buffer_type": "dma",
diff --git a/imx8m/vp6820_8mp/evk_8mp.mk b/imx8m/vp6820_8mp/evk_8mp.mk
deleted file mode 100644
index 4c933774..00000000
--- a/imx8m/vp6820_8mp/evk_8mp.mk
+++ /dev/null
@@ -1,494 +0,0 @@
-# -------@block_infrastructure-------
-CONFIG_REPO_PATH := device/nxp
-CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
-IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
-
-# configs shared between uboot, kernel and Android rootfs
-include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
-
--include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
-include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
-
-# -------@block_common_config-------
-# Overrides
-PRODUCT_NAME := evk_8mp
-PRODUCT_DEVICE := evk_8mp
-PRODUCT_MODEL := EVK_8MP
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-PRODUCT_CHARACTERISTICS := tablet
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# -------@block_treble-------
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-
-# -------@block_power-------
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/powerhint_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mp.json
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-
-PRODUCT_PACKAGES += \
-    android.hardware.power-service.imx
-
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mp.json
-
-
-# -------@block_app-------
-
-#Enable this to choose 32 bit user space build
-IMX8_BUILD_32BIT_ROOTFS := false
-
-# Set permission for GMS packages
-PRODUCT_COPY_FILES += \
-	  $(CONFIG_REPO_PATH)/imx8m/permissions/privapp-permissions-imx.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/privapp.permissions-imx.xml
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml
-
-# -------@block_kernel_bootimg-------
-
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc
-
-
-# -------@block_storage-------
-
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
-  PRODUCT_USE_DYNAMIC_PARTITIONS := true
-  BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
-  BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-endif
-
-#Enable this to disable product partition build.
-IMX_NO_PRODUCT_PARTITION := false
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
-  PRODUCT_PACKAGES += imx_ota_postinstall
-
-  AB_OTA_POSTINSTALL_CONFIG += \
-    RUN_POSTINSTALL_vendor=true \
-    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
-    FILESYSTEM_TYPE_vendor=ext4 \
-    POSTINSTALL_OPTIONAL_vendor=false
-
-  PRODUCT_COPY_FILES += \
-    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mp-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
-endif
-
-
-# fastboot_imx_flashall scripts, imx-sdcard-partition script uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# -------@block_security-------
-
-# Include keystore attestation keys and certificates.
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
--include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
-endif
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# Keymaster HAL
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-# Resume on Reboot support
-PRODUCT_PACKAGES += \
-    android.hardware.rebootescrow-service.default
-
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rebootescrow.device=/dev/block/pmem0
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-# -------@block_audio-------
-
-# Audio card json
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/audio-json/wm8960_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8960_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/hdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/hdmi_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32
-
-
-PRODUCT_COPY_FILES += \
-    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mp/imx8mp_mcu_demo.img:imx8mp_mcu_demo.img \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml
-
-# -------@block_camera-------
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mp.json \
-    $(IMX_DEVICE_PATH)/ov5640_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/ov5640_camera_config_imx8mp.json \
-    $(IMX_DEVICE_PATH)/isp_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp_camera_config_imx8mp.json \
-    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-# Copy isp files to board
-ISP_PROPRIETARY := $(FSL_PROPRIETARY_PATH)/fsl-proprietary/isp
-PRODUCT_COPY_FILES += \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/bin,$(TARGET_COPY_OUT_VENDOR)/bin) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/lib64,$(TARGET_COPY_OUT_VENDOR)/lib64) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/config,$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp)
-
-# ISP camera feature demo
-PRODUCT_PACKAGES += \
-    CameraXBasic
-
-# -------@block_display-------
-
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# HWC2 HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.composer@2.4-service
-
-# define frame buffer count
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@4.0-impl.imx \
-    android.hardware.graphics.allocator@4.0-service.imx
-
-# RenderScript HAL
-PRODUCT_PACKAGES += \
-    android.hardware.renderscript@1.0-impl
-
-PRODUCT_PACKAGES += \
-    libg2d-opencl
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod \
-    MultiDisplay
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
-
-# -------@block_gpu-------
-PRODUCT_PACKAGES += \
-    libEGL_VIVANTE \
-    libGLESv1_CM_VIVANTE \
-    libGLESv2_VIVANTE \
-    gralloc_viv.$(TARGET_BOARD_PLATFORM) \
-    libGAL \
-    libGLSLC \
-    libVSC \
-    libgpuhelper \
-    libSPIRV_viv \
-    libvulkan_VIVANTE \
-    vulkan.$(TARGET_BOARD_PLATFORM) \
-    libCLC \
-    libLLVM_viv \
-    libOpenCL \
-    libg2d-viv \
-    libOpenVX \
-    libOpenVXU \
-    libNNVXCBinary-evis \
-    libNNVXCBinary-evis2 \
-    libNNVXCBinary-lite \
-    libOvx12VXCBinary-evis \
-    libOvx12VXCBinary-evis2 \
-    libOvx12VXCBinary-lite \
-    libNNGPUBinary-evis \
-    libNNGPUBinary-evis2 \
-    libNNGPUBinary-lite \
-    libNNGPUBinary-ulite \
-    libNNArchPerf \
-    libarchmodelSw
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# -------@block_wifi-------
-
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
-
-# WiFi HAL
-PRODUCT_PACKAGES += \
-    android.hardware.wifi@1.0-service \
-    wificond
-
-# WiFi RRO
-PRODUCT_PACKAGES += \
-    WifiOverlay
-
-# nxp 8997 wifi and bluetooth combo Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para_powersave.conf:vendor/firmware/wifi_mod_para_powersave.conf
-
-# Wifi regulatory
-PRODUCT_COPY_FILES += \
-    external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
-    external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
-
-# -------@block_bluetooth-------
-
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-#nxp 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# -------@block_usb-------
-
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
-
-# -------@block_multimedia_codec-------
-
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_PACKAGES += \
-    libg1 \
-    libhantro \
-    libcodec \
-    libhantro_vc8000e
-
-# imx c2 codec binary
-PRODUCT_PACKAGES += \
-    lib_vpu_wrapper \
-    lib_imx_c2_videodec_common \
-    lib_imx_c2_videodec \
-    lib_imx_c2_vpuwrapper_dec \
-    lib_imx_c2_videoenc_common \
-    lib_imx_c2_videoenc \
-    lib_imx_c2_vpuwrapper_enc \
-    lib_imx_c2_process \
-    lib_imx_c2_process_dummy_post \
-    lib_imx_c2_process_g2d_pre \
-    c2_component_register \
-    c2_component_register_ms \
-    c2_component_register_ra
-
-# dsp decoder
-PRODUCT_PACKAGES += \
-    media_codecs_c2_dsp.xml \
-    media_codecs_c2_dsp_aacp.xml \
-    media_codecs_c2_dsp_wma.xml \
-    lib_dsp_aac_dec \
-    lib_dsp_bsac_dec \
-    lib_dsp_codec_wrap \
-    lib_dsp_mp3_dec \
-    lib_dsp_wrap_arm12_android \
-    lib_dsp_mp3_dec_ext \
-    lib_dsp_codec_wrap_ext \
-    lib_aacd_wrap_dsp \
-    lib_mp3d_wrap_dsp \
-    lib_wma10d_wrap_dsp \
-    c2_component_register_dsp \
-    c2_component_register_dsp_wma \
-    c2_component_register_dsp_aacp
-
-
-PRODUCT_PACKAGES += \
-    DirectAudioPlayer
-
-ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
-ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
-INSTALL_64BIT_LIBRARY := true
-endif
--include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
--include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp_aacp_dec/imx_dsp_aacp_dec.mk
--include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp_codec/imx_dsp_codec.mk
--include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp_wma_dec/imx_dsp_wma_dec.mk
--include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp/imx_dsp_8mp.mk
-endif
-
-# -------@block_memory-------
-
-# Include Android Go config for low memory device.
-ifeq ($(LOW_MEMORY),true)
-$(call inherit-product, build/target/product/go_defaults.mk)
-endif
-
-# -------@block_neural_network-------
-
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# -------@block_miscellaneous-------
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.imx8mp.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mp.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
-# Included GMS package
-$(call inherit-product-if-exists, vendor/partner_gms/products/gms.mk)
-PRODUCT_SOONG_NAMESPACES += vendor/partner_gms
-
-
diff --git a/imx8m/vp6820_8mp/init.imx8mp.rc b/imx8m/vp6820_8mp/init.imx8mp.rc
index 0e324b72..aebbee4a 100755
--- a/imx8m/vp6820_8mp/init.imx8mp.rc
+++ b/imx8m/vp6820_8mp/init.imx8mp.rc
@@ -16,13 +16,10 @@ on early-boot
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
-<<<<<<< HEAD
-=======
     chown root system /sys/devices/system/cpu/cpu2/online
     chmod 0664 /sys/devices/system/cpu/cpu2/online
     chown root system /sys/devices/system/cpu/cpu3/online
     chmod 0664 /sys/devices/system/cpu/cpu3/online
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on property:sys.boot_completed=1
     # Set default CPU frequency governor
@@ -33,12 +30,9 @@ on property:sys.boot_completed=1
     write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 200
     write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 200
     write /proc/sys/kernel/sched_util_clamp_min 512
-<<<<<<< HEAD
-=======
     write /sys/devices/platform/soc@0/30c00000.bus/30e20000.audio-blk-ctrl/power/control auto
     write /sys/devices/platform/soc@0/32c00000.bus/32ec0000.media-blk-ctrl/power/control auto
     write /sys/devices/platform/soc@0/30c00000.bus/32fc0000.hdmi-blk-ctrl/power/control auto
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 on property:sys.boot_completed=1
     # update cpuset now that processors are up
@@ -63,7 +57,6 @@ on early-boot
 service isp_media_server /vendor/bin/isp_media_server /vendor/etc/configs/isp/daA3840_30mc_1080P.json
     group camera
     oneshot
-<<<<<<< HEAD
 
 on init
     #IDtech added for AB ota update bootloader
@@ -71,5 +64,3 @@ on init
     symlink   /dev/block/mmcblk2boot1p1   /dev/block/by-name/spl_b
     symlink   /dev/block/mmcblk2boot0p2   /dev/block/by-name/spl_bak_a
     symlink   /dev/block/mmcblk2boot1p2   /dev/block/by-name/spl_bak_b
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mp/init.rc b/imx8m/vp6820_8mp/init.rc
index 29624540..c9a851f4 100644
--- a/imx8m/vp6820_8mp/init.rc
+++ b/imx8m/vp6820_8mp/init.rc
@@ -44,11 +44,6 @@ on init && property:vendor.skip.charger_not_need=0
     symlink /sdcard /mnt/sdcard
     symlink /sdcard /storage/sdcard0
 
-    # setup the global environment
-    export CORE_REGISTER_FILE /vendor/etc/core_register
-    export COMPONENT_REGISTER_FILE /vendor/etc/component_register
-    export CONTENTPIPE_REGISTER_FILE /vendor/etc/contentpipe_register
-
     # disable cursor blink for fbcon, if no splash screen support
     write /sys/class/graphics/fbcon/cursor_blink 0
 
@@ -89,15 +84,12 @@ on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charg
     start vendor.oemlock-1-0
 
 on early-boot && property:vendor.skip.charger_not_need=0
-    # For evk_8mp, when swap used about 400M, upgrade the level.
+    # For vp6820_8mp, when swap used about 400M, upgrade the level.
     setprop ro.lmk.upgrade_pressure 93
     setprop ro.lmk.downgrade_pressure 99
     setprop ro.lmk.critical_upgrade true
 
-    # Set permission for IIM node
-    symlink /dev/mxs_viim /dev/mxc_mem
-
-    setprop hwc.stretch.filter  1
+    setprop vendor.hwc.stretch.filter  1
 
     # Default g2d [dpu|pxp|viv] lib to be used
     setprop vendor.imx.default-g2d viv
@@ -133,6 +125,12 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chown system system /sys/class/backlight/32e60000.mipi_dsi.0/brightness
     chmod 0660 /sys/class/backlight/32e60000.mipi_dsi.0/brightness
 
+    # Backup backlight device
+    setprop vendor.hw.backlight_backup.dev "lvds_backlight"
+    # Chmod/chown FSL specific sys entry
+    chown system system /sys/class/backlight/lvds_backlight/brightness
+    chmod 0660 /sys/class/backlight/lvds_backlight/brightness
+
     # Set light sensor sysfs path and light sensor threshold lux value
     setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
     setprop vendor.ro.lightsensor.threshold  20
@@ -143,9 +141,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # Enlarge limition of audio buffer allocation
     setprop ro.af.client_heap_size_kbyte 32768
 
-    # enlarge media max memory size to 3G.
-    setprop ro.media.maxmem 3221225471
-
     start vendor.wifi_hal_legacy
 
 service wpa_supplicant /vendor/bin/hw/wpa_supplicant \
@@ -178,49 +173,8 @@ service watchdogd /system/bin/watchdogd 10 20
     class core
     seclabel u:r:watchdogd:s0
 
-service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_p2p /system/bin/dhcpcd -aABKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_eth0 /system/bin/dhcpcd -ABKL eth0
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_bt-pan /system/bin/dhcpcd -ABKL
-    class main
-    disabled
-    oneshot
-
-service iprenew_wlan0 /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_p2p /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_eth0 /system/bin/dhcpcd -n eth0
-    class main
-    disabled
-    oneshot
-
-service iprenew_bt-pan /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
 # bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -B -z \
-        -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
+service bugreport /system/bin/dumpstate -d -p -z
     class main
     disabled
     oneshot
@@ -242,9 +196,6 @@ on fs && property:vendor.skip.charger_not_need=0
     # Update dm-verity state and set partition.*.verified properties
     verity_update_state
 
-on verity-logging && property:vendor.skip.charger_not_need=0
-    exec u:r:slideshow:s0 -- /sbin/slideshow warning/verity_red_1 warning/verity_red_2
-
 on post-fs && property:vendor.skip.charger_not_need=0
     # Set netd memlock rlimit to 8MB
     setrlimit 8 8388608 8388608
@@ -265,7 +216,7 @@ on post-fs-data && property:vendor.skip.charger_not_need=0
     mkdir /data/vendor/ss 0700 system system
 
     # tmp dir for opencl Compiler
-    setprop TMPDIR /data/vendor/.opencl-cache
+    setprop vendor.TMPDIR /data/vendor/.opencl-cache
     mkdir /data/vendor/.opencl-cache 0771 system camera
 
 on zygote-start && property:vendor.skip.charger_not_need=0
@@ -293,3 +244,12 @@ on property:ro.boot.vendor.sysrq=1 && property:vendor.skip.charger_not_need=0
 # setenv append_bootargs androidboot.usb.debugging=1
 on property:ro.boot.usb.debugging=1
     setprop persist.sys.usb.config adb
+
+# setenv append_bootargs androidboot.powersave.usb=true
+on property:ro.boot.powersave.usb=true
+    # enable platform/32f10100.usb runtime_pm
+    write /sys/devices/platform/soc@0/32f10100.usb/38100000.dwc3/power/control auto
+
+    #enable platform/32f10108.usb runtime_pm
+    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/power/control auto
+    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/xhci-hcd.0.auto/power/control auto
diff --git a/imx8m/vp6820_8mp/init.rc~post_merge_android-11.0.0_2.0.0 b/imx8m/vp6820_8mp/init.rc~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index eee4cf7c..00000000
--- a/imx8m/vp6820_8mp/init.rc~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,248 +0,0 @@
-import /vendor/etc/init/hw/init.${ro.hardware}.usb.rc
-import /vendor/etc/init/hw/init.${ro.hardware}.${ro.boot.soc_type}.rc
-
-service vendor.charger /system/bin/charger
-    class charger
-    user system
-    group system wakelock input
-    capabilities SYS_BOOT
-    file /dev/kmsg w
-    file /sys/fs/pstore/console-ramoops-0 r
-    file /sys/fs/pstore/console-ramoops r
-    file /proc/last_kmsg r
-
-on charger
-    start vendor.charger
-
-on early-init
-    # mount the debugfs
-    mount debugfs none /sys/kernel/debug/ mode=0755
-
-on early-init
-    start early_init_sh
-    # Set the host name which used in console
-    export HOSTNAME evk_8mp
-
-    # Due keymaster start very early so set prop here
-    # Also gatekeeper share same role for keymaster
-    setprop ro.hardware.keystore ${ro.boot.keystore}
-    setprop ro.hardware.gatekeeper ${ro.boot.keystore}
-    setprop vendor.storageproxyd ${ro.boot.keystore}
-
-    # Use ro.boot.lcd_density to override ro.sf.lcd_density
-    setprop ro.sf.lcd_density ${ro.boot.lcd_density}
-
-# Skip charger_not_need trigger for charger mode
-on early-init && property:ro.boot.mode=charger
-    setprop vendor.skip.charger_not_need 1
-
-on init && property:vendor.skip.charger_not_need=0
-    start watchdogd
-
-    # Support legacy paths
-    symlink /sdcard /mnt/sdcard
-    symlink /sdcard /storage/sdcard0
-
-    # disable cursor blink for fbcon, if no splash screen support
-    write /sys/class/graphics/fbcon/cursor_blink 0
-
-    # deattch the fbcon as hdmi hotplug conflict with fbcon
-    write /sys/class/vtconsole/vtcon1/bind 0
-
-    chown system system /dev/stune/top-app/schedtune.boost
-    chmod 664 /dev/stune/top-app/schedtune.boost
-    chown system system /dev/stune/top-app/schedtune.prefer_idle
-    chmod 664 /dev/stune/top-app/schedtune.prefer_idle
-    chown system system /dev/stune/foreground/schedtune.boost
-    chmod 664 /dev/stune/foreground/schedtune.boost
-    chown system system /dev/stune/foreground/schedtune.prefer_idle
-    chmod 664 /dev/stune/foreground/schedtune.prefer_idle
-    chown system system /dev/stune/schedtune.boost
-    chmod 664 /dev/stune/schedtune.boost
-
-    # set default schedTune value for foreground/top-app (only affects EAS)
-    write /dev/stune/foreground/schedtune.boost 10
-    write /dev/stune/foreground/schedtune.prefer_idle 1
-    write /dev/stune/top-app/schedtune.boost 40
-    write /dev/stune/top-app/schedtune.prefer_idle 1
-    write /dev/stune/rt/schedtune.boost 50
-    write /dev/stune/rt/schedtune.prefer_idle 1
-
-on late-fs && property:vendor.skip.charger_not_need=0
-    # Start keymaster/gatekeeper service
-    start vendor.gatekeeper-1-0-${ro.boot.keystore}
-    start vendor.keymaster-4-0-${ro.boot.keystore}
-    setprop vendor.powerhal.init 1
-
-    # Wait for keymaster
-    exec_start wait_for_keymaster
-
-    mount_all /vendor/etc/fstab.nxp --late
-
-on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
-    start vendor.oemlock-1-0
-
-on early-boot && property:vendor.skip.charger_not_need=0
-    # For evk_8mp, when swap used about 400M, upgrade the level.
-    setprop ro.lmk.upgrade_pressure 93
-    setprop ro.lmk.downgrade_pressure 99
-    setprop ro.lmk.critical_upgrade true
-
-    setprop vendor.hwc.stretch.filter  1
-
-    # Default g2d [dpu|pxp|viv] lib to be used
-    setprop vendor.imx.default-g2d viv
-
-    # fsl omx graphic manager media framework property
-    setprop vendor.rw.VIDEO_RENDER_NAME video_render.surface
-    setprop vendor.media.fsl_codec.flag 7
-
-    setprop camera.disable_zsl_mode 1
-
-    #Enable GPU 2D do CSC on imx8mp platform
-    setprop vendor.camera.2d.enable true
-
-   # Tweak the mmc device read ahead buffer size
-    write /sys/block/mmcblk1/queue/read_ahead_kb 2048
-    write /sys/block/mmcblk2/queue/read_ahead_kb 2048
-
-    # Prepare for wifi
-    setprop wifi.interface wlan0
-    setprop wifi.direct.interface p2p0
-    setprop wifi.concurrent.interface wlan1
-
-    # Set tracefs permission to 755
-    chmod 0755 /sys/kernel/debug/tracing
-
-    # Set sw_sync group to graphics and set permission to 664
-    chown root graphics /sys/kernel/debug/sync/sw_sync
-    chmod 0664 /sys/kernel/debug/sync/sw_sync
-
-    # Default backlight device
-    setprop vendor.hw.backlight.dev "32e60000.mipi_dsi.0"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/32e60000.mipi_dsi.0/brightness
-    chmod 0660 /sys/class/backlight/32e60000.mipi_dsi.0/brightness
-
-    # Backup backlight device
-    setprop vendor.hw.backlight_backup.dev "lvds_backlight"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/lvds_backlight/brightness
-    chmod 0660 /sys/class/backlight/lvds_backlight/brightness
-
-    # Set light sensor sysfs path and light sensor threshold lux value
-    setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
-    setprop vendor.ro.lightsensor.threshold  20
-
-    # Allow DSD file(duration larger than 10s) can play
-    setprop audio.offload.min.duration.secs 10
-
-    # Enlarge limition of audio buffer allocation
-    setprop ro.af.client_heap_size_kbyte 32768
-
-    start vendor.wifi_hal_legacy
-
-service wpa_supplicant /vendor/bin/hw/wpa_supplicant \
-    -O/data/vendor/wifi/wpa/sockets -puse_p2p_group_interface=1 \
-    -g@android:wpa_wlan0
-    interface android.hardware.wifi.supplicant@1.0::ISupplicant default
-    interface android.hardware.wifi.supplicant@1.1::ISupplicant default
-    interface android.hardware.wifi.supplicant@1.2::ISupplicant default
-    interface android.hardware.wifi.supplicant@1.3::ISupplicant default
-    class main
-    socket wpa_wlan0 dgram 660 wifi wifi
-    disabled
-    oneshot
-
-service sensor_fusion /vendor/bin/fsl_sensor_fusion
-    class late_start
-    seclabel u:r:sensors:s0
-    user system
-    group system uhid
-    oneshot
-
-# Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
-service watchdogd /system/bin/watchdogd 10 20
-    class core
-    seclabel u:r:watchdogd:s0
-
-# bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -z
-    class main
-    disabled
-    oneshot
-    keycodes 114 115 116
-
-on boot && property:vendor.skip.charger_not_need=0
-    start audioserver
-    start mediadrm
-    start media
-    start drm
-
-on fs && property:vendor.skip.charger_not_need=0
-# mount ext4 partitions
-    mount_all /vendor/etc/fstab.nxp --early
-
-    # Adjust parameters for dm-verity device
-    write /sys/block/dm-0/queue/read_ahead_kb 4096
-
-    # Update dm-verity state and set partition.*.verified properties
-    verity_update_state
-
-on post-fs && property:vendor.skip.charger_not_need=0
-    # Set netd memlock rlimit to 8MB
-    setrlimit 8 8388608 8388608
-
-    # Turn on swap
-    swapon_all /vendor/etc/fstab.nxp
-
-    # Swap in only 1 page at a time
-    write /proc/sys/vm/page-cluster 0
-
-    # Grant permission for fetching available_pages info of statsd
-    chown system system /proc/pagetypeinfo
-    chmod 0440 /proc/pagetypeinfo
-
-on post-fs-data && property:vendor.skip.charger_not_need=0
-    setprop vold.post_fs_data_done 1
-    # create temp node for secure storage proxy
-    mkdir /data/vendor/ss 0700 system system
-
-    # tmp dir for opencl Compiler
-    setprop vendor.TMPDIR /data/vendor/.opencl-cache
-    mkdir /data/vendor/.opencl-cache 0771 system camera
-
-on zygote-start && property:vendor.skip.charger_not_need=0
-    # Create the directories used by the Wireless subsystem
-    mkdir /data/vendor/wifi 0771 wifi wifi
-    mkdir /data/vendor/wifi/wpa 0770 wifi wifi
-    mkdir /data/vendor/wifi/wpa/sockets 0770 wifi wifi
-
-service early_init_sh /vendor/bin/init.insmod.sh /vendor/etc/early.init.cfg vendor.all.early_init.ready
-    class main
-    user root
-    group root system
-    disabled
-    oneshot
-
-on property:sys.boot_completed=1 && property:vendor.storageproxyd=trusty && property:vendor.skip.charger_not_need=0
-    start storageproxyd
-
-service storageproxyd /vendor/bin/storageproxyd -p /data/vendor/ss -r /dev/mmcblk2rpmb -d /dev/trusty-ipc-dev0
-   group system
-
-on property:ro.boot.vendor.sysrq=1 && property:vendor.skip.charger_not_need=0
-    write /proc/sys/kernel/sysrq 1
-
-# setenv append_bootargs androidboot.usb.debugging=1
-on property:ro.boot.usb.debugging=1
-    setprop persist.sys.usb.config adb
-
-# setenv append_bootargs androidboot.powersave.usb=true
-on property:ro.boot.powersave.usb=true
-    # enable platform/32f10100.usb runtime_pm
-    write /sys/devices/platform/soc@0/32f10100.usb/38100000.dwc3/power/control auto
-
-    #enable platform/32f10108.usb runtime_pm
-    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/power/control auto
-    write /sys/devices/platform/soc@0/32f10108.usb/38200000.dwc3/xhci-hcd.0.auto/power/control auto
diff --git a/imx8m/vp6820_8mp/isp_camera_config_imx8mp.json b/imx8m/vp6820_8mp/isp_camera_config_imx8mp.json
index e24b80e0..1ed505f8 100644
--- a/imx8m/vp6820_8mp/isp_camera_config_imx8mp.json
+++ b/imx8m/vp6820_8mp/isp_camera_config_imx8mp.json
@@ -10,13 +10,8 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
-      "camera_name": "viv_v4l2_device",
-      "device_node": "/dev/video0",
-=======
       "camera_name": "viv_v4l20",
       "bus_info": "platform:viv0",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "orientation": "0",
       "buffer_type": "mmap",
       "ActiveArrayWidth": "1920",
diff --git a/imx8m/vp6820_8mp/ov5640_camera_config_imx8mp.json b/imx8m/vp6820_8mp/ov5640_camera_config_imx8mp.json
index 6dcf34a7..73b1b25b 100644
--- a/imx8m/vp6820_8mp/ov5640_camera_config_imx8mp.json
+++ b/imx8m/vp6820_8mp/ov5640_camera_config_imx8mp.json
@@ -10,11 +10,7 @@
   "camera_metadata": [
     {
       "camera_type": "back",
-<<<<<<< HEAD
-      "camera_name": "mxc-isi-cap",
-=======
       "camera_name": "mxc_isi.1.capture",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "orientation": "0",
       "mplane": "1",
       "buffer_type": "dma",
diff --git a/imx8m/vp6820_8mp/overlay/frameworks/base/core/res/res/values/config.xml b/imx8m/vp6820_8mp/overlay/frameworks/base/core/res/res/values/config.xml
index 416ce4ff..cd5b7b69 100644
--- a/imx8m/vp6820_8mp/overlay/frameworks/base/core/res/res/values/config.xml
+++ b/imx8m/vp6820_8mp/overlay/frameworks/base/core/res/res/values/config.xml
@@ -188,6 +188,9 @@
     <!-- Boolean indicating whether system support sustained performance mode. -->
     <bool name="config_sustainedPerformanceModeSupported">true</bool>
 
+    <!-- If the system has the input method for each display - enable per-display focus. -->
+    <bool name="config_perDisplayFocusEnabled">true</bool>
+
     <!-- The default gravity for the picture-in-picture window.
          Currently, this maps to Gravity.TOP | Gravity.RIGHT -->
     <integer name="config_defaultPictureInPictureGravity">0x35</integer>
diff --git a/imx8m/vp6820_8mp/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml b/imx8m/vp6820_8mp/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
index 87976f74..0bf9ee21 100644
--- a/imx8m/vp6820_8mp/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
+++ b/imx8m/vp6820_8mp/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
@@ -21,8 +21,5 @@
     <bool name="def_user_setup_complete">true</bool>
     <bool name="def_bluetooth_on">false</bool>
     <bool name="def_stay_on_while_plugged_in">true</bool>
-<<<<<<< HEAD
     <string name="def_immersive_mode_confirmations" translatable="false">confirmed</string>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </resources>
diff --git a/imx8m/vp6820_8mp/sepolicy/file_contexts b/imx8m/vp6820_8mp/sepolicy/file_contexts
index 1cdba81e..ad88cb47 100644
--- a/imx8m/vp6820_8mp/sepolicy/file_contexts
+++ b/imx8m/vp6820_8mp/sepolicy/file_contexts
@@ -1,63 +1,15 @@
-<<<<<<< HEAD
-#sd boot
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/misc             u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/metadata         u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/presistdata      u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/userdata         u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/vbmeta_[ab]      u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b50000\.mmc/by-name/super            u:object_r:super_block_device:s0
-
-#emmc boot
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/misc             u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/metadata         u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/presistdata      u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/userdata         u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/vbmeta_[ab]      u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/super            u:object_r:super_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/bootloader_[ab]  u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/mem_info_[ab]    u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/30800000.bus/30b60000\.mmc/by-name/idtechdata       u:object_r:idtechdata_block_device:s0
-
-# spl
-/dev/block/mmcblk2boot[01]            u:object_r:spl_block_device:s0
-/dev/block/mmcblk2boot[01]p[1-9]      u:object_r:spl_block_device:s0
-
-#peripheral
-/vendor/bin/magd                u:object_r:sensors_exec:s0
-/vendor/bin/fsl_sensor_fusion   u:object_r:sensors_exec:s0
-/dev/mma8x5x                    u:object_r:sensors_device:s0
-/dev/ttymxc[0-9]*               u:object_r:tty_device:s0
-/dev/FreescaleAccelerometer     u:object_r:sensors_device:s0
-/dev/FreescaleMagnetometer      u:object_r:sensors_device:s0
-/dev/FreescaleGyroscope         u:object_r:sensors_device:s0
-=======
 /dev/block/mmcblk2boot0                      u:object_r:emmc_boot0:s0
 /dev/block/mmcblk1                           u:object_r:sdcard:s0
 
 #peripheral
 /vendor/bin/fsl_sensor_fusion   u:object_r:sensors_exec:s0
 /dev/ttymxc[0-9]*               u:object_r:tty_device:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 /dev/sda[0-8]*                  u:object_r:fuse:s0
 
 #Thermal HAL service
 /vendor/bin/hw/android\.hardware\.thermal@2\.0-service.imx         u:object_r:hal_thermal_default_exec:s0
 #Neural Network HAL service
-<<<<<<< HEAD
-/vendor/bin/hw/android\.hardware\.neuralnetworks@1\.2-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
-=======
 /vendor/bin/hw/android\.hardware\.neuralnetworks@1\.3-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # Media Codec2 service
 /vendor/bin/hw/android\.hardware\.media\.c2@1\.0-service    u:object_r:mediacodec_exec:s0
diff --git a/imx8m/vp6820_8mp/sepolicy/genfs_contexts b/imx8m/vp6820_8mp/sepolicy/genfs_contexts
index 0c88bf65..d80ffb8e 100644
--- a/imx8m/vp6820_8mp/sepolicy/genfs_contexts
+++ b/imx8m/vp6820_8mp/sepolicy/genfs_contexts
@@ -3,22 +3,13 @@ genfscon sysfs /devices/platform/soc@0/30800000.bus/30b50000.mmc/mmc_host/mmc1/m
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30b60000.mmc/mmc_host/mmc2/mmc2:0001/block/mmcblk2 u:object_r:sysfs_block_devices:s0
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30bb0000.spi/spi_master/spi0/spi0.0/mtd/mtd0/mtdblock0 u:object_r:sysfs_block_devices:s0
 genfscon sysfs /devices/platform/soc@0/32c00000.bus/32e60000.mipi_dsi/32e60000.mipi_dsi.0/backlight u:object_r:sysfs_leds:s0
-<<<<<<< HEAD
-genfscon sysfs /devices/platform/backlight/backlight/backlight u:object_r:sysfs_leds:s0
-=======
 genfscon sysfs /devices/platform/soc@0/30400000.bus/30670000.pwm/consumer:lvds_backlight/consumer/backlight u:object_r:sysfs_leds:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 #sys/class/net
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30be0000.ethernet/net                u:object_r:sysfs_net:s0
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30bf0000.ethernet/net                u:object_r:sysfs_net:s0
-<<<<<<< HEAD
-genfscon sysfs /devices/platform/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net  u:object_r:sysfs_net:s0
-genfscon sysfs /devices/platform/32f10100.usb/38100000.dwc3/gadget/net                   u:object_r:sysfs_net:s0
-=======
 genfscon sysfs /devices/platform/32f10100.usb/38100000.dwc3/gadget/net                   u:object_r:sysfs_net:s0
 genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net  u:object_r:sysfs_net:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30a30000.i2c/i2c-1/1-0050/extcon u:object_r:sysfs_extcon:s0
 
@@ -33,3 +24,5 @@ genfscon sysfs /devices/platform/soc@0/30800000.bus/30a30000.i2c/i2c-1/1-0050/po
 
 # for dumpstate to access the stat file
 genfscon sysfs /devices/platform/94400000.pmem/ndbus0/region0/namespace0.0/block/pmem0                                       u:object_r:sysfs_block_devices:s0
+
+genfscon sysfs /devices/platform/backlight/backlight/backlight u:object_r:sysfs_leds:s0
diff --git a/imx8m/vp6820_8mp/thermal_info_config_imx8mp.json b/imx8m/vp6820_8mp/thermal_info_config_imx8mp.json
index 9b8f10ba..36416a7e 100755
--- a/imx8m/vp6820_8mp/thermal_info_config_imx8mp.json
+++ b/imx8m/vp6820_8mp/thermal_info_config_imx8mp.json
@@ -1,28 +1,18 @@
 {
-<<<<<<< HEAD
-=======
     "HotplugCPUs":[
             "cpu2",
             "cpu3"
     ],
->>>>>>> post_merge/android-11.0.0_2.0.0
     "Sensors":[
         {
             "Name":"cpu-thermal",
             "Type":"CPU",
             "HotThreshold":[
                 "NAN",
-<<<<<<< HEAD
-                "NAN",
-                "NAN",
-                85.0,
-                95.0,
-=======
                 80.0,
                 82.0,
                 86.0,
                 90.0,
->>>>>>> post_merge/android-11.0.0_2.0.0
                 "NAN",
                 "NAN"
             ],
diff --git a/imx8m/vp6820_8mp/vp6820_8mp.mk b/imx8m/vp6820_8mp/vp6820_8mp.mk
index f60d0903..e945914c 100644
--- a/imx8m/vp6820_8mp/vp6820_8mp.mk
+++ b/imx8m/vp6820_8mp/vp6820_8mp.mk
@@ -1,46 +1,19 @@
-<<<<<<< HEAD
-# This is a FSL Android Reference Design platform based on i.MX8QP ARD board
-# It will inherit from FSL core product which in turn inherit from Google generic
-
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mp
-=======
 # -------@block_infrastructure-------
-CONFIG_REPO_PATH := device/nxp
+CONFIG_REPO_PATH := device/idtech
 CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
 IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # configs shared between uboot, kernel and Android rootfs
 include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
 
-<<<<<<< HEAD
--include device/idtech/common/imx_path/ImxPathConfig.mk
-include device/idtech/imx8m/ProductConfigCommon.mk
-
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab.nxp)
-endif
-
-# Overrides
-PRODUCT_NAME := vp6820_8mp
-PRODUCT_DEVICE := vp6820_8mp
-PRODUCT_MODEL := VP6820_8MP
-
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-#Enable this to choose 32 bit user space build
-#IMX8_BUILD_32BIT_ROOTFS := true
-=======
 -include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
 include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
 
 # -------@block_common_config-------
 # Overrides
-PRODUCT_NAME := evk_8mp
-PRODUCT_DEVICE := evk_8mp
-PRODUCT_MODEL := EVK_8MP
+PRODUCT_NAME := vp6820_8mp
+PRODUCT_DEVICE := vp6820_8mp
+PRODUCT_MODEL := VP6820_8MP
 
 TARGET_BOOTLOADER_BOARD_NAME := EVK
 
@@ -90,21 +63,16 @@ PRODUCT_COPY_FILES += \
 	  $(CONFIG_REPO_PATH)/imx8m/permissions/privapp-permissions-imx.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/privapp.permissions-imx.xml
 
 PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml
+    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
+    $(CONFIG_REPO_PATH)/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
+    $(CONFIG_REPO_PATH)/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
+    $(CONFIG_REPO_PATH)/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
 
 # -------@block_kernel_bootimg-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
 TARGET_USE_VENDOR_BOOT ?= true
 
-<<<<<<< HEAD
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-#If the device is retrofit to have dynamic partition feature, set this variable to true to build
-#the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
-TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
-=======
 
 # We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
 # boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
@@ -125,31 +93,12 @@ PRODUCT_COPY_FILES += \
 
 #Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
 TARGET_USE_DYNAMIC_PARTITIONS ?= true
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
   PRODUCT_USE_DYNAMIC_PARTITIONS := true
   BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
   BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-<<<<<<< HEAD
-  ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
-    PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
-    BOARD_SUPER_PARTITION_METADATA_DEVICE := system
-    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 2952790016
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-    else
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor product
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 1610612736
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-      BOARD_SUPER_PARTITION_PRODUCT_DEVICE_SIZE := 1879048192
-    endif
-  endif
-endif
-
-=======
 endif
 
 #Enable this to disable product partition build.
@@ -184,151 +133,18 @@ PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
     $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
 
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt
+
 # -------@block_security-------
 
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Include keystore attestation keys and certificates.
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 -include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
 endif
 
-<<<<<<< HEAD
-# Include Android Go config for low memory device.
-ifeq ($(LOW_MEMORY),true)
-$(call inherit-product, build/target/product/go_defaults.mk)
-endif
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(FSL_PROPRIETARY_PATH)/fsl-proprietary/mcu-sdk/imx8mp/imx8mp_mcu_demo.img:imx8mp_mcu_demo.img \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/usb_audio_policy_configuration-direct-output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/usb_audio_policy_configuration-direct-output.xml \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp \
-    $(IMX_DEVICE_PATH)/init.imx8mp.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mp.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    device/idtech/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    device/idtech/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    device/idtech/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf \
-    device/idtech/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
-    device/idtech/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
-    device/idtech/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
-    device/idtech/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
-    device/idtech/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt \
-    device/idtech/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
-
-# Copy isp files to board
-ISP_PROPRIETARY := $(FSL_PROPRIETARY_PATH)/fsl-proprietary/isp
-PRODUCT_COPY_FILES += \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/bin,$(TARGET_COPY_OUT_VENDOR)/bin) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/lib64,$(TARGET_COPY_OUT_VENDOR)/lib64) \
-    $(call find-copy-subdir-files,*,$(ISP_PROPRIETARY)/config,$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp)
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-
-# Audio card json
-PRODUCT_COPY_FILES += \
-    device/idtech/common/audio-json/wm8960_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8960_config.json \
-    device/idtech/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
-    device/idtech/common/audio-json/hdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/hdmi_config.json \
-    device/idtech/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    device/idtech/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
-    device/idtech/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    device/idtech/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    device/idtech/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/vp6820_8mp/camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mp.json \
-    device/idtech/imx8m/vp6820_8mp/ov5640_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/ov5640_camera_config_imx8mp.json \
-    device/idtech/imx8m/vp6820_8mp/isp_camera_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/isp_camera_config_imx8mp.json \
-    device/idtech/imx8m/vp6820_8mp/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/vp6820_8mp/powerhint_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mp.json
-
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    device/idtech/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    device/idtech/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    device/idtech/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    device/idtech/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    device/idtech/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# Set permission for GMS packages
-PRODUCT_COPY_FILES += \
-	  device/idtech/imx8m/permissions/privapp-permissions-imx.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/privapp.permissions-imx.xml \
-
-USE_XML_AUDIO_POLICY_CONF := 1
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_CHARACTERISTICS := tablet
-
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-=======
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
@@ -402,6 +218,7 @@ PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/audio-json/micfil_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/micfil_config.json \
     $(CONFIG_REPO_PATH)/common/audio-json/hdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/hdmi_config.json \
     $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
     $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
 
 PRODUCT_PACKAGES += \
@@ -441,27 +258,11 @@ PRODUCT_PACKAGES += \
 # -------@block_display-------
 
 PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # HWC2 HAL
 PRODUCT_PACKAGES += \
     android.hardware.graphics.composer@2.4-service
 
-<<<<<<< HEAD
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@2.0-impl-2.1 \
-    android.hardware.graphics.allocator@2.0-impl \
-    android.hardware.graphics.allocator@2.0-service
-=======
 # define frame buffer count
 PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
     ro.surface_flinger.max_frame_buffer_acquired_buffers=3
@@ -470,25 +271,17 @@ PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
 PRODUCT_PACKAGES += \
     android.hardware.graphics.mapper@4.0-impl.imx \
     android.hardware.graphics.allocator@4.0-service.imx
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # RenderScript HAL
 PRODUCT_PACKAGES += \
     android.hardware.renderscript@1.0-impl
 
 PRODUCT_PACKAGES += \
-<<<<<<< HEAD
-    libEGL_VIVANTE \
-    libGLESv1_CM_VIVANTE \
-    libGLESv2_VIVANTE \
-    gralloc_viv.imx \
-=======
     libg2d-opencl
 
 # Multi-Display launcher
 PRODUCT_PACKAGES += \
-    MultiClientInputMethod \
-    MultiDisplay
+    MultiClientInputMethod
 
 PRODUCT_COPY_FILES += \
     $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
@@ -499,25 +292,16 @@ PRODUCT_PACKAGES += \
     libGLESv1_CM_VIVANTE \
     libGLESv2_VIVANTE \
     gralloc_viv.$(TARGET_BOARD_PLATFORM) \
->>>>>>> post_merge/android-11.0.0_2.0.0
     libGAL \
     libGLSLC \
     libVSC \
     libgpuhelper \
     libSPIRV_viv \
     libvulkan_VIVANTE \
-<<<<<<< HEAD
-    vulkan.imx \
-    libCLC \
-    libLLVM_viv \
-    libOpenCL \
-    libg2d-opencl \
-=======
     vulkan.$(TARGET_BOARD_PLATFORM) \
     libCLC \
     libLLVM_viv \
     libOpenCL \
->>>>>>> post_merge/android-11.0.0_2.0.0
     libg2d-viv \
     libOpenVX \
     libOpenVXU \
@@ -534,65 +318,25 @@ PRODUCT_PACKAGES += \
     libNNArchPerf \
     libarchmodelSw
 
-<<<<<<< HEAD
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32 \
-    android.hardware.power@1.3-service.imx \
-    android.hardware.light@2.0-impl \
-    android.hardware.light@2.0-service \
-    android.hardware.sensors@1.0-impl \
-    android.hardware.sensors@1.0-convert \
-    android.hardware.sensors@1.0-service \
-    android.hardware.configstore@1.1-service \
-    configstore@1.1.policy
-
-ifneq ($(IMX8MP_USES_GKI), true)
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/vp6820_8mp/thermal_info_config_imx8mp.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mp.json
-endif
-
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.2-service-vsi-npu-server
-
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-#nxp 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-=======
 # GPU openCL g2d
 PRODUCT_COPY_FILES += \
     $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
 
+# -------@block_sensor-------
+PRODUCT_PACKAGES += \
+    android.hardware.sensors@1.0-impl \
+    android.hardware.sensors@1.0-convert \
+    android.hardware.sensors@1.0-service
+
 # -------@block_wifi-------
 
 PRODUCT_COPY_FILES += \
     $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
     $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # WiFi HAL
 PRODUCT_PACKAGES += \
     android.hardware.wifi@1.0-service \
-<<<<<<< HEAD
-    wifilogd \
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     wificond
 
 # WiFi RRO
@@ -602,43 +346,14 @@ PRODUCT_PACKAGES += \
 # nxp 8997 wifi and bluetooth combo Firmware
 PRODUCT_COPY_FILES += \
     vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
-<<<<<<< HEAD
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf
-=======
     vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf \
     vendor/nxp/imx-firmware/nxp/android_wifi_mod_para_powersave.conf:vendor/firmware/wifi_mod_para_powersave.conf
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # Wifi regulatory
 PRODUCT_COPY_FILES += \
     external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
     external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
 
-<<<<<<< HEAD
-# Keymaster HAL
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# DRM HAL
-TARGET_ENABLE_MEDIADRM_64 := true
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-ifneq ($(BUILD_TARGET_FS),ubifs)
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.frp.pst=/dev/block/by-name/presistdata
-endif
-=======
 # -------@block_bluetooth-------
 
 # Bluetooth HAL
@@ -668,7 +383,6 @@ PRODUCT_COPY_FILES += \
     $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
     $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
     $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 PRODUCT_PACKAGES += \
     libg1 \
@@ -715,59 +429,6 @@ PRODUCT_PACKAGES += \
 PRODUCT_PACKAGES += \
     DirectAudioPlayer
 
-<<<<<<< HEAD
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-#Dumpstate HAL 1.1 support
-PRODUCT_PACKAGES += \
-    android.hardware.dumpstate@1.1-service.imx
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-IMX-DEFAULT-G2D-LIB := libg2d-opencl
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 INSTALL_64BIT_LIBRARY := true
@@ -779,59 +440,6 @@ endif
 -include $(FSL_RESTRICTED_CODEC_PATH)/fsl-restricted-codec/imx_dsp/imx_dsp_8mp.mk
 endif
 
-<<<<<<< HEAD
-# Included GMS package
-$(call inherit-product-if-exists, vendor/partner_gms/products/gms.mk)
-PRODUCT_SOONG_NAMESPACES += vendor/partner_gms
-
-# Resume on Reboot support
-PRODUCT_PACKAGES += \
-    android.hardware.rebootescrow-service.default
-
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.rebootescrow.device=/dev/block/pmem0
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-# Copy Quectel vendor RIL
-PRODUCT_COPY_FILES += \
-    vendor/quectel/libstdc++.so:/vendor/lib64/libstdc++.so \
-    vendor/quectel/libQuectelreference-ril.so:/vendor/lib64/libQuectelreference-ril.so \
-    vendor/quectel/ql-ril.conf:/system/etc/ql-ril.conf \
-    vendor/quectel/apns-conf.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/apns-conf.xml  \
-    vendor/quectel/chat:/system/bin/chat \
-    vendor/quectel/ip-down:/system/etc/ppp/ip-down \
-    vendor/quectel/ip-up:/system/etc/ppp/ip-up \
-    vendor/quectel/QAndroidLog:/system/bin/QAndroidLog \
-    vendor/quectel/QFlash:/system/bin/QFlash \
-    vendor/quectel/T1.LinuxData-OTA-DataService_V01.cfg:/system/data/T1.LinuxData-OTA-DataService_V01.cfg \
-    vendor/quectel/T2.RegServ-CotextAct_V01.cfg:/system/data/T2.RegServ-CotextAct_V01.cfg \
-    vendor/quectel/T3.SimpleData_V01.cfg:/system/data/T3.SimpleData_V01.cfg \
-    vendor/quectel/T4.Throughput_V01.cfg:/system/data/T4.Throughput_V01.cfg \
-    vendor/quectel/T5.COMMON_V01.cfg:/system/data/T5.COMMON_V01.cfg \
-    vendor/quectel/T6.FullMessage.SimpleLogPacket_V01.cfg:/system/data/T6.FullMessage.SimpleLogPacket_V01.cfg
-
-#AMS
-PRODUCT_PACKAGES += \
-    deviceadmin \
-    appmanager \
-    amsconnector \
-    amsclouddrive \
-    amsbootmediasync \
-    welcomeapp \
-    diagnosis \
-    otaupdater \
-    watchdog
-
-# Enable kernel log for diagnosis
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.logd.kernel=true
-=======
 # -------@block_memory-------
 
 # Include Android Go config for low memory device.
@@ -847,10 +455,6 @@ PRODUCT_PACKAGES += \
     libnnrt \
     android.hardware.neuralnetworks@1.3-service-vsi-npu-server
 
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
 # -------@block_miscellaneous-------
 
 # Copy device related config and binary to board
@@ -897,5 +501,36 @@ PRODUCT_COPY_FILES += \
 $(call inherit-product-if-exists, vendor/partner_gms/products/gms.mk)
 PRODUCT_SOONG_NAMESPACES += vendor/partner_gms
 
+# Copy Quectel vendor RIL
+PRODUCT_COPY_FILES += \
+    vendor/quectel/libstdc++.so:/vendor/lib64/libstdc++.so \
+    vendor/quectel/libQuectelreference-ril.so:/vendor/lib64/libQuectelreference-ril.so \
+    vendor/quectel/ql-ril.conf:/system/etc/ql-ril.conf \
+    vendor/quectel/apns-conf.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/apns-conf.xml  \
+    vendor/quectel/chat:/system/bin/chat \
+    vendor/quectel/ip-down:/system/etc/ppp/ip-down \
+    vendor/quectel/ip-up:/system/etc/ppp/ip-up \
+    vendor/quectel/QAndroidLog:/system/bin/QAndroidLog \
+    vendor/quectel/QFlash:/system/bin/QFlash \
+    vendor/quectel/T1.LinuxData-OTA-DataService_V01.cfg:/system/data/T1.LinuxData-OTA-DataService_V01.cfg \
+    vendor/quectel/T2.RegServ-CotextAct_V01.cfg:/system/data/T2.RegServ-CotextAct_V01.cfg \
+    vendor/quectel/T3.SimpleData_V01.cfg:/system/data/T3.SimpleData_V01.cfg \
+    vendor/quectel/T4.Throughput_V01.cfg:/system/data/T4.Throughput_V01.cfg \
+    vendor/quectel/T5.COMMON_V01.cfg:/system/data/T5.COMMON_V01.cfg \
+    vendor/quectel/T6.FullMessage.SimpleLogPacket_V01.cfg:/system/data/T6.FullMessage.SimpleLogPacket_V01.cfg
 
->>>>>>> post_merge/android-11.0.0_2.0.0
+#AMS
+PRODUCT_PACKAGES += \
+    deviceadmin \
+    appmanager \
+    amsconnector \
+    amsclouddrive \
+    amsbootmediasync \
+    welcomeapp \
+    diagnosis \
+    otaupdater \
+    watchdog
+
+# Enable kernel log for diagnosis
+PRODUCT_PROPERTY_OVERRIDES += \
+    ro.logd.kernel=true
diff --git a/imx8m/vp6820_8mp/vp6820_8mp_pci.mk b/imx8m/vp6820_8mp/vp6820_8mp_pci.mk
index 623fa871..dd8d66a4 100644
--- a/imx8m/vp6820_8mp/vp6820_8mp_pci.mk
+++ b/imx8m/vp6820_8mp/vp6820_8mp_pci.mk
@@ -1,7 +1,9 @@
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mp
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mp.mk)
 
 # Overrides
diff --git a/imx8m/vp6820_8mp/vp6820_8mp_pcidev.mk b/imx8m/vp6820_8mp/vp6820_8mp_pcidev.mk
index 01ae62a4..56ecd212 100644
--- a/imx8m/vp6820_8mp/vp6820_8mp_pcidev.mk
+++ b/imx8m/vp6820_8mp/vp6820_8mp_pcidev.mk
@@ -1,8 +1,10 @@
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mp
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mp.mk)
 
 # Overrides
-PRODUCT_NAME := vp6820_8mp_pci
+PRODUCT_NAME := vp6820_8mp_pcidev
diff --git a/imx8m/vp6820_8mq/AndroidBoard.mk b/imx8m/vp6820_8mq/AndroidBoard.mk
index cb6595f6..75defabe 100644
--- a/imx8m/vp6820_8mq/AndroidBoard.mk
+++ b/imx8m/vp6820_8mq/AndroidBoard.mk
@@ -1,8 +1,8 @@
 LOCAL_PATH := $(call my-dir)
 
-include device/idtech/common/build/dtbo.mk
-include device/idtech/common/build/imx-recovery.mk
-include device/idtech/common/build/gpt.mk
+include $(CONFIG_REPO_PATH)/common/build/dtbo.mk
+include $(CONFIG_REPO_PATH)/common/build/imx-recovery.mk
+include $(CONFIG_REPO_PATH)/common/build/gpt.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/media-profile/media-profile.mk
 include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/sensor/fsl-sensor.mk
 -include $(IMX_MEDIA_CODEC_XML_PATH)/mediacodec-profile/mediacodec-profile.mk
diff --git a/imx8m/vp6820_8mq/AndroidTee.mk b/imx8m/vp6820_8mq/AndroidTee.mk
index ef1138fb..ef45e595 100644
--- a/imx8m/vp6820_8mq/AndroidTee.mk
+++ b/imx8m/vp6820_8mq/AndroidTee.mk
@@ -4,7 +4,7 @@ MAKE += SHELL=/bin/bash
 define build_uboot_w_tee
 	$(MAKE) -C bootable/bootloader/arm-trusted-firmware/ -B CROSS_COMPILE=aarch64-linux-android- PLAT=imx8mq V=1 SPD=opteed DECRYPTED_BUFFER_START=$(DECRYPTED_BUFFER_START) DECRYPTED_BUFFER_LEN=$(DECRYPTED_BUFFER_LEN) DECODED_BUFFER_START=$(DECODED_BUFFER_START) DECODED_BUFFER_LEN=$(DECODED_BUFFER_LEN) bl31; \
 	cp bootable/bootloader/arm-trusted-firmware/build/imx8mq/release/bl31.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.;\
-	aarch64-linux-android-objcopy -O binary out/target/product/vp6820_8mq/optee/arm-plat-imx/core/tee.elf $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
+	aarch64-linux-android-objcopy -O binary $(PRODUCT_OUT)/optee/arm-plat-imx/core/tee.elf $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 	$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ clean; \
 	$(MAKE) -C $(IMX_MKIMAGE_PATH)/imx-mkimage/ SOC=iMX8M  flash_hdmi_spl_uboot; \
 	cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(PRODUCT_OUT)/u-boot-$(strip $(2)).imx;
diff --git a/imx8m/vp6820_8mq/AndroidUboot.mk b/imx8m/vp6820_8mq/AndroidUboot.mk
index 7785c321..2a879e41 100644
--- a/imx8m/vp6820_8mq/AndroidUboot.mk
+++ b/imx8m/vp6820_8mq/AndroidUboot.mk
@@ -2,16 +2,9 @@
 MAKE += SHELL=/bin/bash
 
 ifneq ($(AARCH64_GCC_CROSS_COMPILE),)
-<<<<<<< HEAD
-ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
-else
-ATF_TOOLCHAIN_ABS := $(realpath prebuilts/gcc/$(HOST_PREBUILT_TAG)/aarch64/aarch64-linux-android-4.9/bin)
-ATF_CROSS_COMPILE := $(ATF_TOOLCHAIN_ABS)/aarch64-linux-androidkernel-
-=======
   ATF_CROSS_COMPILE := $(strip $(AARCH64_GCC_CROSS_COMPILE))
 else
   $(error shell env AARCH64_GCC_CROSS_COMPILE is not set)
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 define build_imx_uboot
@@ -19,19 +12,11 @@ define build_imx_uboot
 	cp $(UBOOT_OUT)/u-boot-nodtb.$(strip $(1)) $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(UBOOT_OUT)/spl/u-boot-spl.bin  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(UBOOT_OUT)/tools/mkimage  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/mkimage_uboot; \
-<<<<<<< HEAD
 	cp $(UBOOT_OUT)/arch/arm/dts/idt_a300_evt-0_devboard_evt-1.dtb  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/imx8mq-evk.dtb; \
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/hdmi/cadence/signed_hdmi_imx8m.bin  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
 	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
 	if [ `echo $(2) | cut -d '-' -f3` = "trusty" ] && [ `echo $(2) | rev | cut -d '-' -f1` != "uuu" ]; then \
-=======
-	cp $(UBOOT_OUT)/arch/arm/dts/imx8mq-evk.dtb  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
-	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/hdmi/cadence/signed_hdmi_imx8m.bin  $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
-	cp $(FSL_PROPRIETARY_PATH)/linux-firmware-imx/firmware/ddr/synopsys/lpddr4_pmu_train* $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/.; \
-	$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ PLAT=`echo $(2) | cut -d '-' -f1` clean; \
-	if [ `echo $(2) | cut -d '-' -f2` = "trusty" ] && [ `echo $(2) | rev | cut -d '-' -f1` != "uuu" ]; then \
->>>>>>> post_merge/android-11.0.0_2.0.0
 		cp $(FSL_PROPRIETARY_PATH)/fsl-proprietary/uboot-firmware/imx8m/tee-imx8mq.bin $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/tee.bin; \
 		$(MAKE) -C $(IMX_PATH)/arm-trusted-firmware/ CROSS_COMPILE="$(ATF_CROSS_COMPILE)" PLAT=`echo $(2) | cut -d '-' -f1` bl31 -B SPD=trusty 1>/dev/null || exit 1; \
 	else \
@@ -51,7 +36,6 @@ define build_imx_uboot
 	fi; \
 	if [ `echo $(2) | rev | cut -d '-' -f1 | rev` != "dual" ]; then \
 		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(UBOOT_COLLECTION)/u-boot-$(strip $(2)).imx; \
-<<<<<<< HEAD
 		if [ -f device/idtech/common/prebuilts/spl_tab_auxiliary.img ]; then \
 			dd if=device/idtech/common/prebuilts/spl_tab_auxiliary.img of=$(UBOOT_COLLECTION)/u-boot-$(strip $(2)).imx bs=1 seek=105984 conv=notrunc; \
 		fi; \
@@ -61,11 +45,6 @@ define build_imx_uboot
 		if [ -f device/idtech/common/prebuilts/spl_tab_auxiliary.img ]; then \
 			dd if=device/idtech/common/prebuilts/spl_tab_auxiliary.img of=$(UBOOT_COLLECTION)/spl-$(strip $(2)).bin bs=1 seek=105984 conv=notrunc; \
 		fi; \
-=======
-	else \
-		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/flash.bin $(UBOOT_COLLECTION)/spl-$(strip $(2)).bin; \
-		cp $(IMX_MKIMAGE_PATH)/imx-mkimage/iMX8M/u-boot-ivt.itb $(UBOOT_COLLECTION)/bootloader-$(strip $(2)).img; \
->>>>>>> post_merge/android-11.0.0_2.0.0
 	fi;
 endef
 
diff --git a/imx8m/vp6820_8mq/BoardConfig.mk b/imx8m/vp6820_8mq/BoardConfig.mk
index 51ddf44a..285a27be 100644
--- a/imx8m/vp6820_8mq/BoardConfig.mk
+++ b/imx8m/vp6820_8mq/BoardConfig.mk
@@ -1,5 +1,3 @@
-<<<<<<< HEAD
-=======
 # -------@block_infrastructure-------
 #
 # Product-specific compile-time definitions.
@@ -8,33 +6,14 @@
 include $(CONFIG_REPO_PATH)/imx8m/BoardConfigCommon.mk
 
 # -------@block_common_config-------
->>>>>>> post_merge/android-11.0.0_2.0.0
 #
 # SoC-specific compile-time definitions.
 #
 
 BOARD_SOC_TYPE := IMX8MQ
-<<<<<<< HEAD
 BOARD_SOM_TYPE := a300
 BOARD_TYPE := DEVBOARD
-BOARD_HAVE_VPU := true
-BOARD_VPU_TYPE := hantro
 BOARD_MAIN_DISPLAY_ROTATION := 0
-HAVE_FSL_IMX_GPU2D := false
-HAVE_FSL_IMX_GPU3D := true
-HAVE_FSL_IMX_IPU := false
-HAVE_FSL_IMX_PXP := false
-BOARD_KERNEL_BASE := 0x40400000
-TARGET_GRALLOC_VERSION := v3
-TARGET_USES_HWC2 := true
-TARGET_HWCOMPOSER_VERSION := v2.0
-USE_OPENGL_RENDERER := true
-TARGET_HAVE_VULKAN := true
-ENABLE_CFI=false
-
-SOONG_CONFIG_IMXPLUGIN += \
-                          BOARD_HAVE_VPU \
-=======
 BOARD_HAVE_VPU := true
 BOARD_VPU_TYPE := hantro
 HAVE_FSL_IMX_GPU2D := false
@@ -44,7 +23,6 @@ TARGET_USES_HWC2 := true
 TARGET_HAVE_VULKAN := true
 
 SOONG_CONFIG_IMXPLUGIN += \
->>>>>>> post_merge/android-11.0.0_2.0.0
                           BOARD_VPU_TYPE
 
 SOONG_CONFIG_IMXPLUGIN_BOARD_SOC_TYPE = IMX8MQ
@@ -52,53 +30,6 @@ SOONG_CONFIG_IMXPLUGIN_BOARD_HAVE_VPU = true
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_TYPE = hantro
 SOONG_CONFIG_IMXPLUGIN_BOARD_VPU_ONLY = false
 
-<<<<<<< HEAD
-#
-# Product-specific compile-time definitions.
-#
-
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mq
-
-include device/idtech/imx8m/BoardConfigCommon.mk
-
-BUILD_TARGET_FS ?= ext4
-TARGET_USERIMAGES_USE_EXT4 := true
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-# Support gpt
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab_super.bpt
-  ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
-                           partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
-else
-  ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-13GB-ab-no-product.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab-no-product.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
-  else
-    BOARD_BPT_INPUT_FILES += device/idtech/common/partition/device-partitions-14.4GB-ab.bpt
-    ADDITION_BPT_PARTITION = partition-table-28GB:device/idtech/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:device/idtech/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
-                             partition-table-28GB-dual:device/idtech/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
-  endif
-endif
-
-# Vendor Interface manifest and compatibility
-DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
-ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
-DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
-endif
-DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-USE_OPENGL_RENDERER := true
-
-BOARD_WLAN_DEVICE            := bcmdhd
-=======
 # -------@block_memory-------
 USE_ION_ALLOCATOR := true
 USE_GPU_ALLOCATOR := false
@@ -111,9 +42,9 @@ TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
 
 # Support gpt
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab_super.bpt
+  BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab_super.bpt
   ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab_super.bpt \
-                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader_super.bpt \
+                           partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader_super.bpt \
                            partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader_super.bpt
 else
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
@@ -122,14 +53,17 @@ else
                              partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader-no-product.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader-no-product.bpt
   else
-    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab.bpt
+    BOARD_BPT_INPUT_FILES += $(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab.bpt
     ADDITION_BPT_PARTITION = partition-table-28GB:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab.bpt \
-                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-13GB-ab-dual-bootloader.bpt \
+                             partition-table-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-14.4GB-ab-dual-bootloader.bpt \
                              partition-table-28GB-dual:$(CONFIG_REPO_PATH)/common/partition/device-partitions-28GB-ab-dual-bootloader.bpt
   endif
 endif
 
-BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-imx8mq.img
+AB_OTA_PARTITIONS += spl_bak
+LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
+LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
+BOARD_PREBUILT_DTBOIMAGE := $(OUT_DIR)/target/product/$(PRODUCT_DEVICE)/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
 
 BOARD_USES_METADATA_PARTITION := true
 BOARD_ROOT_EXTRA_FOLDERS += metadata
@@ -138,85 +72,48 @@ BOARD_ROOT_EXTRA_FOLDERS += metadata
 ENABLE_CFI=false
 
 BOARD_AVB_ENABLE := true
-BOARD_AVB_ALGORITHM := SHA256_RSA4096
+BOARD_AVB_ALGORITHM := SHA256_RSA2048
 # The testkey_rsa4096.pem is copied from external/avb/test/data/testkey_rsa4096.pem
-BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/testkey_rsa4096.pem
+BOARD_AVB_KEY_PATH := $(CONFIG_REPO_PATH)/common/security/idt_testkey_rsa2048.pem
 
-BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
+#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
+#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
+#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
 
 # -------@block_treble-------
 # Vendor Interface manifest and compatibility
 DEVICE_MANIFEST_FILE := $(IMX_DEVICE_PATH)/manifest.xml
+ifneq (,$(filter userdebug,$(TARGET_BUILD_VARIANT)))
+DEVICE_MANIFEST_FILE += $(IMX_DEVICE_PATH)/manifest_userdebug.xml
+endif
 DEVICE_MATRIX_FILE := $(IMX_DEVICE_PATH)/compatibility_matrix.xml
 DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE := $(IMX_DEVICE_PATH)/device_framework_matrix.xml
 
 # -------@block_wifi-------
-BOARD_WLAN_DEVICE            := nxp
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_WLAN_DEVICE            := bcmdhd
 WPA_SUPPLICANT_VERSION       := VER_0_8_X
 BOARD_WPA_SUPPLICANT_DRIVER  := NL80211
 BOARD_HOSTAPD_DRIVER         := NL80211
 BOARD_HOSTAPD_PRIVATE_LIB           := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
 BOARD_WPA_SUPPLICANT_PRIVATE_LIB    := lib_driver_cmd_$(BOARD_WLAN_DEVICE)
-
-<<<<<<< HEAD
 WIFI_DRIVER_FW_PATH_PARAM := "/sys/module/brcmfmac/parameters/alternative_fw_path"
+WIFI_HIDL_FEATURE_DUAL_INTERFACE := false
 
-#WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-
-BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
-
+# -------@block_bluetooth-------
 # BCM 1CX BT
 BOARD_HAVE_BLUETOOTH_BCM := true
-
-#BOARD_USE_SENSOR_FUSION := true
-BOARD_USE_ST_SENSOR_INPUT := true
-
-# we don't support sparse image.
-TARGET_USERIMAGES_SPARSE_EXT_DISABLED := false
-
-BOARD_HAVE_USB_CAMERA := true
-BOARD_HAVE_USB_MJPEG_CAMERA := false
-
-USE_ION_ALLOCATOR := true
-USE_GPU_ALLOCATOR := false
-
-BOARD_AVB_ENABLE := true
-TARGET_USES_MKE2FS := true
-BOARD_AVB_ALGORITHM := SHA256_RSA2048
-BOARD_AVB_KEY_PATH := device/idtech/common/security/idt_testkey_rsa2048.pem
-
-#BOARD_AVB_BOOT_KEY_PATH := external/avb/test/data/testkey_rsa2048.pem
-#BOARD_AVB_BOOT_ALGORITHM := SHA256_RSA2048
-#BOARD_AVB_BOOT_ROLLBACK_INDEX_LOCATION := 2
-
-# define frame buffer count
-NUM_FRAMEBUFFER_SURFACE_BUFFERS := 4
-=======
-WIFI_HIDL_FEATURE_DUAL_INTERFACE := true
-
-# -------@block_bluetooth-------
-# NXP 8997 BT
-BOARD_HAVE_BLUETOOTH_NXP := true
 BOARD_BLUETOOTH_BDROID_BUILDCFG_INCLUDE_DIR := $(IMX_DEVICE_PATH)/bluetooth
 
 # -------@block_sensor-------
-BOARD_USE_SENSOR_FUSION := true
+BOARD_USE_ST_SENSOR_INPUT := true
 
 # -------@block_kernel_bootimg-------
 BOARD_KERNEL_BASE := 0x40400000
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 ifeq ($(PRODUCT_IMX_DRM),true)
 CMASIZE=736M
 else
-<<<<<<< HEAD
 CMASIZE=800M
-=======
-CMASIZE=1280M
->>>>>>> post_merge/android-11.0.0_2.0.0
 endif
 
 # NXP default config
@@ -229,11 +126,7 @@ BOARD_KERNEL_CMDLINE += androidboot.fbTileSupport=enable
 BOARD_KERNEL_CMDLINE += transparent_hugepage=never cma=$(CMASIZE)
 
 # display config
-<<<<<<< HEAD
 BOARD_KERNEL_CMDLINE += androidboot.lcd_density=294 androidboot.primary_display=mxsfb-drm androidboot.gui_resolution=1080p
-=======
-BOARD_KERNEL_CMDLINE += androidboot.lcd_density=240 androidboot.primary_display=imx-dcss androidboot.gui_resolution=1080p
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # wifi config
 BOARD_KERNEL_CMDLINE += androidboot.wificountrycode=CN moal.mod_para=wifi_mod_para.conf
@@ -242,18 +135,6 @@ ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
 BOARD_KERNEL_CMDLINE += androidboot.vendor.sysrq=1
 endif
 
-<<<<<<< HEAD
-ifeq ($(TARGET_USERIMAGES_USE_UBIFS),true)
-ifeq ($(TARGET_USERIMAGES_USE_EXT4),true)
-$(error "TARGET_USERIMAGES_USE_UBIFS and TARGET_USERIMAGES_USE_EXT4 config open in same time, please only choose one target file system image")
-endif
-endif
-
-LOWER_BOARD_TYPE  = $(shell echo $(BOARD_TYPE) | tr A-Z a-z)
-LOWER_BOARD_SOC_TYPE  = $(shell echo $(BOARD_SOC_TYPE) | tr A-Z a-z)
-BOARD_PREBUILT_DTBOIMAGE := out/target/product/vp6820_8mq/dtbo-$(BOARD_SOM_TYPE)-$(LOWER_BOARD_TYPE).img
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-product.dtb
@@ -271,14 +152,6 @@ else # no dynamic parition feature
   ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
     TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-product-no-dynamic_partition.dtb
   else
-<<<<<<< HEAD
-    TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-dynamic_partition.dtb
-  endif
-endif
-
-BOARD_SEPOLICY_DIRS := \
-       device/idtech/imx8m/sepolicy \
-=======
 	TARGET_BOARD_DTS_CONFIG ?= imx8mq:imx8mq-evk-no-dynamic_partition.dtb
   endif
 endif
@@ -288,7 +161,6 @@ ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
 # -------@block_sepolicy-------
 BOARD_SEPOLICY_DIRS := \
        $(CONFIG_REPO_PATH)/imx8m/sepolicy \
->>>>>>> post_merge/android-11.0.0_2.0.0
        $(IMX_DEVICE_PATH)/sepolicy
 
 ifeq ($(PRODUCT_IMX_DRM),true)
@@ -296,16 +168,4 @@ BOARD_SEPOLICY_DIRS += \
        $(IMX_DEVICE_PATH)/sepolicy_drm
 endif
 
-<<<<<<< HEAD
-TARGET_BOARD_KERNEL_HEADERS := device/idtech/common/kernel-headers
-
-ALL_DEFAULT_INSTALLED_MODULES += $(BOARD_VENDOR_KERNEL_MODULES)
-
-BOARD_USES_METADATA_PARTITION := true
-BOARD_ROOT_EXTRA_FOLDERS += metadata
-
-BOARD_PLAT_PRIVATE_SEPOLICY_DIR := device/idtech/imx8m/sepolicy_system/private
-
-AB_OTA_PARTITIONS += spl_bak
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
+BOARD_PLAT_PRIVATE_SEPOLICY_DIR := $(CONFIG_REPO_PATH)/imx8m/sepolicy_system/private
diff --git a/imx8m/vp6820_8mq/SharedBoardConfig.mk b/imx8m/vp6820_8mq/SharedBoardConfig.mk
index 9d36f4fb..1312266c 100644
--- a/imx8m/vp6820_8mq/SharedBoardConfig.mk
+++ b/imx8m/vp6820_8mq/SharedBoardConfig.mk
@@ -1,37 +1,18 @@
-<<<<<<< HEAD
+# -------@block_kernel_bootimg-------
+
 KERNEL_NAME := Image
 TARGET_KERNEL_ARCH := arm64
 
-#Enable this to include trusty support
-PRODUCT_IMX_TRUSTY := true
-
-#Enable this to disable product partition build.
-#IMX_NO_PRODUCT_PARTITION := true
-
 # BCM fmac wifi driver module
 BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/drivers/net/wireless/broadcom/brcm80211/brcmfmac/brcmfmac.ko \
     $(KERNEL_OUT)/drivers/net/wireless/broadcom/brcm80211/brcmutil/brcmutil.ko
-=======
-# -------@block_kernel_bootimg-------
-
-KERNEL_NAME := Image
-TARGET_KERNEL_ARCH := arm64
-
-#NXP 8997 wifi driver module
-BOARD_VENDOR_KERNEL_MODULES += \
-    $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/mlan.ko \
-    $(TARGET_OUT_INTERMEDIATES)/MXMWIFI_OBJ/moal.ko
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 # mipi-panel touch driver module
 BOARD_VENDOR_KERNEL_MODULES += \
     $(KERNEL_OUT)/drivers/input/touchscreen/synaptics_dsx/synaptics_dsx_i2c.ko
-<<<<<<< HEAD
-=======
 
 # -------@block_security-------
 #Enable this to include trusty support
 PRODUCT_IMX_TRUSTY := true
 
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mq/UbootKernelBoardConfig.mk b/imx8m/vp6820_8mq/UbootKernelBoardConfig.mk
index e8f6bd9e..98346baa 100644
--- a/imx8m/vp6820_8mq/UbootKernelBoardConfig.mk
+++ b/imx8m/vp6820_8mq/UbootKernelBoardConfig.mk
@@ -2,7 +2,6 @@ TARGET_BOOTLOADER_POSTFIX := bin
 UBOOT_POST_PROCESS := true
 
 # u-boot target for imx8mq_evk
-<<<<<<< HEAD
 TARGET_BOOTLOADER_CONFIG := imx8mq-lpddr4:vp6820_8mq_evk_android_defconfig:signed
 TARGET_BOOTLOADER_CONFIG += imx8mq-lpddr4-dual:vp6820_8mq_evk_android_dual_defconfig:signed
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
@@ -19,21 +18,6 @@ TARGET_BOOTLOADER_CONFIG += imx8mq-lpddr4-evk-uuu-ktc4g:vp6820_8mq_evk_android_u
 TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
 TARGET_KERNEL_ADDITION_DEFCONF ?= android_addition_defconfig
 TARGET_KERNEL_SECURE_DEFCONF ?= android_secure_defconfig
-=======
-TARGET_BOOTLOADER_CONFIG := imx8mq:imx8mq_evk_android_defconfig
-TARGET_BOOTLOADER_CONFIG += imx8mq-dual:imx8mq_evk_android_dual_defconfig
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-  TARGET_BOOTLOADER_CONFIG += imx8mq-trusty:imx8mq_evk_android_trusty_defconfig
-  TARGET_BOOTLOADER_CONFIG += imx8mq-trusty-secure-unlock:imx8mq_evk_android_trusty_secure_unlock_defconfig
-  TARGET_BOOTLOADER_CONFIG += imx8mq-trusty-dual:imx8mq_evk_android_trusty_dual_defconfig
-endif
-
-# u-boot target used by uuu for imx8mq_evk
-TARGET_BOOTLOADER_CONFIG += imx8mq-evk-uuu:imx8mq_evk_android_uuu_defconfig
-
-TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
-# TARGET_KERNEL_ADDITION_DEFCONF ?= android_addition_defconfig
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 
 # absolute path is used, not the same as relative path used in AOSP make
diff --git a/imx8m/vp6820_8mq/audio_policy_configuration.xml b/imx8m/vp6820_8mq/audio_policy_configuration.xml
index d1ab187f..a9ce6cfe 100644
--- a/imx8m/vp6820_8mq/audio_policy_configuration.xml
+++ b/imx8m/vp6820_8mq/audio_policy_configuration.xml
@@ -21,13 +21,9 @@
         <module name="primary" halVersion="2.0">
             <attachedDevices>
                 <item>Speaker</item>
-<<<<<<< HEAD
                 <item>Wired Headphones</item>
                 <item>Built-In Mic</item>
                 <item>Wired-In Headsets</item>
-=======
-                <item>Built-In Mic</item>
->>>>>>> post_merge/android-11.0.0_2.0.0
             </attachedDevices>
             <defaultOutputDevice>Speaker</defaultOutputDevice>
             <mixPorts>
@@ -79,11 +75,8 @@
                 </devicePort>
                 <devicePort tagName="BT SCO Headset Mic" type="AUDIO_DEVICE_IN_BLUETOOTH_SCO_HEADSET" role="source">
                 </devicePort>
-<<<<<<< HEAD
                 <devicePort tagName="Wired-In Headsets" type="AUDIO_DEVICE_IN_WIRED_HEADSET" role="source">
                 </devicePort>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
             </devicePorts>
             <routes>
                 <route type="mix" sink="Speaker"
@@ -100,11 +93,7 @@
                        sources="bt sco output"/>
 
                 <route type="mix" sink="primary input"
-<<<<<<< HEAD
                        sources="Wired-In Headsets,Built-In Mic,Spdif-In,BT SCO Headset Mic"/>
-=======
-                       sources="Built-In Mic,Spdif-In,BT SCO Headset Mic"/>
->>>>>>> post_merge/android-11.0.0_2.0.0
             </routes>
         </module>
 
diff --git a/imx8m/vp6820_8mq/camera_config_imx8mq.json b/imx8m/vp6820_8mq/camera_config_imx8mq.json
index dc40c5d3..f1709bb6 100644
--- a/imx8m/vp6820_8mq/camera_config_imx8mq.json
+++ b/imx8m/vp6820_8mq/camera_config_imx8mq.json
@@ -11,6 +11,7 @@
     {
       "camera_type": "back",
       "camera_name": "mx6s-csi0",
+      "bus_info": "platform:30b80000.csi2_bridge",
       "orientation": "0",
       "buffer_type": "mmap",
       "ActiveArrayWidth": "2592",
diff --git a/imx8m/vp6820_8mq/camera_config_imx8mq.json~post_merge_android-11.0.0_2.0.0 b/imx8m/vp6820_8mq/camera_config_imx8mq.json~post_merge_android-11.0.0_2.0.0
deleted file mode 100644
index a8bde1a0..00000000
--- a/imx8m/vp6820_8mq/camera_config_imx8mq.json~post_merge_android-11.0.0_2.0.0
+++ /dev/null
@@ -1,41 +0,0 @@
-{
-  "__readme": [
-    "Basic Camera HAL v3 configuration."
-  ],
-
-  "hal_version": "3",
-  "cam_blit_copy": "GPU_3D",
-  "cam_blit_csc": "CPU",
-
-  "camera_metadata": [
-    {
-      "camera_type": "back",
-      "camera_name": "mx6s-csi",
-      "bus_info": "platform:30b80000.csi2_bridge",
-      "orientation": "0",
-      "buffer_type": "mmap",
-      "ActiveArrayWidth": "2592",
-      "ActiveArrayHeight": "1944",
-      "PixelArrayWidth": "2592",
-      "PixelArrayHeight": "1944",
-      "PhysicalWidth": "3.6288",
-      "PhysicalHeight": "2.7216",
-      "FocalLength": "3.37",
-      "MaxJpegSize": "8388608",
-      "MinFrameDuration": "33331760",
-      "MaxFrameDuration": "300000000",
-      "OmitFrame": [
-          {
-              "width": "2592",
-              "height": "1944",
-              "omit_num": "3"
-          },
-          {
-              "width": "1920",
-              "height": "1080",
-              "omit_num": "2"
-          }
-      ]
-    }
-  ]
-}
diff --git a/imx8m/vp6820_8mq/evk_8mq.mk b/imx8m/vp6820_8mq/evk_8mq.mk
deleted file mode 100644
index 186df7ad..00000000
--- a/imx8m/vp6820_8mq/evk_8mq.mk
+++ /dev/null
@@ -1,422 +0,0 @@
-# -------@block_infrastructure-------
-
-CONFIG_REPO_PATH := device/nxp
-CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
-IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
-
-# configs shared between uboot, kernel and Android rootfs
-include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
-
--include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
-include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
-
-# -------@block_common_config-------
-
-# Overrides
-PRODUCT_NAME := evk_8mq
-PRODUCT_DEVICE := evk_8mq
-PRODUCT_MODEL := EVK_8MQ
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-PRODUCT_CHARACTERISTICS := tablet
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# -------@block_treble-------
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-
-# -------@block_power-------
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-PRODUCT_PACKAGES += \
-    android.hardware.power-service.imx
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mq.json
-
-# -------@block_app-------
-#Enable this to choose 32 bit user space build
-IMX8_BUILD_32BIT_ROOTFS := false
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-
-# -------@block_kernel_bootimg-------
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh
-
-# -------@block_storage-------
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
-  PRODUCT_USE_DYNAMIC_PARTITIONS := true
-  BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
-  BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-endif
-
-#Enable this to disable product partition build.
-IMX_NO_PRODUCT_PARTITION := false
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
-  PRODUCT_PACKAGES += imx_ota_postinstall
-
-  AB_OTA_POSTINSTALL_CONFIG += \
-    RUN_POSTINSTALL_vendor=true \
-    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
-    FILESYSTEM_TYPE_vendor=ext4 \
-    POSTINSTALL_OPTIONAL_vendor=false
-
-  PRODUCT_COPY_FILES += \
-    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mq-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
-endif
-
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# -------@block_security-------
-
-# Include keystore attestation keys and certificates.
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
--include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
-endif
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# hardware backed keymaster service
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-# Keymaster HAL
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-# -------@block_audio-------
-# Audio card json
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml
-
-# -------@block_camera-------
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/camera_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mq.json \
-    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-# -------@block_display-------
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# HWC2 HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.composer@2.4-service
-
-# define frame buffer count
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@4.0-impl.imx \
-    android.hardware.graphics.allocator@4.0-service.imx
-
-# RenderScript HAL
-PRODUCT_PACKAGES += \
-    android.hardware.renderscript@1.0-impl
-
-PRODUCT_PACKAGES += \
-        libg2d-opencl
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod \
-    MultiDisplay
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
-
-# -------@block_gpu-------
-PRODUCT_PACKAGES += \
-        libEGL_VIVANTE \
-        libGLESv1_CM_VIVANTE \
-        libGLESv2_VIVANTE \
-        gralloc_viv.$(TARGET_BOARD_PLATFORM) \
-        libGAL \
-        libGLSLC \
-        libVSC \
-        libgpuhelper \
-        libSPIRV_viv \
-        libvulkan_VIVANTE \
-        vulkan.$(TARGET_BOARD_PLATFORM) \
-        libCLC \
-        libLLVM_viv \
-        libOpenCL \
-        libg2d-viv \
-        libOpenVX \
-        libOpenVXU \
-        libNNVXCBinary-evis \
-        libNNVXCBinary-evis2 \
-        libNNVXCBinary-lite \
-        libOvx12VXCBinary-evis \
-        libOvx12VXCBinary-evis2 \
-        libOvx12VXCBinary-lite \
-        libNNGPUBinary-evis \
-        libNNGPUBinary-evis2 \
-        libNNGPUBinary-lite \
-        libNNGPUBinary-ulite \
-        libNNArchPerf \
-        libarchmodelSw
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# GPU openCL SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/CL/cl_sdk.mk
-
-# GPU openVX SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/nnxc_kernels/nnxc_kernels.mk
-
-# GPU openCL icdloader config file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
-
-
-# -------@block_wifi-------
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
-
-# WiFi HAL
-PRODUCT_PACKAGES += \
-    android.hardware.wifi@1.0-service \
-    wificond
-
-# WiFi RRO
-PRODUCT_PACKAGES += \
-    WifiOverlay
-
-# NXP 8997 Wifi and Bluetooth Combo Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf
-
-# Wifi regulatory
-PRODUCT_COPY_FILES += \
-    external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
-    external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
-
-# -------@block_bluetooth-------
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-# NXP 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# -------@block_usb-------
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
-
-# -------@block_multimedia_codec-------
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_PACKAGES += \
-    libg1 \
-    libhantro \
-    libcodec
-
-# imx c2 codec binary
-PRODUCT_PACKAGES += \
-    lib_vpu_wrapper \
-    lib_imx_c2_videodec_common \
-    lib_imx_c2_videodec \
-    lib_imx_c2_vpuwrapper_dec \
-    lib_imx_c2_process \
-    lib_imx_c2_process_dummy_post \
-    c2_component_register \
-    c2_component_register_ms \
-    c2_component_register_wmv9 \
-    c2_component_register_ra \
-    c2_component_register_rv
-
-ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
-ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
-INSTALL_64BIT_LIBRARY := true
-endif
--include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
-endif
-
-# -------@block_neural_network-------
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# -------@block_miscellaneous-------
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
diff --git a/imx8m/vp6820_8mq/evk_8mq_drm.mk b/imx8m/vp6820_8mq/evk_8mq_drm.mk
deleted file mode 100644
index fe4b31ad..00000000
--- a/imx8m/vp6820_8mq/evk_8mq_drm.mk
+++ /dev/null
@@ -1,72 +0,0 @@
-# This is a FSL Android Reference Design platform based on i.MX8MQ board
-# It will inherit from FSL core product which in turn inherit from Google generic
-
-IMX_DEVICE_PATH := device/nxp/imx8m/evk_8mq
-
-PRODUCT_IMX_DRM := true
-
-# copy drm specific files before inherit evk_8mq.mk, otherwise copy is ignored
-PRODUCT_COPY_FILES += \
-	$(IMX_DEVICE_PATH)/audio_policy_configuration_drm.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-	$(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.main.rc \
-	$(IMX_DEVICE_PATH)/init.imx8mq.drm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-	$(TOPDIR)device/nxp/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
-
-
-$(call inherit-product, $(TOPDIR)device/nxp/imx8m/optee-packages.mk)
-$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/evk_8mq.mk)
-
-TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
-
-
-# Overrides
-PRODUCT_NAME := evk_8mq_drm
-
-CFG_DRM_SECURE_DATA_PATH ?= y
-CFG_RDC_SECURE_DATA_PATH ?= y
-
-ifeq ($(CFG_DRM_SECURE_DATA_PATH),y)
-CFG_SECURE_DATA_PATH := y
-SOONG_CONFIG_IMXPLUGIN += CFG_SECURE_DATA_PATH
-SOONG_CONFIG_IMXPLUGIN_CFG_SECURE_DATA_PATH = y
-CFG_TEE_SDP_MEM_BASE := 0xcc000000
-CFG_TEE_SDP_MEM_SIZE := 0x02000000
-ifeq ($(CFG_RDC_SECURE_DATA_PATH),y)
-DECRYPTED_BUFFER_START	:= $(CFG_TEE_SDP_MEM_BASE)
-DECRYPTED_BUFFER_LEN	:= $(CFG_TEE_SDP_MEM_SIZE)
-DECODED_BUFFER_START	:= 0xCE000000
-DECODED_BUFFER_LEN		:= 0x30000000
-endif
-endif
-
-TARGET_BOARD_DTS_CONFIG := imx8mq:imx8mq-evk-drm.dtb imx8mq-mipi:imx8mq-evk-lcdif-adv7535.dtb imx8mq-dual:imx8mq-evk-dual-display.dtb
-
-# Exoplayer
-PRODUCT_PACKAGES += \
-	exoplayer \
-
-# Playready
-PRODUCT_COPY_FILES += \
-	vendor/nxp/drm_artifacts/playready/Samples/devcert.dat:$(TARGET_COPY_OUT_VENDOR)/playready/devcert.dat \
-	vendor/nxp/drm_artifacts/playready/Samples/priv.dat:$(TARGET_COPY_OUT_VENDOR)/playready/priv.dat \
-	vendor/nxp/drm_artifacts/playready/bgroupcert.dat:$(TARGET_COPY_OUT_VENDOR)/playready/bgroupcert.dat \
-	vendor/nxp/drm_artifacts/playready/zgpriv_protected.dat:$(TARGET_COPY_OUT_VENDOR)/playready/zgpriv_protected.dat \
-
-ifneq ($(CFG_BUILD_DRM_FROM_SOURCES),y)
-PRODUCT_COPY_FILES += \
-	vendor/nxp/drm_artifacts/playready/ta/82dbae9c-9ce0-47e0-a1cb4048cfdb84aa.ta:$(TARGET_COPY_OUT_VENDOR)/lib/optee_armtz/82dbae9c-9ce0-47e0-a1cb4048cfdb84aa.ta \
-	vendor/nxp/drm_artifacts/playready/libdrmplayreadyplugin.so:$(TARGET_COPY_OUT_VENDOR)/lib64/mediadrm/libdrmplayreadyplugin.so \
-	vendor/nxp/drm_artifacts/playready/optee_playready_test:$(TARGET_COPY_OUT_VENDOR)/bin/optee_playready_test
-endif
-
-ifneq ($(CFG_BUILD_DRM_FROM_SOURCES),y)
-# Widevine
-PRODUCT_COPY_FILES += \
-	vendor/nxp/drm_artifacts/widevine/lib/liboemcrypto.so:$(TARGET_COPY_OUT_VENDOR)/lib/liboemcrypto.so \
-	vendor/nxp/drm_artifacts/widevine/lib/libwvdrmengine.so:$(TARGET_COPY_OUT_VENDOR)/lib/mediadrm/libwvdrmengine.so \
-	vendor/nxp/drm_artifacts/widevine/lib/libvtswidevine.so:$(TARGET_COPY_OUT_VENDOR)/lib/drm-vts-test-libs/libvtswidevine.so \
-	vendor/nxp/drm_artifacts/widevine/lib64/liboemcrypto.so:$(TARGET_COPY_OUT_VENDOR)/lib64/liboemcrypto.so \
-	vendor/nxp/drm_artifacts/widevine/lib64/libwvdrmengine.so:$(TARGET_COPY_OUT_VENDOR)/lib64/mediadrm/libwvdrmengine.so \
-	vendor/nxp/drm_artifacts/widevine/lib64/libvtswidevine.so:$(TARGET_COPY_OUT_VENDOR)/lib64/drm-vts-test-libs/libvtswidevine.so \
-	vendor/nxp/drm_artifacts/widevine/ta/706f6574-7765-6469-77656e6942656665.ta:$(TARGET_COPY_OUT_VENDOR)/lib/optee_armtz/706f6574-7765-6469-77656e6942656665.ta
-endif
diff --git a/imx8m/vp6820_8mq/fstab.nxp b/imx8m/vp6820_8mq/fstab.nxp
index 1db83d0a..73a34ecf 100644
--- a/imx8m/vp6820_8mq/fstab.nxp
+++ b/imx8m/vp6820_8mq/fstab.nxp
@@ -4,21 +4,12 @@
 # specify MF_CHECK, and must come before any filesystems that do specify MF_CHECK
 
 /devices/platform/soc@0/38200000.usb/* auto auto defaults voldmanaged=usb:auto
-<<<<<<< HEAD
-/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block,metadata_csum
+/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block
 /dev/block/by-name/metadata    /metadata    ext4    noatime,nosuid,nodev,discard,sync                                                wait,formattable,first_stage_mount,check
 /dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
 /dev/block/by-name/idtechdata  /mnt/vendor/idtechdata  ext4    nosuid,nodev,noatime,barrier=1                       wait,formattable
 /dev/block/zram0 none swap defaults zramsize=629145600
 /tmp /sdcard none defaults,bind recoveryonly
 
-/devices/platform/soc@0/soc@0:bus@30800000/30b50000.mmc/mmc_host* /storage/sdcard1 vfat nosuid,nodev wait,voldmanaged=sdcard1:auto,encryptable=footer
+/devices/platform/soc@0/30800000.bus/30b50000.mmc/mmc_host* /storage/sdcard1 vfat nosuid,nodev wait,voldmanaged=sdcard1:auto,encryptable=footer
 /devices/platform/soc@0/38100000.usb/* auto auto defaults voldmanaged=usb:auto
-=======
-/dev/block/by-name/userdata    /data        ext4    nosuid,nodev,nodiratime,noatime,noauto_da_alloc,errors=panic    latemount,wait,formattable,quota,fileencryption=aes-256-xts:aes-256-cts:v2,keydirectory=/metadata/vold/metadata_encryption,reservedsize=128M,checkpoint=block
-/dev/block/by-name/metadata    /metadata    ext4    noatime,nosuid,nodev,discard,sync                                                wait,formattable,first_stage_mount,check
-/dev/block/by-name/misc        /misc        emmc    defaults                                                                         defaults
-/dev/block/zram0 none swap defaults zramsize=629145600
-/tmp /sdcard none defaults,bind recoveryonly
-
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mq/init.imx8mq.rc b/imx8m/vp6820_8mq/init.imx8mq.rc
index 71d142d3..25355d09 100755
--- a/imx8m/vp6820_8mq/init.imx8mq.rc
+++ b/imx8m/vp6820_8mq/init.imx8mq.rc
@@ -7,11 +7,7 @@ on early-boot
     write /sys/bus/platform/drivers/galcore/gpu3DMinClock 3
 
     # Set NN reject model by weights md5
-<<<<<<< HEAD
-    setprop WEIGHT_MD5_CHECK 1
-=======
     setprop vendor.MODEL_BLOCK_LEVEL 1
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # change for FSL specific service
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
@@ -23,16 +19,13 @@ on early-boot
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chmod 0440 /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
     chown root system /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
-<<<<<<< HEAD
-
-    # disable 3D composition overlay to fix video rotate problem
-    setprop vendor.hwc.enable.overlay 0
-=======
     chown root system /sys/devices/system/cpu/cpu2/online
     chmod 0664 /sys/devices/system/cpu/cpu2/online
     chown root system /sys/devices/system/cpu/cpu3/online
     chmod 0664 /sys/devices/system/cpu/cpu3/online
->>>>>>> post_merge/android-11.0.0_2.0.0
+
+    # disable 3D composition overlay to fix video rotate problem
+    setprop vendor.hwc.enable.overlay 0
 
 on property:sys.boot_completed=1
     # Set default CPU frequency governor
@@ -59,7 +52,6 @@ on property:sys.boot_completed=1
     # system-background is for system tasks that should only run on
     # little cores, not on bigs to be used only by init
     write /dev/cpuset/system-background/cpus 0-2
-<<<<<<< HEAD
 
 on init
     #IDtech added for AB ota update bootloader
@@ -67,5 +59,3 @@ on init
     symlink   /dev/block/mmcblk0boot1p1   /dev/block/by-name/spl_b
     symlink   /dev/block/mmcblk0boot0p2   /dev/block/by-name/spl_bak_a
     symlink   /dev/block/mmcblk0boot1p2   /dev/block/by-name/spl_bak_b
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mq/init.rc b/imx8m/vp6820_8mq/init.rc
index b7576d5e..f6b092a6 100644
--- a/imx8m/vp6820_8mq/init.rc
+++ b/imx8m/vp6820_8mq/init.rc
@@ -1,9 +1,6 @@
 import /vendor/etc/init/hw/init.${ro.hardware}.usb.rc
 import /vendor/etc/init/hw/init.${ro.hardware}.${ro.boot.soc_type}.rc
-<<<<<<< HEAD
 import /product/etc/init/hw/init.idt.common.rc
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 service vendor.charger /system/bin/charger
     class charger
@@ -25,11 +22,7 @@ on early-init
 on early-init
     start early_init_sh
     # Set the host name which used in console
-<<<<<<< HEAD
     export HOSTNAME vp6820_8mq
-=======
-    export HOSTNAME evk_8mq
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Due keymaster start very early so set prop here
     # Also gatekeeper share same role for keymaster
@@ -51,14 +44,6 @@ on init && property:vendor.skip.charger_not_need=0
     symlink /sdcard /mnt/sdcard
     symlink /sdcard /storage/sdcard0
 
-<<<<<<< HEAD
-    # setup the global environment
-    export CORE_REGISTER_FILE /vendor/etc/core_register
-    export COMPONENT_REGISTER_FILE /vendor/etc/component_register
-    export CONTENTPIPE_REGISTER_FILE /vendor/etc/contentpipe_register
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     # disable cursor blink for fbcon, if no splash screen support
     write /sys/class/graphics/fbcon/cursor_blink 0
 
@@ -99,65 +84,38 @@ on late-fs && property:vendor.storageproxyd=trusty && property:vendor.skip.charg
     start vendor.oemlock-1-0
 
 on early-boot && property:vendor.skip.charger_not_need=0
-    # For evk_8mq, when swap used about 400M, upgrade the level.
+    # For vp6820_8mq, when swap used about 400M, upgrade the level.
     setprop ro.lmk.upgrade_pressure 87
     setprop ro.lmk.downgrade_pressure 95
     setprop ro.lmk.critical_upgrade true
 
-<<<<<<< HEAD
-    # Set permission for IIM node
-    symlink /dev/mxs_viim /dev/mxc_mem
-
-    setprop sys.hwc.disable     1
-    setprop vendor.2d.composition 0
-    setprop hwc.stretch.filter  1
-
-    #viv sdk dir
-    setprop VIVANTE_SDK_DIR /vendor/etc/viv_sdk
-=======
     setprop vendor.sys.hwc.disable     1
     setprop vendor.2d.composition 0
     setprop vendor.hwc.stretch.filter  1
 
     #viv sdk dir
     setprop vendor.VIVANTE_SDK_DIR /vendor/etc/viv_sdk
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # fsl omx graphic manager media framework property
     setprop vendor.rw.VIDEO_RENDER_NAME video_render.surface
     setprop vendor.media.fsl_codec.flag 7
 
     setprop camera.disable_zsl_mode 1
-<<<<<<< HEAD
     setprop back_camera_name mx6s-csi0
     setprop back_camera_orient 0
     setprop front_camera_name mx6s-csi1
     setprop front_camera_orient 0
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
    # Tweak the mmc device read ahead buffer size
     write /sys/block/mmcblk0/queue/read_ahead_kb 2048
     write /sys/block/mmcblk1/queue/read_ahead_kb 2048
 
-<<<<<<< HEAD
     # Wifi firmware reload path
     chown wifi wifi /sys/module/brcmfmac/parameters/alternative_fw_path
 
     # Prepare for wifi
     setprop wifi.interface wlan0
 
-    # Prepare for bluetooth
-    chmod 665 /sys/class/rfkill/rfkill0/state
-    chown bluetooth bluetooth /sys/class/rfkill/rfkill0/state
-    write /sys/class/rfkill/rfkill0/state 0
-=======
-    # Prepare for wifi
-    setprop wifi.interface wlan0
-    setprop wifi.direct.interface p2p0
-    setprop wifi.concurrent.interface wlan1
->>>>>>> post_merge/android-11.0.0_2.0.0
-
     # Disable surfaceflinger back pressure propagate
     setprop debug.sf.disable_backpressure 1
 
@@ -169,11 +127,10 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0664 /sys/kernel/debug/sync/sw_sync
 
     # Default backlight device
-<<<<<<< HEAD
-    #setprop vendor.hw.backlight.dev "30a00000.mipi_dsi.0"
+    #setprop vendor.hw.backlight.dev "30a00000.mipi-dsi.0"
     # Chmod/chown FSL specific sys entry
-    #chown system system /sys/class/backlight/30a00000.mipi_dsi.0/brightness
-    #chmod 0660 /sys/class/backlight/30a00000.mipi_dsi.0/brightness
+    #chown system system /sys/class/backlight/30a00000.mipi-dsi.0/brightness
+    #chmod 0660 /sys/class/backlight/30a00000.mipi-dsi.0/brightness
     setprop vendor.hw.backlight.dev "backlight"
     chown system system /sys/class/backlight/backlight/brightness
     chmod 0660 /sys/class/backlight/backlight/brightness
@@ -185,12 +142,6 @@ on early-boot && property:vendor.skip.charger_not_need=0
     chmod 0660 /sys/class/backlight/pwm_2/brightness
     chmod 0660 /sys/class/backlight/pwm_3/brightness
     chmod 0660 /sys/class/backlight/pwm_4/brightness
-=======
-    setprop vendor.hw.backlight.dev "30a00000.mipi-dsi.0"
-    # Chmod/chown FSL specific sys entry
-    chown system system /sys/class/backlight/30a00000.mipi-dsi.0/brightness
-    chmod 0660 /sys/class/backlight/30a00000.mipi-dsi.0/brightness
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     # Set light sensor sysfs path and light sensor threshold lux value
     setprop ro.hardware.lightsensor "/sys/class/i2c-dev/i2c-0/device/0-0044/"
@@ -202,15 +153,9 @@ on early-boot && property:vendor.skip.charger_not_need=0
     # Enlarge limition of audio buffer allocation
     setprop ro.af.client_heap_size_kbyte 32768
 
-<<<<<<< HEAD
-    # enlarge media max memory size to 3G.
-    setprop ro.media.maxmem 3221225471
-
     setprop wifi.direct.interface p2p-dev-wlan0
     start vendor.wifi_hal_legacy
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 on boot && property:vendor.skip.charger_not_need=0
     start audioserver
     start mediadrm
@@ -236,68 +181,19 @@ service sensor_fusion /vendor/bin/fsl_sensor_fusion
     group system uhid
     oneshot
 
-<<<<<<< HEAD
 service vendor.sensors-hal-1-0 /vendor/bin/hw/android.hardware.sensors@1.0-service
     class hal
     user system
     group system wakelock input root
     capabilities BLOCK_SUSPEND SYS_NICE
 
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 # Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
 service watchdogd /system/bin/watchdogd 10 20
     class core
     seclabel u:r:watchdogd:s0
 
-<<<<<<< HEAD
-service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_p2p /system/bin/dhcpcd -aABKL
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_eth0 /system/bin/dhcpcd -ABKL eth0
-    class main
-    disabled
-    oneshot
-
-service dhcpcd_bt-pan /system/bin/dhcpcd -ABKL
-    class main
-    disabled
-    oneshot
-
-service iprenew_wlan0 /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_p2p /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-service iprenew_eth0 /system/bin/dhcpcd -n eth0
-    class main
-    disabled
-    oneshot
-
-service iprenew_bt-pan /system/bin/dhcpcd -n
-    class main
-    disabled
-    oneshot
-
-# bugreport is triggered by holding down volume down, volume up and power
-service bugreport /system/bin/dumpstate -d -p -B -z \
-        -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
-=======
 # bugreport is triggered by holding down volume down, volume up and power
 service bugreport /system/bin/dumpstate -d -p -z
->>>>>>> post_merge/android-11.0.0_2.0.0
     class main
     disabled
     oneshot
@@ -313,12 +209,6 @@ on fs && property:vendor.skip.charger_not_need=0
     # Update dm-verity state and set partition.*.verified properties
     verity_update_state
 
-<<<<<<< HEAD
-on verity-logging && property:vendor.skip.charger_not_need=0
-    exec u:r:slideshow:s0 -- /sbin/slideshow warning/verity_red_1 warning/verity_red_2
-
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 on post-fs && property:vendor.skip.charger_not_need=0
     # Set netd memlock rlimit to 8MB
     setrlimit 8 8388608 8388608
@@ -339,11 +229,7 @@ on post-fs-data && property:vendor.skip.charger_not_need=0
     mkdir /data/vendor/ss 0700 system system
 
     # tmp dir for opencl Compiler
-<<<<<<< HEAD
-    setprop TMPDIR /data/vendor/.opencl-cache
-=======
     setprop vendor.TMPDIR /data/vendor/.opencl-cache
->>>>>>> post_merge/android-11.0.0_2.0.0
     mkdir /data/vendor/.opencl-cache 0771 system camera
 
 on zygote-start && property:vendor.skip.charger_not_need=0
diff --git a/imx8m/vp6820_8mq/manifest.xml b/imx8m/vp6820_8mq/manifest.xml
index 69dadc6a..adad2fd1 100644
--- a/imx8m/vp6820_8mq/manifest.xml
+++ b/imx8m/vp6820_8mq/manifest.xml
@@ -1,18 +1,10 @@
-<<<<<<< HEAD
-<manifest version="1.0" type="device" target-level="4">
-=======
 <manifest version="1.0" type="device" target-level="5">
->>>>>>> post_merge/android-11.0.0_2.0.0
     <kernel  target-level="5" />
     <hal format="hidl">
 	<name>android.hardware.graphics.allocator</name>
         <transport>hwbinder</transport>
 	<impl level="generic"></impl>
-<<<<<<< HEAD
-	<version>2.0</version>
-=======
 	<version>4.0</version>
->>>>>>> post_merge/android-11.0.0_2.0.0
 	<interface>
 	    <name>IAllocator</name>
 	    <instance>default</instance>
@@ -44,23 +36,12 @@
     <hal format="hidl">
         <name>android.hardware.drm</name>
         <transport>hwbinder</transport>
-<<<<<<< HEAD
-        <version>1.0</version>
-        <interface>
-            <name>ICryptoFactory</name>
-            <instance>default</instance>
-        </interface>
-        <interface>
-            <name>IDrmFactory</name>
-            <instance>default</instance>
-=======
         <version>1.3</version>
         <interface>
             <name>ICryptoFactory</name>
         </interface>
         <interface>
             <name>IDrmFactory</name>
->>>>>>> post_merge/android-11.0.0_2.0.0
         </interface>
         <fqname>@1.3::ICryptoFactory/clearkey</fqname>
         <fqname>@1.3::IDrmFactory/clearkey</fqname>
@@ -78,11 +59,7 @@
         <name>android.hardware.graphics.mapper</name>
         <transport arch="32+64">passthrough</transport>
         <impl level="generic"></impl>
-<<<<<<< HEAD
-        <version>2.1</version>
-=======
         <version>4.0</version>
->>>>>>> post_merge/android-11.0.0_2.0.0
         <interface>
             <name>IMapper</name>
             <instance>default</instance>
@@ -98,7 +75,6 @@
         </interface>
     </hal>
     <hal format="hidl">
-<<<<<<< HEAD
         <name>android.hardware.sensors</name>
         <transport>hwbinder</transport>
         <version>1.0</version>
@@ -108,17 +84,6 @@
         </interface>
     </hal>
     <hal format="hidl">
-        <name>android.hardware.configstore</name>
-        <transport>hwbinder</transport>
-        <version>1.1</version>
-        <interface>
-            <name>ISurfaceFlingerConfigs</name>
-            <instance>default</instance>
-        </interface>
-    </hal>
-    <hal format="hidl">
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
         <name>android.hardware.media.c2</name>
         <transport>hwbinder</transport>
         <version>1.0</version>
@@ -140,23 +105,6 @@
             <instance>default</instance>
         </interface>
     </hal>
-    <hal format="hidl">
-<<<<<<< HEAD
-        <name>android.hardware.light</name>
-        <transport>hwbinder</transport>
-        <version>2.0</version>
-        <interface>
-            <name>ILight</name>
-=======
-        <name>android.hardware.memtrack</name>
-        <transport>hwbinder</transport>
-        <version>1.0</version>
-        <interface>
-            <name>IMemtrack</name>
->>>>>>> post_merge/android-11.0.0_2.0.0
-            <instance>default</instance>
-        </interface>
-    </hal>
     <hal format="hidl">
         <name>android.hardware.audio</name>
         <transport>hwbinder</transport>
diff --git a/imx8m/vp6820_8mq/overlay/frameworks/base/core/res/res/values/config.xml b/imx8m/vp6820_8mq/overlay/frameworks/base/core/res/res/values/config.xml
index d209ca63..a8d9f4d6 100644
--- a/imx8m/vp6820_8mq/overlay/frameworks/base/core/res/res/values/config.xml
+++ b/imx8m/vp6820_8mq/overlay/frameworks/base/core/res/res/values/config.xml
@@ -72,16 +72,12 @@
          before automatically restore the default connection.  Set -1 if the connection
          does not require auto-restore. -->
     <!-- the 6th element indicates boot-time dependency-met value. -->
-<<<<<<< HEAD
 <!--
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
     <string-array translatable="false" name="networkAttributes">
         <item>"wifi,1,1,1,-1,true"</item>
         <item>"bluetooth,7,7,2,-1,true"</item>
         <item>"ethernet,9,9,2,-1,true"</item>
     </string-array>
-<<<<<<< HEAD
 -->
     <string-array translatable="false" name="networkAttributes">
         <item>"wifi,1,1,1,-1,true"</item>
@@ -97,8 +93,6 @@
         <item>"mobile_ia,14,0,2,-1,true"</item>
         <item>"mobile_emergency,15,0,2,-1,true"</item>
     </string-array>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 
     <!-- Array of light sensor LUX values to define our levels for auto backlight brightness support.
          The N entries of this array define N + 1 zones as follows:
@@ -212,11 +206,8 @@
 
     <!-- If the system has the input method for each display - enable per-display focus. -->
     <bool name="config_perDisplayFocusEnabled">true</bool>
-<<<<<<< HEAD
 
     <!-- The default gravity for the picture-in-picture window.
          Currently, this maps to Gravity.TOP | Gravity.RIGHT -->
     <integer name="config_defaultPictureInPictureGravity">0x35</integer>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </resources>
diff --git a/imx8m/vp6820_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml b/imx8m/vp6820_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
index 87976f74..0bf9ee21 100644
--- a/imx8m/vp6820_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
+++ b/imx8m/vp6820_8mq/overlay/frameworks/base/packages/SettingsProvider/res/values/defaults.xml
@@ -21,8 +21,5 @@
     <bool name="def_user_setup_complete">true</bool>
     <bool name="def_bluetooth_on">false</bool>
     <bool name="def_stay_on_while_plugged_in">true</bool>
-<<<<<<< HEAD
     <string name="def_immersive_mode_confirmations" translatable="false">confirmed</string>
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
 </resources>
diff --git a/imx8m/vp6820_8mq/powerhint_imx8mq.json b/imx8m/vp6820_8mq/powerhint_imx8mq.json
index 275fa309..3d7db6ab 100644
--- a/imx8m/vp6820_8mq/powerhint_imx8mq.json
+++ b/imx8m/vp6820_8mq/powerhint_imx8mq.json
@@ -47,11 +47,7 @@
       "Name": "PowerHALMainState",
       "Path": "vendor.powerhal.camera",
       "Values": [
-<<<<<<< HEAD
-        "CAMERA_STREAMING",
-=======
         "CAMERA_STREAMING_MID",
->>>>>>> post_merge/android-11.0.0_2.0.0
         ""
       ],
       "Type": "Property"
@@ -60,11 +56,7 @@
       "Name": "PowerHALAudioState",
       "Path": "vendor.powerhal.audio",
       "Values": [
-<<<<<<< HEAD
-        "AUDIO_LOW_LATENCY",
-=======
         "AUDIO_STREAMING_LOW_LATENCY",
->>>>>>> post_merge/android-11.0.0_2.0.0
         ""
       ],
       "Type": "Property"
@@ -141,15 +133,6 @@
       "Value": "0"
     },
     {
-<<<<<<< HEAD
-      "PowerHint": "CAMERA_STREAMING",
-      "Node": "PowerHALMainState",
-      "Duration": 0,
-      "Value": "CAMERA_STREAMING"
-    },
-    {
-      "PowerHint": "CAMERA_STREAMING",
-=======
       "PowerHint": "CAMERA_STREAMING_MID",
       "Node": "PowerHALMainState",
       "Duration": 0,
@@ -157,7 +140,6 @@
     },
     {
       "PowerHint": "CAMERA_STREAMING_MID",
->>>>>>> post_merge/android-11.0.0_2.0.0
       "Node": "CPULittleClusterMaxFreq",
       "Duration": 0,
       "Value": "1300000"
@@ -193,30 +175,6 @@
       "Value": "1300000"
     },
     {
-<<<<<<< HEAD
-      "PowerHint": "AUDIO_STREAMING",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 2000,
-      "Value": "0"
-    },
-    {
-      "PowerHint": "AUDIO_STREAMING",
-      "Node": "CPULittleClusterMinFreq",
-      "Duration": 2000,
-      "Value": "1000000"
-    },
-    {
-      "PowerHint": "AUDIO_LOW_LATENCY",
-      "Node": "PowerHALAudioState",
-      "Duration": 0,
-      "Value": "AUDIO_LOW_LATENCY"
-    },
-    {
-      "PowerHint": "AUDIO_LOW_LATENCY",
-      "Node": "PMQoSCpuDmaLatency",
-      "Duration": 0,
-      "Value": "0"
-=======
       "PowerHint": "AUDIO_STREAMING_LOW_LATENCY",
       "Node": "PowerHALAudioState",
       "Duration": 0,
@@ -239,7 +197,6 @@
       "Node": "CPULittleClusterMinFreq",
       "Duration": 0,
       "Value": "1300000"
->>>>>>> post_merge/android-11.0.0_2.0.0
     }
   ]
 }
diff --git a/imx8m/vp6820_8mq/sepolicy/file_contexts b/imx8m/vp6820_8mq/sepolicy/file_contexts
index b3f52b97..ba4f0809 100644
--- a/imx8m/vp6820_8mq/sepolicy/file_contexts
+++ b/imx8m/vp6820_8mq/sepolicy/file_contexts
@@ -1,50 +1,3 @@
-<<<<<<< HEAD
-#sd boot
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/misc        u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/metadata    u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/presistdata u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/userdata    u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/vbmeta_[ab]    u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/super            u:object_r:super_block_device:s0
-
-#emmc boot
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/dtbo_[ab]        u:object_r:dtbo_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/boot_[ab]        u:object_r:boot_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/system_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/vendor_[ab]      u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/product_[ab]     u:object_r:system_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/misc             u:object_r:misc_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/metadata         u:object_r:metadata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/presistdata      u:object_r:frp_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/userdata         u:object_r:userdata_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/vbmeta_[ab]      u:object_r:vbmeta_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/super            u:object_r:super_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/bootloader_[ab]  u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/mem_info_[ab]    u:object_r:bootloader_block_device:s0
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/idtechdata       u:object_r:idtechdata_block_device:s0
-
-# spl
-/dev/block/mmcblk0boot[01]            u:object_r:spl_block_device:s0
-/dev/block/mmcblk0boot[01]p[1-9]      u:object_r:spl_block_device:s0
-
-#peripheral
-/vendor/bin/magd                u:object_r:sensors_exec:s0
-/vendor/bin/fsl_sensor_fusion   u:object_r:sensors_exec:s0
-/dev/mma8x5x                    u:object_r:sensors_device:s0
-/dev/ttymxc[0-9]*               u:object_r:tty_device:s0
-/dev/FreescaleAccelerometer     u:object_r:sensors_device:s0
-/dev/FreescaleMagnetometer      u:object_r:sensors_device:s0
-/dev/FreescaleGyroscope         u:object_r:sensors_device:s0
-/dev/sda[0-8]*                  u:object_r:fuse:s0
-
-#Neural Network HAL service
-/vendor/bin/hw/android\.hardware\.neuralnetworks@1\.2-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
-=======
 /dev/block/mmcblk0boot0                      u:object_r:emmc_boot0:s0
 /dev/block/mmcblk1                           u:object_r:sdcard:s0
 
@@ -55,7 +8,6 @@
 
 #Neural Network HAL service
 /vendor/bin/hw/android\.hardware\.neuralnetworks@1\.3-service-vsi-npu-server      u:object_r:hal_neuralnetworks_imx_exec:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
 
 #Thermal HAL service
 /vendor/bin/hw/android\.hardware\.thermal@2\.0-service.imx         u:object_r:hal_thermal_default_exec:s0
diff --git a/imx8m/vp6820_8mq/sepolicy/genfs_contexts b/imx8m/vp6820_8mq/sepolicy/genfs_contexts
index dadd5582..4bea6a6c 100644
--- a/imx8m/vp6820_8mq/sepolicy/genfs_contexts
+++ b/imx8m/vp6820_8mq/sepolicy/genfs_contexts
@@ -1,38 +1,3 @@
-<<<<<<< HEAD
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/hctosys     u:object_r:sysfs_rtc:s0
-
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a20000.i2c/i2c-0/0-0050/power_supply u:object_r:sysfs_batteryinfo:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a20000.i2c/i2c-0/0-0050/extcon   u:object_r:sysfs_extcon:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30b40000.mmc/mmc_host/mmc0/mmc0:0001/block/mmcblk0 u:object_r:sysfs_block_devices:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30b50000.mmc/mmc_host/mmc1/mmc1:aaaa/block/mmcblk1 u:object_r:sysfs_block_devices:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30bb0000.spi/spi_master/spi3/spi3.0/mtd/mtd0/mtdblock u:object_r:sysfs_block_devices:s0
-
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a00000.mipi_dsi/30a00000.mipi_dsi.0/backlight u:object_r:sysfs_leds:s0
-genfscon sysfs /devices/platform/backlight/backlight/backlight u:object_r:sysfs_leds:s0
-
-#/sys/class/net
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30be0000.ethernet/net               u:object_r:sysfs_net:s0
-genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net u:object_r:sysfs_net:s0
-genfscon sysfs /devices/platform/soc@0/33c00000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/net u:object_r:sysfs_net:s0
-
-
-# android.system.suspend@1.0-service
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30be0000.ethernet/net/eth0/wakeup0                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30be0000.ethernet/net/eth0/wakeup5                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-powerkey/wakeup                         u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/wakeup                           u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/wakeup2                 u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30000000/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/wakeup3                 u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/battery/wakeup3                                                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/battery/wakeup4                                                                       u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/usb/wakeup4                                                                           u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/virtual/power_supply/usb/wakeup5                                                                           u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a20000.i2c/i2c-0/0-0050/power_supply/tcpm-source-psy-0-0050/wakeup6    u:object_r:sysfs_wakeup:s0
-genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/wakeup/wakeup7                           u:object_r:sysfs_wakeup:s0
-
-# vp6820 chip as external connection
-genfscon sysfs /devices/platform/soc@0/soc@0:bus@30800000/30a40000.i2c/i2c-2/2-0067/extcon   u:object_r:sysfs_extcon:s0
-=======
 genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/hctosys     u:object_r:sysfs_rtc:s0
 
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30a20000.i2c/i2c-0/0-0050/power_supply u:object_r:sysfs_batteryinfo:s0
@@ -49,10 +14,19 @@ genfscon sysfs /devices/platform/soc@0/33c00000.pcie/pci0001:00/0001:00:00.0/000
 
 # android.system.suspend@1.0-service
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30be0000.ethernet/net/eth0/wakeup0                                       u:object_r:sysfs_wakeup:s0
+genfscon sysfs /devices/platform/soc@0/30800000.bus/30be0000.ethernet/net/eth0/wakeup5                                       u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-powerkey/wakeup                         u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-rtc-lp/wakeup                           u:object_r:sysfs_wakeup:s0
+genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/wakeup2                 u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/platform/soc@0/30000000.bus/30370000.snvs/30370000.snvs:snvs-rtc-lp/rtc/rtc0/wakeup3                 u:object_r:sysfs_wakeup:s0
+genfscon sysfs /devices/virtual/power_supply/battery/wakeup3                                                                       u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/virtual/power_supply/battery/wakeup4                                                                       u:object_r:sysfs_wakeup:s0
+genfscon sysfs /devices/virtual/power_supply/usb/wakeup4                                                                           u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/virtual/power_supply/usb/wakeup5                                                                           u:object_r:sysfs_wakeup:s0
 genfscon sysfs /devices/platform/soc@0/30800000.bus/30a20000.i2c/i2c-0/0-0050/power_supply/tcpm-source-psy-0-0050/wakeup6    u:object_r:sysfs_wakeup:s0
->>>>>>> post_merge/android-11.0.0_2.0.0
+genfscon sysfs /devices/platform/soc@0/33800000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/wakeup/wakeup7                           u:object_r:sysfs_wakeup:s0
+
+# vp6820 chip as external connection
+genfscon sysfs /devices/platform/soc@0/30800000.bus/30a40000.i2c/i2c-2/2-0067/extcon   u:object_r:sysfs_extcon:s0
+
+genfscon sysfs /devices/platform/backlight/backlight/backlight u:object_r:sysfs_leds:s0
diff --git a/imx8m/vp6820_8mq/thermal_info_config_imx8mq.json b/imx8m/vp6820_8mq/thermal_info_config_imx8mq.json
index 0702f138..758490bf 100755
--- a/imx8m/vp6820_8mq/thermal_info_config_imx8mq.json
+++ b/imx8m/vp6820_8mq/thermal_info_config_imx8mq.json
@@ -1,28 +1,18 @@
 {
-<<<<<<< HEAD
-=======
     "HotplugCPUs":[
             "cpu2",
             "cpu3"
     ],
->>>>>>> post_merge/android-11.0.0_2.0.0
     "Sensors":[
         {
             "Name":"cpu-thermal",
             "Type":"CPU",
             "HotThreshold":[
                 "NAN",
-<<<<<<< HEAD
-                "NAN",
-                "NAN",
-                85.0,
-                95.0,
-=======
                 80.0,
                 82.0,
                 86.0,
                 90.0,
->>>>>>> post_merge/android-11.0.0_2.0.0
                 "NAN",
                 "NAN"
             ],
diff --git a/imx8m/vp6820_8mq/ueventd.nxp.rc b/imx8m/vp6820_8mq/ueventd.nxp.rc
index 2da5c2e4..9fbc97c6 100644
--- a/imx8m/vp6820_8mq/ueventd.nxp.rc
+++ b/imx8m/vp6820_8mq/ueventd.nxp.rc
@@ -1,18 +1,9 @@
-<<<<<<< HEAD
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b50000\.mmc/by-name/presistdata 0600   system     system
-/dev/block/platform/soc@0/soc@0\:bus@30800000/30b40000\.mmc/by-name/presistdata 0600   system     system
-/dev/ttymxc1              0660   bluetooth  bluetooth
-/dev/snd/*                0660   system     audio
-/dev/video*               0660   system     camera
-/dev/mxc_hantro           0660   media      drmrpc
-=======
 /dev/block/by-name/presistdata 0600   system     system
-/dev/ttymxc2              0660   bluetooth  bluetooth
+/dev/ttymxc1              0660   bluetooth  bluetooth
 /dev/snd/*                0660   system     audio
 /dev/video*               0660   system     camera
 /dev/mxc_hantro           0666   media      drmrpc
 /dev/vsi_daemon_ctrl      0666   media      drmrpc
->>>>>>> post_merge/android-11.0.0_2.0.0
 /dev/imxdpu               0660   media      drmrpc
 /dev/ion                  0666   media      drmrpc
 /dev/galcore              0666 	 system     graphics
@@ -26,12 +17,9 @@
 
 /sys/devices/virtual/thermal/thermal_zone* trip_point_0_hyst 0660 system system
 /sys/devices/virtual/thermal/thermal_zone* trip_point_1_hyst 0660 system system
-<<<<<<< HEAD
 
 #quectel port
 /dev/ttyUSB*              0660   radio        radio
 /dev/cdc-wdm*             0660   radio        radio
 /dev/qcqmi*               0660   radio        radio
 /dev/cdc-acm*             0660   radio        radio
-=======
->>>>>>> post_merge/android-11.0.0_2.0.0
diff --git a/imx8m/vp6820_8mq/vp6820_8mq.mk b/imx8m/vp6820_8mq/vp6820_8mq.mk
index 6bb6686a..9e46e986 100644
--- a/imx8m/vp6820_8mq/vp6820_8mq.mk
+++ b/imx8m/vp6820_8mq/vp6820_8mq.mk
@@ -1,433 +1,10 @@
-<<<<<<< HEAD
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mq
-$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mq_common.mk)
-
-# Overrides
-PRODUCT_NAME := vp6820_8mq
-=======
-# -------@block_infrastructure-------
-
-CONFIG_REPO_PATH := device/nxp
+CONFIG_REPO_PATH := device/idtech
 CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
 IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
-
-# configs shared between uboot, kernel and Android rootfs
-include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
-
--include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
-include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
-
-# -------@block_common_config-------
+$(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mq_common.mk)
 
 # Overrides
-PRODUCT_NAME := evk_8mq
-PRODUCT_DEVICE := evk_8mq
-PRODUCT_MODEL := EVK_8MQ
-
-TARGET_BOOTLOADER_BOARD_NAME := EVK
-
-PRODUCT_CHARACTERISTICS := tablet
-
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
-
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# -------@block_treble-------
-PRODUCT_FULL_TREBLE_OVERRIDE := true
-
-# -------@block_power-------
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
-PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
-
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
-
-PRODUCT_PACKAGES += \
-    android.hardware.power-service.imx
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mq.json
-
-# -------@block_app-------
-#Enable this to choose 32 bit user space build
-IMX8_BUILD_32BIT_ROOTFS := false
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-
-# -------@block_kernel_bootimg-------
-# Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
-TARGET_USE_VENDOR_BOOT ?= true
-
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
-endif
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh
-
-# -------@block_storage-------
-#Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
-TARGET_USE_DYNAMIC_PARTITIONS ?= true
-
-ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
-  $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
-  PRODUCT_USE_DYNAMIC_PARTITIONS := true
-  BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
-  BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-endif
-
-#Enable this to disable product partition build.
-IMX_NO_PRODUCT_PARTITION := false
-
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
-
-TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
-
-ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
-  PRODUCT_PACKAGES += imx_ota_postinstall
-
-  AB_OTA_POSTINSTALL_CONFIG += \
-    RUN_POSTINSTALL_vendor=true \
-    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
-    FILESYSTEM_TYPE_vendor=ext4 \
-    POSTINSTALL_OPTIONAL_vendor=false
-
-  PRODUCT_COPY_FILES += \
-    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mq-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
-endif
-
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
-
-# -------@block_security-------
-
-# Include keystore attestation keys and certificates.
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
--include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
-endif
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
-endif
-
-# hardware backed keymaster service
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-# Keymaster HAL
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# new gatekeeper HAL
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
-
-# Add Trusty OS backed gatekeeper and secure storage proxy
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
-
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-# -------@block_audio-------
-# Audio card json
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
-
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml
-
-# -------@block_camera-------
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/camera_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mq.json \
-    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
-
-# -------@block_display-------
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
-
-# HWC2 HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.composer@2.4-service
-
-# define frame buffer count
-PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
-
-# Gralloc HAL
-PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@4.0-impl.imx \
-    android.hardware.graphics.allocator@4.0-service.imx
-
-# RenderScript HAL
-PRODUCT_PACKAGES += \
-    android.hardware.renderscript@1.0-impl
-
-PRODUCT_PACKAGES += \
-        libg2d-opencl
-
-# Multi-Display launcher
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod \
-    MultiDisplay
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
-
-# -------@block_gpu-------
-PRODUCT_PACKAGES += \
-        libEGL_VIVANTE \
-        libGLESv1_CM_VIVANTE \
-        libGLESv2_VIVANTE \
-        gralloc_viv.$(TARGET_BOARD_PLATFORM) \
-        libGAL \
-        libGLSLC \
-        libVSC \
-        libgpuhelper \
-        libSPIRV_viv \
-        libvulkan_VIVANTE \
-        vulkan.$(TARGET_BOARD_PLATFORM) \
-        libCLC \
-        libLLVM_viv \
-        libOpenCL \
-        libg2d-viv \
-        libOpenVX \
-        libOpenVXU \
-        libNNVXCBinary-evis \
-        libNNVXCBinary-evis2 \
-        libNNVXCBinary-lite \
-        libOvx12VXCBinary-evis \
-        libOvx12VXCBinary-evis2 \
-        libOvx12VXCBinary-lite \
-        libNNGPUBinary-evis \
-        libNNGPUBinary-evis2 \
-        libNNGPUBinary-lite \
-        libNNGPUBinary-ulite \
-        libNNArchPerf \
-        libarchmodelSw
-
-# GPU openCL g2d
-PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
-
-# GPU openCL SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/CL/cl_sdk.mk
-
-# GPU openVX SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/nnxc_kernels/nnxc_kernels.mk
-
-# GPU openCL icdloader config file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
-
-
-# -------@block_wifi-------
-PRODUCT_COPY_FILES += \
-    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    $(CONFIG_REPO_PATH)/common/wifi/wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
-
-# WiFi HAL
-PRODUCT_PACKAGES += \
-    android.hardware.wifi@1.0-service \
-    wificond
-
-# WiFi RRO
-PRODUCT_PACKAGES += \
-    WifiOverlay
-
-# NXP 8997 Wifi and Bluetooth Combo Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/nxp/FwImage_8997/pcieuart8997_combo_v4.bin:vendor/firmware/pcieuart8997_combo_v4.bin \
-    vendor/nxp/imx-firmware/nxp/android_wifi_mod_para.conf:vendor/firmware/wifi_mod_para.conf
-
-# Wifi regulatory
-PRODUCT_COPY_FILES += \
-    external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
-    external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
-
-# -------@block_bluetooth-------
-# Bluetooth HAL
-PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
-
-# NXP 8997 Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# -------@block_usb-------
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
-
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
-
-# -------@block_multimedia_codec-------
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
-
-PRODUCT_PACKAGES += \
-    libg1 \
-    libhantro \
-    libcodec
-
-# imx c2 codec binary
-PRODUCT_PACKAGES += \
-    lib_vpu_wrapper \
-    lib_imx_c2_videodec_common \
-    lib_imx_c2_videodec \
-    lib_imx_c2_vpuwrapper_dec \
-    lib_imx_c2_process \
-    lib_imx_c2_process_dummy_post \
-    c2_component_register \
-    c2_component_register_ms \
-    c2_component_register_wmv9 \
-    c2_component_register_ra \
-    c2_component_register_rv
-
-ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
-ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
-INSTALL_64BIT_LIBRARY := true
-endif
--include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
-endif
-
-# -------@block_neural_network-------
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
-
-# Tensorflow lite camera demo
-PRODUCT_PACKAGES += \
-                    tflitecamerademo
-
-# -------@block_miscellaneous-------
-
-# Copy device related config and binary to board
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
-
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
-
->>>>>>> post_merge/android-11.0.0_2.0.0
+PRODUCT_NAME := vp6820_8mq
diff --git a/imx8m/vp6820_8mq/vp6820_8mq_common.mk b/imx8m/vp6820_8mq/vp6820_8mq_common.mk
index 23325d87..39af2e44 100644
--- a/imx8m/vp6820_8mq/vp6820_8mq_common.mk
+++ b/imx8m/vp6820_8mq/vp6820_8mq_common.mk
@@ -1,231 +1,275 @@
-# This is a FSL Android Reference Design platform based on i.MX8QP ARD board
-# It will inherit from FSL core product which in turn inherit from Google generic
+# -------@block_infrastructure-------
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 
 # configs shared between uboot, kernel and Android rootfs
 include $(IMX_DEVICE_PATH)/SharedBoardConfig.mk
 
--include device/idtech/common/imx_path/ImxPathConfig.mk
-include device/idtech/imx8m/ProductConfigCommon.mk
+-include $(CONFIG_REPO_PATH)/common/imx_path/ImxPathConfig.mk
+include $(CONFIG_REPO_PATH)/imx8m/ProductConfigCommon.mk
 
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab_nand.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab_nand.nxp)
-endif
-
-ifneq ($(wildcard $(IMX_DEVICE_PATH)/fstab.nxp),)
-$(shell touch $(IMX_DEVICE_PATH)/fstab.nxp)
-endif
+# -------@block_common_config-------
 
 # Overrides
 PRODUCT_NAME := vp6820_8mq
 PRODUCT_DEVICE := vp6820_8mq
 PRODUCT_MODEL := VP6820_8MQ
 
+TARGET_BOOTLOADER_BOARD_NAME := EVK
+
+PRODUCT_CHARACTERISTICS := tablet
+
+DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
+
+PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
+
+# -------@block_treble-------
 PRODUCT_FULL_TREBLE_OVERRIDE := true
+
+# -------@block_power-------
 PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/power
 PRODUCT_SOONG_NAMESPACES += hardware/google/pixel
 
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
+
+# Charger Mode
+PRODUCT_PRODUCT_PROPERTIES += \
+    ro.charger.no_ui=false
+
+# Do not skip charger_not_need trigger by default
+PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
+    vendor.skip.charger_not_need=0
+
+PRODUCT_PACKAGES += \
+    android.hardware.power-service.imx
+
+# Thermal HAL
+PRODUCT_PACKAGES += \
+    android.hardware.thermal@2.0-service.imx
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/thermal_info_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mq.json
+
+# -------@block_app-------
 #Enable this to choose 32 bit user space build
-#IMX8_BUILD_32BIT_ROOTFS := true
+IMX8_BUILD_32BIT_ROOTFS := false
 
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
+    $(CONFIG_REPO_PATH)/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
+    $(CONFIG_REPO_PATH)/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
+    $(CONFIG_REPO_PATH)/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
+
+# -------@block_kernel_bootimg-------
 # Enable this to support vendor boot and boot header v3, this would be a MUST for GKI
 TARGET_USE_VENDOR_BOOT ?= true
 
+# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
+# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
+# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
+ifeq ($(TARGET_USE_VENDOR_BOOT),true)
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
+endif
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
+    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
+    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
+    $(CONFIG_REPO_PATH)/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh
+
+# -------@block_storage-------
 #Enable this to use dynamic partitions for the readonly partitions not touched by bootloader
 TARGET_USE_DYNAMIC_PARTITIONS ?= true
-#If the device is retrofit to have dynamic partition feature, set this variable to true to build
-#the images and OTA package. Here is a demo to update 10.0.0_1.0.0 to 10.0.0_2.0.0 or higher
-TARGET_USE_RETROFIT_DYNAMIC_PARTITION ?= false
 
 ifeq ($(TARGET_USE_DYNAMIC_PARTITIONS),true)
   $(call inherit-product, $(SRC_TARGET_DIR)/product/virtual_ab_ota.mk)
   PRODUCT_USE_DYNAMIC_PARTITIONS := true
   BOARD_BUILD_SUPER_IMAGE_BY_DEFAULT := true
   BOARD_SUPER_IMAGE_IN_UPDATE_PACKAGE := true
-  ifeq ($(TARGET_USE_RETROFIT_DYNAMIC_PARTITION),true)
-    PRODUCT_RETROFIT_DYNAMIC_PARTITIONS := true
-    BOARD_SUPER_PARTITION_METADATA_DEVICE := system
-    ifeq ($(IMX_NO_PRODUCT_PARTITION),true)
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 2952790016
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-    else
-      BOARD_SUPER_PARTITION_BLOCK_DEVICES := system vendor product
-      BOARD_SUPER_PARTITION_SYSTEM_DEVICE_SIZE := 1610612736
-      BOARD_SUPER_PARTITION_VENDOR_DEVICE_SIZE := 536870912
-      BOARD_SUPER_PARTITION_PRODUCT_DEVICE_SIZE := 1879048192
-    endif
-  endif
 endif
 
+#Enable this to disable product partition build.
+IMX_NO_PRODUCT_PARTITION := false
+
+$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp
+
+TARGET_RECOVERY_FSTAB = $(IMX_DEVICE_PATH)/fstab.nxp
+
+ifneq ($(filter TRUE true 1,$(IMX_OTA_POSTINSTALL)),)
+  PRODUCT_PACKAGES += imx_ota_postinstall
+
+  AB_OTA_POSTINSTALL_CONFIG += \
+    RUN_POSTINSTALL_vendor=true \
+    POSTINSTALL_PATH_vendor=bin/imx_ota_postinstall \
+    FILESYSTEM_TYPE_vendor=ext4 \
+    POSTINSTALL_OPTIONAL_vendor=false
+
+  PRODUCT_COPY_FILES += \
+    $(OUT_DIR)/target/product/$(firstword $(PRODUCT_DEVICE))/obj/UBOOT_COLLECTION/u-boot-imx8mq-trusty.imx:$(TARGET_COPY_OUT_VENDOR)/etc/bootloader0.img
+endif
+
+# fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
+    $(CONFIG_REPO_PATH)/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
+    $(CONFIG_REPO_PATH)/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
+    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
+    $(CONFIG_REPO_PATH)/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
+
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
+    $(CONFIG_REPO_PATH)/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt
+
+# -------@block_security-------
+
 # Include keystore attestation keys and certificates.
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
 -include $(IMX_SECURITY_PATH)/attestation/imx_attestation.mk
 endif
 
-# Copy device related config and binary to board
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
 PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/app_whitelist.xml:system/etc/sysconfig/app_whitelist.xml \
-    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
-    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
-    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR)/etc/fstab.nxp \
-    $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
-    $(IMX_DEVICE_PATH)/early.init.cfg:$(TARGET_COPY_OUT_VENDOR)/etc/early.init.cfg \
-    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
-    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc \
-    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml \
-    $(IMX_DEVICE_PATH)/ueventd.nxp.rc:$(TARGET_COPY_OUT_VENDOR)/ueventd.rc \
-    $(LINUX_FIRMWARE_IMX_PATH)/linux-firmware-imx/firmware/sdma/sdma-imx7d.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/imx/sdma/sdma-imx7d.bin \
-    device/idtech/common/init/init.insmod.sh:$(TARGET_COPY_OUT_VENDOR)/bin/init.insmod.sh \
-    device/idtech/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
-    device/idtech/common/wifi/bcm_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf \
-    device/idtech/common/permissions/runtime_allowed.xml:$(TARGET_COPY_OUT_PRODUCT)/etc/permissions/runtime_allowed.xml \
-    device/idtech/common/security/signature_of_signature.public.key:$(TARGET_COPY_OUT_PRODUCT)/etc/security/signature_of_signature.public.key \
-    device/idtech/common/prebuilts/spl_tab.img:$(PRODUCT_OUT)/spl_tab.img \
-    device/idtech/common/prebuilts/mem_info.img:$(PRODUCT_OUT)/mem_info.img \
-    device/idtech/common/prebuilts/mem_info.txt:$(PRODUCT_OUT)/mem_info.txt \
-    device/idtech/imx8m/device_policy.sh:$(TARGET_COPY_OUT_PRODUCT)/etc/init/hw/device_policy.sh
+    $(CONFIG_REPO_PATH)/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
+    $(CONFIG_REPO_PATH)/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
+endif
 
-# We load the fstab from device tree so this is not needed, but since no kernel modules are installed to vendor
-# boot ramdisk so far, we need this step to generate the vendor-ramdisk folder or build process would fail. This
-# can be deleted once we figure out what kernel modules should be put into the vendor boot ramdisk.
-ifeq ($(TARGET_USE_VENDOR_BOOT),true)
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/fstab.nxp:$(TARGET_COPY_OUT_VENDOR_RAMDISK)/first_stage_ramdisk/fstab.nxp
+# hardware backed keymaster service
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
+PRODUCT_PACKAGES += \
+    android.hardware.keymaster@4.0-service.trusty
 endif
 
+# Keymaster HAL
+PRODUCT_PACKAGES += \
+    android.hardware.keymaster@4.0-service-imx
 
-# Audio card json
-PRODUCT_COPY_FILES += \
-    device/idtech/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
-    device/idtech/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
-    device/idtech/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
-    device/idtech/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
-    device/idtech/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
-    device/idtech/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
-    device/idtech/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
-    device/idtech/common/audio-json/tlv320aic3110_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/tlv320aic3110_config.json \
-    device/idtech/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
+# new gatekeeper HAL
+PRODUCT_PACKAGES += \
+    android.hardware.gatekeeper@1.0-service.software-imx
+
+# Add Trusty OS backed gatekeeper and secure storage proxy
 
 ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_COPY_FILES += \
-    device/idtech/common/security/rpmb_key_test.bin:rpmb_key_test.bin \
-    device/idtech/common/security/testkey_public_rsa4096.bin:testkey_public_rsa4096.bin
+PRODUCT_PACKAGES += \
+    android.hardware.gatekeeper@1.0-service.trusty \
+    storageproxyd
 endif
 
-# ONLY devices that meet the CDD's requirements may declare these features
-PRODUCT_COPY_FILES += \
-    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
-    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
-    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
-    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
-    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
-    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
-    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
-    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
-    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
-    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
-    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
-    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
-    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
-    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
-    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
-    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
-    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
-    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
-    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
-    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
-    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
-    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
-    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
-    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
-    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
-    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
-    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
+# Add oem unlocking option in settings.
+PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
 
-# Vendor seccomp policy files for media components:
-PRODUCT_COPY_FILES += \
-    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
-    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
-    device/idtech/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
+ifeq ($(PRODUCT_IMX_TRUSTY),true)
+#Oemlock HAL 1.0 support
+PRODUCT_PACKAGES += \
+    android.hardware.oemlock@1.0-service.imx
+endif
 
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/vp6820_8mq/powerhint_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/powerhint_imx8mq.json
+# Specify rollback index for boot and vbmeta partitions
+ifneq ($(AVB_RBINDEX),)
+BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
+else
+BOARD_AVB_ROLLBACK_INDEX := 0
+endif
 
-# fastboot_imx_flashall scripts, fsl-sdcard-partition script and uuu_imx_android_flash scripts
-PRODUCT_COPY_FILES += \
-    device/idtech/common/tools/fastboot_imx_flashall.bat:fastboot_imx_flashall.bat \
-    device/idtech/common/tools/fastboot_imx_flashall.sh:fastboot_imx_flashall.sh \
-    device/idtech/common/tools/imx-sdcard-partition.sh:imx-sdcard-partition.sh \
-    device/idtech/common/tools/uuu_imx_android_flash.bat:uuu_imx_android_flash.bat \
-    device/idtech/common/tools/uuu_imx_android_flash.sh:uuu_imx_android_flash.sh
+ifneq ($(AVB_BOOT_RBINDEX),)
+BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
+else
+BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
+endif
 
-USE_XML_AUDIO_POLICY_CONF := 1
+$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
 
-DEVICE_PACKAGE_OVERLAYS := $(IMX_DEVICE_PATH)/overlay
+#DRM Widevine 1.2 L3 support
+PRODUCT_PACKAGES += \
+    android.hardware.drm@1.3-service.widevine \
+    android.hardware.drm@1.3-service.clearkey \
+    libwvdrmcryptoplugin \
+    libwvhidl \
+    libwvdrmengine \
 
-PRODUCT_CHARACTERISTICS := tablet
+# -------@block_audio-------
+# Audio card json
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/audio-json/wm8524_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/wm8524_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/spdif_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/spdif_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/cdnhdmi_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/cdnhdmi_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/ak4458_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak4458_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/ak5558_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/ak5558_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/btsco_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/btsco_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/rt5640_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/rt5640_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/tlv320aic3110_config.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/tlv320aic3110_config.json \
+    $(CONFIG_REPO_PATH)/common/audio-json/readme.txt:$(TARGET_COPY_OUT_VENDOR)/etc/configs/audio/readme.txt
 
-PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
+PRODUCT_PACKAGES += \
+    android.hardware.audio@6.0-impl:32 \
+    android.hardware.audio@2.0-service \
+    android.hardware.audio.effect@6.0-impl:32
 
-# GPU openCL g2d
 PRODUCT_COPY_FILES += \
-    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
+    $(IMX_DEVICE_PATH)/audio_effects.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_effects.xml \
+    $(IMX_DEVICE_PATH)/audio_policy_configuration.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml
 
-# GPU openCL SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/CL/cl_sdk.mk
+# -------@block_camera-------
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/camera_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mq.json \
+    $(IMX_DEVICE_PATH)/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
 
-# GPU openVX SDK header file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/nnxc_kernels/nnxc_kernels.mk
+PRODUCT_SOONG_NAMESPACES += hardware/google/camera
+PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
 
-# GPU openCL icdloader config file
--include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
+# -------@block_display-------
+PRODUCT_AAPT_CONFIG += xlarge large tvdpi hdpi xhdpi xxhdpi
 
 # HWC2 HAL
 PRODUCT_PACKAGES += \
     android.hardware.graphics.composer@2.4-service
 
-# Charger Mode
-PRODUCT_PRODUCT_PROPERTIES += \
-    ro.charger.no_ui=false
-
-# Do not skip charger_not_need trigger by default
+# define frame buffer count
 PRODUCT_DEFAULT_PROPERTY_OVERRIDES += \
-    vendor.skip.charger_not_need=0
+    ro.surface_flinger.max_frame_buffer_acquired_buffers=3
 
 # Gralloc HAL
 PRODUCT_PACKAGES += \
-    android.hardware.graphics.mapper@2.0-impl-2.1 \
-    android.hardware.graphics.allocator@2.0-impl \
-    android.hardware.graphics.allocator@2.0-service
+    android.hardware.graphics.mapper@4.0-impl.imx \
+    android.hardware.graphics.allocator@4.0-service.imx
 
 # RenderScript HAL
 PRODUCT_PACKAGES += \
     android.hardware.renderscript@1.0-impl
 
+PRODUCT_PACKAGES += \
+        libg2d-opencl
+
+# Multi-Display launcher
+PRODUCT_PACKAGES += \
+    MultiClientInputMethod
+
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/input-port-associations.xml:$(TARGET_COPY_OUT_VENDOR)/etc/input-port-associations.xml
+
+# -------@block_gpu-------
 PRODUCT_PACKAGES += \
         libEGL_VIVANTE \
         libGLESv1_CM_VIVANTE \
         libGLESv2_VIVANTE \
-        gralloc_viv.imx \
+        gralloc_viv.$(TARGET_BOARD_PLATFORM) \
         libGAL \
         libGLSLC \
         libVSC \
         libgpuhelper \
         libSPIRV_viv \
         libvulkan_VIVANTE \
-        vulkan.imx \
+        vulkan.$(TARGET_BOARD_PLATFORM) \
         libCLC \
         libLLVM_viv \
         libOpenCL \
-        libg2d-opencl \
         libg2d-viv \
         libOpenVX \
         libOpenVXU \
@@ -242,58 +286,39 @@ PRODUCT_PACKAGES += \
         libNNArchPerf \
         libarchmodelSw
 
-PRODUCT_PACKAGES += \
-    android.hardware.audio@6.0-impl:32 \
-    android.hardware.audio@2.0-service \
-    android.hardware.audio.effect@6.0-impl:32 \
-    android.hardware.power@1.3-service.imx \
-    android.hardware.light@2.0-impl \
-    android.hardware.light@2.0-service \
-    android.hardware.sensors@1.0-impl \
-    android.hardware.sensors@1.0-convert \
-    android.hardware.sensors@1.0-service \
-    android.hardware.configstore@1.1-service \
-    configstore@1.1.policy
-
-# Thermal HAL
-PRODUCT_PACKAGES += \
-    android.hardware.thermal@2.0-service.imx
+# GPU openCL g2d
 PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/vp6820_8mq/thermal_info_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/thermal_info_config_imx8mq.json
+    $(IMX_PATH)/imx/opencl-2d/cl_g2d.cl:$(TARGET_COPY_OUT_VENDOR)/etc/cl_g2d.cl
 
-# Neural Network HAL and lib
-PRODUCT_PACKAGES += \
-    libovxlib \
-    libnnrt \
-    android.hardware.neuralnetworks@1.2-service-vsi-npu-server
+# GPU openCL SDK header file
+-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/CL/cl_sdk.mk
 
-# Usb HAL
-PRODUCT_PACKAGES += \
-    android.hardware.usb@1.1-service.imx
+# GPU openVX SDK header file
+-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/include/nnxc_kernels/nnxc_kernels.mk
 
-# Bluetooth HAL
+# GPU openCL icdloader config file
+-include $(FSL_PROPRIETARY_PATH)/fsl-proprietary/gpu-viv/icdloader/icdloader.mk
+
+# -------@block_sensor-------
 PRODUCT_PACKAGES += \
-    android.hardware.bluetooth@1.0-impl \
-    android.hardware.bluetooth@1.0-service
+    android.hardware.sensors@1.0-impl \
+    android.hardware.sensors@1.0-convert \
+    android.hardware.sensors@1.0-service
+
+# -------@block_wifi-------
+PRODUCT_COPY_FILES += \
+    $(CONFIG_REPO_PATH)/common/wifi/p2p_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/p2p_supplicant_overlay.conf \
+    $(CONFIG_REPO_PATH)/common/wifi/bcm_wpa_supplicant_overlay.conf:$(TARGET_COPY_OUT_VENDOR)/etc/wifi/wpa_supplicant_overlay.conf
 
 # WiFi HAL
 PRODUCT_PACKAGES += \
     android.hardware.wifi@1.0-service \
-    wifilogd \
     wificond
 
 # WiFi RRO
 PRODUCT_PACKAGES += \
     WifiOverlay
 
-# BCM Bluetooth vendor config
-PRODUCT_PACKAGES += \
-    bt_vendor.conf
-
-# BCM 1CX Bluetooth Firmware
-PRODUCT_COPY_FILES += \
-    vendor/nxp/imx-firmware/cyw-wifi-bt/1CX_CYW4356/BCM4354A2.1CX.hcd:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/CYW4354A2.1CX.hcd
-
 # BCM 1CX Wifi Firmware
 PRODUCT_COPY_FILES += \
     vendor/nxp/imx-firmware/cyw-wifi-bt/1CX_CYW4356/brcmfmac4356-pcie.bin:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/brcmfmac4356-pcie.bin \
@@ -305,51 +330,35 @@ PRODUCT_COPY_FILES += \
     external/wireless-regdb/regulatory.db:vendor/firmware/regulatory.db \
     external/wireless-regdb/regulatory.db.p7s:vendor/firmware/regulatory.db.p7s
 
-# hardware backed keymaster service
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service.trusty
-endif
-
-PRODUCT_COPY_FILES += \
-    device/idtech/imx8m/vp6820_8mq/camera_config_imx8mq.json:$(TARGET_COPY_OUT_VENDOR)/etc/configs/camera_config_imx8mq.json \
-    device/idtech/imx8m/vp6820_8mq/external_camera_config.xml:$(TARGET_COPY_OUT_VENDOR)/etc/external_camera_config.xml
-
-# Keymaster HAL
-PRODUCT_PACKAGES += \
-    android.hardware.keymaster@4.0-service-imx
-
-# DRM HAL
-TARGET_ENABLE_MEDIADRM_64 := true
+# -------@block_bluetooth-------
+# Bluetooth HAL
 PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service
+    android.hardware.bluetooth@1.0-impl \
+    android.hardware.bluetooth@1.0-service
 
-# new gatekeeper HAL
+# BCM Bluetooth vendor config
 PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.software-imx
+    bt_vendor.conf
 
-# Add Trusty OS backed gatekeeper and secure storage proxy
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-PRODUCT_PACKAGES += \
-    android.hardware.gatekeeper@1.0-service.trusty \
-    storageproxyd
-endif
+# BCM 1CX Bluetooth Firmware
+PRODUCT_COPY_FILES += \
+    vendor/nxp/imx-firmware/cyw-wifi-bt/1CX_CYW4356/BCM4354A2.1CX.hcd:$(TARGET_COPY_OUT_VENDOR)/firmware/brcm/CYW4354A2.1CX.hcd
 
-#Dumpstate HAL 1.1 support
+# -------@block_usb-------
+# Usb HAL
 PRODUCT_PACKAGES += \
-    android.hardware.dumpstate@1.1-service.imx
+    android.hardware.usb@1.1-service.imx
 
-ifeq ($(PRODUCT_IMX_TRUSTY),true)
-#Oemlock HAL 1.0 support
-PRODUCT_PACKAGES += \
-    android.hardware.oemlock@1.0-service.imx
-endif
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/init.usb.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.usb.rc
 
-ifneq ($(BUILD_TARGET_FS),ubifs)
-PRODUCT_PROPERTY_OVERRIDES += \
-    ro.frp.pst=/dev/block/by-name/presistdata
-endif
+# -------@block_multimedia_codec-------
+# Vendor seccomp policy files for media components:
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/seccomp/mediacodec-seccomp.policy:vendor/etc/seccomp_policy/mediacodec.policy \
+    $(IMX_DEVICE_PATH)/seccomp/mediaextractor-seccomp.policy:vendor/etc/seccomp_policy/mediaextractor.policy \
+    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.base.policy:vendor/etc/seccomp_policy/codec2.vendor.base.policy \
+    $(CONFIG_REPO_PATH)/common/seccomp_policy/codec2.vendor.ext.policy:vendor/etc/seccomp_policy/codec2.vendor.ext.policy
 
 PRODUCT_PACKAGES += \
     libg1 \
@@ -370,39 +379,6 @@ PRODUCT_PACKAGES += \
     c2_component_register_ra \
     c2_component_register_rv
 
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
-# Multi-Client IME
-PRODUCT_PACKAGES += \
-    MultiClientInputMethod
-
-# Specify rollback index for boot and vbmeta partitions
-ifneq ($(AVB_RBINDEX),)
-BOARD_AVB_ROLLBACK_INDEX := $(AVB_RBINDEX)
-else
-BOARD_AVB_ROLLBACK_INDEX := 0
-endif
-
-ifneq ($(AVB_BOOT_RBINDEX),)
-BOARD_AVB_BOOT_ROLLBACK_INDEX := $(AVB_BOOT_RBINDEX)
-else
-BOARD_AVB_BOOT_ROLLBACK_INDEX := 0
-endif
-
-#DRM Widevine 1.2 L3 support
-PRODUCT_PACKAGES += \
-    android.hardware.drm@1.0-impl \
-    android.hardware.drm@1.0-service \
-    android.hardware.drm@1.3-service.widevine \
-    android.hardware.drm@1.3-service.clearkey \
-    libwvdrmcryptoplugin \
-    libwvhidl \
-    libwvdrmengine \
-
-IMX-DEFAULT-G2D-LIB := libg2d-viv
-
 ifeq ($(PREBUILT_FSL_IMX_CODEC),true)
 ifneq ($(IMX8_BUILD_32BIT_ROOTFS),true)
 INSTALL_64BIT_LIBRARY := true
@@ -410,12 +386,54 @@ endif
 -include $(FSL_CODEC_PATH)/fsl-codec/fsl-codec.mk
 endif
 
-PRODUCT_SOONG_NAMESPACES += hardware/google/camera
-PRODUCT_SOONG_NAMESPACES += vendor/nxp-opensource/imx/camera
+# -------@block_neural_network-------
+# Neural Network HAL and lib
+PRODUCT_PACKAGES += \
+    libovxlib \
+    libnnrt \
+    android.hardware.neuralnetworks@1.3-service-vsi-npu-server
 
-$(call  inherit-product-if-exists, vendor/nxp-private/security/nxp_security.mk)
+# -------@block_miscellaneous-------
 
-$(call inherit-product, $(SRC_TARGET_DIR)/product/emulated_storage.mk)
+# Copy device related config and binary to board
+PRODUCT_COPY_FILES += \
+    $(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
+    $(IMX_DEVICE_PATH)/init.recovery.nxp.rc:root/init.recovery.nxp.rc \
+    $(IMX_DEVICE_PATH)/init.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.rc \
+    $(IMX_DEVICE_PATH)/required_hardware.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/required_hardware.xml
+
+# ONLY devices that meet the CDD's requirements may declare these features
+PRODUCT_COPY_FILES += \
+    frameworks/native/data/etc/android.hardware.audio.output.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.audio.output.xml \
+    frameworks/native/data/etc/android.hardware.bluetooth_le.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.bluetooth_le.xml \
+    frameworks/native/data/etc/android.hardware.camera.external.xml:vendor/etc/permissions/android.hardware.camera.external.xml \
+    frameworks/native/data/etc/android.hardware.camera.front.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.front.xml \
+    frameworks/native/data/etc/android.hardware.camera.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.camera.xml \
+    frameworks/native/data/etc/android.hardware.ethernet.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.ethernet.xml \
+    frameworks/native/data/etc/android.hardware.screen.landscape.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.landscape.xml \
+    frameworks/native/data/etc/android.hardware.screen.portrait.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.screen.portrait.xml \
+    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.distinct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.distinct.xml \
+    frameworks/native/data/etc/android.hardware.touchscreen.multitouch.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.multitouch.xml \
+    frameworks/native/data/etc/android.hardware.touchscreen.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.touchscreen.xml \
+    frameworks/native/data/etc/android.hardware.usb.accessory.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.accessory.xml \
+    frameworks/native/data/etc/android.hardware.usb.host.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.usb.host.xml \
+    frameworks/native/data/etc/android.hardware.vulkan.level-0.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.level-0.xml \
+    frameworks/native/data/etc/android.hardware.vulkan.version-1_1.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.vulkan.version-1_1.xml \
+    frameworks/native/data/etc/android.software.vulkan.deqp.level-2020-03-01.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.vulkan.deqp.level-2020-03-01.xml \
+    frameworks/native/data/etc/android.hardware.wifi.direct.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.direct.xml \
+    frameworks/native/data/etc/android.hardware.wifi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.xml \
+    frameworks/native/data/etc/android.hardware.wifi.passpoint.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.hardware.wifi.passpoint.xml \
+    frameworks/native/data/etc/android.software.app_widgets.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.app_widgets.xml \
+    frameworks/native/data/etc/android.software.backup.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.backup.xml \
+    frameworks/native/data/etc/android.software.device_admin.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.device_admin.xml \
+    frameworks/native/data/etc/android.software.managed_users.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.managed_users.xml \
+    frameworks/native/data/etc/android.software.midi.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.midi.xml \
+    frameworks/native/data/etc/android.software.print.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.print.xml \
+    frameworks/native/data/etc/android.software.sip.voip.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.sip.voip.xml \
+    frameworks/native/data/etc/android.software.verified_boot.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.verified_boot.xml \
+    frameworks/native/data/etc/android.software.voice_recognizers.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.voice_recognizers.xml \
+    frameworks/native/data/etc/android.software.activities_on_secondary_displays.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.activities_on_secondary_displays.xml \
+    frameworks/native/data/etc/android.software.picture_in_picture.xml:$(TARGET_COPY_OUT_VENDOR)/etc/permissions/android.software.picture_in_picture.xml
 
 # Copy Quectel vendor RIL
 PRODUCT_COPY_FILES += \
diff --git a/imx8m/vp6820_8mq/vp6820_8mq_drm.mk b/imx8m/vp6820_8mq/vp6820_8mq_drm.mk
index 495b2ca0..4c1302c2 100644
--- a/imx8m/vp6820_8mq/vp6820_8mq_drm.mk
+++ b/imx8m/vp6820_8mq/vp6820_8mq_drm.mk
@@ -1,7 +1,9 @@
 # This is a FSL Android Reference Design platform based on i.MX8MQ board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 
 PRODUCT_IMX_DRM := true
 
@@ -10,10 +12,10 @@ PRODUCT_COPY_FILES += \
 	$(IMX_DEVICE_PATH)/audio_policy_configuration_drm.xml:$(TARGET_COPY_OUT_VENDOR)/etc/audio_policy_configuration.xml \
 	$(IMX_DEVICE_PATH)/init.imx8mq.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.main.rc \
 	$(IMX_DEVICE_PATH)/init.imx8mq.drm.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/hw/init.nxp.imx8mq.rc \
-	$(TOPDIR)device/idtech/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
+	$(TOPDIR)$(CONFIG_REPO_PATH)/imx8m/tee-supplicant.rc:$(TARGET_COPY_OUT_VENDOR)/etc/init/tee-supplicant.rc \
 
 
-$(call inherit-product, $(TOPDIR)device/idtech/imx8m/optee-packages.mk)
+$(call inherit-product, $(TOPDIR)$(CONFIG_REPO_PATH)/imx8m/optee-packages.mk)
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mq.mk)
 
 TARGET_KERNEL_DEFCONFIG := imx_v8_android_defconfig
diff --git a/imx8m/vp6820_8mq/vp6820_8mq_go.mk b/imx8m/vp6820_8mq/vp6820_8mq_go.mk
index f2df960c..f676fa2a 100644
--- a/imx8m/vp6820_8mq/vp6820_8mq_go.mk
+++ b/imx8m/vp6820_8mq/vp6820_8mq_go.mk
@@ -1,7 +1,9 @@
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mq_common.mk)
 
 # Inherit common Android Go defaults.
@@ -10,10 +12,6 @@ $(call inherit-product, build/target/product/go_defaults_common.mk)
 # Overrides
 PRODUCT_NAME := vp6820_8mq_go
 
-# Add oem unlocking option in settings.
-PRODUCT_PROPERTY_OVERRIDES += ro.frp.pst=/dev/block/by-name/presistdata
-PRODUCT_COMPATIBLE_PROPERTY_OVERRIDE := true
-
 # lmkd can kill more now.
 PRODUCT_PROPERTY_OVERRIDES += \
      ro.lmk.medium=700 \
diff --git a/imx8m/vp6820_8mq/vp6820_8mq_pci.mk b/imx8m/vp6820_8mq/vp6820_8mq_pci.mk
index 246bc98f..45987c23 100644
--- a/imx8m/vp6820_8mq/vp6820_8mq_pci.mk
+++ b/imx8m/vp6820_8mq/vp6820_8mq_pci.mk
@@ -1,7 +1,9 @@
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mq_common.mk)
 
 # Overrides
diff --git a/imx8m/vp6820_8mq/vp6820_8mq_pcidev.mk b/imx8m/vp6820_8mq/vp6820_8mq_pcidev.mk
index e3a408ad..837300e2 100644
--- a/imx8m/vp6820_8mq/vp6820_8mq_pcidev.mk
+++ b/imx8m/vp6820_8mq/vp6820_8mq_pcidev.mk
@@ -1,7 +1,9 @@
 # This is a FSL Android Reference Design platform based on i.MX8QP ARD board
 # It will inherit from FSL core product which in turn inherit from Google generic
 
-IMX_DEVICE_PATH := device/idtech/imx8m/vp6820_8mq
+CONFIG_REPO_PATH := device/idtech
+CURRENT_FILE_PATH :=  $(lastword $(MAKEFILE_LIST))
+IMX_DEVICE_PATH := $(strip $(patsubst %/, %, $(dir $(CURRENT_FILE_PATH))))
 $(call inherit-product, $(TOPDIR)$(IMX_DEVICE_PATH)/vp6820_8mq_common.mk)
 
 # Overrides
